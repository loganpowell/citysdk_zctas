var kc=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},sd={exports:{}};(function(Kl,ch){(function(tt,_s){Kl.exports=_s()})(kc,function(){var tt,_s,Hs;function Au(h,Ei){if(!tt)tt=Ei;else if(!_s)_s=Ei;else{var Bt="var sharedChunk = {}; ("+tt+")(sharedChunk); ("+_s+")(sharedChunk);",En={};tt(En),Hs=Ei(En),typeof window!="undefined"&&(Hs.workerUrl=window.URL.createObjectURL(new Blob([Bt],{type:"text/javascript"})))}}return Au(["exports"],function(h){function Ei(t,e){return t(e={exports:{}},e.exports),e.exports}var Bt=En;function En(t,e,r,s){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=r,this.p2y=s}En.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},En.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},En.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},En.prototype.solveCurveX=function(t,e){var r,s,l,p,d;for(e===void 0&&(e=1e-6),l=t,d=0;d<8;d++){if(p=this.sampleCurveX(l)-t,Math.abs(p)<e)return l;var v=this.sampleCurveDerivativeX(l);if(Math.abs(v)<1e-6)break;l-=p/v}if((l=t)<(r=0))return r;if(l>(s=1))return s;for(;r<s;){if(p=this.sampleCurveX(l),Math.abs(p-t)<e)return l;t>p?r=l:s=l,l=.5*(s-r)+r}return l},En.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Te=pn;function pn(t,e){this.x=t,this.y=e}pn.prototype={clone:function(){return new pn(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),s=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=s,this},_rotateAround:function(t,e){var r=Math.cos(t),s=Math.sin(t),l=e.y+s*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-s*(this.y-e.y),this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},pn.convert=function(t){return t instanceof pn?t:Array.isArray(t)?new pn(t[0],t[1]):t};var Et=typeof self!="undefined"?self:{},je=Math.pow(2,53)-1;function Zn(t,e,r,s){var l=new Bt(t,e,r,s);return function(p){return l.solve(p)}}var To=Zn(.25,.1,.25,1);function Zr(t,e,r){return Math.min(r,Math.max(e,t))}function Zi(t,e,r){var s=r-e,l=((t-e)%s+s)%s+e;return l===e?r:l}function Zt(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var s=0,l=e;s<l.length;s+=1){var p=l[s];for(var d in p)t[d]=p[d]}return t}var Jn=1;function _e(){return Jn++}function Bn(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function ji(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Ai(t,e){t.forEach(function(r){e[r]&&(e[r]=e[r].bind(e))})}function oo(t,e){return t.indexOf(e,t.length-e.length)!==-1}function On(t,e,r){var s={};for(var l in t)s[l]=e.call(r||this,t[l],l,t);return s}function jo(t,e,r){var s={};for(var l in t)e.call(r||this,t[l],l,t)&&(s[l]=t[l]);return s}function ao(t){return Array.isArray(t)?t.map(ao):typeof t=="object"&&t?On(t,ao):t}var Ka={};function Jr(t){Ka[t]||(typeof console!="undefined"&&console.warn(t),Ka[t]=!0)}function ui(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function Ks(t){for(var e=0,r=0,s=t.length,l=s-1,p=void 0,d=void 0;r<s;l=r++)e+=((d=t[l]).x-(p=t[r]).x)*(p.y+d.y);return e}function li(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Gi(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(s,l,p,d){var v=p||d;return e[l]=!v||v.toLowerCase(),""}),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}var Bi=null;function Ys(t){if(Bi==null){var e=t.navigator?t.navigator.userAgent:null;Bi=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Bi}function so(t){try{var e=Et[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}var fn,Io,Ea,Go,Oi=Et.performance&&Et.performance.now?Et.performance.now.bind(Et.performance):Date.now.bind(Date),Ya=Et.requestAnimationFrame||Et.mozRequestAnimationFrame||Et.webkitRequestAnimationFrame||Et.msRequestAnimationFrame,$n=Et.cancelAnimationFrame||Et.mozCancelAnimationFrame||Et.webkitCancelAnimationFrame||Et.msCancelAnimationFrame,ci={now:Oi,frame:function(t){var e=Ya(t);return{cancel:function(){return $n(e)}}},getImageData:function(t,e){e===void 0&&(e=0);var r=Et.document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,s.drawImage(t,0,0,t.width,t.height),s.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return fn||(fn=Et.document.createElement("a")),fn.href=t,fn.href},hardwareConcurrency:Et.navigator&&Et.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Et.devicePixelRatio},get prefersReducedMotion(){return!!Et.matchMedia&&(Io==null&&(Io=Et.matchMedia("(prefers-reduced-motion: reduce)")),Io.matches)}},pr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Wi={supported:!1,testSupport:function(t){!Eo&&Go&&(hi?He(t):Ea=t)}},Eo=!1,hi=!1;function He(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Go),t.isContextLost())return;Wi.supported=!0}catch{}t.deleteTexture(e),Eo=!0}Et.document&&((Go=Et.document.createElement("img")).onload=function(){Ea&&He(Ea),Ea=null,hi=!0},Go.onerror=function(){Eo=!0,Ea=null},Go.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var An="01",dn=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Fi(t){return t.indexOf("mapbox:")===0}dn.prototype._createSkuToken=function(){var t=function(){for(var e="",r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",An,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},dn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},dn.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},dn.prototype.normalizeStyleURL=function(t,e){if(!Fi(t))return t;var r=Qn(t);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},dn.prototype.normalizeGlyphsURL=function(t,e){if(!Fi(t))return t;var r=Qn(t);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},dn.prototype.normalizeSourceURL=function(t,e){if(!Fi(t))return t;var r=Qn(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)},dn.prototype.normalizeSpriteURL=function(t,e,r,s){var l=Qn(t);return Fi(t)?(l.path="/styles/v1"+l.path+"/sprite"+e+r,this._makeAPIURL(l,this._customAccessToken||s)):(l.path+=""+e+r,jn(l))},dn.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Fi(t))return t;var r=Qn(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ci.devicePixelRatio>=2||e===512?"@2x":"")+(Wi.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var s=this._customAccessToken||function(l){for(var p=0,d=l;p<d.length;p+=1){var v=d[p].match(/^access_token=(.*)$/);if(v)return v[1]}return null}(r.params)||pr.ACCESS_TOKEN;return pr.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,s)},dn.prototype.canonicalizeTileURL=function(t,e){var r=Qn(t);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return t;var s="mapbox://tiles/";s+=r.path.replace("/v4/","");var l=r.params;return e&&(l=l.filter(function(p){return!p.match(/^access_token=/)})),l.length&&(s+="?"+l.join("&")),s},dn.prototype.canonicalizeTileset=function(t,e){for(var r=!!e&&Fi(e),s=[],l=0,p=t.tiles||[];l<p.length;l+=1){var d=p[l];Ui(d)?s.push(this.canonicalizeTileURL(d,r)):s.push(d)}return s},dn.prototype._makeAPIURL=function(t,e){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=Qn(pr.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,t.protocol==="http"){var l=t.params.indexOf("secure");l>=0&&t.params.splice(l,1)}if(s.path!=="/"&&(t.path=""+s.path+t.path),!pr.REQUIRE_ACCESS_TOKEN)return jn(t);if(!(e=e||pr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(e[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return t.params=t.params.filter(function(p){return p.indexOf("access_token")===-1}),t.params.push("access_token="+e),jn(t)},dn.prototype.setTransformRequest=function(t){this._transformRequestFn=t};var Xi=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ui(t){return Xi.test(t)}var Ja=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Qn(t){var e=t.match(Ja);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function jn(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function Ao(t){if(!t)return null;var e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(Et.atob(e[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var pi=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};pi.prototype.getStorageKey=function(t){var e,r=Ao(pr.ACCESS_TOKEN);return e=r&&r.u?Et.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(s,l){return String.fromCharCode(Number("0x"+l))})):pr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},pi.prototype.fetchEventData=function(){var t=so("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{var s=Et.localStorage.getItem(e);s&&(this.eventData=JSON.parse(s));var l=Et.localStorage.getItem(r);l&&(this.anonId=l)}catch{Jr("Unable to read from LocalStorage")}},pi.prototype.saveEventData=function(){var t=so("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{Et.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Et.localStorage.setItem(e,JSON.stringify(this.eventData))}catch{Jr("Unable to write to LocalStorage")}},pi.prototype.processRequests=function(t){},pi.prototype.postEvent=function(t,e,r,s){var l=this;if(pr.EVENTS_URL){var p=Qn(pr.EVENTS_URL);p.params.push("access_token="+(s||pr.ACCESS_TOKEN||""));var d={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.2",skuId:An,userId:this.anonId},v=e?Zt(d,e):d,x={url:jn(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=A(x,function(S){l.pendingRequest=null,r(S),l.saveEventData(),l.processRequests(s)})}},pi.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var Hi,uo,lo=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(r,s,l,p){this.skuToken=l,(pr.EVENTS_URL&&p||pr.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(d){return Fi(d)||Ui(d)}))&&this.queueRequest({id:s,timestamp:Date.now()},p)},e.prototype.processRequests=function(r){var s=this;if(!this.pendingRequest&&this.queue.length!==0){var l=this.queue.shift(),p=l.id,d=l.timestamp;p&&this.success[p]||(this.anonId||this.fetchEventData(),ji(this.anonId)||(this.anonId=Bn()),this.postEvent(d,{skuToken:this.skuToken},function(v){v||p&&(s.success[p]=!0)},r))}},e}(pi),ia=new(function(t){function e(r){t.call(this,"appUserTurnstile"),this._customAccessToken=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(r,s){pr.EVENTS_URL&&pr.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(l){return Fi(l)||Ui(l)})&&this.queueRequest(Date.now(),s)},e.prototype.processRequests=function(r){var s=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var l=Ao(pr.ACCESS_TOKEN),p=l?l.u:pr.ACCESS_TOKEN,d=p!==this.eventData.tokenU;ji(this.anonId)||(this.anonId=Bn(),d=!0);var v=this.queue.shift();if(this.eventData.lastSuccess){var x=new Date(this.eventData.lastSuccess),S=new Date(v),I=(v-this.eventData.lastSuccess)/864e5;d=d||I>=1||I<-1||x.getDate()!==S.getDate()}else d=!0;if(!d)return this.processRequests();this.postEvent(v,{"enabled.telemetry":!1},function(E){E||(s.eventData.lastSuccess=v,s.eventData.tokenU=p)},r)}},e}(pi)),Wo=ia.postTurnstileEvent.bind(ia),Aa=new lo,Pa=Aa.postMapLoadEvent.bind(Aa),oa=500,$a=50;function co(){Et.caches&&!Hi&&(Hi=Et.caches.open("mapbox-tiles"))}function Ca(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var Po,za=1/0;function ka(){return Po==null&&(Po=Et.OffscreenCanvas&&new Et.OffscreenCanvas(1,1).getContext("2d")&&typeof Et.createImageBitmap=="function"),Po}var Js={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Js);var xs=function(t){function e(r,s,l){s===401&&Ui(l)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,r),this.status=s,this.url=l,this.name=this.constructor.name,this.message=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),Ma=li()?function(){return self.worker&&self.worker.referrer}:function(){return(Et.location.protocol==="blob:"?Et.parent:Et).location.href};function aa(t,e){var r,s=new Et.AbortController,l=new Et.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:Ma(),signal:s.signal}),p=!1,d=!1,v=(r=l.url).indexOf("sku=")>0&&Ui(r);t.type==="json"&&l.headers.set("Accept","application/json");var x=function(I,E,k){if(!d){if(I&&I.message!=="SecurityError"&&Jr(I),E&&k)return S(E);var R=Date.now();Et.fetch(l).then(function(Z){if(Z.ok){var j=v?Z.clone():null;return S(Z,j,R)}return e(new xs(Z.statusText,Z.status,t.url))}).catch(function(Z){Z.code!==20&&e(new Error(Z.message))})}},S=function(I,E,k){(t.type==="arrayBuffer"?I.arrayBuffer():t.type==="json"?I.json():I.text()).then(function(R){d||(E&&k&&function(Z,j,it){if(co(),Hi){var J={status:j.status,statusText:j.statusText,headers:new Et.Headers};j.headers.forEach(function(dt,_t){return J.headers.set(_t,dt)});var pt=Gi(j.headers.get("Cache-Control")||"");pt["no-store"]||(pt["max-age"]&&J.headers.set("Expires",new Date(it+1e3*pt["max-age"]).toUTCString()),new Date(J.headers.get("Expires")).getTime()-it<42e4||function(dt,_t){if(uo===void 0)try{new Response(new ReadableStream),uo=!0}catch{uo=!1}uo?_t(dt.body):dt.blob().then(_t)}(j,function(dt){var _t=new Et.Response(dt,J);co(),Hi&&Hi.then(function(xt){return xt.put(Ca(Z.url),_t)}).catch(function(xt){return Jr(xt.message)})}))}}(l,E,k),p=!0,e(null,R,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(function(R){d||e(new Error(R.message))})};return v?function(I,E){if(co(),!Hi)return E(null);var k=Ca(I.url);Hi.then(function(R){R.match(k).then(function(Z){var j=function(it){if(!it)return!1;var J=new Date(it.headers.get("Expires")||0),pt=Gi(it.headers.get("Cache-Control")||"");return J>Date.now()&&!pt["no-cache"]}(Z);R.delete(k),j&&R.put(k,Z.clone()),E(null,Z,j)}).catch(E)}).catch(E)}(l,x):x(null,null),{cancel:function(){d=!0,p||s.abort()}}}var Co,La,Qa=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(li()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!li()){var r=t.url.substring(0,t.url.indexOf("://"));return(pr.REGISTERED_PROTOCOLS[r]||aa)(t,e)}}if(!(/^file:/.test(s=t.url)||/^file:/.test(Ma())&&!/^\w+:/.test(s))){if(Et.fetch&&Et.Request&&Et.AbortController&&Et.Request.prototype.hasOwnProperty("signal"))return aa(t,e);if(li()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var s;return function(l,p){var d=new Et.XMLHttpRequest;for(var v in d.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(d.responseType="arraybuffer"),l.headers)d.setRequestHeader(v,l.headers[v]);return l.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=l.credentials==="include",d.onerror=function(){p(new Error(d.statusText))},d.onload=function(){if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){var x=d.response;if(l.type==="json")try{x=JSON.parse(d.response)}catch(S){return p(S)}p(null,x,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else p(new xs(d.statusText,d.status,l.url))},d.send(l.body),{cancel:function(){return d.abort()}}}(t,e)},Gr=function(t,e){return Qa(Zt(t,{type:"arrayBuffer"}),e)},A=function(t,e){return Qa(Zt(t,{method:"POST"}),e)},M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Co=[],La=0;var L=function(t,e){if(Wi.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),La>=pr.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return Co.push(r),r}La++;var s=!1,l=function(){if(!s)for(s=!0,La--;Co.length&&La<pr.MAX_PARALLEL_IMAGE_REQUESTS;){var d=Co.shift();d.cancelled||(d.cancel=L(d.requestParameters,d.callback).cancel)}},p=Gr(t,function(d,v,x,S){l(),d?e(d):v&&(ka()?function(I,E){var k=new Et.Blob([new Uint8Array(I)],{type:"image/png"});Et.createImageBitmap(k).then(function(R){E(null,R)}).catch(function(R){E(new Error("Could not load image because of "+R.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(v,e):function(I,E,k,R){var Z=new Et.Image,j=Et.URL;Z.onload=function(){E(null,Z),j.revokeObjectURL(Z.src),Z.onload=null,Et.requestAnimationFrame(function(){Z.src=M})},Z.onerror=function(){return E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var it=new Et.Blob([new Uint8Array(I)],{type:"image/png"});Z.cacheControl=k,Z.expires=R,Z.src=I.byteLength?j.createObjectURL(it):M}(v,e,x,S))});return{cancel:function(){p.cancel(),l()}}};function N(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function X(t,e,r){if(r&&r[t]){var s=r[t].indexOf(e);s!==-1&&r[t].splice(s,1)}}var rt=function(t,e){e===void 0&&(e={}),Zt(this,e),this.type=t},st=function(t){function e(r,s){s===void 0&&(s={}),t.call(this,"error",Zt({error:r},s))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(rt),nt=function(){};nt.prototype.on=function(t,e){return this._listeners=this._listeners||{},N(t,e,this._listeners),this},nt.prototype.off=function(t,e){return X(t,e,this._listeners),X(t,e,this._oneTimeListeners),this},nt.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},N(t,e,this._oneTimeListeners),this},nt.prototype.fire=function(t,e){typeof t=="string"&&(t=new rt(t,e||{}));var r=t.type;if(this.listens(r)){t.target=this;for(var s=0,l=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];s<l.length;s+=1)l[s].call(this,t);for(var p=0,d=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];p<d.length;p+=1){var v=d[p];X(r,v,this._oneTimeListeners),v.call(this,t)}var x=this._eventedParent;x&&(Zt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(t))}else t instanceof st&&console.error(t.error);return this},nt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},nt.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var V={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Y=function(t,e,r,s){this.message=(t?t+": ":"")+r,s&&(this.identifier=s),e!=null&&e.__line__&&(this.line=e.__line__)};function Lt(t){var e=t.value;return e?[new Y(t.key,e,"constants have been deprecated as of v8")]:[]}function Wt(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var s=0,l=e;s<l.length;s+=1){var p=l[s];for(var d in p)t[d]=p[d]}return t}function vt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Rt(t){if(Array.isArray(t))return t.map(Rt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var r in t)e[r]=Rt(t[r]);return e}return vt(t)}var ee=function(t){function e(r,s){t.call(this,s),this.message=s,this.key=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),re=function(t,e){e===void 0&&(e=[]),this.parent=t,this.bindings={};for(var r=0,s=e;r<s.length;r+=1){var l=s[r];this.bindings[l[0]]=l[1]}};re.prototype.concat=function(t){return new re(this,t)},re.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},re.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var ce={kind:"null"},At={kind:"number"},Ht={kind:"string"},kt={kind:"boolean"},Me={kind:"color"},Le={kind:"object"},ne={kind:"value"},_r={kind:"collator"},we={kind:"formatted"},br={kind:"resolvedImage"};function Mr(t,e){return{kind:"array",itemType:t,N:e}}function rr(t){if(t.kind==="array"){var e=rr(t.itemType);return typeof t.N=="number"?"array<"+e+", "+t.N+">":t.itemType.kind==="value"?"array":"array<"+e+">"}return t.kind}var wr=[ce,At,Ht,kt,Me,we,Le,Mr(ne),br];function Fr(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Fr(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(var r=0,s=wr;r<s.length;r+=1)if(!Fr(s[r],e))return null}}return"Expected "+rr(t)+" but found "+rr(e)+" instead."}function Sr(t,e){return e.some(function(r){return r.kind===t.kind})}function Ve(t,e){return e.some(function(r){return r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t})}var ts=Ei(function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(v){return(v=Math.round(v))<0?0:v>255?255:v}function l(v){return s(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function p(v){return(x=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:x>1?1:x;var x}function d(v,x,S){return S<0?S+=1:S>1&&(S-=1),6*S<1?v+(x-v)*S*6:2*S<1?x:3*S<2?v+(x-v)*(2/3-S)*6:v}try{e.parseCSSColor=function(v){var x,S=v.replace(/ /g,"").toLowerCase();if(S in r)return r[S].slice();if(S[0]==="#")return S.length===4?(x=parseInt(S.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:S.length===7&&(x=parseInt(S.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var I=S.indexOf("("),E=S.indexOf(")");if(I!==-1&&E+1===S.length){var k=S.substr(0,I),R=S.substr(I+1,E-(I+1)).split(","),Z=1;switch(k){case"rgba":if(R.length!==4)return null;Z=p(R.pop());case"rgb":return R.length!==3?null:[l(R[0]),l(R[1]),l(R[2]),Z];case"hsla":if(R.length!==4)return null;Z=p(R.pop());case"hsl":if(R.length!==3)return null;var j=(parseFloat(R[0])%360+360)%360/360,it=p(R[1]),J=p(R[2]),pt=J<=.5?J*(it+1):J+it-J*it,dt=2*J-pt;return[s(255*d(dt,pt,j+1/3)),s(255*d(dt,pt,j)),s(255*d(dt,pt,j-1/3)),Z];default:return null}}return null}}catch{}}).parseCSSColor,Ye=function(t,e,r,s){s===void 0&&(s=1),this.r=t,this.g=e,this.b=r,this.a=s};Ye.parse=function(t){if(t){if(t instanceof Ye)return t;if(typeof t=="string"){var e=ts(t);if(e)return new Ye(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Ye.prototype.toString=function(){var t=this.toArray(),e=t[1],r=t[2],s=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(r)+","+s+")"},Ye.prototype.toArray=function(){var t=this.a;return t===0?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Ye.black=new Ye(0,0,0,1),Ye.white=new Ye(1,1,1,1),Ye.transparent=new Ye(0,0,0,0),Ye.red=new Ye(1,0,0,1);var Da=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Da.prototype.compare=function(t,e){return this.collator.compare(t,e)},Da.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var es=function(t,e,r,s,l){this.text=t,this.image=e,this.scale=r,this.fontStack=s,this.textColor=l},nn=function(t){this.sections=t};nn.fromString=function(t){return new nn([new es(t,null,null,null,null)])},nn.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(t){return t.text.length!==0||t.image&&t.image.name.length!==0})},nn.factory=function(t){return t instanceof nn?t:nn.fromString(t)},nn.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(t){return t.text}).join("")},nn.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var s=r[e];if(s.image)t.push(["image",s.image.name]);else{t.push(s.text);var l={};s.fontStack&&(l["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(l["font-scale"]=s.scale),s.textColor&&(l["text-color"]=["rgba"].concat(s.textColor.toArray())),t.push(l)}}return t};var Gn=function(t){this.name=t.name,this.available=t.available};function $s(t,e,r,s){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:"Invalid rgba value ["+[t,e,r,s].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof s=="number"?[t,e,r,s]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Xo(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Ye||t instanceof Da||t instanceof nn||t instanceof Gn)return!0;if(Array.isArray(t)){for(var e=0,r=t;e<r.length;e+=1)if(!Xo(r[e]))return!1;return!0}if(typeof t=="object"){for(var s in t)if(!Xo(t[s]))return!1;return!0}return!1}function wn(t){if(t===null)return ce;if(typeof t=="string")return Ht;if(typeof t=="boolean")return kt;if(typeof t=="number")return At;if(t instanceof Ye)return Me;if(t instanceof Da)return _r;if(t instanceof nn)return we;if(t instanceof Gn)return br;if(Array.isArray(t)){for(var e,r=t.length,s=0,l=t;s<l.length;s+=1){var p=wn(l[s]);if(e){if(e===p)continue;e=ne;break}e=p}return Mr(e||ne,r)}return Le}function ho(t){var e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Ye||t instanceof nn||t instanceof Gn?t.toString():JSON.stringify(t)}Gn.prototype.toString=function(){return this.name},Gn.fromString=function(t){return t?new Gn({name:t,available:!1}):null},Gn.prototype.serialize=function(){return["image",this.name]};var fi=function(t,e){this.type=t,this.value=e};fi.parse=function(t,e){if(t.length!==2)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!Xo(t[1]))return e.error("invalid value");var r=t[1],s=wn(r),l=e.expectedType;return s.kind!=="array"||s.N!==0||!l||l.kind!=="array"||typeof l.N=="number"&&l.N!==0||(s=l),new fi(s,r)},fi.prototype.evaluate=function(){return this.value},fi.prototype.eachChild=function(){},fi.prototype.outputDefined=function(){return!0},fi.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ye?["rgba"].concat(this.value.toArray()):this.value instanceof nn?this.value.serialize():this.value};var Ur=function(t){this.name="ExpressionEvaluationError",this.message=t};Ur.prototype.toJSON=function(){return this.message};var di={string:Ht,number:At,boolean:kt,object:Le},Fn=function(t,e){this.type=t,this.args=e};Fn.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,s=1,l=t[0];if(l==="array"){var p,d;if(t.length>2){var v=t[1];if(typeof v!="string"||!(v in di)||v==="object")return e.error('The item type argument of "array" must be one of string, number, boolean',1);p=di[v],s++}else p=ne;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);d=t[2],s++}r=Mr(p,d)}else r=di[l];for(var x=[];s<t.length;s++){var S=e.parse(t[s],s,ne);if(!S)return null;x.push(S)}return new Fn(r,x)},Fn.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!Fr(this.type,wn(r)))return r;if(e===this.args.length-1)throw new Ur("Expected value to be of type "+rr(this.type)+", but found "+rr(wn(r))+" instead.")}return null},Fn.prototype.eachChild=function(t){this.args.forEach(t)},Fn.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Fn.prototype.serialize=function(){var t=this.type,e=[t.kind];if(t.kind==="array"){var r=t.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){e.push(r.kind);var s=t.N;(typeof s=="number"||this.args.length>1)&&e.push(s)}}return e.concat(this.args.map(function(l){return l.serialize()}))};var mi=function(t){this.type=we,this.sections=t};mi.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&typeof r=="object")return e.error("First argument must be an image or text section.");for(var s=[],l=!1,p=1;p<=t.length-1;++p){var d=t[p];if(l&&typeof d=="object"&&!Array.isArray(d)){l=!1;var v=null;if(d["font-scale"]&&!(v=e.parse(d["font-scale"],1,At)))return null;var x=null;if(d["text-font"]&&!(x=e.parse(d["text-font"],1,Mr(Ht))))return null;var S=null;if(d["text-color"]&&!(S=e.parse(d["text-color"],1,Me)))return null;var I=s[s.length-1];I.scale=v,I.font=x,I.textColor=S}else{var E=e.parse(t[p],1,ne);if(!E)return null;var k=E.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");l=!0,s.push({content:E,scale:null,font:null,textColor:null})}}return new mi(s)},mi.prototype.evaluate=function(t){return new nn(this.sections.map(function(e){var r=e.content.evaluate(t);return wn(r)===br?new es("",r,null,null,null):new es(ho(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))},mi.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var s=r[e];t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}},mi.prototype.outputDefined=function(){return!1},mi.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var s=r[e];t.push(s.content.serialize());var l={};s.scale&&(l["font-scale"]=s.scale.serialize()),s.font&&(l["text-font"]=s.font.serialize()),s.textColor&&(l["text-color"]=s.textColor.serialize()),t.push(l)}return t};var po=function(t){this.type=br,this.input=t};po.parse=function(t,e){if(t.length!==2)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Ht);return r?new po(r):e.error("No image name provided.")},po.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=Gn.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r},po.prototype.eachChild=function(t){t(this.input)},po.prototype.outputDefined=function(){return!1},po.prototype.serialize=function(){return["image",this.input.serialize()]};var Yl={"to-boolean":kt,"to-color":Me,"to-number":At,"to-string":Ht},Pi=function(t,e){this.type=t,this.args=e};Pi.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if((r==="to-boolean"||r==="to-string")&&t.length!==2)return e.error("Expected one argument.");for(var s=Yl[r],l=[],p=1;p<t.length;p++){var d=e.parse(t[p],p,ne);if(!d)return null;l.push(d)}return new Pi(s,l)},Pi.prototype.evaluate=function(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){for(var e,r,s=0,l=this.args;s<l.length;s+=1){if(r=null,(e=l[s].evaluate(t))instanceof Ye)return e;if(typeof e=="string"){var p=t.parseColor(e);if(p)return p}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":$s(e[0],e[1],e[2],e[3])))return new Ye(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Ur(r||"Could not parse color from value '"+(typeof e=="string"?e:String(JSON.stringify(e)))+"'")}if(this.type.kind==="number"){for(var d=null,v=0,x=this.args;v<x.length;v+=1){if((d=x[v].evaluate(t))===null)return 0;var S=Number(d);if(!isNaN(S))return S}throw new Ur("Could not convert "+JSON.stringify(d)+" to number.")}return this.type.kind==="formatted"?nn.fromString(ho(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Gn.fromString(ho(this.args[0].evaluate(t))):ho(this.args[0].evaluate(t))},Pi.prototype.eachChild=function(t){this.args.forEach(t)},Pi.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Pi.prototype.serialize=function(){if(this.type.kind==="formatted")return new mi([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new po(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var Qs=["Unknown","Point","LineString","Polygon"],fo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};fo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},fo.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Qs[this.feature.type]:this.feature.type:null},fo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},fo.prototype.canonicalID=function(){return this.canonical},fo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},fo.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Ye.parse(t)),e};var $r=function(t,e,r,s){this.name=t,this.type=e,this._evaluate=r,this.args=s};$r.prototype.evaluate=function(t){return this._evaluate(t,this.args)},$r.prototype.eachChild=function(t){this.args.forEach(t)},$r.prototype.outputDefined=function(){return!1},$r.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},$r.parse=function(t,e){var r,s=t[0],l=$r.definitions[s];if(!l)return e.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0);for(var p=Array.isArray(l)?l[0]:l.type,d=Array.isArray(l)?[[l[1],l[2]]]:l.overloads,v=d.filter(function(fe){var Qt=fe[0];return!Array.isArray(Qt)||Qt.length===t.length-1}),x=null,S=0,I=v;S<I.length;S+=1){var E=I[S],k=E[0],R=E[1];x=new xr(e.registry,e.path,null,e.scope);for(var Z=[],j=!1,it=1;it<t.length;it++){var J=t[it],pt=Array.isArray(k)?k[it-1]:k.type,dt=x.parse(J,1+Z.length,pt);if(!dt){j=!0;break}Z.push(dt)}if(!j)if(Array.isArray(k)&&k.length!==Z.length)x.error("Expected "+k.length+" arguments, but found "+Z.length+" instead.");else{for(var _t=0;_t<Z.length;_t++){var xt=Array.isArray(k)?k[_t]:k.type,Pt=Z[_t];x.concat(_t+1).checkSubtype(xt,Pt.type)}if(x.errors.length===0)return new $r(s,p,R,Z)}}if(v.length===1)(r=e.errors).push.apply(r,x.errors);else{for(var qt=(v.length?v:d).map(function(fe){var Qt;return Qt=fe[0],Array.isArray(Qt)?"("+Qt.map(rr).join(", ")+")":"("+rr(Qt.type)+"...)"}).join(" | "),Yt=[],se=1;se<t.length;se++){var $t=e.parse(t[se],1+Yt.length);if(!$t)return null;Yt.push(rr($t.type))}e.error("Expected arguments of type "+qt+", but found ("+Yt.join(", ")+") instead.")}return null},$r.register=function(t,e){for(var r in $r.definitions=e,e)t[r]=$r};var on=function(t,e,r){this.type=_r,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};function Ra(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function tu(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function dl(t,e){var r=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,l=Math.pow(2,e.z);return[Math.round(r*l*8192),Math.round(s*l*8192)]}function ml(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function bs(t,e){for(var r,s,l,p,d,v,x,S=!1,I=0,E=e.length;I<E;I++)for(var k=e[I],R=0,Z=k.length;R<Z-1;R++){if((p=(r=t)[0]-(s=k[R])[0])*(x=r[1]-(l=k[R+1])[1])-(v=r[0]-l[0])*(d=r[1]-s[1])==0&&p*v<=0&&d*x<=0)return!1;ml(t,k[R],k[R+1])&&(S=!S)}return S}function gl(t,e){for(var r=0;r<e.length;r++)if(bs(t,e[r]))return!0;return!1}function yl(t,e,r,s){var l=s[0]-r[0],p=s[1]-r[1],d=(t[0]-r[0])*p-l*(t[1]-r[1]),v=(e[0]-r[0])*p-l*(e[1]-r[1]);return d>0&&v<0||d<0&&v>0}function Jl(t,e,r){for(var s=0,l=r;s<l.length;s+=1)for(var p=l[s],d=0;d<p.length-1;++d)if((E=[(I=p[d+1])[0]-(S=p[d])[0],I[1]-S[1]])[0]*(k=[(x=e)[0]-(v=t)[0],x[1]-v[1]])[1]-E[1]*k[0]!=0&&yl(v,x,S,I)&&yl(S,I,v,x))return!0;var v,x,S,I,E,k;return!1}function Pu(t,e){for(var r=0;r<t.length;++r)if(!bs(t[r],e))return!1;for(var s=0;s<t.length-1;++s)if(Jl(t[s],t[s+1],e))return!1;return!0}function ws(t,e){for(var r=0;r<e.length;r++)if(Pu(t,e[r]))return!0;return!1}function eu(t,e,r){for(var s=[],l=0;l<t.length;l++){for(var p=[],d=0;d<t[l].length;d++){var v=dl(t[l][d],r);Ra(e,v),p.push(v)}s.push(p)}return s}function zo(t,e,r){for(var s=[],l=0;l<t.length;l++){var p=eu(t[l],e,r);s.push(p)}return s}function vl(t,e,r,s){if(t[0]<r[0]||t[0]>r[2]){var l=.5*s,p=t[0]-r[0]>l?-s:r[0]-t[0]>l?s:0;p===0&&(p=t[0]-r[2]>l?-s:r[2]-t[0]>l?s:0),t[0]+=p}Ra(e,t)}function ru(t,e,r,s){for(var l=8192*Math.pow(2,s.z),p=[8192*s.x,8192*s.y],d=[],v=0,x=t;v<x.length;v+=1)for(var S=0,I=x[v];S<I.length;S+=1){var E=I[S],k=[E.x+p[0],E.y+p[1]];vl(k,e,r,l),d.push(k)}return d}function Ss(t,e,r,s){for(var l,p=8192*Math.pow(2,s.z),d=[8192*s.x,8192*s.y],v=[],x=0,S=t;x<S.length;x+=1){for(var I=[],E=0,k=S[x];E<k.length;E+=1){var R=k[E],Z=[R.x+d[0],R.y+d[1]];Ra(e,Z),I.push(Z)}v.push(I)}if(e[2]-e[0]<=p/2){(l=e)[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(var j=0,it=v;j<it.length;j+=1)for(var J=0,pt=it[j];J<pt.length;J+=1)vl(pt[J],e,r,p)}return v}on.parse=function(t,e){if(t.length!==2)return e.error("Expected one argument.");var r=t[1];if(typeof r!="object"||Array.isArray(r))return e.error("Collator options argument must be an object.");var s=e.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,kt);if(!s)return null;var l=e.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,kt);if(!l)return null;var p=null;return r.locale&&!(p=e.parse(r.locale,1,Ht))?null:new on(s,l,p)},on.prototype.evaluate=function(t){return new Da(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},on.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},on.prototype.outputDefined=function(){return!1},on.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var gi=function(t,e){this.type=kt,this.geojson=t,this.geometries=e};function Ba(t){if(t instanceof $r&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof gi)return!1;var e=!0;return t.eachChild(function(r){e&&!Ba(r)&&(e=!1)}),e}function sa(t){if(t instanceof $r&&t.name==="feature-state")return!1;var e=!0;return t.eachChild(function(r){e&&!sa(r)&&(e=!1)}),e}function nu(t,e){if(t instanceof $r&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild(function(s){r&&!nu(s,e)&&(r=!1)}),r}gi.parse=function(t,e){if(t.length!==2)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(Xo(t[1])){var r=t[1];if(r.type==="FeatureCollection")for(var s=0;s<r.features.length;++s){var l=r.features[s].geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new gi(r,r.features[s].geometry)}else if(r.type==="Feature"){var p=r.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new gi(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new gi(r,r)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},gi.prototype.evaluate=function(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(e,r){var s=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if(r.type==="Polygon"){var d=eu(r.coordinates,l,p),v=ru(e.geometry(),s,l,p);if(!tu(s,l))return!1;for(var x=0,S=v;x<S.length;x+=1)if(!bs(S[x],d))return!1}if(r.type==="MultiPolygon"){var I=zo(r.coordinates,l,p),E=ru(e.geometry(),s,l,p);if(!tu(s,l))return!1;for(var k=0,R=E;k<R.length;k+=1)if(!gl(R[k],I))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(e,r){var s=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if(r.type==="Polygon"){var d=eu(r.coordinates,l,p),v=Ss(e.geometry(),s,l,p);if(!tu(s,l))return!1;for(var x=0,S=v;x<S.length;x+=1)if(!Pu(S[x],d))return!1}if(r.type==="MultiPolygon"){var I=zo(r.coordinates,l,p),E=Ss(e.geometry(),s,l,p);if(!tu(s,l))return!1;for(var k=0,R=E;k<R.length;k+=1)if(!ws(R[k],I))return!1}return!0}(t,this.geometries)}return!1},gi.prototype.eachChild=function(){},gi.prototype.outputDefined=function(){return!0},gi.prototype.serialize=function(){return["within",this.geojson]};var ua=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};ua.parse=function(t,e){if(t.length!==2||typeof t[1]!="string")return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new ua(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ua.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},ua.prototype.eachChild=function(){},ua.prototype.outputDefined=function(){return!1},ua.prototype.serialize=function(){return["var",this.name]};var xr=function(t,e,r,s,l){e===void 0&&(e=[]),s===void 0&&(s=new re),l===void 0&&(l=[]),this.registry=t,this.path=e,this.key=e.map(function(p){return"["+p+"]"}).join(""),this.scope=s,this.errors=l,this.expectedType=r};function mr(t,e){for(var r,s=t.length-1,l=0,p=s,d=0;l<=p;)if((r=t[d=Math.floor((l+p)/2)])<=e){if(d===s||e<t[d+1])return d;l=d+1}else{if(!(r>e))throw new Ur("Input is not a number.");p=d-1}return 0}xr.prototype.parse=function(t,e,r,s,l){return l===void 0&&(l={}),e?this.concat(e,r,s)._parse(t,l):this._parse(t,l)},xr.prototype._parse=function(t,e){function r(S,I,E){return E==="assert"?new Fn(I,[S]):E==="coerce"?new Pi(I,[S]):S}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=t[0];if(typeof s!="string")return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var l=this.registry[s];if(l){var p=l.parse(t,this);if(!p)return null;if(this.expectedType){var d=this.expectedType,v=p.type;if(d.kind!=="string"&&d.kind!=="number"&&d.kind!=="boolean"&&d.kind!=="object"&&d.kind!=="array"||v.kind!=="value")if(d.kind!=="color"&&d.kind!=="formatted"&&d.kind!=="resolvedImage"||v.kind!=="value"&&v.kind!=="string"){if(this.checkSubtype(d,v))return null}else p=r(p,d,e.typeAnnotation||"coerce");else p=r(p,d,e.typeAnnotation||"assert")}if(!(p instanceof fi)&&p.type.kind!=="resolvedImage"&&function S(I){if(I instanceof ua)return S(I.boundExpression);if(I instanceof $r&&I.name==="error"||I instanceof on||I instanceof gi)return!1;var E=I instanceof Pi||I instanceof Fn,k=!0;return I.eachChild(function(R){k=E?k&&S(R):k&&R instanceof fi}),!!k&&Ba(I)&&nu(I,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(p)){var x=new fo;try{p=new fi(p.type,p.evaluate(x))}catch(S){return this.error(S.message),null}}return p}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},xr.prototype.concat=function(t,e,r){var s=typeof t=="number"?this.path.concat(t):this.path,l=r?this.scope.concat(r):this.scope;return new xr(this.registry,s,e||null,l,this.errors)},xr.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var s=""+this.key+e.map(function(l){return"["+l+"]"}).join("");this.errors.push(new ee(s,t))},xr.prototype.checkSubtype=function(t,e){var r=Fr(t,e);return r&&this.error(r),r};var Ki=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var s=0,l=r;s<l.length;s+=1){var p=l[s],d=p[1];this.labels.push(p[0]),this.outputs.push(d)}};function Wr(t,e,r){return t*(1-r)+e*r}Ki.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,At);if(!r)return null;var s=[],l=null;e.expectedType&&e.expectedType.kind!=="value"&&(l=e.expectedType);for(var p=1;p<t.length;p+=2){var d=p===1?-1/0:t[p],v=t[p+1],x=p,S=p+1;if(typeof d!="number")return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',x);if(s.length&&s[s.length-1][0]>=d)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',x);var I=e.parse(v,S,l);if(!I)return null;l=l||I.type,s.push([d,I])}return new Ki(l,r,s)},Ki.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(e.length===1)return r[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return r[0].evaluate(t);var l=e.length;return s>=e[l-1]?r[l-1].evaluate(t):r[mr(e,s)].evaluate(t)},Ki.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Ki.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Ki.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var iu=Object.freeze({__proto__:null,number:Wr,color:function(t,e,r){return new Ye(Wr(t.r,e.r,r),Wr(t.g,e.g,r),Wr(t.b,e.b,r),Wr(t.a,e.a,r))},array:function(t,e,r){return t.map(function(s,l){return Wr(s,e[l],r)})}}),Cu=6/29*3*(6/29),$l=Math.PI/180,Ql=180/Math.PI;function ou(t){return t>.008856451679035631?Math.pow(t,1/3):t/Cu+4/29}function zu(t){return t>6/29?t*t*t:Cu*(t-4/29)}function Pn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ts(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function la(t){var e=Ts(t.r),r=Ts(t.g),s=Ts(t.b),l=ou((.4124564*e+.3575761*r+.1804375*s)/.95047),p=ou((.2126729*e+.7151522*r+.072175*s)/1);return{l:116*p-16,a:500*(l-p),b:200*(p-ou((.0193339*e+.119192*r+.9503041*s)/1.08883)),alpha:t.a}}function ku(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*zu(e),r=.95047*zu(r),s=1.08883*zu(s),new Ye(Pn(3.2404542*r-1.5371385*e-.4985314*s),Pn(-.969266*r+1.8760108*e+.041556*s),Pn(.0556434*r-.2040259*e+1.0572252*s),t.alpha)}function Mu(t,e,r){var s=e-t;return t+r*(s>180||s<-180?s-360*Math.round(s/360):s)}var ti={forward:la,reverse:ku,interpolate:function(t,e,r){return{l:Wr(t.l,e.l,r),a:Wr(t.a,e.a,r),b:Wr(t.b,e.b,r),alpha:Wr(t.alpha,e.alpha,r)}}},ca={forward:function(t){var e=la(t),r=e.l,s=e.a,l=e.b,p=Math.atan2(l,s)*Ql;return{h:p<0?p+360:p,c:Math.sqrt(s*s+l*l),l:r,alpha:t.a}},reverse:function(t){var e=t.h*$l,r=t.c;return ku({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:Mu(t.h,e.h,r),c:Wr(t.c,e.c,r),l:Wr(t.l,e.l,r),alpha:Wr(t.alpha,e.alpha,r)}}},ei=Object.freeze({__proto__:null,lab:ti,hcl:ca}),Sn=function(t,e,r,s,l){this.type=t,this.operator=e,this.interpolation=r,this.input=s,this.labels=[],this.outputs=[];for(var p=0,d=l;p<d.length;p+=1){var v=d[p],x=v[1];this.labels.push(v[0]),this.outputs.push(x)}};function Is(t,e,r,s){var l=s-r,p=t-r;return l===0?0:e===1?p/l:(Math.pow(e,p)-1)/(Math.pow(e,l)-1)}Sn.interpolationFactor=function(t,e,r,s){var l=0;if(t.name==="exponential")l=Is(e,t.base,r,s);else if(t.name==="linear")l=Is(e,1,r,s);else if(t.name==="cubic-bezier"){var p=t.controlPoints;l=new Bt(p[0],p[1],p[2],p[3]).solve(Is(e,1,r,s))}return l},Sn.parse=function(t,e){var r=t[0],s=t[1],l=t[2],p=t.slice(3);if(!Array.isArray(s)||s.length===0)return e.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){var d=s[1];if(typeof d!="number")return e.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:d}}else{if(s[0]!=="cubic-bezier")return e.error("Unknown interpolation type "+String(s[0]),1,0);var v=s.slice(1);if(v.length!==4||v.some(function(it){return typeof it!="number"||it<0||it>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:v}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(l=e.parse(l,2,At)))return null;var x=[],S=null;r==="interpolate-hcl"||r==="interpolate-lab"?S=Me:e.expectedType&&e.expectedType.kind!=="value"&&(S=e.expectedType);for(var I=0;I<p.length;I+=2){var E=p[I],k=p[I+1],R=I+3,Z=I+4;if(typeof E!="number")return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(x.length&&x[x.length-1][0]>=E)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);var j=e.parse(k,Z,S);if(!j)return null;S=S||j.type,x.push([E,j])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new Sn(S,r,s,l,x):e.error("Type "+rr(S)+" is not interpolatable.")},Sn.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(e.length===1)return r[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return r[0].evaluate(t);var l=e.length;if(s>=e[l-1])return r[l-1].evaluate(t);var p=mr(e,s),d=Sn.interpolationFactor(this.interpolation,s,e[p],e[p+1]),v=r[p].evaluate(t),x=r[p+1].evaluate(t);return this.operator==="interpolate"?iu[this.type.kind.toLowerCase()](v,x,d):this.operator==="interpolate-hcl"?ca.reverse(ca.interpolate(ca.forward(v),ca.forward(x),d)):ti.reverse(ti.interpolate(ti.forward(v),ti.forward(x),d))},Sn.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},Sn.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Sn.prototype.serialize=function(){var t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var ko=function(t,e){this.type=t,this.args=e};ko.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,s=e.expectedType;s&&s.kind!=="value"&&(r=s);for(var l=[],p=0,d=t.slice(1);p<d.length;p+=1){var v=e.parse(d[p],1+l.length,r,void 0,{typeAnnotation:"omit"});if(!v)return null;r=r||v.type,l.push(v)}var x=s&&l.some(function(S){return Fr(s,S.type)});return new ko(x?ne:r,l)},ko.prototype.evaluate=function(t){for(var e,r=null,s=0,l=0,p=this.args;l<p.length&&(s++,(r=p[l].evaluate(t))&&r instanceof Gn&&!r.available&&(e||(e=r.name),r=null,s===this.args.length&&(r=e)),r===null);l+=1);return r},ko.prototype.eachChild=function(t){this.args.forEach(t)},ko.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},ko.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ho=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Ho.prototype.evaluate=function(t){return this.result.evaluate(t)},Ho.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},Ho.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],s=1;s<t.length-1;s+=2){var l=t[s];if(typeof l!="string")return e.error("Expected string, but found "+typeof l+" instead.",s);if(/[^a-zA-Z0-9_]/.test(l))return e.error("Variable names must contain only alphanumeric characters or '_'.",s);var p=e.parse(t[s+1],s+1);if(!p)return null;r.push([l,p])}var d=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return d?new Ho(r,d):null},Ho.prototype.outputDefined=function(){return this.result.outputDefined()},Ho.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var s=r[e];t.push(s[0],s[1].serialize())}return t.push(this.result.serialize()),t};var mn=function(t,e,r){this.type=t,this.index=e,this.input=r};mn.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,At),s=e.parse(t[2],2,Mr(e.expectedType||ne));return r&&s?new mn(s.type.itemType,r,s):null},mn.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new Ur("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new Ur("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new Ur("Array index must be an integer, but found "+e+" instead.");return r[e]},mn.prototype.eachChild=function(t){t(this.index),t(this.input)},mn.prototype.outputDefined=function(){return!1},mn.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Yi=function(t,e){this.type=kt,this.needle=t,this.haystack=e};Yi.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,ne),s=e.parse(t[2],2,ne);return r&&s?Sr(r.type,[kt,Ht,At,ce,ne])?new Yi(r,s):e.error("Expected first argument to be of type boolean, string, number or null, but found "+rr(r.type)+" instead"):null},Yi.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!Ve(e,["boolean","string","number","null"]))throw new Ur("Expected first argument to be of type boolean, string, number or null, but found "+rr(wn(e))+" instead.");if(!Ve(r,["string","array"]))throw new Ur("Expected second argument to be of type array or string, but found "+rr(wn(r))+" instead.");return r.indexOf(e)>=0},Yi.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Yi.prototype.outputDefined=function(){return!0},Yi.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Cn=function(t,e,r){this.type=At,this.needle=t,this.haystack=e,this.fromIndex=r};Cn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,ne),s=e.parse(t[2],2,ne);if(!r||!s)return null;if(!Sr(r.type,[kt,Ht,At,ce,ne]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+rr(r.type)+" instead");if(t.length===4){var l=e.parse(t[3],3,At);return l?new Cn(r,s,l):null}return new Cn(r,s)},Cn.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!Ve(e,["boolean","string","number","null"]))throw new Ur("Expected first argument to be of type boolean, string, number or null, but found "+rr(wn(e))+" instead.");if(!Ve(r,["string","array"]))throw new Ur("Expected second argument to be of type array or string, but found "+rr(wn(r))+" instead.");if(this.fromIndex){var s=this.fromIndex.evaluate(t);return r.indexOf(e,s)}return r.indexOf(e)},Cn.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Cn.prototype.outputDefined=function(){return!1},Cn.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Oa=function(t,e,r,s,l,p){this.inputType=t,this.type=e,this.input=r,this.cases=s,this.outputs=l,this.otherwise=p};Oa.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,s;e.expectedType&&e.expectedType.kind!=="value"&&(s=e.expectedType);for(var l={},p=[],d=2;d<t.length-1;d+=2){var v=t[d],x=t[d+1];Array.isArray(v)||(v=[v]);var S=e.concat(d);if(v.length===0)return S.error("Expected at least one branch label.");for(var I=0,E=v;I<E.length;I+=1){var k=E[I];if(typeof k!="number"&&typeof k!="string")return S.error("Branch labels must be numbers or strings.");if(typeof k=="number"&&Math.abs(k)>Number.MAX_SAFE_INTEGER)return S.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof k=="number"&&Math.floor(k)!==k)return S.error("Numeric branch labels must be integer values.");if(r){if(S.checkSubtype(r,wn(k)))return null}else r=wn(k);if(l[String(k)]!==void 0)return S.error("Branch labels must be unique.");l[String(k)]=p.length}var R=e.parse(x,d,s);if(!R)return null;s=s||R.type,p.push(R)}var Z=e.parse(t[1],1,ne);if(!Z)return null;var j=e.parse(t[t.length-1],t.length-1,s);return j?Z.type.kind!=="value"&&e.concat(1).checkSubtype(r,Z.type)?null:new Oa(r,s,Z,l,p,j):null},Oa.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(wn(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Oa.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Oa.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Oa.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],s={},l=0,p=Object.keys(this.cases).sort();l<p.length;l+=1){var d=p[l];(E=s[this.cases[d]])===void 0?(s[this.cases[d]]=r.length,r.push([this.cases[d],[d]])):r[E][1].push(d)}for(var v=function(R){return t.inputType.kind==="number"?Number(R):R},x=0,S=r;x<S.length;x+=1){var I=S[x],E=I[0],k=I[1];e.push(k.length===1?v(k[0]):k.map(v)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var Ji=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};Ji.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&e.expectedType.kind!=="value"&&(r=e.expectedType);for(var s=[],l=1;l<t.length-1;l+=2){var p=e.parse(t[l],l,kt);if(!p)return null;var d=e.parse(t[l+1],l+1,r);if(!d)return null;s.push([p,d]),r=r||d.type}var v=e.parse(t[t.length-1],t.length-1,r);return v?new Ji(r,s,v):null},Ji.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var s=r[e],l=s[1];if(s[0].evaluate(t))return l.evaluate(t)}return this.otherwise.evaluate(t)},Ji.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var s=r[e],l=s[1];t(s[0]),t(l)}t(this.otherwise)},Ji.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},Ji.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var ri=function(t,e,r,s){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=s};function Es(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Lr(t,e,r,s){return s.compare(e,r)===0}function Dr(t,e,r){var s=t!=="=="&&t!=="!=";return function(){function l(p,d,v){this.type=kt,this.lhs=p,this.rhs=d,this.collator=v,this.hasUntypedArgument=p.type.kind==="value"||d.type.kind==="value"}return l.parse=function(p,d){if(p.length!==3&&p.length!==4)return d.error("Expected two or three arguments.");var v=p[0],x=d.parse(p[1],1,ne);if(!x)return null;if(!Es(v,x.type))return d.concat(1).error('"'+v+`" comparisons are not supported for type '`+rr(x.type)+"'.");var S=d.parse(p[2],2,ne);if(!S)return null;if(!Es(v,S.type))return d.concat(2).error('"'+v+`" comparisons are not supported for type '`+rr(S.type)+"'.");if(x.type.kind!==S.type.kind&&x.type.kind!=="value"&&S.type.kind!=="value")return d.error("Cannot compare types '"+rr(x.type)+"' and '"+rr(S.type)+"'.");s&&(x.type.kind==="value"&&S.type.kind!=="value"?x=new Fn(S.type,[x]):x.type.kind!=="value"&&S.type.kind==="value"&&(S=new Fn(x.type,[S])));var I=null;if(p.length===4){if(x.type.kind!=="string"&&S.type.kind!=="string"&&x.type.kind!=="value"&&S.type.kind!=="value")return d.error("Cannot use collator to compare non-string types.");if(!(I=d.parse(p[3],3,_r)))return null}return new l(x,S,I)},l.prototype.evaluate=function(p){var d=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){var x=wn(d),S=wn(v);if(x.kind!==S.kind||x.kind!=="string"&&x.kind!=="number")throw new Ur('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+x.kind+", "+S.kind+") instead.")}if(this.collator&&!s&&this.hasUntypedArgument){var I=wn(d),E=wn(v);if(I.kind!=="string"||E.kind!=="string")return e(p,d,v)}return this.collator?r(p,d,v,this.collator.evaluate(p)):e(p,d,v)},l.prototype.eachChild=function(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)},l.prototype.outputDefined=function(){return!0},l.prototype.serialize=function(){var p=[t];return this.eachChild(function(d){p.push(d.serialize())}),p},l}()}ri.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,ne),s=e.parse(t[2],2,At);if(!r||!s)return null;if(!Sr(r.type,[Mr(ne),Ht,ne]))return e.error("Expected first argument to be of type array or string, but found "+rr(r.type)+" instead");if(t.length===4){var l=e.parse(t[3],3,At);return l?new ri(r.type,r,s,l):null}return new ri(r.type,r,s)},ri.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!Ve(e,["string","array"]))throw new Ur("Expected first argument to be of type array or string, but found "+rr(wn(e))+" instead.");if(this.endIndex){var s=this.endIndex.evaluate(t);return e.slice(r,s)}return e.slice(r)},ri.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},ri.prototype.outputDefined=function(){return!1},ri.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var mo=Dr("==",function(t,e,r){return e===r},Lr),au=Dr("!=",function(t,e,r){return e!==r},function(t,e,r,s){return!Lr(0,e,r,s)}),_l=Dr("<",function(t,e,r){return e<r},function(t,e,r,s){return s.compare(e,r)<0}),rs=Dr(">",function(t,e,r){return e>r},function(t,e,r,s){return s.compare(e,r)>0}),su=Dr("<=",function(t,e,r){return e<=r},function(t,e,r,s){return s.compare(e,r)<=0}),Lu=Dr(">=",function(t,e,r){return e>=r},function(t,e,r,s){return s.compare(e,r)>=0}),Ko=function(t,e,r,s,l){this.type=Ht,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=s,this.maxFractionDigits=l};Ko.parse=function(t,e){if(t.length!==3)return e.error("Expected two arguments.");var r=e.parse(t[1],1,At);if(!r)return null;var s=t[2];if(typeof s!="object"||Array.isArray(s))return e.error("NumberFormat options argument must be an object.");var l=null;if(s.locale&&!(l=e.parse(s.locale,1,Ht)))return null;var p=null;if(s.currency&&!(p=e.parse(s.currency,1,Ht)))return null;var d=null;if(s["min-fraction-digits"]&&!(d=e.parse(s["min-fraction-digits"],1,At)))return null;var v=null;return s["max-fraction-digits"]&&!(v=e.parse(s["max-fraction-digits"],1,At))?null:new Ko(r,l,p,d,v)},Ko.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Ko.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Ko.prototype.outputDefined=function(){return!1},Ko.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Mo=function(t){this.type=At,this.input=t};Mo.parse=function(t,e){if(t.length!==2)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?e.error("Expected argument of type string or array, but found "+rr(r.type)+" instead."):new Mo(r):null},Mo.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(typeof e=="string"||Array.isArray(e))return e.length;throw new Ur("Expected value to be of type string or array, but found "+rr(wn(e))+" instead.")},Mo.prototype.eachChild=function(t){t(this.input)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Yo={"==":mo,"!=":au,">":rs,"<":_l,">=":Lu,"<=":su,array:Fn,at:mn,boolean:Fn,case:Ji,coalesce:ko,collator:on,format:mi,image:po,in:Yi,"index-of":Cn,interpolate:Sn,"interpolate-hcl":Sn,"interpolate-lab":Sn,length:Mo,let:Ho,literal:fi,match:Oa,number:Fn,"number-format":Ko,object:Fn,slice:ri,step:Ki,string:Fn,"to-boolean":Pi,"to-color":Pi,"to-number":Pi,"to-string":Pi,var:ua,within:gi};function Fa(t,e){var r=e[0],s=e[1],l=e[2],p=e[3];r=r.evaluate(t),s=s.evaluate(t),l=l.evaluate(t);var d=p?p.evaluate(t):1,v=$s(r,s,l,d);if(v)throw new Ur(v);return new Ye(r/255*d,s/255*d,l/255*d,d)}function xl(t,e){return t in e}function Jo(t,e){var r=e[t];return r===void 0?null:r}function ha(t){return{type:t}}function pa(t){return{result:"success",value:t}}function $o(t){return{result:"error",value:t}}function Qo(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function uu(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function yi(t){return!!t.expression&&t.expression.interpolated}function nr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function go(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Du(t){return t}function Un(t,e,r){return t!==void 0?t:e!==void 0?e:r!==void 0?r:void 0}function Ru(t,e,r,s,l){return Un(typeof r===l?s[r]:void 0,t.default,e.default)}function As(t,e,r){if(nr(r)!=="number")return Un(t.default,e.default);var s=t.stops.length;if(s===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[s-1][0])return t.stops[s-1][1];var l=mr(t.stops.map(function(p){return p[0]}),r);return t.stops[l][1]}function ns(t,e,r){var s=t.base!==void 0?t.base:1;if(nr(r)!=="number")return Un(t.default,e.default);var l=t.stops.length;if(l===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[l-1][0])return t.stops[l-1][1];var p=mr(t.stops.map(function(E){return E[0]}),r),d=function(E,k,R,Z){var j=Z-R,it=E-R;return j===0?0:k===1?it/j:(Math.pow(k,it)-1)/(Math.pow(k,j)-1)}(r,s,t.stops[p][0],t.stops[p+1][0]),v=t.stops[p][1],x=t.stops[p+1][1],S=iu[e.type]||Du;if(t.colorSpace&&t.colorSpace!=="rgb"){var I=ei[t.colorSpace];S=function(E,k){return I.reverse(I.interpolate(I.forward(E),I.forward(k),d))}}return typeof v.evaluate=="function"?{evaluate:function(){for(var E=[],k=arguments.length;k--;)E[k]=arguments[k];var R=v.evaluate.apply(void 0,E),Z=x.evaluate.apply(void 0,E);if(R!==void 0&&Z!==void 0)return S(R,Z,d)}}:S(v,x,d)}function Bu(t,e,r){return e.type==="color"?r=Ye.parse(r):e.type==="formatted"?r=nn.fromString(r.toString()):e.type==="resolvedImage"?r=Gn.fromString(r.toString()):nr(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),Un(r,t.default,e.default)}$r.register(Yo,{error:[{kind:"error"},[Ht],function(t,e){throw new Ur(e[0].evaluate(t))}],typeof:[Ht,[ne],function(t,e){return rr(wn(e[0].evaluate(t)))}],"to-rgba":[Mr(At,4),[Me],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Me,[At,At,At],Fa],rgba:[Me,[At,At,At,At],Fa],has:{type:kt,overloads:[[[Ht],function(t,e){return xl(e[0].evaluate(t),t.properties())}],[[Ht,Le],function(t,e){var r=e[1];return xl(e[0].evaluate(t),r.evaluate(t))}]]},get:{type:ne,overloads:[[[Ht],function(t,e){return Jo(e[0].evaluate(t),t.properties())}],[[Ht,Le],function(t,e){var r=e[1];return Jo(e[0].evaluate(t),r.evaluate(t))}]]},"feature-state":[ne,[Ht],function(t,e){return Jo(e[0].evaluate(t),t.featureState||{})}],properties:[Le,[],function(t){return t.properties()}],"geometry-type":[Ht,[],function(t){return t.geometryType()}],id:[ne,[],function(t){return t.id()}],zoom:[At,[],function(t){return t.globals.zoom}],"heatmap-density":[At,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[At,[],function(t){return t.globals.lineProgress||0}],accumulated:[ne,[],function(t){return t.globals.accumulated===void 0?null:t.globals.accumulated}],"+":[At,ha(At),function(t,e){for(var r=0,s=0,l=e;s<l.length;s+=1)r+=l[s].evaluate(t);return r}],"*":[At,ha(At),function(t,e){for(var r=1,s=0,l=e;s<l.length;s+=1)r*=l[s].evaluate(t);return r}],"-":{type:At,overloads:[[[At,At],function(t,e){var r=e[1];return e[0].evaluate(t)-r.evaluate(t)}],[[At],function(t,e){return-e[0].evaluate(t)}]]},"/":[At,[At,At],function(t,e){var r=e[1];return e[0].evaluate(t)/r.evaluate(t)}],"%":[At,[At,At],function(t,e){var r=e[1];return e[0].evaluate(t)%r.evaluate(t)}],ln2:[At,[],function(){return Math.LN2}],pi:[At,[],function(){return Math.PI}],e:[At,[],function(){return Math.E}],"^":[At,[At,At],function(t,e){var r=e[1];return Math.pow(e[0].evaluate(t),r.evaluate(t))}],sqrt:[At,[At],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[At,[At],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[At,[At],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[At,[At],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[At,[At],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[At,[At],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[At,[At],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[At,[At],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[At,[At],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[At,[At],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[At,ha(At),function(t,e){return Math.min.apply(Math,e.map(function(r){return r.evaluate(t)}))}],max:[At,ha(At),function(t,e){return Math.max.apply(Math,e.map(function(r){return r.evaluate(t)}))}],abs:[At,[At],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[At,[At],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[At,[At],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[At,[At],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[kt,[Ht,ne],function(t,e){var r=e[0],s=e[1];return t.properties()[r.value]===s.value}],"filter-id-==":[kt,[ne],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[kt,[Ht],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[kt,[Ht,ne],function(t,e){var r=e[0],s=e[1],l=t.properties()[r.value],p=s.value;return typeof l==typeof p&&l<p}],"filter-id-<":[kt,[ne],function(t,e){var r=e[0],s=t.id(),l=r.value;return typeof s==typeof l&&s<l}],"filter->":[kt,[Ht,ne],function(t,e){var r=e[0],s=e[1],l=t.properties()[r.value],p=s.value;return typeof l==typeof p&&l>p}],"filter-id->":[kt,[ne],function(t,e){var r=e[0],s=t.id(),l=r.value;return typeof s==typeof l&&s>l}],"filter-<=":[kt,[Ht,ne],function(t,e){var r=e[0],s=e[1],l=t.properties()[r.value],p=s.value;return typeof l==typeof p&&l<=p}],"filter-id-<=":[kt,[ne],function(t,e){var r=e[0],s=t.id(),l=r.value;return typeof s==typeof l&&s<=l}],"filter->=":[kt,[Ht,ne],function(t,e){var r=e[0],s=e[1],l=t.properties()[r.value],p=s.value;return typeof l==typeof p&&l>=p}],"filter-id->=":[kt,[ne],function(t,e){var r=e[0],s=t.id(),l=r.value;return typeof s==typeof l&&s>=l}],"filter-has":[kt,[ne],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[kt,[],function(t){return t.id()!==null&&t.id()!==void 0}],"filter-type-in":[kt,[Mr(Ht)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[kt,[Mr(ne)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[kt,[Ht,Mr(ne)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[kt,[Ht,Mr(ne)],function(t,e){var r=e[0],s=e[1];return function(l,p,d,v){for(;d<=v;){var x=d+v>>1;if(p[x]===l)return!0;p[x]>l?v=x-1:d=x+1}return!1}(t.properties()[r.value],s.value,0,s.value.length-1)}],all:{type:kt,overloads:[[[kt,kt],function(t,e){var r=e[1];return e[0].evaluate(t)&&r.evaluate(t)}],[ha(kt),function(t,e){for(var r=0,s=e;r<s.length;r+=1)if(!s[r].evaluate(t))return!1;return!0}]]},any:{type:kt,overloads:[[[kt,kt],function(t,e){var r=e[1];return e[0].evaluate(t)||r.evaluate(t)}],[ha(kt),function(t,e){for(var r=0,s=e;r<s.length;r+=1)if(s[r].evaluate(t))return!0;return!1}]]},"!":[kt,[kt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[kt,[Ht],function(t,e){var r=t.globals&&t.globals.isSupportedScript;return!r||r(e[0].evaluate(t))}],upcase:[Ht,[Ht],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Ht,[Ht],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Ht,ha(ne),function(t,e){return e.map(function(r){return ho(r.evaluate(t))}).join("")}],"resolved-locale":[Ht,[_r],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var is=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new fo,this._defaultValue=e?function(r){return r.type==="color"&&go(r.default)?new Ye(0,0,0,0):r.type==="color"?Ye.parse(r.default)||null:r.default===void 0?null:r.default}(e):null,this._enumValues=e&&e.type==="enum"?e.values:null};function lu(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Yo}function cu(t,e){var r=new xr(Yo,[],e?function(l){var p={color:Me,string:Ht,number:At,enum:Ht,boolean:kt,formatted:we,resolvedImage:br};return l.type==="array"?Mr(p[l.value]||ne,l.length):p[l.type]}(e):void 0),s=r.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?pa(new is(s,e)):$o(r.errors)}is.prototype.evaluateWithoutErrorHandling=function(t,e,r,s,l,p){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=s,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=p,this.expression.evaluate(this._evaluator)},is.prototype.evaluate=function(t,e,r,s,l,p){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=s,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=p||null;try{var d=this.expression.evaluate(this._evaluator);if(d==null||typeof d=="number"&&d!=d)return this._defaultValue;if(this._enumValues&&!(d in this._enumValues))throw new Ur("Expected value to be one of "+Object.keys(this._enumValues).map(function(v){return JSON.stringify(v)}).join(", ")+", but found "+JSON.stringify(d)+" instead.");return d}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console!="undefined"&&console.warn(v.message)),this._defaultValue}};var Ua=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent=t!=="constant"&&!sa(e.expression)};Ua.prototype.evaluateWithoutErrorHandling=function(t,e,r,s,l,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,s,l,p)},Ua.prototype.evaluate=function(t,e,r,s,l,p){return this._styleExpression.evaluate(t,e,r,s,l,p)};var os=function(t,e,r,s){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent=t!=="camera"&&!sa(e.expression),this.interpolationType=s};function fa(t,e){if((t=cu(t,e)).result==="error")return t;var r=t.value.expression,s=Ba(r);if(!s&&!Qo(e))return $o([new ee("","data expressions not supported")]);var l=nu(r,["zoom"]);if(!l&&!uu(e))return $o([new ee("","zoom expressions not supported")]);var p=function d(v){var x=null;if(v instanceof Ho)x=d(v.result);else if(v instanceof ko)for(var S=0,I=v.args;S<I.length&&!(x=d(I[S]));S+=1);else(v instanceof Ki||v instanceof Sn)&&v.input instanceof $r&&v.input.name==="zoom"&&(x=v);return x instanceof ee||v.eachChild(function(E){var k=d(E);k instanceof ee?x=k:!x&&k?x=new ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):x&&k&&x!==k&&(x=new ee("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),x}(r);return p||l?p instanceof ee?$o([p]):p instanceof Sn&&!yi(e)?$o([new ee("",'"interpolate" expressions cannot be used with this property')]):pa(p?new os(s?"camera":"composite",t.value,p.labels,p instanceof Sn?p.interpolation:void 0):new Ua(s?"constant":"source",t.value)):$o([new ee("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}os.prototype.evaluateWithoutErrorHandling=function(t,e,r,s,l,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,s,l,p)},os.prototype.evaluate=function(t,e,r,s,l,p){return this._styleExpression.evaluate(t,e,r,s,l,p)},os.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?Sn.interpolationFactor(this.interpolationType,t,e,r):0};var Ps=function(t,e){this._parameters=t,this._specification=e,Wt(this,function r(s,l){var p,d,v,x=l.type==="color",S=s.stops&&typeof s.stops[0][0]=="object",I=S||!(S||s.property!==void 0),E=s.type||(yi(l)?"exponential":"interval");if(x&&((s=Wt({},s)).stops&&(s.stops=s.stops.map(function($t){return[$t[0],Ye.parse($t[1])]})),s.default=Ye.parse(s.default?s.default:l.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!ei[s.colorSpace])throw new Error("Unknown color space: "+s.colorSpace);if(E==="exponential")p=ns;else if(E==="interval")p=As;else if(E==="categorical"){p=Ru,d=Object.create(null);for(var k=0,R=s.stops;k<R.length;k+=1){var Z=R[k];d[Z[0]]=Z[1]}v=typeof s.stops[0][0]}else{if(E!=="identity")throw new Error('Unknown function type "'+E+'"');p=Bu}if(S){for(var j={},it=[],J=0;J<s.stops.length;J++){var pt=s.stops[J],dt=pt[0].zoom;j[dt]===void 0&&(j[dt]={zoom:dt,type:s.type,property:s.property,default:s.default,stops:[]},it.push(dt)),j[dt].stops.push([pt[0].value,pt[1]])}for(var _t=[],xt=0,Pt=it;xt<Pt.length;xt+=1){var qt=Pt[xt];_t.push([j[qt].zoom,r(j[qt],l)])}var Yt={name:"linear"};return{kind:"composite",interpolationType:Yt,interpolationFactor:Sn.interpolationFactor.bind(void 0,Yt),zoomStops:_t.map(function($t){return $t[0]}),evaluate:function($t,fe){var Qt=$t.zoom;return ns({stops:_t,base:s.base},l,Qt).evaluate(Qt,fe)}}}if(I){var se=E==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:se,interpolationFactor:Sn.interpolationFactor.bind(void 0,se),zoomStops:s.stops.map(function($t){return $t[0]}),evaluate:function($t){return p(s,l,$t.zoom,d,v)}}}return{kind:"source",evaluate:function($t,fe){var Qt=fe&&fe.properties?fe.properties[s.property]:void 0;return Qt===void 0?Un(s.default,l.default):p(s,l,Qt,d,v)}}}(this._parameters,this._specification))};function yo(t){var e=t.key,r=t.value,s=t.valueSpec||{},l=t.objectElementValidators||{},p=t.style,d=t.styleSpec,v=[],x=nr(r);if(x!=="object")return[new Y(e,r,"object expected, "+x+" found")];for(var S in r){var I=S.split(".")[0],E=s[I]||s["*"],k=void 0;if(l[I])k=l[I];else if(s[I])k=Ke;else if(l["*"])k=l["*"];else{if(!s["*"]){v.push(new Y(e,r[S],'unknown property "'+S+'"'));continue}k=Ke}v=v.concat(k({key:(e&&e+".")+S,value:r[S],valueSpec:E,style:p,styleSpec:d,object:r,objectKey:S},r))}for(var R in s)l[R]||s[R].required&&s[R].default===void 0&&r[R]===void 0&&v.push(new Y(e,r,'missing required property "'+R+'"'));return v}function hu(t){var e=t.value,r=t.valueSpec,s=t.style,l=t.styleSpec,p=t.key,d=t.arrayElementValidator||Ke;if(nr(e)!=="array")return[new Y(p,e,"array expected, "+nr(e)+" found")];if(r.length&&e.length!==r.length)return[new Y(p,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new Y(p,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var v={type:r.value,values:r.values};l.$version<7&&(v.function=r.function),nr(r.value)==="object"&&(v=r.value);for(var x=[],S=0;S<e.length;S++)x=x.concat(d({array:e,arrayIndex:S,value:e[S],valueSpec:v,style:s,styleSpec:l,key:p+"["+S+"]"}));return x}function Ou(t){var e=t.key,r=t.value,s=t.valueSpec,l=nr(r);return l==="number"&&r!=r&&(l="NaN"),l!=="number"?[new Y(e,r,"number expected, "+l+" found")]:"minimum"in s&&r<s.minimum?[new Y(e,r,r+" is less than the minimum value "+s.minimum)]:"maximum"in s&&r>s.maximum?[new Y(e,r,r+" is greater than the maximum value "+s.maximum)]:[]}function Lo(t){var e,r,s,l=t.valueSpec,p=vt(t.value.type),d={},v=p!=="categorical"&&t.value.property===void 0,x=!v,S=nr(t.value.stops)==="array"&&nr(t.value.stops[0])==="array"&&nr(t.value.stops[0][0])==="object",I=yo({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(R){if(p==="identity")return[new Y(R.key,R.value,'identity function may not have a "stops" property')];var Z=[],j=R.value;return Z=Z.concat(hu({key:R.key,value:j,valueSpec:R.valueSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:E})),nr(j)==="array"&&j.length===0&&Z.push(new Y(R.key,j,"array must have at least one stop")),Z},default:function(R){return Ke({key:R.key,value:R.value,valueSpec:l,style:R.style,styleSpec:R.styleSpec})}}});return p==="identity"&&v&&I.push(new Y(t.key,t.value,'missing required property "property"')),p==="identity"||t.value.stops||I.push(new Y(t.key,t.value,'missing required property "stops"')),p==="exponential"&&t.valueSpec.expression&&!yi(t.valueSpec)&&I.push(new Y(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(x&&!Qo(t.valueSpec)?I.push(new Y(t.key,t.value,"property functions not supported")):v&&!uu(t.valueSpec)&&I.push(new Y(t.key,t.value,"zoom functions not supported"))),p!=="categorical"&&!S||t.value.property!==void 0||I.push(new Y(t.key,t.value,'"property" property is required')),I;function E(R){var Z=[],j=R.value,it=R.key;if(nr(j)!=="array")return[new Y(it,j,"array expected, "+nr(j)+" found")];if(j.length!==2)return[new Y(it,j,"array length 2 expected, length "+j.length+" found")];if(S){if(nr(j[0])!=="object")return[new Y(it,j,"object expected, "+nr(j[0])+" found")];if(j[0].zoom===void 0)return[new Y(it,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Y(it,j,"object stop key must have value")];if(s&&s>vt(j[0].zoom))return[new Y(it,j[0].zoom,"stop zoom values must appear in ascending order")];vt(j[0].zoom)!==s&&(s=vt(j[0].zoom),r=void 0,d={}),Z=Z.concat(yo({key:it+"[0]",value:j[0],valueSpec:{zoom:{}},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:Ou,value:k}}))}else Z=Z.concat(k({key:it+"[0]",value:j[0],valueSpec:{},style:R.style,styleSpec:R.styleSpec},j));return lu(Rt(j[1]))?Z.concat([new Y(it+"[1]",j[1],"expressions are not allowed in function stops.")]):Z.concat(Ke({key:it+"[1]",value:j[1],valueSpec:l,style:R.style,styleSpec:R.styleSpec}))}function k(R,Z){var j=nr(R.value),it=vt(R.value),J=R.value!==null?R.value:Z;if(e){if(j!==e)return[new Y(R.key,J,j+" stop domain type must match previous stop domain type "+e)]}else e=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new Y(R.key,J,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&p!=="categorical"){var pt="number expected, "+j+" found";return Qo(l)&&p===void 0&&(pt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Y(R.key,J,pt)]}return p!=="categorical"||j!=="number"||isFinite(it)&&Math.floor(it)===it?p!=="categorical"&&j==="number"&&r!==void 0&&it<r?[new Y(R.key,J,"stop domain values must appear in ascending order")]:(r=it,p==="categorical"&&it in d?[new Y(R.key,J,"stop domain values must be unique")]:(d[it]=!0,[])):[new Y(R.key,J,"integer expected, found "+it)]}}function Do(t){var e=(t.expressionContext==="property"?fa:cu)(Rt(t.value),t.valueSpec);if(e.result==="error")return e.value.map(function(s){return new Y(""+t.key+s.key,t.value,s.message)});var r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new Y(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!sa(r))return[new Y(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!sa(r))return[new Y(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!nu(r,["zoom","feature-state"]))return[new Y(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Ba(r))return[new Y(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cs(t){var e=t.key,r=t.value,s=t.valueSpec,l=[];return Array.isArray(s.values)?s.values.indexOf(vt(r))===-1&&l.push(new Y(e,r,"expected one of ["+s.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(s.values).indexOf(vt(r))===-1&&l.push(new Y(e,r,"expected one of ["+Object.keys(s.values).join(", ")+"], "+JSON.stringify(r)+" found")),l}function zs(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var s=r[e];if(!zs(s)&&typeof s!="boolean")return!1}return!0;default:return!0}}Ps.deserialize=function(t){return new Ps(t._parameters,t._specification)},Ps.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var bl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ta(t){if(t==null)return{filter:function(){return!0},needGeometry:!1};zs(t)||(t=ks(t));var e=cu(t,bl);if(e.result==="error")throw new Error(e.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,s,l){return e.value.evaluate(r,s,{},l)},needGeometry:function r(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(var l=1;l<s.length;l++)if(r(s[l]))return!0;return!1}(t)}}function vo(t,e){return t<e?-1:t>e?1:0}function ks(t){if(!t)return!0;var e,r=t[0];return t.length<=1?r!=="any":r==="=="?pu(t[1],t[2],"=="):r==="!="?fu(pu(t[1],t[2],"==")):r==="<"||r===">"||r==="<="||r===">="?pu(t[1],t[2],r):r==="any"?(e=t.slice(1),["any"].concat(e.map(ks))):r==="all"?["all"].concat(t.slice(1).map(ks)):r==="none"?["all"].concat(t.slice(1).map(ks).map(fu)):r==="in"?Fu(t[1],t.slice(2)):r==="!in"?fu(Fu(t[1],t.slice(2))):r==="has"?Uu(t[1]):r==="!has"?fu(Uu(t[1])):r!=="within"||t}function pu(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function Fu(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(r){return typeof r!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(vo)]]:["filter-in-small",t,["literal",e]]}}function Uu(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function fu(t){return["!",t]}function Na(t){return zs(Rt(t.value))?Do(Wt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(r){var s=r.value,l=r.key;if(nr(s)!=="array")return[new Y(l,s,"array expected, "+nr(s)+" found")];var p,d=r.styleSpec,v=[];if(s.length<1)return[new Y(l,s,"filter array must have at least 1 element")];switch(v=v.concat(Cs({key:l+"[0]",value:s[0],valueSpec:d.filter_operator,style:r.style,styleSpec:r.styleSpec})),vt(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&vt(s[1])==="$type"&&v.push(new Y(l,s,'"$type" cannot be use with operator "'+s[0]+'"'));case"==":case"!=":s.length!==3&&v.push(new Y(l,s,'filter array for operator "'+s[0]+'" must have 3 elements'));case"in":case"!in":s.length>=2&&(p=nr(s[1]))!=="string"&&v.push(new Y(l+"[1]",s[1],"string expected, "+p+" found"));for(var x=2;x<s.length;x++)p=nr(s[x]),vt(s[1])==="$type"?v=v.concat(Cs({key:l+"["+x+"]",value:s[x],valueSpec:d.geometry_type,style:r.style,styleSpec:r.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Y(l+"["+x+"]",s[x],"string, number, or boolean expected, "+p+" found"));break;case"any":case"all":case"none":for(var S=1;S<s.length;S++)v=v.concat(e({key:l+"["+S+"]",value:s[S],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":p=nr(s[1]),s.length!==2?v.push(new Y(l,s,'filter array for "'+s[0]+'" operator must have 2 elements')):p!=="string"&&v.push(new Y(l+"[1]",s[1],"string expected, "+p+" found"));break;case"within":p=nr(s[1]),s.length!==2?v.push(new Y(l,s,'filter array for "'+s[0]+'" operator must have 2 elements')):p!=="object"&&v.push(new Y(l+"[1]",s[1],"object expected, "+p+" found"))}return v}(t)}function da(t,e){var r=t.key,s=t.style,l=t.styleSpec,p=t.value,d=t.objectKey,v=l[e+"_"+t.layerType];if(!v)return[];var x=d.match(/^(.*)-transition$/);if(e==="paint"&&x&&v[x[1]]&&v[x[1]].transition)return Ke({key:r,value:p,valueSpec:l.transition,style:s,styleSpec:l});var S,I=t.valueSpec||v[d];if(!I)return[new Y(r,p,'unknown property "'+d+'"')];if(nr(p)==="string"&&Qo(I)&&!I.tokens&&(S=/^{([^}]+)}$/.exec(p)))return[new Y(r,p,'"'+d+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(S[1])+" }`.")];var E=[];return t.layerType==="symbol"&&(d==="text-field"&&s&&!s.glyphs&&E.push(new Y(r,p,'use of "text-field" requires a style "glyphs" property')),d==="text-font"&&go(Rt(p))&&vt(p.type)==="identity"&&E.push(new Y(r,p,'"text-font" does not support identity functions'))),E.concat(Ke({key:t.key,value:p,valueSpec:I,style:s,styleSpec:l,expressionContext:"property",propertyType:e,propertyKey:d}))}function ft(t){return da(t,"paint")}function zt(t){return da(t,"layout")}function It(t){var e=[],r=t.value,s=t.key,l=t.style,p=t.styleSpec;r.type||r.ref||e.push(new Y(s,r,'either "type" or "ref" is required'));var d,v=vt(r.type),x=vt(r.ref);if(r.id)for(var S=vt(r.id),I=0;I<t.arrayIndex;I++){var E=l.layers[I];vt(E.id)===S&&e.push(new Y(s,r.id,'duplicate layer id "'+r.id+'", previously used at line '+E.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Z){Z in r&&e.push(new Y(s,r[Z],'"'+Z+'" is prohibited for ref layers'))}),l.layers.forEach(function(Z){vt(Z.id)===x&&(d=Z)}),d?d.ref?e.push(new Y(s,r.ref,"ref cannot reference another ref layer")):v=vt(d.type):e.push(new Y(s,r.ref,'ref layer "'+x+'" not found'));else if(v!=="background")if(r.source){var k=l.sources&&l.sources[r.source],R=k&&vt(k.type);k?R==="vector"&&v==="raster"?e.push(new Y(s,r.source,'layer "'+r.id+'" requires a raster source')):R==="raster"&&v!=="raster"?e.push(new Y(s,r.source,'layer "'+r.id+'" requires a vector source')):R!=="vector"||r["source-layer"]?R==="raster-dem"&&v!=="hillshade"?e.push(new Y(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!r.paint||!r.paint["line-gradient"]||R==="geojson"&&k.lineMetrics||e.push(new Y(s,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Y(s,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new Y(s,r.source,'source "'+r.source+'" not found'))}else e.push(new Y(s,r,'missing required property "source"'));return e=e.concat(yo({key:s,value:r,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ke({key:s+".type",value:r.type,valueSpec:p.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:Na,layout:function(Z){return yo({layer:r,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":function(j){return zt(Wt({layerType:v},j))}}})},paint:function(Z){return yo({layer:r,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":function(j){return ft(Wt({layerType:v},j))}}})}}}))}function jt(t){var e=t.value,r=t.key,s=nr(e);return s!=="string"?[new Y(r,e,"string expected, "+s+" found")]:[]}var qe={promoteId:function(t){var e=t.key,r=t.value;if(nr(r)==="string")return jt({key:e,value:r});var s=[];for(var l in r)s.push.apply(s,jt({key:e+"."+l,value:r[l]}));return s}};function lr(t){var e=t.value,r=t.key,s=t.styleSpec,l=t.style;if(!e.type)return[new Y(r,e,'"type" is required')];var p,d=vt(e.type);switch(d){case"vector":case"raster":case"raster-dem":return yo({key:r,value:e,valueSpec:s["source_"+d.replace("-","_")],style:t.style,styleSpec:s,objectElementValidators:qe});case"geojson":if(p=yo({key:r,value:e,valueSpec:s.source_geojson,style:l,styleSpec:s,objectElementValidators:qe}),e.cluster)for(var v in e.clusterProperties){var x=e.clusterProperties[v],S=x[0],I=typeof S=="string"?[S,["accumulated"],["get",v]]:S;p.push.apply(p,Do({key:r+"."+v+".map",value:x[1],expressionContext:"cluster-map"})),p.push.apply(p,Do({key:r+"."+v+".reduce",value:I,expressionContext:"cluster-reduce"}))}return p;case"video":return yo({key:r,value:e,valueSpec:s.source_video,style:l,styleSpec:s});case"image":return yo({key:r,value:e,valueSpec:s.source_image,style:l,styleSpec:s});case"canvas":return[new Y(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Cs({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:l,styleSpec:s})}}function jr(t){var e=t.value,r=t.styleSpec,s=r.light,l=t.style,p=[],d=nr(e);if(e===void 0)return p;if(d!=="object")return p.concat([new Y("light",e,"object expected, "+d+" found")]);for(var v in e){var x=v.match(/^(.*)-transition$/);p=p.concat(x&&s[x[1]]&&s[x[1]].transition?Ke({key:v,value:e[v],valueSpec:r.transition,style:l,styleSpec:r}):s[v]?Ke({key:v,value:e[v],valueSpec:s[v],style:l,styleSpec:r}):[new Y(v,e[v],'unknown property "'+v+'"')])}return p}var xe={"*":function(){return[]},array:hu,boolean:function(t){var e=t.value,r=t.key,s=nr(e);return s!=="boolean"?[new Y(r,e,"boolean expected, "+s+" found")]:[]},number:Ou,color:function(t){var e=t.key,r=t.value,s=nr(r);return s!=="string"?[new Y(e,r,"color expected, "+s+" found")]:ts(r)===null?[new Y(e,r,'color expected, "'+r+'" found')]:[]},constants:Lt,enum:Cs,filter:Na,function:Lo,layer:It,object:yo,source:lr,light:jr,string:jt,formatted:function(t){return jt(t).length===0?[]:Do(t)},resolvedImage:function(t){return jt(t).length===0?[]:Do(t)}};function Ke(t){var e=t.value,r=t.valueSpec,s=t.styleSpec;return r.expression&&go(vt(e))?Lo(t):r.expression&&lu(Rt(e))?Do(t):r.type&&xe[r.type]?xe[r.type](t):yo(Wt({},t,{valueSpec:r.type?s[r.type]:r}))}function ma(t){var e=t.value,r=t.key,s=jt(t);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new Y(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new Y(r,e,'"glyphs" url must include a "{range}" token'))),s}function an(t,e){e===void 0&&(e=V);var r=[];return r=r.concat(Ke({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:ma,"*":function(){return[]}}})),t.constants&&(r=r.concat(Lt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Ms(r)}function Ms(t){return[].concat(t).sort(function(e,r){return e.line-r.line})}function as(t){return function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return Ms(t.apply(this,e))}}an.source=as(lr),an.light=as(jr),an.layer=as(It),an.filter=as(Na),an.paintProperty=as(ft),an.layoutProperty=as(zt);var w=an,P=w.light,D=w.paintProperty,H=w.layoutProperty;function ct(t,e){var r=!1;if(e&&e.length)for(var s=0,l=e;s<l.length;s+=1)t.fire(new st(new Error(l[s].message))),r=!0;return r}var ut=ot;function ot(t,e,r){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var l=new Int32Array(this.arrayBuffer);t=l[0],this.d=(e=l[1])+2*(r=l[2]);for(var p=0;p<this.d*this.d;p++){var d=l[3+p],v=l[3+p+1];s.push(d===v?null:l.subarray(d,v))}var x=l[3+s.length+1];this.keys=l.subarray(l[3+s.length],x),this.bboxes=l.subarray(x),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var S=0;S<this.d*this.d;S++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var I=r/e*t;this.min=-I,this.max=t+I}ot.prototype.insert=function(t,e,r,s,l){this._forEachCell(e,r,s,l,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(l)},ot.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ot.prototype._insertCell=function(t,e,r,s,l,p){this.cells[l].push(p)},ot.prototype.query=function(t,e,r,s,l){var p=this.min,d=this.max;if(t<=p&&e<=p&&d<=r&&d<=s&&!l)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,r,s,this._queryCell,v,{},l),v},ot.prototype._queryCell=function(t,e,r,s,l,p,d,v){var x=this.cells[l];if(x!==null)for(var S=this.keys,I=this.bboxes,E=0;E<x.length;E++){var k=x[E];if(d[k]===void 0){var R=4*k;(v?v(I[R+0],I[R+1],I[R+2],I[R+3]):t<=I[R+2]&&e<=I[R+3]&&r>=I[R+0]&&s>=I[R+1])?(d[k]=!0,p.push(S[k])):d[k]=!1}}},ot.prototype._forEachCell=function(t,e,r,s,l,p,d,v){for(var x=this._convertToCellCoord(t),S=this._convertToCellCoord(e),I=this._convertToCellCoord(r),E=this._convertToCellCoord(s),k=x;k<=I;k++)for(var R=S;R<=E;R++){var Z=this.d*R+k;if((!v||v(this._convertFromCellCoord(k),this._convertFromCellCoord(R),this._convertFromCellCoord(k+1),this._convertFromCellCoord(R+1)))&&l.call(this,t,e,r,s,Z,p,d,v))return}},ot.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},ot.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},ot.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var l=new Int32Array(e+r+this.keys.length+this.bboxes.length);l[0]=this.extent,l[1]=this.n,l[2]=this.padding;for(var p=e,d=0;d<t.length;d++){var v=t[d];l[3+d]=p,l.set(v,p),p+=v.length}return l[3+t.length]=p,l.set(this.keys,p),l[3+t.length+1]=p+=this.keys.length,l.set(this.bboxes,p),p+=this.bboxes.length,l.buffer};var wt=Et.ImageData,gt=Et.ImageBitmap,Mt={};function mt(t,e,r){r===void 0&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Mt[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var Ft in mt("Object",Object),ut.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},ut.deserialize=function(t){return new ut(t.buffer)},mt("Grid",ut),mt("Color",Ye),mt("Error",Error),mt("ResolvedImage",Gn),mt("StylePropertyFunction",Ps),mt("StyleExpression",is,{omit:["_evaluator"]}),mt("ZoomDependentExpression",os),mt("ZoomConstantExpression",Ua),mt("CompoundExpression",$r,{omit:["_evaluate"]}),Yo)Yo[Ft]._classRegistryKey||mt("Expression_"+Ft,Yo[Ft]);function le(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function oe(t){return gt&&t instanceof gt}function ge(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(le(t)||oe(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof wt)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var s=[],l=0,p=t;l<p.length;l+=1)s.push(ge(p[l],e));return s}if(typeof t=="object"){var d=t.constructor,v=d._classRegistryKey;if(!v)throw new Error("can't serialize object of unregistered class");var x=d.serialize?d.serialize(t,e):{};if(!d.serialize){for(var S in t)if(t.hasOwnProperty(S)&&!(Mt[v].omit.indexOf(S)>=0)){var I=t[S];x[S]=Mt[v].shallow.indexOf(S)>=0?I:ge(I,e)}t instanceof Error&&(x.message=t.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return v!=="Object"&&(x.$name=v),x}throw new Error("can't serialize object of type "+typeof t)}function Je(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||le(t)||oe(t)||ArrayBuffer.isView(t)||t instanceof wt)return t;if(Array.isArray(t))return t.map(Je);if(typeof t=="object"){var e=t.$name||"Object",r=Mt[e].klass;if(!r)throw new Error("can't deserialize unregistered class "+e);if(r.deserialize)return r.deserialize(t);for(var s=Object.create(r.prototype),l=0,p=Object.keys(t);l<p.length;l+=1){var d=p[l];if(d!=="$name"){var v=t[d];s[d]=Mt[e].shallow.indexOf(d)>=0?v:Je(v)}}return s}throw new Error("can't deserialize object of type "+typeof t)}var Ie=function(){this.first=!0};Ie.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var Dt={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Tr(t){for(var e=0,r=t;e<r.length;e+=1)if(Qr(r[e].charCodeAt(0)))return!0;return!1}function Qr(t){return!(t!==746&&t!==747&&(t<4352||!(Dt["Bopomofo Extended"](t)||Dt.Bopomofo(t)||Dt["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Dt["CJK Compatibility Ideographs"](t)||Dt["CJK Compatibility"](t)||Dt["CJK Radicals Supplement"](t)||Dt["CJK Strokes"](t)||!(!Dt["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||Dt["CJK Unified Ideographs Extension A"](t)||Dt["CJK Unified Ideographs"](t)||Dt["Enclosed CJK Letters and Months"](t)||Dt["Hangul Compatibility Jamo"](t)||Dt["Hangul Jamo Extended-A"](t)||Dt["Hangul Jamo Extended-B"](t)||Dt["Hangul Jamo"](t)||Dt["Hangul Syllables"](t)||Dt.Hiragana(t)||Dt["Ideographic Description Characters"](t)||Dt.Kanbun(t)||Dt["Kangxi Radicals"](t)||Dt["Katakana Phonetic Extensions"](t)||Dt.Katakana(t)&&t!==12540||!(!Dt["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!Dt["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Dt["Unified Canadian Aboriginal Syllabics"](t)||Dt["Unified Canadian Aboriginal Syllabics Extended"](t)||Dt["Vertical Forms"](t)||Dt["Yijing Hexagram Symbols"](t)||Dt["Yi Syllables"](t)||Dt["Yi Radicals"](t))))}function yr(t){return!(Qr(t)||function(e){return!!(Dt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Dt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Dt["Letterlike Symbols"](e)||Dt["Number Forms"](e)||Dt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Dt["Control Pictures"](e)&&e!==9251||Dt["Optical Character Recognition"](e)||Dt["Enclosed Alphanumerics"](e)||Dt["Geometric Shapes"](e)||Dt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Dt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Dt["CJK Symbols and Punctuation"](e)||Dt.Katakana(e)||Dt["Private Use Area"](e)||Dt["CJK Compatibility Forms"](e)||Dt["Small Form Variants"](e)||Dt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function Cr(t){return t>=1424&&t<=2303||Dt["Arabic Presentation Forms-A"](t)||Dt["Arabic Presentation Forms-B"](t)}function ir(t,e){return!(!e&&Cr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Dt.Khmer(t))}function Xt(t){for(var e=0,r=t;e<r.length;e+=1)if(Cr(r[e].charCodeAt(0)))return!0;return!1}var De=null,ze="unavailable",Oe=null,zn=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(ze="error"),De&&De(t)};function Xr(){Ir.fire(new rt("pluginStateChange",{pluginStatus:ze,pluginURL:Oe}))}var Ir=new nt,or=function(){return ze},gn=function(){if(ze!=="deferred"||!Oe)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ze="loading",Xr(),Oe&&Gr({url:Oe},function(t){t?zn(t):(ze="loaded",Xr())})},he={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ze==="loaded"||he.applyArabicShaping!=null},isLoading:function(){return ze==="loading"},setState:function(t){ze=t.pluginStatus,Oe=t.pluginURL},isParsed:function(){return he.applyArabicShaping!=null&&he.processBidirectionalText!=null&&he.processStyledBidirectionalText!=null},getPluginURL:function(){return Oe}},Ee=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ie,this.transition={})};Ee.prototype.isSupportedScript=function(t){return function(e,r){for(var s=0,l=e;s<l.length;s+=1)if(!ir(l[s].charCodeAt(0),r))return!1;return!0}(t,he.isLoaded())},Ee.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ee.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}};var Wn=function(t,e){this.property=t,this.value=e,this.expression=function(r,s){if(go(r))return new Ps(r,s);if(lu(r)){var l=fa(r,s);if(l.result==="error")throw new Error(l.value.map(function(d){return d.key+": "+d.message}).join(", "));return l.value}var p=r;return typeof r=="string"&&s.type==="color"&&(p=Ye.parse(r)),{kind:"constant",evaluate:function(){return p}}}(e===void 0?t.specification.default:e,t.specification)};Wn.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Wn.prototype.possiblyEvaluate=function(t,e,r){return this.property.possiblyEvaluate(this,t,e,r)};var Nn=function(t){this.property=t,this.value=new Wn(t,void 0)};Nn.prototype.transitioned=function(t,e){return new Ro(this.property,this.value,e,Zt({},t.transition,this.transition),t.now)},Nn.prototype.untransitioned=function(){return new Ro(this.property,this.value,null,{},0)};var ni=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};ni.prototype.getValue=function(t){return ao(this._values[t].value.value)},ni.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Nn(this._values[t].property)),this._values[t].value=new Wn(this._values[t].property,e===null?void 0:ao(e))},ni.prototype.getTransition=function(t){return ao(this._values[t].transition)},ni.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Nn(this._values[t].property)),this._values[t].transition=ao(e)||void 0},ni.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var s=r[e],l=this.getValue(s);l!==void 0&&(t[s]=l);var p=this.getTransition(s);p!==void 0&&(t[s+"-transition"]=p)}return t},ni.prototype.transitioned=function(t,e){for(var r=new Vn(this._properties),s=0,l=Object.keys(this._values);s<l.length;s+=1){var p=l[s];r._values[p]=this._values[p].transitioned(t,e._values[p])}return r},ni.prototype.untransitioned=function(){for(var t=new Vn(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var s=r[e];t._values[s]=this._values[s].untransitioned()}return t};var Ro=function(t,e,r,s,l){this.property=t,this.value=e,this.begin=l+s.delay||0,this.end=this.begin+s.duration||0,t.specification.transition&&(s.delay||s.duration)&&(this.prior=r)};Ro.prototype.possiblyEvaluate=function(t,e,r){var s=t.now||0,l=this.value.possiblyEvaluate(t,e,r),p=this.prior;if(p){if(s>this.end)return this.prior=null,l;if(this.value.isDataDriven())return this.prior=null,l;if(s<this.begin)return p.possiblyEvaluate(t,e,r);var d=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(t,e,r),l,function(v){if(v<=0)return 0;if(v>=1)return 1;var x=v*v,S=x*v;return 4*(v<.5?S:3*(v-x)+S-.75)}(d))}return l};var Vn=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Vn.prototype.possiblyEvaluate=function(t,e,r){for(var s=new Ci(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var d=p[l];s._values[d]=this._values[d].possiblyEvaluate(t,e,r)}return s},Vn.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var ii=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};ii.prototype.getValue=function(t){return ao(this._values[t].value)},ii.prototype.setValue=function(t,e){this._values[t]=new Wn(this._values[t].property,e===null?void 0:ao(e))},ii.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var s=r[e],l=this.getValue(s);l!==void 0&&(t[s]=l)}return t},ii.prototype.possiblyEvaluate=function(t,e,r){for(var s=new Ci(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var d=p[l];s._values[d]=this._values[d].possiblyEvaluate(t,e,r)}return s};var Xn=function(t,e,r){this.property=t,this.value=e,this.parameters=r};Xn.prototype.isConstant=function(){return this.value.kind==="constant"},Xn.prototype.constantOr=function(t){return this.value.kind==="constant"?this.value.value:t},Xn.prototype.evaluate=function(t,e,r,s){return this.property.evaluate(this.value,this.parameters,t,e,r,s)};var Ci=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Ci.prototype.get=function(t){return this._values[t]};var Kt=function(t){this.specification=t};Kt.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Kt.prototype.interpolate=function(t,e,r){var s=iu[this.specification.type];return s?s(t,e,r):t};var ye=function(t,e){this.specification=t,this.overrides=e};ye.prototype.possiblyEvaluate=function(t,e,r,s){return new Xn(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(e,null,{},r,s)}:t.expression,e)},ye.prototype.interpolate=function(t,e,r){if(t.value.kind!=="constant"||e.value.kind!=="constant")return t;if(t.value.value===void 0||e.value.value===void 0)return new Xn(this,{kind:"constant",value:void 0},t.parameters);var s=iu[this.specification.type];return s?new Xn(this,{kind:"constant",value:s(t.value.value,e.value.value,r)},t.parameters):t},ye.prototype.evaluate=function(t,e,r,s,l,p){return t.kind==="constant"?t.value:t.evaluate(e,r,s,l,p)};var vi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(r,s,l,p){if(r.value===void 0)return new Xn(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){var d=r.expression.evaluate(s,null,{},l,p),v=r.property.specification.type==="resolvedImage"&&typeof d!="string"?d.name:d,x=this._calculate(v,v,v,s);return new Xn(this,{kind:"constant",value:x},s)}if(r.expression.kind==="camera"){var S=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new Xn(this,{kind:"constant",value:S},s)}return new Xn(this,r.expression,s)},e.prototype.evaluate=function(r,s,l,p,d,v){if(r.kind==="source"){var x=r.evaluate(s,l,p,d,v);return this._calculate(x,x,x,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},l,p),r.evaluate({zoom:Math.floor(s.zoom)},l,p),r.evaluate({zoom:Math.floor(s.zoom)+1},l,p),s):r.value},e.prototype._calculate=function(r,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:l,to:s}},e.prototype.interpolate=function(r){return r},e}(ye),_i=function(t){this.specification=t};_i.prototype.possiblyEvaluate=function(t,e,r,s){if(t.value!==void 0){if(t.expression.kind==="constant"){var l=t.expression.evaluate(e,null,{},r,s);return this._calculate(l,l,l,e)}return this._calculate(t.expression.evaluate(new Ee(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Ee(Math.floor(e.zoom),e)),t.expression.evaluate(new Ee(Math.floor(e.zoom+1),e)),e)}},_i.prototype._calculate=function(t,e,r,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},_i.prototype.interpolate=function(t){return t};var Va=function(t){this.specification=t};Va.prototype.possiblyEvaluate=function(t,e,r,s){return!!t.expression.evaluate(e,null,{},r,s)},Va.prototype.interpolate=function(){return!1};var $i=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var r=t[e];r.specification.overridable&&this.overridableProperties.push(e);var s=this.defaultPropertyValues[e]=new Wn(r,void 0),l=this.defaultTransitionablePropertyValues[e]=new Nn(r);this.defaultTransitioningPropertyValues[e]=l.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=s.possiblyEvaluate({})}};mt("DataDrivenProperty",ye),mt("DataConstantProperty",Kt),mt("CrossFadedDataDrivenProperty",vi),mt("CrossFadedProperty",_i),mt("ColorRampProperty",Va);var Bo=function(t){function e(r,s){if(t.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new ii(s.layout)),s.paint)){for(var l in this._transitionablePaint=new ni(s.paint),r.paint)this.setPaintProperty(l,r.paint[l],{validate:!1});for(var p in r.layout)this.setLayoutProperty(p,r.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ci(s.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},e.prototype.setLayoutProperty=function(r,s,l){l===void 0&&(l={}),s!=null&&this._validate(H,"layers."+this.id+".layout."+r,r,s,l)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)},e.prototype.getPaintProperty=function(r){return oo(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},e.prototype.setPaintProperty=function(r,s,l){if(l===void 0&&(l={}),s!=null&&this._validate(D,"layers."+this.id+".paint."+r,r,s,l))return!1;if(oo(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),s||void 0),!1;var p=this._transitionablePaint._values[r],d=p.property.specification["property-type"]==="cross-faded-data-driven",v=p.value.isDataDriven(),x=p.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);var S=this._transitionablePaint._values[r].value;return S.isDataDriven()||v||d||this._handleOverridablePaintPropertyUpdate(r,x,S)},e.prototype._handleSpecialPaintPropertyUpdate=function(r){},e.prototype._handleOverridablePaintPropertyUpdate=function(r,s,l){return!1},e.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},e.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)},e.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),jo(r,function(s,l){return!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length)})},e.prototype._validate=function(r,s,l,p,d){return d===void 0&&(d={}),(!d||d.validate!==!1)&&ct(this,r.call(w,{key:s,layerType:this.type,objectKey:l,value:p,styleSpec:V,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var r in this.paint._values){var s=this.paint.get(r);if(s instanceof Xn&&Qo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1},e}(nt),hh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},qa=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},zr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function yn(t,e){e===void 0&&(e=1);var r=0,s=0;return{members:t.map(function(l){var p=hh[l.type].BYTES_PER_ELEMENT,d=r=wl(r,Math.max(e,p)),v=l.components||1;return s=Math.max(s,p),r+=p*v,{name:l.name,type:l.type,components:v,offset:d}}),size:wl(r,Math.max(s,e)),alignment:e}}function wl(t,e){return Math.ceil(t/e)*e}zr.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},zr.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},zr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},zr.prototype.clear=function(){this.length=0},zr.prototype.resize=function(t){this.reserve(t),this.length=t},zr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},zr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var F=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s){var l=this.length;return this.resize(l+1),this.emplace(l,r,s)},e.prototype.emplace=function(r,s,l){var p=2*r;return this.int16[p+0]=s,this.int16[p+1]=l,r},e}(zr);F.prototype.bytesPerElement=4,mt("StructArrayLayout2i4",F);var Qi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,r,s,l,p)},e.prototype.emplace=function(r,s,l,p,d){var v=4*r;return this.int16[v+0]=s,this.int16[v+1]=l,this.int16[v+2]=p,this.int16[v+3]=d,r},e}(zr);Qi.prototype.bytesPerElement=8,mt("StructArrayLayout4i8",Qi);var xi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v){var x=this.length;return this.resize(x+1),this.emplace(x,r,s,l,p,d,v)},e.prototype.emplace=function(r,s,l,p,d,v,x){var S=6*r;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=d,this.int16[S+4]=v,this.int16[S+5]=x,r},e}(zr);xi.prototype.bytesPerElement=12,mt("StructArrayLayout2i4i12",xi);var Ni=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v){var x=this.length;return this.resize(x+1),this.emplace(x,r,s,l,p,d,v)},e.prototype.emplace=function(r,s,l,p,d,v,x){var S=4*r,I=8*r;return this.int16[S+0]=s,this.int16[S+1]=l,this.uint8[I+4]=p,this.uint8[I+5]=d,this.uint8[I+6]=v,this.uint8[I+7]=x,r},e}(zr);Ni.prototype.bytesPerElement=8,mt("StructArrayLayout2i4ub8",Ni);var er=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s){var l=this.length;return this.resize(l+1),this.emplace(l,r,s)},e.prototype.emplace=function(r,s,l){var p=2*r;return this.float32[p+0]=s,this.float32[p+1]=l,r},e}(zr);er.prototype.bytesPerElement=8,mt("StructArrayLayout2f8",er);var Za=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v,x,S,I,E){var k=this.length;return this.resize(k+1),this.emplace(k,r,s,l,p,d,v,x,S,I,E)},e.prototype.emplace=function(r,s,l,p,d,v,x,S,I,E,k){var R=10*r;return this.uint16[R+0]=s,this.uint16[R+1]=l,this.uint16[R+2]=p,this.uint16[R+3]=d,this.uint16[R+4]=v,this.uint16[R+5]=x,this.uint16[R+6]=S,this.uint16[R+7]=I,this.uint16[R+8]=E,this.uint16[R+9]=k,r},e}(zr);Za.prototype.bytesPerElement=20,mt("StructArrayLayout10ui20",Za);var du=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v,x,S,I,E,k,R){var Z=this.length;return this.resize(Z+1),this.emplace(Z,r,s,l,p,d,v,x,S,I,E,k,R)},e.prototype.emplace=function(r,s,l,p,d,v,x,S,I,E,k,R,Z){var j=12*r;return this.int16[j+0]=s,this.int16[j+1]=l,this.int16[j+2]=p,this.int16[j+3]=d,this.uint16[j+4]=v,this.uint16[j+5]=x,this.uint16[j+6]=S,this.uint16[j+7]=I,this.int16[j+8]=E,this.int16[j+9]=k,this.int16[j+10]=R,this.int16[j+11]=Z,r},e}(zr);du.prototype.bytesPerElement=24,mt("StructArrayLayout4i4ui4i24",du);var Nu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,l)},e.prototype.emplace=function(r,s,l,p){var d=3*r;return this.float32[d+0]=s,this.float32[d+1]=l,this.float32[d+2]=p,r},e}(zr);Nu.prototype.bytesPerElement=12,mt("StructArrayLayout3f12",Nu);var ja=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},e.prototype.emplace=function(r,s){return this.uint32[1*r+0]=s,r},e}(zr);ja.prototype.bytesPerElement=4,mt("StructArrayLayout1ul4",ja);var Vu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v,x,S,I){var E=this.length;return this.resize(E+1),this.emplace(E,r,s,l,p,d,v,x,S,I)},e.prototype.emplace=function(r,s,l,p,d,v,x,S,I,E){var k=10*r,R=5*r;return this.int16[k+0]=s,this.int16[k+1]=l,this.int16[k+2]=p,this.int16[k+3]=d,this.int16[k+4]=v,this.int16[k+5]=x,this.uint32[R+3]=S,this.uint16[k+8]=I,this.uint16[k+9]=E,r},e}(zr);Vu.prototype.bytesPerElement=20,mt("StructArrayLayout6i1ul2ui20",Vu);var ss=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v){var x=this.length;return this.resize(x+1),this.emplace(x,r,s,l,p,d,v)},e.prototype.emplace=function(r,s,l,p,d,v,x){var S=6*r;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=d,this.int16[S+4]=v,this.int16[S+5]=x,r},e}(zr);ss.prototype.bytesPerElement=12,mt("StructArrayLayout2i2i2i12",ss);var tc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d){var v=this.length;return this.resize(v+1),this.emplace(v,r,s,l,p,d)},e.prototype.emplace=function(r,s,l,p,d,v){var x=4*r,S=8*r;return this.float32[x+0]=s,this.float32[x+1]=l,this.float32[x+2]=p,this.int16[S+6]=d,this.int16[S+7]=v,r},e}(zr);tc.prototype.bytesPerElement=16,mt("StructArrayLayout2f1f2i16",tc);var ec=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,r,s,l,p)},e.prototype.emplace=function(r,s,l,p,d){var v=12*r,x=3*r;return this.uint8[v+0]=s,this.uint8[v+1]=l,this.float32[x+1]=p,this.float32[x+2]=d,r},e}(zr);ec.prototype.bytesPerElement=12,mt("StructArrayLayout2ub2f12",ec);var _o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,l)},e.prototype.emplace=function(r,s,l,p){var d=3*r;return this.uint16[d+0]=s,this.uint16[d+1]=l,this.uint16[d+2]=p,r},e}(zr);_o.prototype.bytesPerElement=6,mt("StructArrayLayout3ui6",_o);var Oo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v,x,S,I,E,k,R,Z,j,it,J,pt){var dt=this.length;return this.resize(dt+1),this.emplace(dt,r,s,l,p,d,v,x,S,I,E,k,R,Z,j,it,J,pt)},e.prototype.emplace=function(r,s,l,p,d,v,x,S,I,E,k,R,Z,j,it,J,pt,dt){var _t=24*r,xt=12*r,Pt=48*r;return this.int16[_t+0]=s,this.int16[_t+1]=l,this.uint16[_t+2]=p,this.uint16[_t+3]=d,this.uint32[xt+2]=v,this.uint32[xt+3]=x,this.uint32[xt+4]=S,this.uint16[_t+10]=I,this.uint16[_t+11]=E,this.uint16[_t+12]=k,this.float32[xt+7]=R,this.float32[xt+8]=Z,this.uint8[Pt+36]=j,this.uint8[Pt+37]=it,this.uint8[Pt+38]=J,this.uint32[xt+10]=pt,this.int16[_t+22]=dt,r},e}(zr);Oo.prototype.bytesPerElement=48,mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Oo);var Ls=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p,d,v,x,S,I,E,k,R,Z,j,it,J,pt,dt,_t,xt,Pt,qt,Yt,se,$t,fe,Qt,Ue){var be=this.length;return this.resize(be+1),this.emplace(be,r,s,l,p,d,v,x,S,I,E,k,R,Z,j,it,J,pt,dt,_t,xt,Pt,qt,Yt,se,$t,fe,Qt,Ue)},e.prototype.emplace=function(r,s,l,p,d,v,x,S,I,E,k,R,Z,j,it,J,pt,dt,_t,xt,Pt,qt,Yt,se,$t,fe,Qt,Ue,be){var ue=34*r,Ge=17*r;return this.int16[ue+0]=s,this.int16[ue+1]=l,this.int16[ue+2]=p,this.int16[ue+3]=d,this.int16[ue+4]=v,this.int16[ue+5]=x,this.int16[ue+6]=S,this.int16[ue+7]=I,this.uint16[ue+8]=E,this.uint16[ue+9]=k,this.uint16[ue+10]=R,this.uint16[ue+11]=Z,this.uint16[ue+12]=j,this.uint16[ue+13]=it,this.uint16[ue+14]=J,this.uint16[ue+15]=pt,this.uint16[ue+16]=dt,this.uint16[ue+17]=_t,this.uint16[ue+18]=xt,this.uint16[ue+19]=Pt,this.uint16[ue+20]=qt,this.uint16[ue+21]=Yt,this.uint16[ue+22]=se,this.uint32[Ge+12]=$t,this.float32[Ge+13]=fe,this.float32[Ge+14]=Qt,this.float32[Ge+15]=Ue,this.float32[Ge+16]=be,r},e}(zr);Ls.prototype.bytesPerElement=68,mt("StructArrayLayout8i15ui1ul4f68",Ls);var xo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},e.prototype.emplace=function(r,s){return this.float32[1*r+0]=s,r},e}(zr);xo.prototype.bytesPerElement=4,mt("StructArrayLayout1f4",xo);var rc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,l)},e.prototype.emplace=function(r,s,l,p){var d=3*r;return this.int16[d+0]=s,this.int16[d+1]=l,this.int16[d+2]=p,r},e}(zr);rc.prototype.bytesPerElement=6,mt("StructArrayLayout3i6",rc);var nc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l){var p=this.length;return this.resize(p+1),this.emplace(p,r,s,l)},e.prototype.emplace=function(r,s,l,p){var d=4*r;return this.uint32[2*r+0]=s,this.uint16[d+2]=l,this.uint16[d+3]=p,r},e}(zr);nc.prototype.bytesPerElement=8,mt("StructArrayLayout1ul2ui8",nc);var qu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s){var l=this.length;return this.resize(l+1),this.emplace(l,r,s)},e.prototype.emplace=function(r,s,l){var p=2*r;return this.uint16[p+0]=s,this.uint16[p+1]=l,r},e}(zr);qu.prototype.bytesPerElement=4,mt("StructArrayLayout2ui4",qu);var Fo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r){var s=this.length;return this.resize(s+1),this.emplace(s,r)},e.prototype.emplace=function(r,s){return this.uint16[1*r+0]=s,r},e}(zr);Fo.prototype.bytesPerElement=2,mt("StructArrayLayout1ui2",Fo);var n=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(r,s,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,r,s,l,p)},e.prototype.emplace=function(r,s,l,p,d){var v=4*r;return this.float32[v+0]=s,this.float32[v+1]=l,this.float32[v+2]=p,this.float32[v+3]=d,r},e}(zr);n.prototype.bytesPerElement=16,mt("StructArrayLayout4f16",n);var o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new Te(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(qa);o.prototype.size=20;var i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new o(this,r)},e}(Vu);mt("CollisionBoxArray",i);var u=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(s){this._structArray.uint8[this._pos1+37]=s},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(s){this._structArray.uint8[this._pos1+38]=s},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(s){this._structArray.uint32[this._pos4+10]=s},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,r),e}(qa);u.prototype.size=48;var f=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new u(this,r)},e}(Oo);mt("PlacedSymbolArray",f);var m=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(s){this._structArray.uint32[this._pos4+12]=s},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,r),e}(qa);m.prototype.size=68;var y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new m(this,r)},e}(Ls);mt("SymbolInstanceArray",y);var _=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(r){return this.float32[1*r+0]},e}(xo);mt("GlyphOffsetArray",_);var T=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(r){return this.int16[3*r+0]},e.prototype.gety=function(r){return this.int16[3*r+1]},e.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},e}(rc);mt("SymbolLineVertexArray",T);var C=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,r),e}(qa);C.prototype.size=8;var B=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(r){return new C(this,r)},e}(nc);mt("FeatureIndexArray",B);var U=yn([{name:"a_pos",components:2,type:"Int16"}],4).members,O=function(t){t===void 0&&(t=[]),this.segments=t};function K(t,e){return 256*(t=Zr(Math.floor(t),0,255))+Zr(Math.floor(e),0,255)}O.prototype.prepareSegment=function(t,e,r,s){var l=this.segments[this.segments.length-1];return t>O.MAX_VERTEX_ARRAY_LENGTH&&Jr("Max vertices per segment is "+O.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!l||l.vertexLength+t>O.MAX_VERTEX_ARRAY_LENGTH||l.sortKey!==s)&&(l={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},s!==void 0&&(l.sortKey=s),this.segments.push(l)),l},O.prototype.get=function(){return this.segments},O.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var s in r.vaos)r.vaos[s].destroy()}},O.simpleSegment=function(t,e,r,s){return new O([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:s,vaos:{},sortKey:0}])},O.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt("SegmentVector",O);var W=yn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Q=Ei(function(t){t.exports=function(e,r){var s,l,p,d,v,x,S,I;for(l=e.length-(s=3&e.length),p=r,v=3432918353,x=461845907,I=0;I<l;)S=255&e.charCodeAt(I)|(255&e.charCodeAt(++I))<<8|(255&e.charCodeAt(++I))<<16|(255&e.charCodeAt(++I))<<24,++I,p=27492+(65535&(d=5*(65535&(p=(p^=S=(65535&(S=(S=(65535&S)*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(S=0,s){case 3:S^=(255&e.charCodeAt(I+2))<<16;case 2:S^=(255&e.charCodeAt(I+1))<<8;case 1:p^=S=(65535&(S=(S=(65535&(S^=255&e.charCodeAt(I)))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),G=Ei(function(t){t.exports=function(e,r){for(var s,l=e.length,p=r^l,d=0;l>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),l-=4,++d;switch(l){case 3:p^=(255&e.charCodeAt(d+2))<<16;case 2:p^=(255&e.charCodeAt(d+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(d)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),$=Q,at=G;$.murmur3=Q,$.murmur2=at;var ht=function(){this.ids=[],this.positions=[],this.indexed=!1};ht.prototype.add=function(t,e,r,s){this.ids.push(bt(t)),this.positions.push(e,r,s)},ht.prototype.getPositions=function(t){for(var e=bt(t),r=0,s=this.ids.length-1;r<s;){var l=r+s>>1;this.ids[l]>=e?s=l:r=l+1}for(var p=[];this.ids[r]===e;)p.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return p},ht.serialize=function(t,e){var r=new Float64Array(t.ids),s=new Uint32Array(t.positions);return function l(p,d,v,x){for(;v<x;){for(var S=p[v+x>>1],I=v-1,E=x+1;;){do I++;while(p[I]<S);do E--;while(p[E]>S);if(I>=E)break;Tt(p,I,E),Tt(d,3*I,3*E),Tt(d,3*I+1,3*E+1),Tt(d,3*I+2,3*E+2)}E-v<x-E?(l(p,d,v,E),v=E+1):(l(p,d,E+1,x),x=E)}}(r,s,0,r.length-1),e&&e.push(r.buffer,s.buffer),{ids:r,positions:s}},ht.deserialize=function(t){var e=new ht;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var St=Math.pow(2,53)-1;function bt(t){var e=+t;return!isNaN(e)&&e<=St?e:$(String(t))}function Tt(t,e,r){var s=t[e];t[e]=t[r],t[r]=s}mt("FeaturePositionMap",ht);var Ct=function(t,e){this.gl=t.gl,this.location=e},Vt=function(t){function e(r,s){t.call(this,r,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},e}(Ct),Ut=function(t){function e(r,s){t.call(this,r,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},e}(Ct),Jt=function(t){function e(r,s){t.call(this,r,s),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},e}(Ct),ae=function(t){function e(r,s){t.call(this,r,s),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},e}(Ct),ve=function(t){function e(r,s){t.call(this,r,s),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},e}(Ct),de=function(t){function e(r,s){t.call(this,r,s),this.current=Ye.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},e}(Ct),ar=new Float32Array(16),te=function(t){function e(r,s){t.call(this,r,s),this.current=ar}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var s=1;s<16;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},e}(Ct);function Se(t){return[K(255*t.r,255*t.g),K(255*t.b,255*t.a)]}var Ze=function(t,e,r){this.value=t,this.uniformNames=e.map(function(s){return"u_"+s}),this.type=r};Ze.prototype.setUniform=function(t,e,r){t.set(r.constantOr(this.value))},Ze.prototype.getBinding=function(t,e,r){return this.type==="color"?new de(t,e):new Ut(t,e)};var Re=function(t,e){this.uniformNames=e.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Re.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},Re.prototype.setUniform=function(t,e,r,s){var l=s==="u_pattern_to"?this.patternTo:s==="u_pattern_from"?this.patternFrom:s==="u_pixel_ratio_to"?this.pixelRatioTo:s==="u_pixel_ratio_from"?this.pixelRatioFrom:null;l&&t.set(l)},Re.prototype.getBinding=function(t,e,r){return r.substr(0,9)==="u_pattern"?new ve(t,e):new Ut(t,e)};var Pe=function(t,e,r,s){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=e.map(function(l){return{name:"a_"+l,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new s};Pe.prototype.populatePaintArray=function(t,e,r,s,l){var p=this.paintVertexArray.length,d=this.expression.evaluate(new Ee(0),e,{},s,[],l);this.paintVertexArray.resize(t),this._setPaintValue(p,t,d)},Pe.prototype.updatePaintArray=function(t,e,r,s){var l=this.expression.evaluate({zoom:0},r,s);this._setPaintValue(t,e,l)},Pe.prototype._setPaintValue=function(t,e,r){if(this.type==="color")for(var s=Se(r),l=t;l<e;l++)this.paintVertexArray.emplace(l,s[0],s[1]);else{for(var p=t;p<e;p++)this.paintVertexArray.emplace(p,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Pe.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Pe.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ke=function(t,e,r,s,l,p){this.expression=t,this.uniformNames=e.map(function(d){return"u_"+d+"_t"}),this.type=r,this.useIntegerZoom=s,this.zoom=l,this.maxValue=0,this.paintVertexAttributes=e.map(function(d){return{name:"a_"+d,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new p};ke.prototype.populatePaintArray=function(t,e,r,s,l){var p=this.expression.evaluate(new Ee(this.zoom),e,{},s,[],l),d=this.expression.evaluate(new Ee(this.zoom+1),e,{},s,[],l),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,p,d)},ke.prototype.updatePaintArray=function(t,e,r,s){var l=this.expression.evaluate({zoom:this.zoom},r,s),p=this.expression.evaluate({zoom:this.zoom+1},r,s);this._setPaintValue(t,e,l,p)},ke.prototype._setPaintValue=function(t,e,r,s){if(this.type==="color")for(var l=Se(r),p=Se(s),d=t;d<e;d++)this.paintVertexArray.emplace(d,l[0],l[1],p[0],p[1]);else{for(var v=t;v<e;v++)this.paintVertexArray.emplace(v,r,s);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(s))}},ke.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ke.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ke.prototype.setUniform=function(t,e){var r=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,s=Zr(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);t.set(s)},ke.prototype.getBinding=function(t,e,r){return new Ut(t,e)};var Ae=function(t,e,r,s,l,p){this.expression=t,this.type=e,this.useIntegerZoom=r,this.zoom=s,this.layerId=p,this.zoomInPaintVertexArray=new l,this.zoomOutPaintVertexArray=new l};Ae.prototype.populatePaintArray=function(t,e,r){var s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(s,t,e.patterns&&e.patterns[this.layerId],r)},Ae.prototype.updatePaintArray=function(t,e,r,s,l){this._setPaintValues(t,e,r.patterns&&r.patterns[this.layerId],l)},Ae.prototype._setPaintValues=function(t,e,r,s){if(s&&r){var l=s[r.min],p=s[r.mid],d=s[r.max];if(l&&p&&d)for(var v=t;v<e;v++)this.zoomInPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],p.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],p.pixelRatio,d.pixelRatio)}},Ae.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,W.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,W.members,this.expression.isStateDependent))},Ae.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ie=function(t,e,r){this.binders={},this._buffers=[];var s=[];for(var l in t.paint._values)if(r(l)){var p=t.paint.get(l);if(p instanceof Xn&&Qo(p.property.specification)){var d=sn(l,t.type),v=p.value,x=p.property.specification.type,S=p.property.useIntegerZoom,I=p.property.specification["property-type"],E=I==="cross-faded"||I==="cross-faded-data-driven";if(v.kind==="constant")this.binders[l]=E?new Re(v.value,d):new Ze(v.value,d,x),s.push("/u_"+l);else if(v.kind==="source"||E){var k=en(l,x,"source");this.binders[l]=E?new Ae(v,x,S,e,k,t.id):new Pe(v,d,x,k),s.push("/a_"+l)}else{var R=en(l,x,"composite");this.binders[l]=new ke(v,d,x,S,e,R),s.push("/z_"+l)}}}this.cacheKey=s.sort().join("")};ie.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof Pe||e instanceof ke?e.maxValue:0},ie.prototype.populatePaintArrays=function(t,e,r,s,l){for(var p in this.binders){var d=this.binders[p];(d instanceof Pe||d instanceof ke||d instanceof Ae)&&d.populatePaintArray(t,e,r,s,l)}},ie.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders){var s=this.binders[r];s instanceof Re&&s.setConstantPatternPositions(t,e)}},ie.prototype.updatePaintArrays=function(t,e,r,s,l){var p=!1;for(var d in t)for(var v=0,x=e.getPositions(d);v<x.length;v+=1){var S=x[v],I=r.feature(S.index);for(var E in this.binders){var k=this.binders[E];if((k instanceof Pe||k instanceof ke||k instanceof Ae)&&k.expression.isStateDependent===!0){var R=s.paint.get(E);k.expression=R.value,k.updatePaintArray(S.start,S.end,I,t[d],l),p=!0}}}return p},ie.prototype.defines=function(){var t=[];for(var e in this.binders){var r=this.binders[e];(r instanceof Ze||r instanceof Re)&&t.push.apply(t,r.uniformNames.map(function(s){return"#define HAS_UNIFORM_"+s}))}return t},ie.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof Pe||r instanceof ke)for(var s=0;s<r.paintVertexAttributes.length;s++)t.push(r.paintVertexAttributes[s].name);else if(r instanceof Ae)for(var l=0;l<W.members.length;l++)t.push(W.members[l].name)}return t},ie.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof Ze||r instanceof Re||r instanceof ke)for(var s=0,l=r.uniformNames;s<l.length;s+=1)t.push(l[s])}return t},ie.prototype.getPaintVertexBuffers=function(){return this._buffers},ie.prototype.getUniforms=function(t,e){var r=[];for(var s in this.binders){var l=this.binders[s];if(l instanceof Ze||l instanceof Re||l instanceof ke)for(var p=0,d=l.uniformNames;p<d.length;p+=1){var v=d[p];if(e[v]){var x=l.getBinding(t,e[v],v);r.push({name:v,property:s,binding:x})}}}return r},ie.prototype.setUniforms=function(t,e,r,s){for(var l=0,p=e;l<p.length;l+=1){var d=p[l],v=d.name,x=d.property;this.binders[x].setUniform(d.binding,s,r.get(x),v)}},ie.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var r=this.binders[e];if(t&&r instanceof Ae){var s=t.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(r instanceof Pe||r instanceof ke)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ie.prototype.upload=function(t){for(var e in this.binders){var r=this.binders[e];(r instanceof Pe||r instanceof ke||r instanceof Ae)&&r.upload(t)}this.updatePaintBuffers()},ie.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Pe||e instanceof ke||e instanceof Ae)&&e.destroy()}};var Er=function(t,e,r){r===void 0&&(r=function(){return!0}),this.programConfigurations={};for(var s=0,l=t;s<l.length;s+=1){var p=l[s];this.programConfigurations[p.id]=new ie(p,e,r)}this.needsUpload=!1,this._featureMap=new ht,this._bufferOffset=0};function sn(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function en(t,e,r){var s={color:{source:er,composite:n},number:{source:xo,composite:er}},l=function(p){return{"line-pattern":{source:Za,composite:Za},"fill-pattern":{source:Za,composite:Za},"fill-extrusion-pattern":{source:Za,composite:Za}}[p]}(t);return l&&l[r]||s[e][r]}Er.prototype.populatePaintArrays=function(t,e,r,s,l,p){for(var d in this.programConfigurations)this.programConfigurations[d].populatePaintArrays(t,e,s,l,p);e.id!==void 0&&this._featureMap.add(e.id,r,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Er.prototype.updatePaintArrays=function(t,e,r,s){for(var l=0,p=r;l<p.length;l+=1){var d=p[l];this.needsUpload=this.programConfigurations[d.id].updatePaintArrays(t,this._featureMap,e,d,s)||this.needsUpload}},Er.prototype.get=function(t){return this.programConfigurations[t]},Er.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Er.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},mt("ConstantBinder",Ze),mt("CrossFadedConstantBinder",Re),mt("SourceExpressionBinder",Pe),mt("CrossFadedCompositeBinder",Ae),mt("CompositeExpressionBinder",ke),mt("ProgramConfiguration",ie,{omit:["_buffers"]}),mt("ProgramConfigurationSet",Er);var Tn=Math.pow(2,14)-1,vn=-Tn-1;function Vr(t){for(var e=8192/t.extent,r=t.loadGeometry(),s=0;s<r.length;s++)for(var l=r[s],p=0;p<l.length;p++){var d=l[p],v=Math.round(d.x*e),x=Math.round(d.y*e);d.x=Zr(v,vn,Tn),d.y=Zr(x,vn,Tn),(v<d.x||v>d.x+1||x<d.y||x>d.y+1)&&Jr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function oi(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Vr(t):[]}}function un(t,e,r,s,l){t.emplaceBack(2*e+(s+1)/2,2*r+(l+1)/2)}var ai=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new F,this.indexArray=new _o,this.segments=new O,this.programConfigurations=new Er(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function zi(t,e){for(var r=0;r<t.length;r++)if(to(e,t[r]))return!0;for(var s=0;s<e.length;s++)if(to(t,e[s]))return!0;return!!us(t,e)}function ga(t,e,r){return!!to(t,e)||!!ls(e,t,r)}function bo(t,e){if(t.length===1)return mu(e,t[0]);for(var r=0;r<e.length;r++)for(var s=e[r],l=0;l<s.length;l++)if(to(t,s[l]))return!0;for(var p=0;p<t.length;p++)if(mu(e,t[p]))return!0;for(var d=0;d<e.length;d++)if(us(t,e[d]))return!0;return!1}function Zu(t,e,r){if(t.length>1){if(us(t,e))return!0;for(var s=0;s<e.length;s++)if(ls(e[s],t,r))return!0}for(var l=0;l<t.length;l++)if(ls(t[l],e,r))return!0;return!1}function us(t,e){if(t.length===0||e.length===0)return!1;for(var r=0;r<t.length-1;r++)for(var s=t[r],l=t[r+1],p=0;p<e.length-1;p++)if(ya(s,l,e[p],e[p+1]))return!0;return!1}function ya(t,e,r,s){return ui(t,r,s)!==ui(e,r,s)&&ui(t,e,r)!==ui(t,e,s)}function ls(t,e,r){var s=r*r;if(e.length===1)return t.distSqr(e[0])<s;for(var l=1;l<e.length;l++)if(ju(t,e[l-1],e[l])<s)return!0;return!1}function ju(t,e,r){var s=e.distSqr(r);if(s===0)return t.distSqr(e);var l=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/s;return t.distSqr(l<0?e:l>1?r:r.sub(e)._mult(l)._add(e))}function mu(t,e){for(var r,s,l,p=!1,d=0;d<t.length;d++)for(var v=0,x=(r=t[d]).length-1;v<r.length;x=v++)(s=r[v]).y>e.y!=(l=r[x]).y>e.y&&e.x<(l.x-s.x)*(e.y-s.y)/(l.y-s.y)+s.x&&(p=!p);return p}function to(t,e){for(var r=!1,s=0,l=t.length-1;s<t.length;l=s++){var p=t[s],d=t[l];p.y>e.y!=d.y>e.y&&e.x<(d.x-p.x)*(e.y-p.y)/(d.y-p.y)+p.x&&(r=!r)}return r}function gu(t,e,r){var s=r[0],l=r[2];if(t.x<s.x&&e.x<s.x||t.x>l.x&&e.x>l.x||t.y<s.y&&e.y<s.y||t.y>l.y&&e.y>l.y)return!1;var p=ui(t,e,r[0]);return p!==ui(t,e,r[1])||p!==ui(t,e,r[2])||p!==ui(t,e,r[3])}function kn(t,e,r){var s=e.paint.get(t).value;return s.kind==="constant"?s.value:r.programConfigurations.get(e.id).getMaxValue(t)}function ea(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Uo(t,e,r,s,l){if(!e[0]&&!e[1])return t;var p=Te.convert(e)._mult(l);r==="viewport"&&p._rotate(-s);for(var d=[],v=0;v<t.length;v++)d.push(t[v].sub(p));return d}ai.prototype.populate=function(t,e,r){var s=this.layers[0],l=[],p=null,d=!1;s.type==="circle"&&(d=!(p=s.layout.get("circle-sort-key")).isConstant());for(var v=0,x=t;v<x.length;v+=1){var S=x[v],I=S.feature,E=S.id,k=S.index,R=S.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,j=oi(I,Z);if(this.layers[0]._featureFilter.filter(new Ee(this.zoom),j,r)){var it=d?p.evaluate(j,{},r):void 0,J={id:E,properties:I.properties,type:I.type,sourceLayerIndex:R,index:k,geometry:Z?j.geometry:Vr(I),patterns:{},sortKey:it};l.push(J)}}d&&l.sort(function(se,$t){return se.sortKey-$t.sortKey});for(var pt=0,dt=l;pt<dt.length;pt+=1){var _t=dt[pt],xt=_t.geometry,Pt=_t.index,qt=_t.sourceLayerIndex,Yt=t[Pt].feature;this.addFeature(_t,xt,Pt,r),e.featureIndex.insert(Yt,xt,Pt,qt,this.index)}},ai.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},ai.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ai.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ai.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,U),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ai.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ai.prototype.addFeature=function(t,e,r,s){for(var l=0,p=e;l<p.length;l+=1)for(var d=0,v=p[l];d<v.length;d+=1){var x=v[d],S=x.x,I=x.y;if(!(S<0||S>=8192||I<0||I>=8192)){var E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),k=E.vertexLength;un(this.layoutVertexArray,S,I,-1,-1),un(this.layoutVertexArray,S,I,1,-1),un(this.layoutVertexArray,S,I,1,1),un(this.layoutVertexArray,S,I,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+3,k+2),E.vertexLength+=4,E.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},s)},mt("CircleBucket",ai,{omit:["layers"]});var Ds=new $i({"circle-sort-key":new ye(V.layout_circle["circle-sort-key"])}),_n={paint:new $i({"circle-radius":new ye(V.paint_circle["circle-radius"]),"circle-color":new ye(V.paint_circle["circle-color"]),"circle-blur":new ye(V.paint_circle["circle-blur"]),"circle-opacity":new ye(V.paint_circle["circle-opacity"]),"circle-translate":new Kt(V.paint_circle["circle-translate"]),"circle-translate-anchor":new Kt(V.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kt(V.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kt(V.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ye(V.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ye(V.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ye(V.paint_circle["circle-stroke-opacity"])}),layout:Ds},ln=typeof Float32Array!="undefined"?Float32Array:Array;function bi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Rs(t,e,r){var s=e[0],l=e[1],p=e[2],d=e[3],v=e[4],x=e[5],S=e[6],I=e[7],E=e[8],k=e[9],R=e[10],Z=e[11],j=e[12],it=e[13],J=e[14],pt=e[15],dt=r[0],_t=r[1],xt=r[2],Pt=r[3];return t[0]=dt*s+_t*v+xt*E+Pt*j,t[1]=dt*l+_t*x+xt*k+Pt*it,t[2]=dt*p+_t*S+xt*R+Pt*J,t[3]=dt*d+_t*I+xt*Z+Pt*pt,t[4]=(dt=r[4])*s+(_t=r[5])*v+(xt=r[6])*E+(Pt=r[7])*j,t[5]=dt*l+_t*x+xt*k+Pt*it,t[6]=dt*p+_t*S+xt*R+Pt*J,t[7]=dt*d+_t*I+xt*Z+Pt*pt,t[8]=(dt=r[8])*s+(_t=r[9])*v+(xt=r[10])*E+(Pt=r[11])*j,t[9]=dt*l+_t*x+xt*k+Pt*it,t[10]=dt*p+_t*S+xt*R+Pt*J,t[11]=dt*d+_t*I+xt*Z+Pt*pt,t[12]=(dt=r[12])*s+(_t=r[13])*v+(xt=r[14])*E+(Pt=r[15])*j,t[13]=dt*l+_t*x+xt*k+Pt*it,t[14]=dt*p+_t*S+xt*R+Pt*J,t[15]=dt*d+_t*I+xt*Z+Pt*pt,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,r=arguments.length;r--;)e+=t[r]*t[r];return Math.sqrt(e)});var Sl,ic=Rs;function Gu(t,e,r){var s=e[0],l=e[1],p=e[2],d=e[3];return t[0]=r[0]*s+r[4]*l+r[8]*p+r[12]*d,t[1]=r[1]*s+r[5]*l+r[9]*p+r[13]*d,t[2]=r[2]*s+r[6]*l+r[10]*p+r[14]*d,t[3]=r[3]*s+r[7]*l+r[11]*p+r[15]*d,t}Sl=new ln(3),ln!=Float32Array&&(Sl[0]=0,Sl[1]=0,Sl[2]=0),function(){var t=new ln(4);ln!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var Wu=(function(){var t=new ln(2);ln!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(r){t.call(this,r,_n)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(r){return new ai(r)},e.prototype.queryRadius=function(r){var s=r;return kn("circle-radius",this,s)+kn("circle-stroke-width",this,s)+ea(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(r,s,l,p,d,v,x,S){for(var I=Uo(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,x),E=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),k=this.paint.get("circle-pitch-alignment")==="map",R=k?I:function(qt,Yt){return qt.map(function(se){return oc(se,Yt)})}(I,S),Z=k?E*x:E,j=0,it=p;j<it.length;j+=1)for(var J=0,pt=it[j];J<pt.length;J+=1){var dt=pt[J],_t=k?dt:oc(dt,S),xt=Z,Pt=Gu([],[dt.x,dt.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?xt*=Pt[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(xt*=v.cameraToCenterDistance/Pt[3]),ga(R,_t,xt))return!0}return!1},e}(Bo));function oc(t,e){var r=Gu([],[t.x,t.y,0,1],e);return new Te(r[0]/r[3],r[1]/r[3])}var cs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(ai);function Xu(t,e,r,s){var l=e.width,p=e.height;if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==l*p*r)throw new RangeError("mismatched image size")}else s=new Uint8Array(l*p*r);return t.width=l,t.height=p,t.data=s,t}function ph(t,e,r){var s=e.width,l=e.height;if(s!==t.width||l!==t.height){var p=Xu({},{width:s,height:l},r);Mc(t,p,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,l)},r),t.width=s,t.height=l,t.data=p.data}}function Mc(t,e,r,s,l,p){if(l.width===0||l.height===0)return e;if(l.width>t.width||l.height>t.height||r.x>t.width-l.width||r.y>t.height-l.height)throw new RangeError("out of range source coordinates for image copy");if(l.width>e.width||l.height>e.height||s.x>e.width-l.width||s.y>e.height-l.height)throw new RangeError("out of range destination coordinates for image copy");for(var d=t.data,v=e.data,x=0;x<l.height;x++)for(var S=((r.y+x)*t.width+r.x)*p,I=((s.y+x)*e.width+s.x)*p,E=0;E<l.width*p;E++)v[I+E]=d[S+E];return e}mt("HeatmapBucket",cs,{omit:["layers"]});var Hu=function(t,e){Xu(this,t,1,e)};Hu.prototype.resize=function(t){ph(this,t,1)},Hu.prototype.clone=function(){return new Hu({width:this.width,height:this.height},new Uint8Array(this.data))},Hu.copy=function(t,e,r,s,l){Mc(t,e,r,s,l,1)};var Vi=function(t,e){Xu(this,t,4,e)};Vi.prototype.resize=function(t){ph(this,t,4)},Vi.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},Vi.prototype.clone=function(){return new Vi({width:this.width,height:this.height},new Uint8Array(this.data))},Vi.copy=function(t,e,r,s,l){Mc(t,e,r,s,l,4)},mt("AlphaImage",Hu),mt("RGBAImage",Vi);var of={paint:new $i({"heatmap-radius":new ye(V.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ye(V.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kt(V.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Va(V.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kt(V.paint_heatmap["heatmap-opacity"])})};function Lc(t){var e={},r=t.resolution||256,s=t.clips?t.clips.length:1,l=t.image||new Vi({width:r,height:s}),p=function(Z,j,it){e[t.evaluationKey]=it;var J=t.expression.evaluate(e);l.data[Z+j+0]=Math.floor(255*J.r/J.a),l.data[Z+j+1]=Math.floor(255*J.g/J.a),l.data[Z+j+2]=Math.floor(255*J.b/J.a),l.data[Z+j+3]=Math.floor(255*J.a)};if(t.clips)for(var d=0,v=0;d<s;++d,v+=4*r)for(var x=0,S=0;x<r;x++,S+=4){var I=x/(r-1),E=t.clips[d];p(v,S,E.start*(1-I)+E.end*I)}else for(var k=0,R=0;k<r;k++,R+=4)p(0,R,k/(r-1));return l}var Xh=function(t){function e(r){t.call(this,r,of),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(r){return new cs(r)},e.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=Lc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},e}(Bo),fh={paint:new $i({"hillshade-illumination-direction":new Kt(V.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Kt(V.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kt(V.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kt(V.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kt(V.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kt(V.paint_hillshade["hillshade-accent-color"])})},af=function(t){function e(r){t.call(this,r,fh)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},e}(Bo),dh=yn([{name:"a_pos",components:2,type:"Int16"}],4).members,cr=Dc,sf=Dc;function Dc(t,e,r){r=r||2;var s,l,p,d,v,x,S,I=e&&e.length,E=I?e[0]*r:t.length,k=Tl(t,0,E,r,!0),R=[];if(!k||k.next===k.prev)return R;if(I&&(k=function(j,it,J,pt){var dt,_t,xt,Pt=[];for(dt=0,_t=it.length;dt<_t;dt++)(xt=Tl(j,it[dt]*pt,dt<_t-1?it[dt+1]*pt:j.length,pt,!1))===xt.next&&(xt.steiner=!0),Pt.push(yu(xt));for(Pt.sort(mh),dt=0;dt<Pt.length;dt++)Hh(Pt[dt],J),J=Bs(J,J.next);return J}(t,e,k,r)),t.length>80*r){s=p=t[0],l=d=t[1];for(var Z=r;Z<E;Z+=r)(v=t[Z])<s&&(s=v),(x=t[Z+1])<l&&(l=x),v>p&&(p=v),x>d&&(d=x);S=(S=Math.max(p-s,d-l))!==0?1/S:0}return ac(k,R,r,s,l,S),R}function Tl(t,e,r,s,l){var p,d;if(l===Fc(t,e,r,s)>0)for(p=e;p<r;p+=s)d=Jh(p,t[p],t[p+1],d);else for(p=r-s;p>=e;p-=s)d=Jh(p,t[p],t[p+1],d);return d&&sc(d,d.next)&&(_a(d),d=d.next),d}function Bs(t,e){if(!t)return t;e||(e=t);var r,s=t;do if(r=!1,s.steiner||!sc(s,s.next)&&cn(s.prev,s,s.next)!==0)s=s.next;else{if(_a(s),(s=e=s.prev)===s.next)break;r=!0}while(r||s!==e);return e}function ac(t,e,r,s,l,p,d){if(t){!d&&p&&function(I,E,k,R){var Z=I;do Z.z===null&&(Z.z=wo(Z.x,Z.y,E,k,R)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==I);Z.prevZ.nextZ=null,Z.prevZ=null,function(j){var it,J,pt,dt,_t,xt,Pt,qt,Yt=1;do{for(J=j,j=null,_t=null,xt=0;J;){for(xt++,pt=J,Pt=0,it=0;it<Yt&&(Pt++,pt=pt.nextZ);it++);for(qt=Yt;Pt>0||qt>0&&pt;)Pt!==0&&(qt===0||!pt||J.z<=pt.z)?(dt=J,J=J.nextZ,Pt--):(dt=pt,pt=pt.nextZ,qt--),_t?_t.nextZ=dt:j=dt,dt.prevZ=_t,_t=dt;J=pt}_t.nextZ=null,Yt*=2}while(xt>1)}(Z)}(t,s,l,p);for(var v,x,S=t;t.prev!==t.next;)if(v=t.prev,x=t.next,p?va(t,s,l,p):uf(t))e.push(v.i/r),e.push(t.i/r),e.push(x.i/r),_a(t),t=x.next,S=x.next;else if((t=x)===S){d?d===1?ac(t=lf(Bs(t),e,r),e,r,s,l,p,2):d===2&&Rc(t,e,r,s,l,p):ac(Bs(t),e,r,s,l,p,1);break}}}function uf(t){var e=t.prev,r=t,s=t.next;if(cn(e,r,s)>=0)return!1;for(var l=t.next.next;l!==t.prev;){if(vu(e.x,e.y,r.x,r.y,s.x,s.y,l.x,l.y)&&cn(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function va(t,e,r,s){var l=t.prev,p=t,d=t.next;if(cn(l,p,d)>=0)return!1;for(var v=l.x>p.x?l.x>d.x?l.x:d.x:p.x>d.x?p.x:d.x,x=l.y>p.y?l.y>d.y?l.y:d.y:p.y>d.y?p.y:d.y,S=wo(l.x<p.x?l.x<d.x?l.x:d.x:p.x<d.x?p.x:d.x,l.y<p.y?l.y<d.y?l.y:d.y:p.y<d.y?p.y:d.y,e,r,s),I=wo(v,x,e,r,s),E=t.prevZ,k=t.nextZ;E&&E.z>=S&&k&&k.z<=I;){if(E!==t.prev&&E!==t.next&&vu(l.x,l.y,p.x,p.y,d.x,d.y,E.x,E.y)&&cn(E.prev,E,E.next)>=0||(E=E.prevZ,k!==t.prev&&k!==t.next&&vu(l.x,l.y,p.x,p.y,d.x,d.y,k.x,k.y)&&cn(k.prev,k,k.next)>=0))return!1;k=k.nextZ}for(;E&&E.z>=S;){if(E!==t.prev&&E!==t.next&&vu(l.x,l.y,p.x,p.y,d.x,d.y,E.x,E.y)&&cn(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;k&&k.z<=I;){if(k!==t.prev&&k!==t.next&&vu(l.x,l.y,p.x,p.y,d.x,d.y,k.x,k.y)&&cn(k.prev,k,k.next)>=0)return!1;k=k.nextZ}return!0}function lf(t,e,r){var s=t;do{var l=s.prev,p=s.next.next;!sc(l,p)&&Bc(l,s,s.next,p)&&Ku(l,p)&&Ku(p,l)&&(e.push(l.i/r),e.push(s.i/r),e.push(p.i/r),_a(s),_a(s.next),s=t=p),s=s.next}while(s!==t);return Bs(s)}function Rc(t,e,r,s,l,p){var d=t;do{for(var v=d.next.next;v!==d.prev;){if(d.i!==v.i&&Yh(d,v)){var x=Os(d,v);return d=Bs(d,d.next),x=Bs(x,x.next),ac(d,e,r,s,l,p),void ac(x,e,r,s,l,p)}v=v.next}d=d.next}while(d!==t)}function mh(t,e){return t.x-e.x}function Hh(t,e){if(e=function(s,l){var p,d=l,v=s.x,x=s.y,S=-1/0;do{if(x<=d.y&&x>=d.next.y&&d.next.y!==d.y){var I=d.x+(x-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(I<=v&&I>S){if(S=I,I===v){if(x===d.y)return d;if(x===d.next.y)return d.next}p=d.x<d.next.x?d:d.next}}d=d.next}while(d!==l);if(!p)return null;if(v===S)return p;var E,k=p,R=p.x,Z=p.y,j=1/0;d=p;do v>=d.x&&d.x>=R&&v!==d.x&&vu(x<Z?v:S,x,R,Z,x<Z?S:v,x,d.x,d.y)&&(E=Math.abs(x-d.y)/(v-d.x),Ku(d,s)&&(E<j||E===j&&(d.x>p.x||d.x===p.x&&Kh(p,d)))&&(p=d,j=E)),d=d.next;while(d!==k);return p}(t,e)){var r=Os(e,t);Bs(e,e.next),Bs(r,r.next)}}function Kh(t,e){return cn(t.prev,t,e.prev)<0&&cn(e.next,t,t.next)<0}function wo(t,e,r,s,l){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*l)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*l)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function yu(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function vu(t,e,r,s,l,p,d,v){return(l-d)*(e-v)-(t-d)*(p-v)>=0&&(t-d)*(s-v)-(r-d)*(e-v)>=0&&(r-d)*(p-v)-(l-d)*(s-v)>=0}function Yh(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(r,s){var l=r;do{if(l.i!==r.i&&l.next.i!==r.i&&l.i!==s.i&&l.next.i!==s.i&&Bc(l,l.next,r,s))return!0;l=l.next}while(l!==r);return!1}(t,e)&&(Ku(t,e)&&Ku(e,t)&&function(r,s){var l=r,p=!1,d=(r.x+s.x)/2,v=(r.y+s.y)/2;do l.y>v!=l.next.y>v&&l.next.y!==l.y&&d<(l.next.x-l.x)*(v-l.y)/(l.next.y-l.y)+l.x&&(p=!p),l=l.next;while(l!==r);return p}(t,e)&&(cn(t.prev,t,e.prev)||cn(t,e.prev,e))||sc(t,e)&&cn(t.prev,t,t.next)>0&&cn(e.prev,e,e.next)>0)}function cn(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function sc(t,e){return t.x===e.x&&t.y===e.y}function Bc(t,e,r,s){var l=Il(cn(t,e,r)),p=Il(cn(t,e,s)),d=Il(cn(r,s,t)),v=Il(cn(r,s,e));return l!==p&&d!==v||!(l!==0||!uc(t,r,e))||!(p!==0||!uc(t,s,e))||!(d!==0||!uc(r,t,s))||!(v!==0||!uc(r,e,s))}function uc(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Il(t){return t>0?1:t<0?-1:0}function Ku(t,e){return cn(t.prev,t,t.next)<0?cn(t,e,t.next)>=0&&cn(t,t.prev,e)>=0:cn(t,e,t.prev)<0||cn(t,t.next,e)<0}function Os(t,e){var r=new Oc(t.i,t.x,t.y),s=new Oc(e.i,e.x,e.y),l=t.next,p=e.prev;return t.next=e,e.prev=t,r.next=l,l.prev=r,s.next=r,r.prev=s,p.next=s,s.prev=p,s}function Jh(t,e,r,s){var l=new Oc(t,e,r);return s?(l.next=s.next,l.prev=s,s.next.prev=l,s.next=l):(l.prev=l,l.next=l),l}function _a(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Oc(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Fc(t,e,r,s){for(var l=0,p=e,d=r-s;p<r;p+=s)l+=(t[d]-t[p])*(t[p+1]+t[d+1]),d=p;return l}function gh(t,e,r,s,l){(function p(d,v,x,S,I){for(;S>x;){if(S-x>600){var E=S-x+1,k=v-x+1,R=Math.log(E),Z=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*Z*(E-Z)/E)*(k-E/2<0?-1:1);p(d,v,Math.max(x,Math.floor(v-k*Z/E+j)),Math.min(S,Math.floor(v+(E-k)*Z/E+j)),I)}var it=d[v],J=x,pt=S;for(lc(d,x,v),I(d[S],it)>0&&lc(d,x,S);J<pt;){for(lc(d,J,pt),J++,pt--;I(d[J],it)<0;)J++;for(;I(d[pt],it)>0;)pt--}I(d[x],it)===0?lc(d,x,pt):lc(d,++pt,S),pt<=v&&(x=pt+1),v<=pt&&(S=pt-1)}})(t,e,r||0,s||t.length-1,l||cf)}function lc(t,e,r){var s=t[e];t[e]=t[r],t[r]=s}function cf(t,e){return t<e?-1:t>e?1:0}function yh(t,e){var r=t.length;if(r<=1)return[t];for(var s,l,p=[],d=0;d<r;d++){var v=Ks(t[d]);v!==0&&(t[d].area=Math.abs(v),l===void 0&&(l=v<0),l===v<0?(s&&p.push(s),s=[t[d]]):s.push(t[d]))}if(s&&p.push(s),e>1)for(var x=0;x<p.length;x++)p[x].length<=e||(gh(p[x],e,1,p[x].length-1,$h),p[x]=p[x].slice(0,e));return p}function $h(t,e){return e.area-t.area}function Uc(t,e,r){for(var s=r.patternDependencies,l=!1,p=0,d=e;p<d.length;p+=1){var v=d[p].paint.get(t+"-pattern");v.isConstant()||(l=!0);var x=v.constantOr(null);x&&(l=!0,s[x.to]=!0,s[x.from]=!0)}return l}function vh(t,e,r,s,l){for(var p=l.patternDependencies,d=0,v=e;d<v.length;d+=1){var x=v[d],S=x.paint.get(t+"-pattern").value;if(S.kind!=="constant"){var I=S.evaluate({zoom:s-1},r,{},l.availableImages),E=S.evaluate({zoom:s},r,{},l.availableImages),k=S.evaluate({zoom:s+1},r,{},l.availableImages);E=E&&E.name?E.name:E,k=k&&k.name?k.name:k,p[I=I&&I.name?I.name:I]=!0,p[E]=!0,p[k]=!0,r.patterns[x.id]={min:I,mid:E,max:k}}}return r}Dc.deviation=function(t,e,r,s){var l=e&&e.length,p=Math.abs(Fc(t,0,l?e[0]*r:t.length,r));if(l)for(var d=0,v=e.length;d<v;d++)p-=Math.abs(Fc(t,e[d]*r,d<v-1?e[d+1]*r:t.length,r));var x=0;for(d=0;d<s.length;d+=3){var S=s[d]*r,I=s[d+1]*r,E=s[d+2]*r;x+=Math.abs((t[S]-t[E])*(t[I+1]-t[S+1])-(t[S]-t[I])*(t[E+1]-t[S+1]))}return p===0&&x===0?0:Math.abs((x-p)/p)},Dc.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},s=0,l=0;l<t.length;l++){for(var p=0;p<t[l].length;p++)for(var d=0;d<e;d++)r.vertices.push(t[l][p][d]);l>0&&r.holes.push(s+=t[l-1].length)}return r},cr.default=sf;var xa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new F,this.indexArray=new _o,this.indexArray2=new qu,this.programConfigurations=new Er(t.layers,t.zoom),this.segments=new O,this.segments2=new O,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};xa.prototype.populate=function(t,e,r){this.hasPattern=Uc("fill",this.layers,e);for(var s=this.layers[0].layout.get("fill-sort-key"),l=!s.isConstant(),p=[],d=0,v=t;d<v.length;d+=1){var x=v[d],S=x.feature,I=x.id,E=x.index,k=x.sourceLayerIndex,R=this.layers[0]._featureFilter.needGeometry,Z=oi(S,R);if(this.layers[0]._featureFilter.filter(new Ee(this.zoom),Z,r)){var j=l?s.evaluate(Z,{},r,e.availableImages):void 0,it={id:I,properties:S.properties,type:S.type,sourceLayerIndex:k,index:E,geometry:R?Z.geometry:Vr(S),patterns:{},sortKey:j};p.push(it)}}l&&p.sort(function(Yt,se){return Yt.sortKey-se.sortKey});for(var J=0,pt=p;J<pt.length;J+=1){var dt=pt[J],_t=dt.geometry,xt=dt.index,Pt=dt.sourceLayerIndex;if(this.hasPattern){var qt=vh("fill",this.layers,dt,this.zoom,e);this.patternFeatures.push(qt)}else this.addFeature(dt,_t,xt,r,{});e.featureIndex.insert(t[xt].feature,_t,xt,Pt,this.index)}},xa.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},xa.prototype.addFeatures=function(t,e,r){for(var s=0,l=this.patternFeatures;s<l.length;s+=1){var p=l[s];this.addFeature(p,p.geometry,p.index,e,r)}},xa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xa.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dh),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},xa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},xa.prototype.addFeature=function(t,e,r,s,l){for(var p=0,d=yh(e,500);p<d.length;p+=1){for(var v=d[p],x=0,S=0,I=v;S<I.length;S+=1)x+=I[S].length;for(var E=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),k=E.vertexLength,R=[],Z=[],j=0,it=v;j<it.length;j+=1){var J=it[j];if(J.length!==0){J!==v[0]&&Z.push(R.length/2);var pt=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),dt=pt.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(dt+J.length-1,dt),R.push(J[0].x),R.push(J[0].y);for(var _t=1;_t<J.length;_t++)this.layoutVertexArray.emplaceBack(J[_t].x,J[_t].y),this.indexArray2.emplaceBack(dt+_t-1,dt+_t),R.push(J[_t].x),R.push(J[_t].y);pt.vertexLength+=J.length,pt.primitiveLength+=J.length}}for(var xt=cr(R,Z),Pt=0;Pt<xt.length;Pt+=3)this.indexArray.emplaceBack(k+xt[Pt],k+xt[Pt+1],k+xt[Pt+2]);E.vertexLength+=x,E.primitiveLength+=xt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,l,s)},mt("FillBucket",xa,{omit:["layers","patternFeatures"]});var Qh=new $i({"fill-sort-key":new ye(V.layout_fill["fill-sort-key"])}),No={paint:new $i({"fill-antialias":new Kt(V.paint_fill["fill-antialias"]),"fill-opacity":new ye(V.paint_fill["fill-opacity"]),"fill-color":new ye(V.paint_fill["fill-color"]),"fill-outline-color":new ye(V.paint_fill["fill-outline-color"]),"fill-translate":new Kt(V.paint_fill["fill-translate"]),"fill-translate-anchor":new Kt(V.paint_fill["fill-translate-anchor"]),"fill-pattern":new vi(V.paint_fill["fill-pattern"])}),layout:Qh},hs=function(t){function e(r){t.call(this,r,No)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(r,s){t.prototype.recalculate.call(this,r,s);var l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(r){return new xa(r)},e.prototype.queryRadius=function(){return ea(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(r,s,l,p,d,v,x){return bo(Uo(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,x),p)},e.prototype.isTileClipped=function(){return!0},e}(Bo),hf=yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,tp=Fs;function Fs(t,e,r,s,l){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=l,t.readFields(El,this,e)}function El(t,e,r){t==1?e.id=r.readVarint():t==2?function(s,l){for(var p=s.readVarint()+s.pos;s.pos<p;){var d=l._keys[s.readVarint()],v=l._values[s.readVarint()];l.properties[d]=v}}(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function ep(t){for(var e,r,s=0,l=0,p=t.length,d=p-1;l<p;d=l++)s+=((r=t[d]).x-(e=t[l]).x)*(e.y+r.y);return s}Fs.types=["Unknown","Point","LineString","Polygon"],Fs.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,s=1,l=0,p=0,d=0,v=[];t.pos<r;){if(l<=0){var x=t.readVarint();s=7&x,l=x>>3}if(l--,s===1||s===2)p+=t.readSVarint(),d+=t.readSVarint(),s===1&&(e&&v.push(e),e=[]),e.push(new Te(p,d));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},Fs.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,s=0,l=0,p=0,d=1/0,v=-1/0,x=1/0,S=-1/0;t.pos<e;){if(s<=0){var I=t.readVarint();r=7&I,s=I>>3}if(s--,r===1||r===2)(l+=t.readSVarint())<d&&(d=l),l>v&&(v=l),(p+=t.readSVarint())<x&&(x=p),p>S&&(S=p);else if(r!==7)throw new Error("unknown command "+r)}return[d,x,v,S]},Fs.prototype.toGeoJSON=function(t,e,r){var s,l,p=this.extent*Math.pow(2,r),d=this.extent*t,v=this.extent*e,x=this.loadGeometry(),S=Fs.types[this.type];function I(R){for(var Z=0;Z<R.length;Z++){var j=R[Z];R[Z]=[360*(j.x+d)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var E=[];for(s=0;s<x.length;s++)E[s]=x[s][0];I(x=E);break;case 2:for(s=0;s<x.length;s++)I(x[s]);break;case 3:for(x=function(R){var Z=R.length;if(Z<=1)return[R];for(var j,it,J=[],pt=0;pt<Z;pt++){var dt=ep(R[pt]);dt!==0&&(it===void 0&&(it=dt<0),it===dt<0?(j&&J.push(j),j=[R[pt]]):j.push(R[pt]))}return j&&J.push(j),J}(x),s=0;s<x.length;s++)for(l=0;l<x[s].length;l++)I(x[s][l])}x.length===1?x=x[0]:S="Multi"+S;var k={type:"Feature",geometry:{type:S,coordinates:x},properties:this.properties};return"id"in this&&(k.id=this.id),k};var _h=rp;function rp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(np,this,e),this.length=this._features.length}function np(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(function(s){for(var l=null,p=s.readVarint()+s.pos;s.pos<p;){var d=s.readVarint()>>3;l=d===1?s.readString():d===2?s.readFloat():d===3?s.readDouble():d===4?s.readVarint64():d===5?s.readVarint():d===6?s.readSVarint():d===7?s.readBoolean():null}return l}(r))}function Al(t,e,r){if(t===3){var s=new _h(r,r.readVarint()+r.pos);s.length&&(e[s.name]=s)}}rp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new tp(this._pbf,e,this.extent,this._keys,this._values)};var ps={VectorTile:function(t,e){this.layers=t.readFields(Al,{},e)},VectorTileFeature:tp,VectorTileLayer:_h},pf=ps.VectorTileFeature.types,Nc=Math.pow(2,13);function Pl(t,e,r,s,l,p,d,v){t.emplaceBack(e,r,2*Math.floor(s*Nc)+d,l*Nc*2,p*Nc*2,Math.round(v))}var Vo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new xi,this.indexArray=new _o,this.programConfigurations=new Er(t.layers,t.zoom),this.segments=new O,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function ip(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}Vo.prototype.populate=function(t,e,r){this.features=[],this.hasPattern=Uc("fill-extrusion",this.layers,e);for(var s=0,l=t;s<l.length;s+=1){var p=l[s],d=p.feature,v=p.id,x=p.index,S=p.sourceLayerIndex,I=this.layers[0]._featureFilter.needGeometry,E=oi(d,I);if(this.layers[0]._featureFilter.filter(new Ee(this.zoom),E,r)){var k={id:v,sourceLayerIndex:S,index:x,geometry:I?E.geometry:Vr(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(vh("fill-extrusion",this.layers,k,this.zoom,e)):this.addFeature(k,k.geometry,x,r,{}),e.featureIndex.insert(d,k.geometry,x,S,this.index,!0)}}},Vo.prototype.addFeatures=function(t,e,r){for(var s=0,l=this.features;s<l.length;s+=1){var p=l[s];this.addFeature(p,p.geometry,p.index,e,r)}},Vo.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Vo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Vo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Vo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Vo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Vo.prototype.addFeature=function(t,e,r,s,l){for(var p=0,d=yh(e,500);p<d.length;p+=1){for(var v=d[p],x=0,S=0,I=v;S<I.length;S+=1)x+=I[S].length;for(var E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),k=0,R=v;k<R.length;k+=1){var Z=R[k];if(Z.length!==0&&!((Ge=Z).every(function(Be){return Be.x<0})||Ge.every(function(Be){return Be.x>8192})||Ge.every(function(Be){return Be.y<0})||Ge.every(function(Be){return Be.y>8192})))for(var j=0,it=0;it<Z.length;it++){var J=Z[it];if(it>=1){var pt=Z[it-1];if(!ip(J,pt)){E.vertexLength+4>O.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var dt=J.sub(pt)._perp()._unit(),_t=pt.dist(J);j+_t>32768&&(j=0),Pl(this.layoutVertexArray,J.x,J.y,dt.x,dt.y,0,0,j),Pl(this.layoutVertexArray,J.x,J.y,dt.x,dt.y,0,1,j),Pl(this.layoutVertexArray,pt.x,pt.y,dt.x,dt.y,0,0,j+=_t),Pl(this.layoutVertexArray,pt.x,pt.y,dt.x,dt.y,0,1,j);var xt=E.vertexLength;this.indexArray.emplaceBack(xt,xt+2,xt+1),this.indexArray.emplaceBack(xt+1,xt+2,xt+3),E.vertexLength+=4,E.primitiveLength+=2}}}}if(E.vertexLength+x>O.MAX_VERTEX_ARRAY_LENGTH&&(E=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray)),pf[t.type]==="Polygon"){for(var Pt=[],qt=[],Yt=E.vertexLength,se=0,$t=v;se<$t.length;se+=1){var fe=$t[se];if(fe.length!==0){fe!==v[0]&&qt.push(Pt.length/2);for(var Qt=0;Qt<fe.length;Qt++){var Ue=fe[Qt];Pl(this.layoutVertexArray,Ue.x,Ue.y,0,0,1,1,0),Pt.push(Ue.x),Pt.push(Ue.y)}}}for(var be=cr(Pt,qt),ue=0;ue<be.length;ue+=3)this.indexArray.emplaceBack(Yt+be[ue],Yt+be[ue+2],Yt+be[ue+1]);E.primitiveLength+=be.length/3,E.vertexLength+=x}}var Ge;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,l,s)},mt("FillExtrusionBucket",Vo,{omit:["layers","features"]});var Vc={paint:new $i({"fill-extrusion-opacity":new Kt(V["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ye(V["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kt(V["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kt(V["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vi(V["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ye(V["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ye(V["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Kt(V["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},xh=function(t){function e(r){t.call(this,r,Vc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(r){return new Vo(r)},e.prototype.queryRadius=function(){return ea(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(r,s,l,p,d,v,x,S){var I=Uo(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,x),E=this.paint.get("fill-extrusion-height").evaluate(s,l),k=this.paint.get("fill-extrusion-base").evaluate(s,l),R=function(j,it,J,pt){for(var dt=[],_t=0,xt=j;_t<xt.length;_t+=1){var Pt=xt[_t],qt=[Pt.x,Pt.y,0,1];Gu(qt,qt,it),dt.push(new Te(qt[0]/qt[3],qt[1]/qt[3]))}return dt}(I,S),Z=function(j,it,J,pt){for(var dt=[],_t=[],xt=pt[8]*it,Pt=pt[9]*it,qt=pt[10]*it,Yt=pt[11]*it,se=pt[8]*J,$t=pt[9]*J,fe=pt[10]*J,Qt=pt[11]*J,Ue=0,be=j;Ue<be.length;Ue+=1){for(var ue=[],Ge=[],Be=0,sr=be[Ue];Be<sr.length;Be+=1){var me=sr[Be],gr=me.x,Nr=me.y,Kr=pt[0]*gr+pt[4]*Nr+pt[12],rn=pt[1]*gr+pt[5]*Nr+pt[13],Yr=pt[2]*gr+pt[6]*Nr+pt[14],tn=pt[3]*gr+pt[7]*Nr+pt[15],Dn=Yr+qt,qn=tn+Yt,Li=Kr+se,Kn=rn+$t,Di=Yr+fe,xn=tn+Qt,Yn=new Te((Kr+xt)/qn,(rn+Pt)/qn);Yn.z=Dn/qn,ue.push(Yn);var $e=new Te(Li/xn,Kn/xn);$e.z=Di/xn,Ge.push($e)}dt.push(ue),_t.push(Ge)}return[dt,_t]}(p,k,E,S);return function(j,it,J){var pt=1/0;bo(J,it)&&(pt=op(J,it[0]));for(var dt=0;dt<it.length;dt++)for(var _t=it[dt],xt=j[dt],Pt=0;Pt<_t.length-1;Pt++){var qt=_t[Pt],Yt=[qt,_t[Pt+1],xt[Pt+1],xt[Pt],qt];zi(J,Yt)&&(pt=Math.min(pt,op(J,Yt)))}return pt!==1/0&&pt}(Z[0],Z[1],R)},e}(Bo);function _u(t,e){return t.x*e.x+t.y*e.y}function op(t,e){if(t.length===1){for(var r,s=0,l=e[s++];!r||l.equals(r);)if(!(r=e[s++]))return 1/0;for(;s<e.length;s++){var p=e[s],d=t[0],v=r.sub(l),x=p.sub(l),S=d.sub(l),I=_u(v,v),E=_u(v,x),k=_u(x,x),R=_u(S,v),Z=_u(S,x),j=I*k-E*E,it=(k*R-E*Z)/j,J=(I*Z-E*R)/j,pt=l.z*(1-it-J)+r.z*it+p.z*J;if(isFinite(pt))return pt}return 1/0}for(var dt=1/0,_t=0,xt=e;_t<xt.length;_t+=1)dt=Math.min(dt,xt[_t].z);return dt}var ap=yn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,qc=yn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,sp=ps.VectorTileFeature.types,bh=Math.cos(Math.PI/180*37.5),up=Math.pow(2,14)/.5,ki=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){e.gradients[r.id]={}}),this.layoutVertexArray=new Ni,this.layoutVertexArray2=new er,this.indexArray=new _o,this.programConfigurations=new Er(t.layers,t.zoom),this.segments=new O,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};ki.prototype.populate=function(t,e,r){this.hasPattern=Uc("line",this.layers,e);for(var s=this.layers[0].layout.get("line-sort-key"),l=!s.isConstant(),p=[],d=0,v=t;d<v.length;d+=1){var x=v[d],S=x.feature,I=x.id,E=x.index,k=x.sourceLayerIndex,R=this.layers[0]._featureFilter.needGeometry,Z=oi(S,R);if(this.layers[0]._featureFilter.filter(new Ee(this.zoom),Z,r)){var j=l?s.evaluate(Z,{},r):void 0,it={id:I,properties:S.properties,type:S.type,sourceLayerIndex:k,index:E,geometry:R?Z.geometry:Vr(S),patterns:{},sortKey:j};p.push(it)}}l&&p.sort(function(Yt,se){return Yt.sortKey-se.sortKey});for(var J=0,pt=p;J<pt.length;J+=1){var dt=pt[J],_t=dt.geometry,xt=dt.index,Pt=dt.sourceLayerIndex;if(this.hasPattern){var qt=vh("line",this.layers,dt,this.zoom,e);this.patternFeatures.push(qt)}else this.addFeature(dt,_t,xt,r,{});e.featureIndex.insert(t[xt].feature,_t,xt,Pt,this.index)}},ki.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},ki.prototype.addFeatures=function(t,e,r){for(var s=0,l=this.patternFeatures;s<l.length;s+=1){var p=l[s];this.addFeature(p,p.geometry,p.index,e,r)}},ki.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ki.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ki.prototype.upload=function(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,qc)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ap),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ki.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ki.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},ki.prototype.addFeature=function(t,e,r,s,l){var p=this.layers[0].layout,d=p.get("line-join").evaluate(t,{}),v=p.get("line-cap"),x=p.get("line-miter-limit"),S=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var I=0,E=e;I<E.length;I+=1)this.addLine(E[I],t,d,v,x,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,l,s)},ki.prototype.addLine=function(t,e,r,s,l,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var d=0;d<t.length-1;d++)this.totalDistance+=t[d].dist(t[d+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var v=sp[e.type]==="Polygon",x=t.length;x>=2&&t[x-1].equals(t[x-2]);)x--;for(var S=0;S<x-1&&t[S].equals(t[S+1]);)S++;if(!(x<(v?3:2))){r==="bevel"&&(l=1.05);var I,E=this.overscaling<=16?122880/(512*this.overscaling):0,k=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray),R=void 0,Z=void 0,j=void 0,it=void 0;this.e1=this.e2=-1,v&&(it=t[S].sub(I=t[x-2])._unit()._perp());for(var J=S;J<x;J++)if(!(Z=J===x-1?v?t[S+1]:void 0:t[J+1])||!t[J].equals(Z)){it&&(j=it),I&&(R=I),I=t[J],it=Z?Z.sub(I)._unit()._perp():j;var pt=(j=j||it).add(it);pt.x===0&&pt.y===0||pt._unit();var dt=j.x*it.x+j.y*it.y,_t=pt.x*it.x+pt.y*it.y,xt=_t!==0?1/_t:1/0,Pt=2*Math.sqrt(2-2*_t),qt=_t<bh&&R&&Z,Yt=j.x*it.y-j.y*it.x>0;if(qt&&J>S){var se=I.dist(R);if(se>2*E){var $t=I.sub(I.sub(R)._mult(E/se)._round());this.updateDistance(R,$t),this.addCurrentVertex($t,j,0,0,k),R=$t}}var fe=R&&Z,Qt=fe?r:v?"butt":s;if(fe&&Qt==="round"&&(xt<p?Qt="miter":xt<=2&&(Qt="fakeround")),Qt==="miter"&&xt>l&&(Qt="bevel"),Qt==="bevel"&&(xt>2&&(Qt="flipbevel"),xt<l&&(Qt="miter")),R&&this.updateDistance(R,I),Qt==="miter")pt._mult(xt),this.addCurrentVertex(I,pt,0,0,k);else if(Qt==="flipbevel"){if(xt>100)pt=it.mult(-1);else{var Ue=xt*j.add(it).mag()/j.sub(it).mag();pt._perp()._mult(Ue*(Yt?-1:1))}this.addCurrentVertex(I,pt,0,0,k),this.addCurrentVertex(I,pt.mult(-1),0,0,k)}else if(Qt==="bevel"||Qt==="fakeround"){var be=-Math.sqrt(xt*xt-1),ue=Yt?be:0,Ge=Yt?0:be;if(R&&this.addCurrentVertex(I,j,ue,Ge,k),Qt==="fakeround")for(var Be=Math.round(180*Pt/Math.PI/20),sr=1;sr<Be;sr++){var me=sr/Be;if(me!==.5){var gr=me-.5;me+=me*gr*(me-1)*((1.0904+dt*(dt*(3.55645-1.43519*dt)-3.2452))*gr*gr+(.848013+dt*(.215638*dt-1.06021)))}var Nr=it.sub(j)._mult(me)._add(j)._unit()._mult(Yt?-1:1);this.addHalfVertex(I,Nr.x,Nr.y,!1,Yt,0,k)}Z&&this.addCurrentVertex(I,it,-ue,-Ge,k)}else if(Qt==="butt")this.addCurrentVertex(I,pt,0,0,k);else if(Qt==="square"){var Kr=R?1:-1;this.addCurrentVertex(I,pt,Kr,Kr,k)}else Qt==="round"&&(R&&(this.addCurrentVertex(I,j,0,0,k),this.addCurrentVertex(I,j,1,1,k,!0)),Z&&(this.addCurrentVertex(I,it,-1,-1,k,!0),this.addCurrentVertex(I,it,0,0,k)));if(qt&&J<x-1){var rn=I.dist(Z);if(rn>2*E){var Yr=I.add(Z.sub(I)._mult(E/rn)._round());this.updateDistance(I,Yr),this.addCurrentVertex(Yr,it,0,0,k),I=Yr}}}}},ki.prototype.addCurrentVertex=function(t,e,r,s,l,p){p===void 0&&(p=!1);var d=e.y*s-e.x,v=-e.y-e.x*s;this.addHalfVertex(t,e.x+e.y*r,e.y-e.x*r,p,!1,r,l),this.addHalfVertex(t,d,v,p,!0,-s,l),this.distance>up/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,e,r,s,l,p))},ki.prototype.addHalfVertex=function(t,e,r,s,l,p,d){var v=.5*(this.lineClips?this.scaledDistance*(up-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(s?1:0),(t.y<<1)+(l?1:0),Math.round(63*e)+128,Math.round(63*r)+128,1+(p===0?0:p<0?-1:1)|(63&v)<<2,v>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var x=d.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),d.primitiveLength++),l?this.e2=x:this.e1=x},ki.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ki.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},mt("LineBucket",ki,{omit:["layers","patternFeatures"]});var Us=new $i({"line-cap":new Kt(V.layout_line["line-cap"]),"line-join":new ye(V.layout_line["line-join"]),"line-miter-limit":new Kt(V.layout_line["line-miter-limit"]),"line-round-limit":new Kt(V.layout_line["line-round-limit"]),"line-sort-key":new ye(V.layout_line["line-sort-key"])}),wh={paint:new $i({"line-opacity":new ye(V.paint_line["line-opacity"]),"line-color":new ye(V.paint_line["line-color"]),"line-translate":new Kt(V.paint_line["line-translate"]),"line-translate-anchor":new Kt(V.paint_line["line-translate-anchor"]),"line-width":new ye(V.paint_line["line-width"]),"line-gap-width":new ye(V.paint_line["line-gap-width"]),"line-offset":new ye(V.paint_line["line-offset"]),"line-blur":new ye(V.paint_line["line-blur"]),"line-dasharray":new _i(V.paint_line["line-dasharray"]),"line-pattern":new vi(V.paint_line["line-pattern"]),"line-gradient":new Va(V.paint_line["line-gradient"])}),layout:Us},Sh=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(r,s){return s=new Ee(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),t.prototype.possiblyEvaluate.call(this,r,s)},e.prototype.evaluate=function(r,s,l,p){return s=Zt({},s,{zoom:Math.floor(s.zoom)}),t.prototype.evaluate.call(this,r,s,l,p)},e}(ye))(wh.paint.properties["line-width"].specification);Sh.useIntegerZoom=!0;var ff=function(t){function e(r){t.call(this,r,wh),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ki,this.gradientVersion=(this.gradientVersion+1)%je)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(r,s){t.prototype.recalculate.call(this,r,s),this.paint._values["line-floorwidth"]=Sh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},e.prototype.createBucket=function(r){return new ki(r)},e.prototype.queryRadius=function(r){var s=r,l=Th(kn("line-width",this,s),kn("line-gap-width",this,s)),p=kn("line-offset",this,s);return l/2+Math.abs(p)+ea(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(r,s,l,p,d,v,x){var S=Uo(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,x),I=x/2*Th(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),E=this.paint.get("line-offset").evaluate(s,l);return E&&(p=function(k,R){for(var Z=[],j=new Te(0,0),it=0;it<k.length;it++){for(var J=k[it],pt=[],dt=0;dt<J.length;dt++){var _t=J[dt],xt=J[dt+1],Pt=dt===0?j:_t.sub(J[dt-1])._unit()._perp(),qt=dt===J.length-1?j:xt.sub(_t)._unit()._perp(),Yt=Pt._add(qt)._unit();Yt._mult(1/(Yt.x*qt.x+Yt.y*qt.y)),pt.push(Yt._mult(R)._add(_t))}Z.push(pt)}return Z}(p,E*x)),function(k,R,Z){for(var j=0;j<R.length;j++){var it=R[j];if(k.length>=3){for(var J=0;J<it.length;J++)if(to(k,it[J]))return!0}if(Zu(k,it,Z))return!0}return!1}(S,p,I)},e.prototype.isTileClipped=function(){return!0},e}(Bo);function Th(t,e){return e>0?e+2*t:t}var df=yn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mf=yn([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ns=(yn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),yn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Zc=(yn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ih=yn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Eh(t,e,r){return t.sections.forEach(function(s){s.text=function(l,p,d){var v=p.layout.get("text-transform").evaluate(d,{});return v==="uppercase"?l=l.toLocaleUpperCase():v==="lowercase"&&(l=l.toLocaleLowerCase()),he.applyArabicShaping&&(l=he.applyArabicShaping(l)),l}(s.text,e,r)}),t}yn([{name:"triangle",components:3,type:"Uint16"}]),yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yn([{type:"Float32",name:"offsetX"}]),yn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var xu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Yu=function(t,e,r,s,l){var p,d,v=8*l-s-1,x=(1<<v)-1,S=x>>1,I=-7,E=r?l-1:0,k=r?-1:1,R=t[e+E];for(E+=k,p=R&(1<<-I)-1,R>>=-I,I+=v;I>0;p=256*p+t[e+E],E+=k,I-=8);for(d=p&(1<<-I)-1,p>>=-I,I+=s;I>0;d=256*d+t[e+E],E+=k,I-=8);if(p===0)p=1-S;else{if(p===x)return d?NaN:1/0*(R?-1:1);d+=Math.pow(2,s),p-=S}return(R?-1:1)*d*Math.pow(2,p-s)},Fe=function(t,e,r,s,l,p){var d,v,x,S=8*p-l-1,I=(1<<S)-1,E=I>>1,k=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=s?0:p-1,Z=s?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,d=I):(d=Math.floor(Math.log(e)/Math.LN2),e*(x=Math.pow(2,-d))<1&&(d--,x*=2),(e+=d+E>=1?k/x:k*Math.pow(2,1-E))*x>=2&&(d++,x/=2),d+E>=I?(v=0,d=I):d+E>=1?(v=(e*x-1)*Math.pow(2,l),d+=E):(v=e*Math.pow(2,E-1)*Math.pow(2,l),d=0));l>=8;t[r+R]=255&v,R+=Z,v/=256,l-=8);for(d=d<<l|v,S+=l;S>0;t[r+R]=255&d,R+=Z,d/=256,S-=8);t[r+R-Z]|=128*j},Ju=Rr;function Rr(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Rr.Varint=0,Rr.Fixed64=1,Rr.Bytes=2,Rr.Fixed32=5;var bu=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Vs(t){return t.type===Rr.Bytes?t.readVarint()+t.pos:t.pos+1}function wu(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Ah(t,e,r){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(s);for(var l=r.pos-1;l>=t;l--)r.buf[l+s]=r.buf[l]}function eo(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function gf(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function yf(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function lp(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function vf(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function cp(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function _f(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function xf(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function bf(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ba(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function si(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function jc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function wf(t,e,r){t===1&&r.readMessage(Ph,e)}function Ph(t,e,r){if(t===3){var s=r.readMessage(Sf,{}),l=s.width,p=s.height,d=s.left,v=s.top,x=s.advance;e.push({id:s.id,bitmap:new Hu({width:l+6,height:p+6},s.bitmap),metrics:{width:l,height:p,left:d,top:v,advance:x}})}}function Sf(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}function hp(t){for(var e=0,r=0,s=0,l=t;s<l.length;s+=1){var p=l[s];e+=p.w*p.h,r=Math.max(r,p.w)}t.sort(function(j,it){return it.h-j.h});for(var d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],v=0,x=0,S=0,I=t;S<I.length;S+=1)for(var E=I[S],k=d.length-1;k>=0;k--){var R=d[k];if(!(E.w>R.w||E.h>R.h)){if(E.x=R.x,E.y=R.y,x=Math.max(x,E.y+E.h),v=Math.max(v,E.x+E.w),E.w===R.w&&E.h===R.h){var Z=d.pop();k<d.length&&(d[k]=Z)}else E.h===R.h?(R.x+=E.w,R.w-=E.w):E.w===R.w?(R.y+=E.h,R.h-=E.h):(d.push({x:R.x+E.w,y:R.y,w:R.w-E.w,h:E.h}),R.y+=E.h,R.h-=E.h);break}}return{w:v,h:x,fill:e/(v*x)||0}}Rr.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),l=s>>3,p=this.pos;this.type=7&s,t(l,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ba(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=jc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ba(this.buf,this.pos)+4294967296*ba(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=ba(this.buf,this.pos)+4294967296*jc(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Yu(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Yu(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,s=this.buf;return e=127&(r=s[this.pos++]),r<128?e:(e|=(127&(r=s[this.pos++]))<<7,r<128?e:(e|=(127&(r=s[this.pos++]))<<14,r<128?e:(e|=(127&(r=s[this.pos++]))<<21,r<128?e:function(l,p,d){var v,x,S=d.buf;if(v=(112&(x=S[d.pos++]))>>4,x<128||(v|=(127&(x=S[d.pos++]))<<3,x<128)||(v|=(127&(x=S[d.pos++]))<<10,x<128)||(v|=(127&(x=S[d.pos++]))<<17,x<128)||(v|=(127&(x=S[d.pos++]))<<24,x<128)||(v|=(1&(x=S[d.pos++]))<<31,x<128))return wu(l,v,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&bu?function(r,s,l){return bu.decode(r.subarray(s,l))}(this.buf,e,t):function(r,s,l){for(var p="",d=s;d<l;){var v,x,S,I=r[d],E=null,k=I>239?4:I>223?3:I>191?2:1;if(d+k>l)break;k===1?I<128&&(E=I):k===2?(192&(v=r[d+1]))==128&&(E=(31&I)<<6|63&v)<=127&&(E=null):k===3?(x=r[d+2],(192&(v=r[d+1]))==128&&(192&x)==128&&((E=(15&I)<<12|(63&v)<<6|63&x)<=2047||E>=55296&&E<=57343)&&(E=null)):k===4&&(x=r[d+2],S=r[d+3],(192&(v=r[d+1]))==128&&(192&x)==128&&(192&S)==128&&((E=(15&I)<<18|(63&v)<<12|(63&x)<<6|63&S)<=65535||E>=1114112)&&(E=null)),E===null?(E=65533,k=1):E>65535&&(E-=65536,p+=String.fromCharCode(E>>>10&1023|55296),E=56320|1023&E),p+=String.fromCharCode(E),d+=k}return p}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Rr.Bytes)return t.push(this.readVarint(e));var r=Vs(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Rr.Bytes)return t.push(this.readSVarint());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Rr.Bytes)return t.push(this.readBoolean());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Rr.Bytes)return t.push(this.readFloat());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Rr.Bytes)return t.push(this.readDouble());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Rr.Bytes)return t.push(this.readFixed32());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Rr.Bytes)return t.push(this.readSFixed32());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Rr.Bytes)return t.push(this.readFixed64());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Rr.Bytes)return t.push(this.readSFixed64());var e=Vs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Rr.Varint)for(;this.buf[this.pos++]>127;);else if(e===Rr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Rr.Fixed32)this.pos+=4;else{if(e!==Rr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),si(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),si(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),si(this.buf,-1&t,this.pos),si(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),si(this.buf,-1&t,this.pos),si(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,r){var s,l;if(e>=0?(s=e%4294967296|0,l=e/4294967296|0):(l=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,l=l+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(p,d,v){v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7)}(s,0,r),function(p,d){var v=(7&p)<<4;d.buf[d.pos++]|=v|((p>>>=3)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p)))))}(l,r)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,l,p){for(var d,v,x=0;x<l.length;x++){if((d=l.charCodeAt(x))>55295&&d<57344){if(!v){d>56319||x+1===l.length?(s[p++]=239,s[p++]=191,s[p++]=189):v=d;continue}if(d<56320){s[p++]=239,s[p++]=191,s[p++]=189,v=d;continue}d=v-55296<<10|d-56320|65536,v=null}else v&&(s[p++]=239,s[p++]=191,s[p++]=189,v=null);d<128?s[p++]=d:(d<2048?s[p++]=d>>6|192:(d<65536?s[p++]=d>>12|224:(s[p++]=d>>18|240,s[p++]=d>>12&63|128),s[p++]=d>>6&63|128),s[p++]=63&d|128)}return p}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&Ah(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Fe(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Fe(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var s=this.pos-r;s>=128&&Ah(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,r){this.writeTag(t,Rr.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,eo,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,gf,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,vf,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,yf,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,lp,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,cp,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,_f,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,xf,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,bf,e)},writeBytesField:function(t,e){this.writeTag(t,Rr.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Rr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Rr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Rr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Rr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Rr.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Rr.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Rr.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Rr.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Rr.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Su=function(t,e){var r=e.pixelRatio,s=e.version,l=e.stretchX,p=e.stretchY,d=e.content;this.paddedRect=t,this.pixelRatio=r,this.stretchX=l,this.stretchY=p,this.content=d,this.version=s},Cl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Cl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Cl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Cl.tlbr.get=function(){return this.tl.concat(this.br)},Cl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Su.prototype,Cl);var zl=function(t,e){var r={},s={};this.haveRenderCallbacks=[];var l=[];this.addImages(t,r,l),this.addImages(e,s,l);var p=hp(l),d=new Vi({width:p.w||1,height:p.h||1});for(var v in t){var x=t[v],S=r[v].paddedRect;Vi.copy(x.data,d,{x:0,y:0},{x:S.x+1,y:S.y+1},x.data)}for(var I in e){var E=e[I],k=s[I].paddedRect,R=k.x+1,Z=k.y+1,j=E.data.width,it=E.data.height;Vi.copy(E.data,d,{x:0,y:0},{x:R,y:Z},E.data),Vi.copy(E.data,d,{x:0,y:it-1},{x:R,y:Z-1},{width:j,height:1}),Vi.copy(E.data,d,{x:0,y:0},{x:R,y:Z+it},{width:j,height:1}),Vi.copy(E.data,d,{x:j-1,y:0},{x:R-1,y:Z},{width:1,height:it}),Vi.copy(E.data,d,{x:0,y:0},{x:R+j,y:Z},{width:1,height:it})}this.image=d,this.iconPositions=r,this.patternPositions=s};zl.prototype.addImages=function(t,e,r){for(var s in t){var l=t[s],p={x:0,y:0,w:l.data.width+2,h:l.data.height+2};r.push(p),e[s]=new Su(p,l),l.hasRenderCallback&&this.haveRenderCallbacks.push(s)}},zl.prototype.patchUpdatedImages=function(t,e){for(var r in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e)},zl.prototype.patchUpdatedImage=function(t,e,r){if(t&&e&&t.version!==e.version){t.version=e.version;var s=t.tl;r.update(e.data,void 0,{x:s[0],y:s[1]})}},mt("ImagePosition",Su),mt("ImageAtlas",zl);var qo={horizontal:1,vertical:2,horizontalOnly:3},kl=function(){this.scale=1,this.fontStack="",this.imageName=null};kl.forText=function(t,e){var r=new kl;return r.scale=t||1,r.fontStack=e,r},kl.forImage=function(t){var e=new kl;return e.imageName=t,e};var Mi=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Gc(t,e,r,s,l,p,d,v,x,S,I,E,k,R,Z,j){var it,J=Mi.fromFeature(t,l);E===qo.vertical&&J.verticalizePunctuation();var pt=he.processBidirectionalText,dt=he.processStyledBidirectionalText;if(pt&&J.sections.length===1){it=[];for(var _t=0,xt=pt(J.toString(),hc(J,S,p,e,s,R,Z));_t<xt.length;_t+=1){var Pt=xt[_t],qt=new Mi;qt.text=Pt,qt.sections=J.sections;for(var Yt=0;Yt<Pt.length;Yt++)qt.sectionIndex.push(0);it.push(qt)}}else if(dt){it=[];for(var se=0,$t=dt(J.text,J.sectionIndex,hc(J,S,p,e,s,R,Z));se<$t.length;se+=1){var fe=$t[se],Qt=new Mi;Qt.text=fe[0],Qt.sectionIndex=fe[1],Qt.sections=J.sections,it.push(Qt)}}else it=function(ue,Ge){for(var Be=[],sr=ue.text,me=0,gr=0,Nr=Ge;gr<Nr.length;gr+=1){var Kr=Nr[gr];Be.push(ue.substring(me,Kr)),me=Kr}return me<sr.length&&Be.push(ue.substring(me,sr.length)),Be}(J,hc(J,S,p,e,s,R,Z));var Ue=[],be={positionedLines:Ue,text:J.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:E,iconsInText:!1,verticalizable:!1};return function(ue,Ge,Be,sr,me,gr,Nr,Kr,rn,Yr,tn,Dn){for(var qn=0,Li=-17,Kn=0,Di=0,xn=Kr==="right"?1:Kr==="left"?0:.5,Yn=0,$e=0,Br=me;$e<Br.length;$e+=1){var Ar=Br[$e];Ar.trim();var hr=Ar.getMaxScale(),qi=24*(hr-1),wi={positionedGlyphs:[],lineOffset:0};ue.positionedLines[Yn]=wi;var fr=wi.positionedGlyphs,In=0;if(Ar.length()){for(var Si=0;Si<Ar.length();Si++){var Qe=Ar.getSection(Si),Ne=Ar.getSectionIndex(Si),Zo=Ar.getCharCode(Si),Rn=0,tr=null,ds=null,Ti=null,Ol=24,ol=!(rn===qo.horizontal||!tn&&!Qr(Zo)||tn&&(cc[Zo]||(qr=Zo,Dt.Arabic(qr)||Dt["Arabic Supplement"](qr)||Dt["Arabic Extended-A"](qr)||Dt["Arabic Presentation Forms-A"](qr)||Dt["Arabic Presentation Forms-B"](qr))));if(Qe.imageName){var Fl=sr[Qe.imageName];if(!Fl)continue;Ti=Qe.imageName,ue.iconsInText=ue.iconsInText||!0,ds=Fl.paddedRect;var Zs=Fl.displaySize;Qe.scale=24*Qe.scale/Dn,Rn=qi+(24-Zs[1]*Qe.scale),Ol=(tr={width:Zs[0],height:Zs[1],left:1,top:-3,advance:ol?Zs[1]:Zs[0]}).advance;var Ul=ol?Zs[0]*Qe.scale-24*hr:Zs[1]*Qe.scale-24*hr;Ul>0&&Ul>In&&(In=Ul)}else{var Nl=Be[Qe.fontStack],Vl=Nl&&Nl[Zo];if(Vl&&Vl.rect)ds=Vl.rect,tr=Vl.metrics;else{var ra=Ge[Qe.fontStack],vc=ra&&ra[Zo];if(!vc)continue;tr=vc.metrics}Rn=24*(hr-Qe.scale)}ol?(ue.verticalizable=!0,fr.push({glyph:Zo,imageName:Ti,x:qn,y:Li+Rn,vertical:ol,scale:Qe.scale,fontStack:Qe.fontStack,sectionIndex:Ne,metrics:tr,rect:ds}),qn+=Ol*Qe.scale+Yr):(fr.push({glyph:Zo,imageName:Ti,x:qn,y:Li+Rn,vertical:ol,scale:Qe.scale,fontStack:Qe.fontStack,sectionIndex:Ne,metrics:tr,rect:ds}),qn+=tr.advance*Qe.scale+Yr)}fr.length!==0&&(Kn=Math.max(qn-Yr,Kn),dp(fr,0,fr.length-1,xn,In)),qn=0;var al=gr*hr+In;wi.lineOffset=Math.max(In,qi),Li+=al,Di=Math.max(al,Di),++Yn}else Li+=gr,++Yn}var qr,hn=Li- -17,sl=Xc(Nr),Eu=sl.horizontalAlign,ql=sl.verticalAlign;(function(th,eh,_c,xc,bc,js,ul,wc,Sc){var Gs,no=(eh-_c)*bc;Gs=js!==ul?-wc*xc- -17:(-xc*Sc+.5)*ul;for(var Ga=0,Tc=th;Ga<Tc.length;Ga+=1)for(var ll=0,Ic=Tc[Ga].positionedGlyphs;ll<Ic.length;ll+=1){var Zl=Ic[ll];Zl.x+=no,Zl.y+=Gs}})(ue.positionedLines,xn,Eu,ql,Kn,Di,gr,hn,me.length),ue.top+=-ql*hn,ue.bottom=ue.top+hn,ue.left+=-Eu*Kn,ue.right=ue.left+Kn}(be,e,r,s,it,d,v,x,E,S,k,j),!function(ue){for(var Ge=0,Be=ue;Ge<Be.length;Ge+=1)if(Be[Ge].positionedGlyphs.length!==0)return!1;return!0}(Ue)&&be}Mi.fromFeature=function(t,e){for(var r=new Mi,s=0;s<t.sections.length;s++){var l=t.sections[s];l.image?r.addImageSection(l):r.addTextSection(l,e)}return r},Mi.prototype.length=function(){return this.text.length},Mi.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Mi.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},Mi.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Mi.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var s=t.charCodeAt(r+1)||null,l=t.charCodeAt(r-1)||null;e+=s&&yr(s)&&!xu[t[r+1]]||l&&yr(l)&&!xu[t[r-1]]||!xu[t[r]]?t[r]:xu[t[r]]}return e}(this.text)},Mi.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&cc[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,s=this.text.length-1;s>=0&&s>=t&&cc[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},Mi.prototype.substring=function(t,e){var r=new Mi;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},Mi.prototype.toString=function(){return this.text},Mi.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,r){return Math.max(e,t.sections[r].scale)},0)},Mi.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(kl.forText(t.scale,t.fontStack||e));for(var r=this.sections.length-1,s=0;s<t.text.length;++s)this.sectionIndex.push(r)},Mi.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(e.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(kl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):Jr("Reached maximum number of images 6401")}else Jr("Can't add FormattedSection with an empty image.")},Mi.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var cc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ro={};function pp(t,e,r,s,l,p){if(e.imageName){var d=s[e.imageName];return d?d.displaySize[0]*e.scale*24/p+l:0}var v=r[e.fontStack],x=v&&v[t];return x?x.metrics.advance*e.scale+l:0}function Wc(t,e,r,s){var l=Math.pow(t-e,2);return s?t<e?l/2:2*l:l+Math.abs(r)*r}function fp(t,e,r){var s=0;return t===10&&(s-=1e4),r&&(s+=150),t!==40&&t!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function Ml(t,e,r,s,l,p){for(var d=null,v=Wc(e,r,l,p),x=0,S=s;x<S.length;x+=1){var I=S[x],E=Wc(e-I.x,r,l,p)+I.badness;E<=v&&(d=I,v=E)}return{index:t,x:e,priorBreak:d,badness:v}}function hc(t,e,r,s,l,p,d){if(p!=="point")return[];if(!t)return[];for(var v,x=[],S=function(it,J,pt,dt,_t,xt){for(var Pt=0,qt=0;qt<it.length();qt++){var Yt=it.getSection(qt);Pt+=pp(it.getCharCode(qt),Yt,dt,_t,J,xt)}return Pt/Math.max(1,Math.ceil(Pt/pt))}(t,e,r,s,l,d),I=t.text.indexOf("\u200B")>=0,E=0,k=0;k<t.length();k++){var R=t.getSection(k),Z=t.getCharCode(k);if(cc[Z]||(E+=pp(Z,R,s,l,e,d)),k<t.length()-1){var j=!((v=Z)<11904||!(Dt["Bopomofo Extended"](v)||Dt.Bopomofo(v)||Dt["CJK Compatibility Forms"](v)||Dt["CJK Compatibility Ideographs"](v)||Dt["CJK Compatibility"](v)||Dt["CJK Radicals Supplement"](v)||Dt["CJK Strokes"](v)||Dt["CJK Symbols and Punctuation"](v)||Dt["CJK Unified Ideographs Extension A"](v)||Dt["CJK Unified Ideographs"](v)||Dt["Enclosed CJK Letters and Months"](v)||Dt["Halfwidth and Fullwidth Forms"](v)||Dt.Hiragana(v)||Dt["Ideographic Description Characters"](v)||Dt["Kangxi Radicals"](v)||Dt["Katakana Phonetic Extensions"](v)||Dt.Katakana(v)||Dt["Vertical Forms"](v)||Dt["Yi Radicals"](v)||Dt["Yi Syllables"](v)));(ro[Z]||j||R.imageName)&&x.push(Ml(k+1,E,S,x,fp(Z,t.getCharCode(k+1),j&&I),!1))}}return function it(J){return J?it(J.priorBreak).concat(J.index):[]}(Ml(t.length(),E,S,x,0,!0))}function Xc(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function dp(t,e,r,s,l){if(s||l)for(var p=t[r],d=(t[r].x+p.metrics.advance*p.scale)*s,v=e;v<=r;v++)t[v].x-=d,t[v].y+=l}function pc(t,e,r,s,l,p){var d,v=t.image;if(v.content){var x=v.content,S=v.pixelRatio||1;d=[x[0]/S,x[1]/S,v.displaySize[0]-x[2]/S,v.displaySize[1]-x[3]/S]}var I,E,k,R,Z=e.left*p,j=e.right*p;r==="width"||r==="both"?(R=l[0]+Z-s[3],E=l[0]+j+s[1]):E=(R=l[0]+(Z+j-v.displaySize[0])/2)+v.displaySize[0];var it=e.top*p,J=e.bottom*p;return r==="height"||r==="both"?(I=l[1]+it-s[0],k=l[1]+J+s[2]):k=(I=l[1]+(it+J-v.displaySize[1])/2)+v.displaySize[1],{image:v,top:I,right:E,bottom:k,left:R,collisionPadding:d}}ro[10]=!0,ro[32]=!0,ro[38]=!0,ro[40]=!0,ro[41]=!0,ro[43]=!0,ro[45]=!0,ro[47]=!0,ro[173]=!0,ro[183]=!0,ro[8203]=!0,ro[8208]=!0,ro[8211]=!0,ro[8231]=!0;var $u=function(t){function e(r,s,l,p){t.call(this,r,s),this.angle=l,p!==void 0&&(this.segment=p)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(Te);function wa(t,e){var r=e.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ee(t+1))};if(r.kind==="source")return{kind:"source"};for(var s=r.zoomStops,l=r.interpolationType,p=0;p<s.length&&s[p]<=t;)p++;for(var d=p=Math.max(0,p-1);d<s.length&&s[d]<t+1;)d++;d=Math.min(s.length-1,d);var v=s[p],x=s[d];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:x,interpolationType:l}:{kind:"camera",minZoom:v,maxZoom:x,minSize:r.evaluate(new Ee(v)),maxSize:r.evaluate(new Ee(x)),interpolationType:l}}function Tu(t,e,r){var s=e.uSize,l=r.lowerSize;return t.kind==="source"?l/128:t.kind==="composite"?Wr(l/128,r.upperSize/128,e.uSizeT):s}function mp(t,e){var r=0,s=0;if(t.kind==="constant")s=t.layoutSize;else if(t.kind!=="source"){var l=t.interpolationType,p=l?Zr(Sn.interpolationFactor(l,e,t.minZoom,t.maxZoom),0,1):0;t.kind==="camera"?s=Wr(t.minSize,t.maxSize,p):r=p}return{uSizeT:r,uSize:s}}mt("Anchor",$u);var gp=Object.freeze({__proto__:null,getSizeData:wa,evaluateSizeForFeature:Tu,evaluateSizeForZoom:mp,SIZE_PACK_FACTOR:128});function yp(t,e,r,s,l){if(e.segment===void 0)return!0;for(var p=e,d=e.segment+1,v=0;v>-r/2;){if(--d<0)return!1;v-=t[d].dist(p),p=t[d]}v+=t[d].dist(t[d+1]),d++;for(var x=[],S=0;v<r/2;){var I=t[d],E=t[d+1];if(!E)return!1;var k=t[d-1].angleTo(I)-I.angleTo(E);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:v,angleDelta:k}),S+=k;v-x[0].distance>s;)S-=x.shift().angleDelta;if(S>l)return!1;d++,v+=I.dist(E)}return!0}function vp(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function _p(t,e,r){return t?.6*e*r:0}function xp(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Tf(t,e,r,s,l,p){for(var d=_p(r,l,p),v=xp(r,s)*p,x=0,S=vp(t)/2,I=0;I<t.length-1;I++){var E=t[I],k=t[I+1],R=E.dist(k);if(x+R>S){var Z=(S-x)/R,j=Wr(E.x,k.x,Z),it=Wr(E.y,k.y,Z),J=new $u(j,it,k.angleTo(E),I);return J._round(),!d||yp(t,J,v,d,e)?J:void 0}x+=R}}function If(t,e,r,s,l,p,d,v,x){var S=_p(s,p,d),I=xp(s,l),E=I*d,k=t[0].x===0||t[0].x===x||t[0].y===0||t[0].y===x;return e-E<e/4&&(e=E+e/4),function R(Z,j,it,J,pt,dt,_t,xt,Pt){for(var qt=dt/2,Yt=vp(Z),se=0,$t=j-it,fe=[],Qt=0;Qt<Z.length-1;Qt++){for(var Ue=Z[Qt],be=Z[Qt+1],ue=Ue.dist(be),Ge=be.angleTo(Ue);$t+it<se+ue;){var Be=(($t+=it)-se)/ue,sr=Wr(Ue.x,be.x,Be),me=Wr(Ue.y,be.y,Be);if(sr>=0&&sr<Pt&&me>=0&&me<Pt&&$t-qt>=0&&$t+qt<=Yt){var gr=new $u(sr,me,Ge,Qt);gr._round(),J&&!yp(Z,gr,dt,J,pt)||fe.push(gr)}}se+=ue}return xt||fe.length||_t||(fe=R(Z,se/2,it,J,pt,dt,_t,!0,Pt)),fe}(t,k?e/2*v%e:(I/2+2*p)*d*v%e,e,S,r,E,k,!1,x)}function bp(t,e,r,s,l){for(var p=[],d=0;d<t.length;d++)for(var v=t[d],x=void 0,S=0;S<v.length-1;S++){var I=v[S],E=v[S+1];I.x<e&&E.x<e||(I.x<e?I=new Te(e,I.y+(e-I.x)/(E.x-I.x)*(E.y-I.y))._round():E.x<e&&(E=new Te(e,I.y+(e-I.x)/(E.x-I.x)*(E.y-I.y))._round()),I.y<r&&E.y<r||(I.y<r?I=new Te(I.x+(r-I.y)/(E.y-I.y)*(E.x-I.x),r)._round():E.y<r&&(E=new Te(I.x+(r-I.y)/(E.y-I.y)*(E.x-I.x),r)._round()),I.x>=s&&E.x>=s||(I.x>=s?I=new Te(s,I.y+(s-I.x)/(E.x-I.x)*(E.y-I.y))._round():E.x>=s&&(E=new Te(s,I.y+(s-I.x)/(E.x-I.x)*(E.y-I.y))._round()),I.y>=l&&E.y>=l||(I.y>=l?I=new Te(I.x+(l-I.y)/(E.y-I.y)*(E.x-I.x),l)._round():E.y>=l&&(E=new Te(I.x+(l-I.y)/(E.y-I.y)*(E.x-I.x),l)._round()),x&&I.equals(x[x.length-1])||p.push(x=[I]),x.push(E)))))}return p}function wp(t,e,r,s){var l=[],p=t.image,d=p.pixelRatio,v=p.paddedRect.w-2,x=p.paddedRect.h-2,S=t.right-t.left,I=t.bottom-t.top,E=p.stretchX||[[0,v]],k=p.stretchY||[[0,x]],R=function(sr,me){return sr+me[1]-me[0]},Z=E.reduce(R,0),j=k.reduce(R,0),it=v-Z,J=x-j,pt=0,dt=Z,_t=0,xt=j,Pt=0,qt=it,Yt=0,se=J;if(p.content&&s){var $t=p.content;pt=Hc(E,0,$t[0]),_t=Hc(k,0,$t[1]),dt=Hc(E,$t[0],$t[2]),xt=Hc(k,$t[1],$t[3]),Pt=$t[0]-pt,Yt=$t[1]-_t,qt=$t[2]-$t[0]-dt,se=$t[3]-$t[1]-xt}var fe=function(sr,me,gr,Nr){var Kr=Kc(sr.stretch-pt,dt,S,t.left),rn=fc(sr.fixed-Pt,qt,sr.stretch,Z),Yr=Kc(me.stretch-_t,xt,I,t.top),tn=fc(me.fixed-Yt,se,me.stretch,j),Dn=Kc(gr.stretch-pt,dt,S,t.left),qn=fc(gr.fixed-Pt,qt,gr.stretch,Z),Li=Kc(Nr.stretch-_t,xt,I,t.top),Kn=fc(Nr.fixed-Yt,se,Nr.stretch,j),Di=new Te(Kr,Yr),xn=new Te(Dn,Yr),Yn=new Te(Dn,Li),$e=new Te(Kr,Li),Br=new Te(rn/d,tn/d),Ar=new Te(qn/d,Kn/d),hr=e*Math.PI/180;if(hr){var qi=Math.sin(hr),wi=Math.cos(hr),fr=[wi,-qi,qi,wi];Di._matMult(fr),xn._matMult(fr),$e._matMult(fr),Yn._matMult(fr)}var In=sr.stretch+sr.fixed,Si=me.stretch+me.fixed;return{tl:Di,tr:xn,bl:$e,br:Yn,tex:{x:p.paddedRect.x+1+In,y:p.paddedRect.y+1+Si,w:gr.stretch+gr.fixed-In,h:Nr.stretch+Nr.fixed-Si},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Br,pixelOffsetBR:Ar,minFontScaleX:qt/d/S,minFontScaleY:se/d/I,isSDF:r}};if(s&&(p.stretchX||p.stretchY))for(var Qt=Sp(E,it,Z),Ue=Sp(k,J,j),be=0;be<Qt.length-1;be++)for(var ue=Qt[be],Ge=Qt[be+1],Be=0;Be<Ue.length-1;Be++)l.push(fe(ue,Ue[Be],Ge,Ue[Be+1]));else l.push(fe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:x+1}));return l}function Hc(t,e,r){for(var s=0,l=0,p=t;l<p.length;l+=1){var d=p[l];s+=Math.max(e,Math.min(r,d[1]))-Math.max(e,Math.min(r,d[0]))}return s}function Sp(t,e,r){for(var s=[{fixed:-1,stretch:0}],l=0,p=t;l<p.length;l+=1){var d=p[l],v=d[0],x=d[1],S=s[s.length-1];s.push({fixed:v-S.stretch,stretch:S.stretch}),s.push({fixed:v-S.stretch,stretch:S.stretch+(x-v)})}return s.push({fixed:e+1,stretch:r}),s}function Kc(t,e,r,s){return t/e*r+s}function fc(t,e,r,s){return t-e*r/s}var dc=function(t,e,r,s,l,p,d,v,x,S){if(this.boxStartIndex=t.length,x){var I=p.top,E=p.bottom,k=p.collisionPadding;k&&(I-=k[1],E+=k[3]);var R=E-I;R>0&&(R=Math.max(10,R),this.circleDiameter=R)}else{var Z=p.top*d-v,j=p.bottom*d+v,it=p.left*d-v,J=p.right*d+v,pt=p.collisionPadding;if(pt&&(it-=pt[0]*d,Z-=pt[1]*d,J+=pt[2]*d,j+=pt[3]*d),S){var dt=new Te(it,Z),_t=new Te(J,Z),xt=new Te(it,j),Pt=new Te(J,j),qt=S*Math.PI/180;dt._rotate(qt),_t._rotate(qt),xt._rotate(qt),Pt._rotate(qt),it=Math.min(dt.x,_t.x,xt.x,Pt.x),J=Math.max(dt.x,_t.x,xt.x,Pt.x),Z=Math.min(dt.y,_t.y,xt.y,Pt.y),j=Math.max(dt.y,_t.y,xt.y,Pt.y)}t.emplaceBack(e.x,e.y,it,Z,J,j,r,s,l)}this.boxEndIndex=t.length},Qu=function(t,e){if(t===void 0&&(t=[]),e===void 0&&(e=Ef),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Ef(t,e){return t<e?-1:t>e?1:0}function Af(t,e,r){e===void 0&&(e=1),r===void 0&&(r=!1);for(var s=1/0,l=1/0,p=-1/0,d=-1/0,v=t[0],x=0;x<v.length;x++){var S=v[x];(!x||S.x<s)&&(s=S.x),(!x||S.y<l)&&(l=S.y),(!x||S.x>p)&&(p=S.x),(!x||S.y>d)&&(d=S.y)}var I=Math.min(p-s,d-l),E=I/2,k=new Qu([],Pf);if(I===0)return new Te(s,l);for(var R=s;R<p;R+=I)for(var Z=l;Z<d;Z+=I)k.push(new tl(R+E,Z+E,E,t));for(var j=function(pt){for(var dt=0,_t=0,xt=0,Pt=pt[0],qt=0,Yt=Pt.length,se=Yt-1;qt<Yt;se=qt++){var $t=Pt[qt],fe=Pt[se],Qt=$t.x*fe.y-fe.x*$t.y;_t+=($t.x+fe.x)*Qt,xt+=($t.y+fe.y)*Qt,dt+=3*Qt}return new tl(_t/dt,xt/dt,0,pt)}(t),it=k.length;k.length;){var J=k.pop();(J.d>j.d||!j.d)&&(j=J,r&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,it)),J.max-j.d<=e||(k.push(new tl(J.p.x-(E=J.h/2),J.p.y-E,E,t)),k.push(new tl(J.p.x+E,J.p.y-E,E,t)),k.push(new tl(J.p.x-E,J.p.y+E,E,t)),k.push(new tl(J.p.x+E,J.p.y+E,E,t)),it+=4)}return r&&(console.log("num probes: "+it),console.log("best distance: "+j.d)),j.p}function Pf(t,e){return e.max-t.max}function tl(t,e,r,s){this.p=new Te(t,e),this.h=r,this.d=function(l,p){for(var d=!1,v=1/0,x=0;x<p.length;x++)for(var S=p[x],I=0,E=S.length,k=E-1;I<E;k=I++){var R=S[I],Z=S[k];R.y>l.y!=Z.y>l.y&&l.x<(Z.x-R.x)*(l.y-R.y)/(Z.y-R.y)+R.x&&(d=!d),v=Math.min(v,ju(l,R,Z))}return(d?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}Qu.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Qu.prototype.pop=function(){if(this.length!==0){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},Qu.prototype.peek=function(){return this.data[0]},Qu.prototype._up=function(t){for(var e=this.data,r=this.compare,s=e[t];t>0;){var l=t-1>>1,p=e[l];if(r(s,p)>=0)break;e[t]=p,t=l}e[t]=s},Qu.prototype._down=function(t){for(var e=this.data,r=this.compare,s=this.length>>1,l=e[t];t<s;){var p=1+(t<<1),d=e[p],v=p+1;if(v<this.length&&r(e[v],d)<0&&(p=v,d=e[v]),r(d,l)>=0)break;e[t]=d,t=p}e[t]=l};var Ch=Number.POSITIVE_INFINITY;function Tp(t,e){return e[1]!==Ch?function(r,s,l){var p=0,d=0;switch(s=Math.abs(s),l=Math.abs(l),r){case"top-right":case"top-left":case"top":d=l-7;break;case"bottom-right":case"bottom-left":case"bottom":d=7-l}switch(r){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,d]}(t,e[0],e[1]):function(r,s){var l=0,p=0;s<0&&(s=0);var d=s/Math.sqrt(2);switch(r){case"top-right":case"top-left":p=d-7;break;case"bottom-right":case"bottom-left":p=7-d;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(r){case"top-right":case"bottom-right":l=-d;break;case"top-left":case"bottom-left":l=d;break;case"left":l=s;break;case"right":l=-s}return[l,p]}(t,e[0])}function zh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ip(t,e,r,s,l,p,d,v,x,S,I,E,k,R,Z){var j=function(_t,xt,Pt,qt,Yt,se,$t,fe){for(var Qt=qt.layout.get("text-rotate").evaluate(se,{})*Math.PI/180,Ue=[],be=0,ue=xt.positionedLines;be<ue.length;be+=1)for(var Ge=ue[be],Be=0,sr=Ge.positionedGlyphs;Be<sr.length;Be+=1){var me=sr[Be];if(me.rect){var gr=me.rect||{},Nr=4,Kr=!0,rn=1,Yr=0,tn=(Yt||fe)&&me.vertical,Dn=me.metrics.advance*me.scale/2;if(fe&&xt.verticalizable&&(Yr=Ge.lineOffset/2-(me.imageName?-(24-me.metrics.width*me.scale)/2:24*(me.scale-1))),me.imageName){var qn=$t[me.imageName];Kr=qn.sdf,Nr=1/(rn=qn.pixelRatio)}var Li=Yt?[me.x+Dn,me.y]:[0,0],Kn=Yt?[0,0]:[me.x+Dn+Pt[0],me.y+Pt[1]-Yr],Di=[0,0];tn&&(Di=Kn,Kn=[0,0]);var xn=(me.metrics.left-Nr)*me.scale-Dn+Kn[0],Yn=(-me.metrics.top-Nr)*me.scale+Kn[1],$e=xn+gr.w*me.scale/rn,Br=Yn+gr.h*me.scale/rn,Ar=new Te(xn,Yn),hr=new Te($e,Yn),qi=new Te(xn,Br),wi=new Te($e,Br);if(tn){var fr=new Te(-Dn,Dn- -17),In=-Math.PI/2,Si=12-Dn,Qe=new Te(22-Si,-(me.imageName?Si:0)),Ne=new(Function.prototype.bind.apply(Te,[null].concat(Di)));Ar._rotateAround(In,fr)._add(Qe)._add(Ne),hr._rotateAround(In,fr)._add(Qe)._add(Ne),qi._rotateAround(In,fr)._add(Qe)._add(Ne),wi._rotateAround(In,fr)._add(Qe)._add(Ne)}if(Qt){var Zo=Math.sin(Qt),Rn=Math.cos(Qt),tr=[Rn,-Zo,Zo,Rn];Ar._matMult(tr),hr._matMult(tr),qi._matMult(tr),wi._matMult(tr)}var ds=new Te(0,0),Ti=new Te(0,0);Ue.push({tl:Ar,tr:hr,bl:qi,br:wi,tex:gr,writingMode:xt.writingMode,glyphOffset:Li,sectionIndex:me.sectionIndex,isSDF:Kr,pixelOffsetTL:ds,pixelOffsetBR:Ti,minFontScaleX:0,minFontScaleY:0})}}return Ue}(0,r,v,l,p,d,s,t.allowVerticalPlacement),it=t.textSizeData,J=null;it.kind==="source"?(J=[128*l.layout.get("text-size").evaluate(d,{})])[0]>32640&&Jr(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):it.kind==="composite"&&((J=[128*R.compositeTextSizes[0].evaluate(d,{},Z),128*R.compositeTextSizes[1].evaluate(d,{},Z)])[0]>32640||J[1]>32640)&&Jr(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,j,J,v,p,d,S,e,x.lineStartIndex,x.lineLength,k,Z);for(var pt=0,dt=I;pt<dt.length;pt+=1)E[dt[pt]]=t.text.placedSymbolArray.length-1;return 4*j.length}function Ep(t){for(var e in t)return t[e];return null}function Cf(t,e,r,s){var l=t.compareText;if(e in l){for(var p=l[e],d=p.length-1;d>=0;d--)if(s.dist(p[d])<r)return!0}else l[e]=[];return l[e].push(s),!1}var Sa=ps.VectorTileFeature.types,zf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yc(t,e,r,s,l,p,d,v,x,S,I,E,k){var R=v?Math.min(32640,Math.round(v[0])):0,Z=v?Math.min(32640,Math.round(v[1])):0;t.emplaceBack(e,r,Math.round(32*s),Math.round(32*l),p,d,(R<<1)+(x?1:0),Z,16*S,16*I,256*E,256*k)}function kh(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function Ap(t){for(var e=0,r=t.sections;e<r.length;e+=1)if(Xt(r[e].text))return!0;return!1}var Ll=function(t){this.layoutVertexArray=new du,this.indexArray=new _o,this.programConfigurations=t,this.segments=new O,this.dynamicLayoutVertexArray=new Nu,this.opacityVertexArray=new ja,this.placedSymbolArray=new f};Ll.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Ll.prototype.upload=function(t,e,r,s){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,df.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,mf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,zf,!0),this.opacityVertexBuffer.itemSize=1),(r||s)&&this.programConfigurations.upload(t))},Ll.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},mt("SymbolBuffers",Ll);var mc=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new O,this.collisionVertexArray=new ec};mc.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ns.members,!0)},mc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},mt("CollisionBuffers",mc);var kr=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bi([]),this.placementViewportMatrix=bi([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wa(this.zoom,e["text-size"]),this.iconSizeData=wa(this.zoom,e["icon-size"]);var r=this.layers[0].layout,s=r.get("symbol-sort-key"),l=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=l!=="viewport-y"&&!s.isConstant(),this.sortFeaturesByY=(l==="viewport-y"||l==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(p){return qo[p]})),this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id}),this.sourceID=t.sourceID};kr.prototype.createArrays=function(){this.text=new Ll(new Er(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Ll(new Er(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new _,this.lineVertexArray=new T,this.symbolInstances=new y},kr.prototype.calculateGlyphDependencies=function(t,e,r,s,l){for(var p=0;p<t.length;p++)if(e[t.charCodeAt(p)]=!0,(r||s)&&l){var d=xu[t.charAt(p)];d&&(e[d.charCodeAt(0)]=!0)}},kr.prototype.populate=function(t,e,r){var s=this.layers[0],l=s.layout,p=l.get("text-font"),d=l.get("text-field"),v=l.get("icon-image"),x=(d.value.kind!=="constant"||d.value.value instanceof nn&&!d.value.value.isEmpty()||d.value.value.toString().length>0)&&(p.value.kind!=="constant"||p.value.value.length>0),S=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,I=l.get("symbol-sort-key");if(this.features=[],x||S){for(var E=e.iconDependencies,k=e.glyphDependencies,R=e.availableImages,Z=new Ee(this.zoom),j=0,it=t;j<it.length;j+=1){var J=it[j],pt=J.feature,dt=J.id,_t=J.index,xt=J.sourceLayerIndex,Pt=s._featureFilter.needGeometry,qt=oi(pt,Pt);if(s._featureFilter.filter(Z,qt,r)){Pt||(qt.geometry=Vr(pt));var Yt=void 0;if(x){var se=s.getValueAndResolveTokens("text-field",qt,r,R),$t=nn.factory(se);Ap($t)&&(this.hasRTLText=!0),(!this.hasRTLText||or()==="unavailable"||this.hasRTLText&&he.isParsed())&&(Yt=Eh($t,s,qt))}var fe=void 0;if(S){var Qt=s.getValueAndResolveTokens("icon-image",qt,r,R);fe=Qt instanceof Gn?Qt:Gn.fromString(Qt)}if(Yt||fe){var Ue=this.sortFeaturesByKey?I.evaluate(qt,{},r):void 0;if(this.features.push({id:dt,text:Yt,icon:fe,index:_t,sourceLayerIndex:xt,geometry:qt.geometry,properties:pt.properties,type:Sa[pt.type],sortKey:Ue}),fe&&(E[fe.name]=!0),Yt){var be=p.evaluate(qt,{},r).join(","),ue=l.get("text-rotation-alignment")==="map"&&l.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qo.vertical)>=0;for(var Ge=0,Be=Yt.sections;Ge<Be.length;Ge+=1){var sr=Be[Ge];if(sr.image)E[sr.image.name]=!0;else{var me=Tr(Yt.toString()),gr=sr.fontStack||be,Nr=k[gr]=k[gr]||{};this.calculateGlyphDependencies(sr.text,Nr,ue,this.allowVerticalPlacement,me)}}}}}}l.get("symbol-placement")==="line"&&(this.features=function(Kr){var rn={},Yr={},tn=[],Dn=0;function qn(fr){tn.push(Kr[fr]),Dn++}function Li(fr,In,Si){var Qe=Yr[fr];return delete Yr[fr],Yr[In]=Qe,tn[Qe].geometry[0].pop(),tn[Qe].geometry[0]=tn[Qe].geometry[0].concat(Si[0]),Qe}function Kn(fr,In,Si){var Qe=rn[In];return delete rn[In],rn[fr]=Qe,tn[Qe].geometry[0].shift(),tn[Qe].geometry[0]=Si[0].concat(tn[Qe].geometry[0]),Qe}function Di(fr,In,Si){var Qe=Si?In[0][In[0].length-1]:In[0][0];return fr+":"+Qe.x+":"+Qe.y}for(var xn=0;xn<Kr.length;xn++){var Yn=Kr[xn],$e=Yn.geometry,Br=Yn.text?Yn.text.toString():null;if(Br){var Ar=Di(Br,$e),hr=Di(Br,$e,!0);if(Ar in Yr&&hr in rn&&Yr[Ar]!==rn[hr]){var qi=Kn(Ar,hr,$e),wi=Li(Ar,hr,tn[qi].geometry);delete rn[Ar],delete Yr[hr],Yr[Di(Br,tn[wi].geometry,!0)]=wi,tn[qi].geometry=null}else Ar in Yr?Li(Ar,hr,$e):hr in rn?Kn(Ar,hr,$e):(qn(xn),rn[Ar]=Dn-1,Yr[hr]=Dn-1)}else qn(xn)}return tn.filter(function(fr){return fr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Kr,rn){return Kr.sortKey-rn.sortKey})}},kr.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},kr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},kr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},kr.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},kr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},kr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},kr.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(t.segment!==void 0){for(var s=t.dist(e[t.segment+1]),l=t.dist(e[t.segment]),p={},d=t.segment+1;d<e.length;d++)p[d]={x:e[d].x,y:e[d].y,tileUnitDistanceFromAnchor:s},d<e.length-1&&(s+=e[d+1].dist(e[d]));for(var v=t.segment||0;v>=0;v--)p[v]={x:e[v].x,y:e[v].y,tileUnitDistanceFromAnchor:l},v>0&&(l+=e[v-1].dist(e[v]));for(var x=0;x<e.length;x++){var S=p[x];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},kr.prototype.addSymbols=function(t,e,r,s,l,p,d,v,x,S,I,E){for(var k=t.indexArray,R=t.layoutVertexArray,Z=t.segments.prepareSegment(4*e.length,R,k,this.canOverlap?p.sortKey:void 0),j=this.glyphOffsetArray.length,it=Z.vertexLength,J=this.allowVerticalPlacement&&d===qo.vertical?Math.PI/2:0,pt=p.text&&p.text.sections,dt=0;dt<e.length;dt++){var _t=e[dt],xt=_t.tl,Pt=_t.tr,qt=_t.bl,Yt=_t.br,se=_t.tex,$t=_t.pixelOffsetTL,fe=_t.pixelOffsetBR,Qt=_t.minFontScaleX,Ue=_t.minFontScaleY,be=_t.glyphOffset,ue=_t.isSDF,Ge=_t.sectionIndex,Be=Z.vertexLength,sr=be[1];Yc(R,v.x,v.y,xt.x,sr+xt.y,se.x,se.y,r,ue,$t.x,$t.y,Qt,Ue),Yc(R,v.x,v.y,Pt.x,sr+Pt.y,se.x+se.w,se.y,r,ue,fe.x,$t.y,Qt,Ue),Yc(R,v.x,v.y,qt.x,sr+qt.y,se.x,se.y+se.h,r,ue,$t.x,fe.y,Qt,Ue),Yc(R,v.x,v.y,Yt.x,sr+Yt.y,se.x+se.w,se.y+se.h,r,ue,fe.x,fe.y,Qt,Ue),kh(t.dynamicLayoutVertexArray,v,J),k.emplaceBack(Be,Be+1,Be+2),k.emplaceBack(Be+1,Be+2,Be+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(be[0]),dt!==e.length-1&&Ge===e[dt+1].sectionIndex||t.programConfigurations.populatePaintArrays(R.length,p,p.index,{},E,pt&&pt[Ge])}t.placedSymbolArray.emplaceBack(v.x,v.y,j,this.glyphOffsetArray.length-j,it,x,S,v.segment,r?r[0]:0,r?r[1]:0,s[0],s[1],d,0,!1,0,I)},kr.prototype._addCollisionDebugVertex=function(t,e,r,s,l,p){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,s,l,Math.round(p.x),Math.round(p.y))},kr.prototype.addCollisionDebugVertices=function(t,e,r,s,l,p,d){var v=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),x=v.vertexLength,S=l.layoutVertexArray,I=l.collisionVertexArray,E=d.anchorX,k=d.anchorY;this._addCollisionDebugVertex(S,I,p,E,k,new Te(t,e)),this._addCollisionDebugVertex(S,I,p,E,k,new Te(r,e)),this._addCollisionDebugVertex(S,I,p,E,k,new Te(r,s)),this._addCollisionDebugVertex(S,I,p,E,k,new Te(t,s)),v.vertexLength+=4;var R=l.indexArray;R.emplaceBack(x,x+1),R.emplaceBack(x+1,x+2),R.emplaceBack(x+2,x+3),R.emplaceBack(x+3,x),v.primitiveLength+=4},kr.prototype.addDebugCollisionBoxes=function(t,e,r,s){for(var l=t;l<e;l++){var p=this.collisionBoxArray.get(l);this.addCollisionDebugVertices(p.x1,p.y1,p.x2,p.y2,s?this.textCollisionBox:this.iconCollisionBox,p.anchorPoint,r)}},kr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mc(ss,Zc.members,qu),this.iconCollisionBox=new mc(ss,Zc.members,qu);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},kr.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,s,l,p,d,v,x){for(var S={},I=e;I<r;I++){var E=t.get(I);S.textBox={x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,anchorPointX:E.anchorPointX,anchorPointY:E.anchorPointY},S.textFeatureIndex=E.featureIndex;break}for(var k=s;k<l;k++){var R=t.get(k);S.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},S.verticalTextFeatureIndex=R.featureIndex;break}for(var Z=p;Z<d;Z++){var j=t.get(Z);S.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},S.iconFeatureIndex=j.featureIndex;break}for(var it=v;it<x;it++){var J=t.get(it);S.verticalIconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},S.verticalIconFeatureIndex=J.featureIndex;break}return S},kr.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},kr.prototype.hasTextData=function(){return this.text.segments.get().length>0},kr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},kr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},kr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},kr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},kr.prototype.addIndicesForPlacedSymbol=function(t,e){for(var r=t.placedSymbolArray.get(e),s=r.vertexStartIndex+4*r.numGlyphs,l=r.vertexStartIndex;l<s;l+=4)t.indexArray.emplaceBack(l,l+1,l+2),t.indexArray.emplaceBack(l+1,l+2,l+3)},kr.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var e=Math.sin(t),r=Math.cos(t),s=[],l=[],p=[],d=0;d<this.symbolInstances.length;++d){p.push(d);var v=this.symbolInstances.get(d);s.push(0|Math.round(e*v.anchorX+r*v.anchorY)),l.push(v.featureIndex)}return p.sort(function(x,S){return s[x]-s[S]||l[S]-l[x]}),p},kr.prototype.addToSortKeyRanges=function(t,e){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===e?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},kr.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,s=this.symbolInstanceIndexes;r<s.length;r+=1){var l=this.symbolInstances.get(s[r]);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach(function(p,d,v){p>=0&&v.indexOf(p)===d&&e.addIndicesForPlacedSymbol(e.text,p)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},mt("SymbolBucket",kr,{omit:["layers","collisionBoxArray","features","compareText"]}),kr.MAX_GLYPHS=65535,kr.addDynamicAttributes=kh;var kf=new $i({"symbol-placement":new Kt(V.layout_symbol["symbol-placement"]),"symbol-spacing":new Kt(V.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kt(V.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ye(V.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Kt(V.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Kt(V.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Kt(V.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kt(V.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kt(V.layout_symbol["icon-rotation-alignment"]),"icon-size":new ye(V.layout_symbol["icon-size"]),"icon-text-fit":new Kt(V.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kt(V.layout_symbol["icon-text-fit-padding"]),"icon-image":new ye(V.layout_symbol["icon-image"]),"icon-rotate":new ye(V.layout_symbol["icon-rotate"]),"icon-padding":new Kt(V.layout_symbol["icon-padding"]),"icon-keep-upright":new Kt(V.layout_symbol["icon-keep-upright"]),"icon-offset":new ye(V.layout_symbol["icon-offset"]),"icon-anchor":new ye(V.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kt(V.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kt(V.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kt(V.layout_symbol["text-rotation-alignment"]),"text-field":new ye(V.layout_symbol["text-field"]),"text-font":new ye(V.layout_symbol["text-font"]),"text-size":new ye(V.layout_symbol["text-size"]),"text-max-width":new ye(V.layout_symbol["text-max-width"]),"text-line-height":new Kt(V.layout_symbol["text-line-height"]),"text-letter-spacing":new ye(V.layout_symbol["text-letter-spacing"]),"text-justify":new ye(V.layout_symbol["text-justify"]),"text-radial-offset":new ye(V.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Kt(V.layout_symbol["text-variable-anchor"]),"text-anchor":new ye(V.layout_symbol["text-anchor"]),"text-max-angle":new Kt(V.layout_symbol["text-max-angle"]),"text-writing-mode":new Kt(V.layout_symbol["text-writing-mode"]),"text-rotate":new ye(V.layout_symbol["text-rotate"]),"text-padding":new Kt(V.layout_symbol["text-padding"]),"text-keep-upright":new Kt(V.layout_symbol["text-keep-upright"]),"text-transform":new ye(V.layout_symbol["text-transform"]),"text-offset":new ye(V.layout_symbol["text-offset"]),"text-allow-overlap":new Kt(V.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Kt(V.layout_symbol["text-ignore-placement"]),"text-optional":new Kt(V.layout_symbol["text-optional"])}),gc={paint:new $i({"icon-opacity":new ye(V.paint_symbol["icon-opacity"]),"icon-color":new ye(V.paint_symbol["icon-color"]),"icon-halo-color":new ye(V.paint_symbol["icon-halo-color"]),"icon-halo-width":new ye(V.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ye(V.paint_symbol["icon-halo-blur"]),"icon-translate":new Kt(V.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kt(V.paint_symbol["icon-translate-anchor"]),"text-opacity":new ye(V.paint_symbol["text-opacity"]),"text-color":new ye(V.paint_symbol["text-color"],{runtimeType:Me,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new ye(V.paint_symbol["text-halo-color"]),"text-halo-width":new ye(V.paint_symbol["text-halo-width"]),"text-halo-blur":new ye(V.paint_symbol["text-halo-blur"]),"text-translate":new Kt(V.paint_symbol["text-translate"]),"text-translate-anchor":new Kt(V.paint_symbol["text-translate-anchor"])}),layout:kf},Dl=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ce,this.defaultValue=t};Dl.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Dl.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Dl.prototype.outputDefined=function(){return!1},Dl.prototype.serialize=function(){return null},mt("FormatSectionOverride",Dl,{omit:["defaultValue"]});var Mf=function(t){function e(r){t.call(this,r,gc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(r,s){if(t.prototype.recalculate.call(this,r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var l=this.layout.get("text-writing-mode");if(l){for(var p=[],d=0,v=l;d<v.length;d+=1){var x=v[d];p.indexOf(x)<0&&p.push(x)}this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(r,s,l,p){var d=this.layout.get(r).evaluate(s,{},l,p),v=this._unevaluatedLayout._values[r];return v.isDataDriven()||lu(v.value)||!d?d:function(x,S){return S.replace(/{([^{}]+)}/g,function(I,E){return E in x?String(x[E]):""})}(s.properties,d)},e.prototype.createBucket=function(r){return new kr(r)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var r=0,s=gc.paint.overridableProperties;r<s.length;r+=1){var l=s[r];if(e.hasPaintOverride(this.layout,l)){var p,d=this.paint.get(l),v=new Dl(d),x=new is(v,d.property.specification);p=d.value.kind==="constant"||d.value.kind==="source"?new Ua("source",x):new os("composite",x,d.value.zoomStops,d.value._interpolationType),this.paint._values[l]=new Xn(d.property,p,d.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(r,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&e.hasPaintOverride(this.layout,r)},e.hasPaintOverride=function(r,s){var l=r.get("text-field"),p=gc.paint.properties[s],d=!1,v=function(I){for(var E=0,k=I;E<k.length;E+=1)if(p.overrides&&p.overrides.hasOverride(k[E]))return void(d=!0)};if(l.value.kind==="constant"&&l.value.value instanceof nn)v(l.value.value.sections);else if(l.value.kind==="source"){var x=function(I){d||(I instanceof fi&&wn(I.value)===we?v(I.value.sections):I instanceof mi?v(I.sections):I.eachChild(x))},S=l.value;S._styleExpression&&x(S._styleExpression.expression)}return d},e}(Bo),Lf={paint:new $i({"background-color":new Kt(V.paint_background["background-color"]),"background-pattern":new _i(V.paint_background["background-pattern"]),"background-opacity":new Kt(V.paint_background["background-opacity"])})},Df=function(t){function e(r){t.call(this,r,Lf)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Bo),Rf={paint:new $i({"raster-opacity":new Kt(V.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kt(V.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kt(V.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kt(V.paint_raster["raster-brightness-max"]),"raster-saturation":new Kt(V.paint_raster["raster-saturation"]),"raster-contrast":new Kt(V.paint_raster["raster-contrast"]),"raster-resampling":new Kt(V.paint_raster["raster-resampling"]),"raster-fade-duration":new Kt(V.paint_raster["raster-fade-duration"])})},Bf=function(t){function e(r){t.call(this,r,Rf)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Bo),Of=function(t){function e(r){t.call(this,r,{}),this.implementation=r}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},e.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},e.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},e}(Bo),Ff={circle:Wu,heatmap:Xh,hillshade:af,fill:hs,"fill-extrusion":xh,line:ff,symbol:Mf,background:Df,raster:Bf},Pp=Et.HTMLImageElement,Cp=Et.HTMLCanvasElement,zp=Et.HTMLVideoElement,kp=Et.ImageData,Jc=Et.ImageBitmap,el=function(t,e,r,s){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,s)};el.prototype.update=function(t,e,r){var s=t.width,l=t.height,p=!(this.size&&this.size[0]===s&&this.size[1]===l||r),d=this.context,v=d.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),v.bindTexture(v.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!e||e.premultiply!==!1)),p)this.size=[s,l],t instanceof Pp||t instanceof Cp||t instanceof zp||t instanceof kp||Jc&&t instanceof Jc?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,t):v.texImage2D(v.TEXTURE_2D,0,this.format,s,l,0,this.format,v.UNSIGNED_BYTE,t.data);else{var x=r||{x:0,y:0},S=x.x,I=x.y;t instanceof Pp||t instanceof Cp||t instanceof zp||t instanceof kp||Jc&&t instanceof Jc?v.texSubImage2D(v.TEXTURE_2D,0,S,I,v.RGBA,v.UNSIGNED_BYTE,t):v.texSubImage2D(v.TEXTURE_2D,0,S,I,s,l,v.RGBA,v.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&v.generateMipmap(v.TEXTURE_2D)},el.prototype.bind=function(t,e,r){var s=this.context.gl;s.bindTexture(s.TEXTURE_2D,this.texture),r!==s.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=s.LINEAR),t!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,e),this.wrap=e)},el.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},el.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Mh=function(t){var e=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Mh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Mh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Rl=function(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ai(["receive","process"],this),this.invoker=new Mh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=li()?t:Et};function Mp(t,e,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}Rl.prototype.send=function(t,e,r,s,l){var p=this;l===void 0&&(l=!1);var d=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[d]=r);var v=Ys(this.globalScope)?void 0:[];return this.target.postMessage({id:d,type:t,hasCallback:!!r,targetMapId:s,mustQueue:l,sourceMapId:this.mapId,data:ge(e,v)},v),{cancel:function(){r&&delete p.callbacks[d],p.target.postMessage({id:d,type:"<cancel>",targetMapId:s,sourceMapId:p.mapId})}}},Rl.prototype.receive=function(t){var e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[r];var s=this.cancelCallbacks[r];delete this.cancelCallbacks[r],s&&s()}else li()||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e)},Rl.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Rl.prototype.processTask=function(t,e){var r=this;if(e.type==="<response>"){var s=this.callbacks[t];delete this.callbacks[t],s&&(e.error?s(Je(e.error)):s(null,Je(e.data)))}else{var l=!1,p=Ys(this.globalScope)?void 0:[],d=e.hasCallback?function(I,E){l=!0,delete r.cancelCallbacks[t],r.target.postMessage({id:t,type:"<response>",sourceMapId:r.mapId,error:I?ge(I):null,data:ge(E,p)},p)}:function(I){l=!0},v=null,x=Je(e.data);if(this.parent[e.type])v=this.parent[e.type](e.sourceMapId,x,d);else if(this.parent.getWorkerSource){var S=e.type.split(".");v=this.parent.getWorkerSource(e.sourceMapId,S[0],x.source)[S[1]](x,d)}else d(new Error("Could not find function "+e.type));!l&&v&&v.cancel&&(this.cancelCallbacks[t]=v.cancel)}},Rl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Mn=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Mn.prototype.setNorthEast=function(t){return this._ne=t instanceof Hr?new Hr(t.lng,t.lat):Hr.convert(t),this},Mn.prototype.setSouthWest=function(t){return this._sw=t instanceof Hr?new Hr(t.lng,t.lat):Hr.convert(t),this},Mn.prototype.extend=function(t){var e,r,s=this._sw,l=this._ne;if(t instanceof Hr)e=t,r=t;else{if(!(t instanceof Mn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Mn.convert(t)):this.extend(Hr.convert(t)):this;if(r=t._ne,!(e=t._sw)||!r)return this}return s||l?(s.lng=Math.min(e.lng,s.lng),s.lat=Math.min(e.lat,s.lat),l.lng=Math.max(r.lng,l.lng),l.lat=Math.max(r.lat,l.lat)):(this._sw=new Hr(e.lng,e.lat),this._ne=new Hr(r.lng,r.lat)),this},Mn.prototype.getCenter=function(){return new Hr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Mn.prototype.getSouthWest=function(){return this._sw},Mn.prototype.getNorthEast=function(){return this._ne},Mn.prototype.getNorthWest=function(){return new Hr(this.getWest(),this.getNorth())},Mn.prototype.getSouthEast=function(){return new Hr(this.getEast(),this.getSouth())},Mn.prototype.getWest=function(){return this._sw.lng},Mn.prototype.getSouth=function(){return this._sw.lat},Mn.prototype.getEast=function(){return this._ne.lng},Mn.prototype.getNorth=function(){return this._ne.lat},Mn.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Mn.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Mn.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Mn.prototype.contains=function(t){var e=Hr.convert(t),r=e.lng,s=e.lat,l=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(l=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&l},Mn.convert=function(t){return!t||t instanceof Mn?t:new Mn(t)};var Hr=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Hr.prototype.wrap=function(){return new Hr(Zi(this.lng,-180,180),this.lat)},Hr.prototype.toArray=function(){return[this.lng,this.lat]},Hr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Hr.prototype.distanceTo=function(t){var e=Math.PI/180,r=this.lat*e,s=t.lat*e,l=Math.sin(r)*Math.sin(s)+Math.cos(r)*Math.cos(s)*Math.cos((t.lng-this.lng)*e);return 63710088e-1*Math.acos(Math.min(l,1))},Hr.prototype.toBounds=function(t){t===void 0&&(t=0);var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new Mn(new Hr(this.lng-r,this.lat-e),new Hr(this.lng+r,this.lat+e))},Hr.convert=function(t){if(t instanceof Hr)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Hr(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Hr(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Lp=2*Math.PI*63710088e-1;function $c(t){return Lp*Math.cos(t*Math.PI/180)}function Lh(t){return(180+t)/360}function Dp(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Rp(t,e){return t/$c(e)}function Dh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var rl=function(t,e,r){r===void 0&&(r=0),this.x=+t,this.y=+e,this.z=+r};rl.fromLngLat=function(t,e){e===void 0&&(e=0);var r=Hr.convert(t);return new rl(Lh(r.lng),Dp(r.lat),Rp(e,r.lat))},rl.prototype.toLngLat=function(){return new Hr(360*this.x-180,Dh(this.y))},rl.prototype.toAltitude=function(){return this.z*$c(Dh(this.y))},rl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Lp*(t=Dh(this.y),1/Math.cos(t*Math.PI/180));var t};var nl=function(t,e,r){this.z=t,this.x=e,this.y=r,this.key=yc(0,t,t,e,r)};nl.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},nl.prototype.url=function(t,e){var r,s,l,p,d,v=(s=this.y,l=this.z,p=Mp(256*(r=this.x),256*(s=Math.pow(2,l)-s-1),l),d=Mp(256*(r+1),256*(s+1),l),p[0]+","+p[1]+","+d[0]+","+d[1]),x=function(S,I,E){for(var k,R="",Z=S;Z>0;Z--)R+=(I&(k=1<<Z-1)?1:0)+(E&k?2:0);return R}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(e==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",x).replace("{bbox-epsg-3857}",v)},nl.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new Te(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},nl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Bp=function(t,e){this.wrap=t,this.canonical=e,this.key=yc(t,e.z,e.z,e.x,e.y)},Ln=function(t,e,r,s,l){this.overscaledZ=t,this.wrap=e,this.canonical=new nl(r,+s,+l),this.key=yc(e,t,r,s,l)};function yc(t,e,r,s,l){(t*=2)<0&&(t=-1*t-1);var p=1<<r;return(p*p*t+p*l+s).toString(36)+r.toString(36)+e.toString(36)}Ln.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Ln.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Ln(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ln(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Ln.prototype.calculateScaledKey=function(t,e){var r=this.canonical.z-t;return t>this.canonical.z?yc(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):yc(this.wrap*+e,t,t,this.canonical.x>>r,this.canonical.y>>r)},Ln.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Ln.prototype.children=function(t){if(this.overscaledZ>=t)return[new Ln(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,s=2*this.canonical.y;return[new Ln(e,this.wrap,e,r,s),new Ln(e,this.wrap,e,r+1,s),new Ln(e,this.wrap,e,r,s+1),new Ln(e,this.wrap,e,r+1,s+1)]},Ln.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Ln.prototype.wrapped=function(){return new Ln(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ln.prototype.unwrapTo=function(t){return new Ln(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Ln.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ln.prototype.toUnwrapped=function(){return new Bp(this.wrap,this.canonical)},Ln.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ln.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new rl(t.x-this.wrap,t.y))},mt("CanonicalTileID",nl),mt("OverscaledTileID",Ln,{omit:["posMatrix"]});var fs=function(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return Jr('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var s=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=r||"mapbox";for(var l=0;l<s;l++)this.data[this._idx(-1,l)]=this.data[this._idx(0,l)],this.data[this._idx(s,l)]=this.data[this._idx(s-1,l)],this.data[this._idx(l,-1)]=this.data[this._idx(l,0)],this.data[this._idx(l,s)]=this.data[this._idx(l,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)]};fs.prototype.get=function(t,e){var r=new Uint8Array(this.data.buffer),s=4*this._idx(t,e);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[s],r[s+1],r[s+2])},fs.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},fs.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},fs.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},fs.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},fs.prototype.getPixels=function(){return new Vi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},fs.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var s=e*this.dim,l=e*this.dim+this.dim,p=r*this.dim,d=r*this.dim+this.dim;switch(e){case-1:s=l-1;break;case 1:l=s+1}switch(r){case-1:p=d-1;break;case 1:d=p+1}for(var v=-e*this.dim,x=-r*this.dim,S=p;S<d;S++)for(var I=s;I<l;I++)this.data[this._idx(I,S)]=t.data[this._idx(I+v,S+x)]},mt("DEMData",fs);var Qc=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}};Qc.prototype.encode=function(t){return this._stringToNumber[t]},Qc.prototype.decode=function(t){return this._numberToString[t]};var il=function(t,e,r,s,l){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=s,this.properties=t.properties,this.id=l},Rh={geometry:{configurable:!0}};Rh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Rh.geometry.set=function(t){this._geometry=t},il.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)e!=="_geometry"&&e!=="_vectorTileFeature"&&(t[e]=this[e]);return t},Object.defineProperties(il.prototype,Rh);var Bl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Bl.prototype.updateState=function(t,e,r){var s=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][s]=this.stateChanges[t][s]||{},Zt(this.stateChanges[t][s],r),this.deletedStates[t]===null)for(var l in this.deletedStates[t]={},this.state[t])l!==s&&(this.deletedStates[t][l]=null);else if(this.deletedStates[t]&&this.deletedStates[t][s]===null)for(var p in this.deletedStates[t][s]={},this.state[t][s])r[p]||(this.deletedStates[t][s][p]=null);else for(var d in r)this.deletedStates[t]&&this.deletedStates[t][s]&&this.deletedStates[t][s][d]===null&&delete this.deletedStates[t][s][d]},Bl.prototype.removeFeatureState=function(t,e,r){if(this.deletedStates[t]!==null){var s=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&e!==void 0)this.deletedStates[t][s]!==null&&(this.deletedStates[t][s]=this.deletedStates[t][s]||{},this.deletedStates[t][s][r]=null);else if(e!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][s])for(r in this.deletedStates[t][s]={},this.stateChanges[t][s])this.deletedStates[t][s][r]=null;else this.deletedStates[t][s]=null;else this.deletedStates[t]=null}},Bl.prototype.getState=function(t,e){var r=String(e),s=Zt({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){var l=this.deletedStates[t][e];if(l===null)return{};for(var p in l)delete s[p]}return s},Bl.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Bl.prototype.coalesceChanges=function(t,e){var r={};for(var s in this.stateChanges){this.state[s]=this.state[s]||{};var l={};for(var p in this.stateChanges[s])this.state[s][p]||(this.state[s][p]={}),Zt(this.state[s][p],this.stateChanges[s][p]),l[p]=this.state[s][p];r[s]=l}for(var d in this.deletedStates){this.state[d]=this.state[d]||{};var v={};if(this.deletedStates[d]===null)for(var x in this.state[d])v[x]={},this.state[d][x]={};else for(var S in this.deletedStates[d]){if(this.deletedStates[d][S]===null)this.state[d][S]={};else for(var I=0,E=Object.keys(this.deletedStates[d][S]);I<E.length;I+=1)delete this.state[d][S][E[I]];v[S]=this.state[d][S]}r[d]=r[d]||{},Zt(r[d],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var k in t)t[k].setFeatureState(r,e)};var qs=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ut(8192,16,0),this.grid3D=new ut(8192,16,0),this.featureIndexArray=new B,this.promoteId=e};function Op(t,e,r,s,l){return On(t,function(p,d){var v=e instanceof Ci?e.get(d):null;return v&&v.evaluate?v.evaluate(r,s,l):v})}function Fp(t){for(var e=1/0,r=1/0,s=-1/0,l=-1/0,p=0,d=t;p<d.length;p+=1){var v=d[p];e=Math.min(e,v.x),r=Math.min(r,v.y),s=Math.max(s,v.x),l=Math.max(l,v.y)}return{minX:e,minY:r,maxX:s,maxY:l}}function Uf(t,e){return e-t}qs.prototype.insert=function(t,e,r,s,l,p){var d=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,s,l);for(var v=p?this.grid3D:this.grid,x=0;x<e.length;x++){for(var S=e[x],I=[1/0,1/0,-1/0,-1/0],E=0;E<S.length;E++){var k=S[E];I[0]=Math.min(I[0],k.x),I[1]=Math.min(I[1],k.y),I[2]=Math.max(I[2],k.x),I[3]=Math.max(I[3],k.y)}I[0]<8192&&I[1]<8192&&I[2]>=0&&I[3]>=0&&v.insert(d,I[0],I[1],I[2],I[3])}},qs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ps.VectorTile(new Ju(this.rawTileData)).layers,this.sourceLayerCoder=new Qc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},qs.prototype.query=function(t,e,r,s){var l=this;this.loadVTLayers();for(var p=t.params||{},d=8192/t.tileSize/t.scale,v=ta(p.filter),x=t.queryGeometry,S=t.queryPadding*d,I=Fp(x),E=this.grid.query(I.minX-S,I.minY-S,I.maxX+S,I.maxY+S),k=Fp(t.cameraQueryGeometry),R=this.grid3D.query(k.minX-S,k.minY-S,k.maxX+S,k.maxY+S,function(_t,xt,Pt,qt){return function(Yt,se,$t,fe,Qt){for(var Ue=0,be=Yt;Ue<be.length;Ue+=1){var ue=be[Ue];if(se<=ue.x&&$t<=ue.y&&fe>=ue.x&&Qt>=ue.y)return!0}var Ge=[new Te(se,$t),new Te(se,Qt),new Te(fe,Qt),new Te(fe,$t)];if(Yt.length>2){for(var Be=0,sr=Ge;Be<sr.length;Be+=1)if(to(Yt,sr[Be]))return!0}for(var me=0;me<Yt.length-1;me++)if(gu(Yt[me],Yt[me+1],Ge))return!0;return!1}(t.cameraQueryGeometry,_t-S,xt-S,Pt+S,qt+S)}),Z=0,j=R;Z<j.length;Z+=1)E.push(j[Z]);E.sort(Uf);for(var it,J={},pt=function(_t){var xt=E[_t];if(xt!==it){it=xt;var Pt=l.featureIndexArray.get(xt),qt=null;l.loadMatchingFeature(J,Pt.bucketIndex,Pt.sourceLayerIndex,Pt.featureIndex,v,p.layers,p.availableImages,e,r,s,function(Yt,se,$t){return qt||(qt=Vr(Yt)),se.queryIntersectsFeature(x,Yt,$t,qt,l.z,t.transform,d,t.pixelPosMatrix)})}},dt=0;dt<E.length;dt++)pt(dt);return J},qs.prototype.loadMatchingFeature=function(t,e,r,s,l,p,d,v,x,S,I){var E=this.bucketLayerIDs[e];if(!p||function(Yt,se){for(var $t=0;$t<Yt.length;$t++)if(se.indexOf(Yt[$t])>=0)return!0;return!1}(p,E)){var k=this.sourceLayerCoder.decode(r),R=this.vtLayers[k].feature(s);if(l.needGeometry){var Z=oi(R,!0);if(!l.filter(new Ee(this.tileID.overscaledZ),Z,this.tileID.canonical))return}else if(!l.filter(new Ee(this.tileID.overscaledZ),R))return;for(var j=this.getId(R,k),it=0;it<E.length;it++){var J=E[it];if(!(p&&p.indexOf(J)<0)){var pt=v[J];if(pt){var dt={};j!==void 0&&S&&(dt=S.getState(pt.sourceLayer||"_geojsonTileLayer",j));var _t=Zt({},x[J]);_t.paint=Op(_t.paint,pt.paint,R,dt,d),_t.layout=Op(_t.layout,pt.layout,R,dt,d);var xt=!I||I(R,pt,dt);if(xt){var Pt=new il(R,this.z,this.x,this.y,j);Pt.layer=_t;var qt=t[J];qt===void 0&&(qt=t[J]=[]),qt.push({featureIndex:s,feature:Pt,intersectionZ:xt})}}}}}},qs.prototype.lookupSymbolFeatures=function(t,e,r,s,l,p,d,v){var x={};this.loadVTLayers();for(var S=ta(l),I=0,E=t;I<E.length;I+=1)this.loadMatchingFeature(x,r,s,E[I],S,p,d,v,e);return x},qs.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var s=0,l=r[e];s<l.length;s+=1)if(t===l[s])return!0;return!1},qs.prototype.getId=function(t,e){var r=t.id;return this.promoteId&&typeof(r=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[e]])=="boolean"&&(r=Number(r)),r},mt("FeatureIndex",qs,{omit:["rawTileData","sourceLayerCoder"]});var Hn=function(t,e){this.tileID=t,this.uid=_e(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Hn.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<ci.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Hn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Hn.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var s in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(S,I){var E={};if(!I)return E;for(var k=function(){var j=Z[R],it=j.layerIds.map(function(dt){return I.getLayer(dt)}).filter(Boolean);if(it.length!==0){j.layers=it,j.stateDependentLayerIds&&(j.stateDependentLayers=j.stateDependentLayerIds.map(function(dt){return it.filter(function(_t){return _t.id===dt})[0]}));for(var J=0,pt=it;J<pt.length;J+=1)E[pt[J].id]=j}},R=0,Z=S;R<Z.length;R+=1)k();return E}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var l=this.buckets[s];if(l instanceof kr){if(this.hasSymbolBuckets=!0,!r)break;l.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var p in this.buckets){var d=this.buckets[p];if(d instanceof kr&&d.hasRTLText){this.hasRTLText=!0,he.isLoading()||he.isLoaded()||or()!=="deferred"||gn();break}}for(var v in this.queryPadding=0,this.buckets){var x=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(v).queryRadius(x))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new i},Hn.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hn.prototype.getBucket=function(t){return this.buckets[t.id]},Hn.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new el(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new el(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)},Hn.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Hn.prototype.queryRenderedFeatures=function(t,e,r,s,l,p,d,v,x,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:s,cameraQueryGeometry:l,scale:p,tileSize:this.tileSize,pixelPosMatrix:S,transform:v,params:d,queryPadding:this.queryPadding*x},t,e,r):{}},Hn.prototype.querySourceFeatures=function(t,e){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var s=r.loadVTLayers(),l=e?e.sourceLayer:"",p=s._geojsonTileLayer||s[l];if(p)for(var d=ta(e&&e.filter),v=this.tileID.canonical,x=v.z,S=v.x,I=v.y,E={z:x,x:S,y:I},k=0;k<p.length;k++){var R=p.feature(k);if(d.needGeometry){var Z=oi(R,!0);if(!d.filter(new Ee(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!d.filter(new Ee(this.tileID.overscaledZ),R))continue;var j=r.getId(R,l),it=new il(R,x,S,I,j);it.tile=E,t.push(it)}}},Hn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Hn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hn.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=Gi(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var s=Date.now(),l=!1;if(this.expirationTime>s)l=!1;else if(e)if(this.expirationTime<e)l=!0;else{var p=this.expirationTime-e;p?this.expirationTime=s+Math.max(p,3e4):l=!0}else l=!0;l?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Hn.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var s in this.buckets)if(e.style.hasLayer(s)){var l=this.buckets[s],p=l.layers[0].sourceLayer||"_geojsonTileLayer",d=r[p],v=t[p];if(d&&v&&Object.keys(v).length!==0){l.update(v,d,this.imageAtlas&&this.imageAtlas.patternPositions||{});var x=e&&e.style&&e.style.getLayer(s);x&&(this.queryPadding=Math.max(this.queryPadding,x.queryRadius(l)))}}}},Hn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Hn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ci.now()},Hn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hn.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=ci.now()+t},Hn.prototype.setDependencies=function(t,e){for(var r={},s=0,l=e;s<l.length;s+=1)r[l[s]]=!0;this.dependencies[t]=r},Hn.prototype.hasDependency=function(t,e){for(var r=0,s=t;r<s.length;r+=1){var l=this.dependencies[s[r]];if(l){for(var p=0,d=e;p<d.length;p+=1)if(l[d[p]])return!0}}return!1};var Iu=Et.performance,Up=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Iu.mark(this._marks.start)};Up.prototype.finish=function(){Iu.mark(this._marks.end);var t=Iu.getEntriesByName(this._marks.measure);return t.length===0&&(Iu.measure(this._marks.measure,this._marks.start,this._marks.end),t=Iu.getEntriesByName(this._marks.measure),Iu.clearMarks(this._marks.start),Iu.clearMarks(this._marks.end),Iu.clearMeasures(this._marks.measure)),t},h.Actor=Rl,h.AlphaImage=Hu,h.CanonicalTileID=nl,h.CollisionBoxArray=i,h.Color=Ye,h.DEMData=fs,h.DataConstantProperty=Kt,h.DictionaryCoder=Qc,h.EXTENT=8192,h.ErrorEvent=st,h.EvaluationParameters=Ee,h.Event=rt,h.Evented=nt,h.FeatureIndex=qs,h.FillBucket=xa,h.FillExtrusionBucket=Vo,h.ImageAtlas=zl,h.ImagePosition=Su,h.LineBucket=ki,h.LngLat=Hr,h.LngLatBounds=Mn,h.MercatorCoordinate=rl,h.ONE_EM=24,h.OverscaledTileID=Ln,h.Point=Te,h.Point$1=Te,h.Properties=$i,h.Protobuf=Ju,h.RGBAImage=Vi,h.RequestManager=dn,h.RequestPerformance=Up,h.ResourceType=Js,h.SegmentVector=O,h.SourceFeatureState=Bl,h.StructArrayLayout1ui2=Fo,h.StructArrayLayout2f1f2i16=tc,h.StructArrayLayout2i4=F,h.StructArrayLayout3ui6=_o,h.StructArrayLayout4i8=Qi,h.SymbolBucket=kr,h.Texture=el,h.Tile=Hn,h.Transitionable=ni,h.Uniform1f=Ut,h.Uniform1i=Vt,h.Uniform2f=Jt,h.Uniform3f=ae,h.Uniform4f=ve,h.UniformColor=de,h.UniformMatrix4f=te,h.UnwrappedTileID=Bp,h.ValidationError=Y,h.WritingMode=qo,h.ZoomHistory=Ie,h.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},h.addDynamicAttributes=kh,h.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var s=t.length,l=new Array(t.length),p=null;t.forEach(function(d,v){e(d,function(x,S){x&&(p=x),l[v]=S,--s==0&&r(p,l)})})},h.bezier=Zn,h.bindAll=Ai,h.browser=ci,h.cacheEntryPossiblyAdded=function(t){++za>$a&&(t.getActor().send("enforceCacheSizeLimit",oa),za=0)},h.clamp=Zr,h.clearTileCache=function(t){var e=Et.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},h.clipLine=bp,h.clone=function(t){var e=new ln(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},h.clone$1=ao,h.clone$2=function(t){var e=new ln(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},h.collisionCircleLayout=Ih,h.config=pr,h.create=function(){var t=new ln(16);return ln!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},h.create$1=function(){var t=new ln(9);return ln!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},h.create$2=function(){var t=new ln(4);return ln!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},h.createCommonjsModule=Ei,h.createExpression=cu,h.createLayout=yn,h.createStyleLayer=function(t){return t.type==="custom"?new Of(t):new Ff[t.type](t)},h.cross=function(t,e,r){var s=e[0],l=e[1],p=e[2],d=r[0],v=r[1],x=r[2];return t[0]=l*x-p*v,t[1]=p*d-s*x,t[2]=s*v-l*d,t},h.deepEqual=function t(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var s=0;s<e.length;s++)if(!t(e[s],r[s]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(var l in e)if(!t(e[l],r[l]))return!1;return!0}return e===r},h.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},h.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},h.ease=To,h.emitValidationErrors=ct,h.endsWith=oo,h.enforceCacheSizeLimit=function(t){co(),Hi&&Hi.then(function(e){e.keys().then(function(r){for(var s=0;s<r.length-t;s++)e.delete(r[s])})})},h.evaluateSizeForFeature=Tu,h.evaluateSizeForZoom=mp,h.evaluateVariableOffset=Tp,h.evented=Ir,h.extend=Zt,h.featureFilter=ta,h.filterObject=jo,h.fromRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=r,t[2]=0,t[3]=-r,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.getAnchorAlignment=Xc,h.getAnchorJustification=zh,h.getArrayBuffer=Gr,h.getImage=L,h.getJSON=function(t,e){return Qa(Zt(t,{type:"json"}),e)},h.getRTLTextPluginStatus=or,h.getReferrer=Ma,h.getVideo=function(t,e){var r,s,l=Et.document.createElement("video");l.muted=!0,l.onloadstart=function(){e(null,l)};for(var p=0;p<t.length;p++){var d=Et.document.createElement("source");r=t[p],s=void 0,(s=Et.document.createElement("a")).href=r,(s.protocol!==Et.document.location.protocol||s.host!==Et.document.location.host)&&(l.crossOrigin="Anonymous"),d.src=t[p],l.appendChild(d)}return{cancel:function(){}}},h.identity=bi,h.invert=function(t,e){var r=e[0],s=e[1],l=e[2],p=e[3],d=e[4],v=e[5],x=e[6],S=e[7],I=e[8],E=e[9],k=e[10],R=e[11],Z=e[12],j=e[13],it=e[14],J=e[15],pt=r*v-s*d,dt=r*x-l*d,_t=r*S-p*d,xt=s*x-l*v,Pt=s*S-p*v,qt=l*S-p*x,Yt=I*j-E*Z,se=I*it-k*Z,$t=I*J-R*Z,fe=E*it-k*j,Qt=E*J-R*j,Ue=k*J-R*it,be=pt*Ue-dt*Qt+_t*fe+xt*$t-Pt*se+qt*Yt;return be?(t[0]=(v*Ue-x*Qt+S*fe)*(be=1/be),t[1]=(l*Qt-s*Ue-p*fe)*be,t[2]=(j*qt-it*Pt+J*xt)*be,t[3]=(k*Pt-E*qt-R*xt)*be,t[4]=(x*$t-d*Ue-S*se)*be,t[5]=(r*Ue-l*$t+p*se)*be,t[6]=(it*_t-Z*qt-J*dt)*be,t[7]=(I*qt-k*_t+R*dt)*be,t[8]=(d*Qt-v*$t+S*Yt)*be,t[9]=(s*$t-r*Qt-p*Yt)*be,t[10]=(Z*Pt-j*_t+J*pt)*be,t[11]=(E*_t-I*Pt-R*pt)*be,t[12]=(v*se-d*fe-x*Yt)*be,t[13]=(r*fe-s*se+l*Yt)*be,t[14]=(j*dt-Z*xt-it*pt)*be,t[15]=(I*xt-E*dt+k*pt)*be,t):null},h.isChar=Dt,h.isMapboxURL=Fi,h.keysDifference=function(t,e){var r=[];for(var s in t)s in e||r.push(s);return r},h.makeRequest=Qa,h.mapObject=On,h.mercatorXfromLng=Lh,h.mercatorYfromLat=Dp,h.mercatorZfromAltitude=Rp,h.mul=ic,h.multiply=Rs,h.mvt=ps,h.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},h.normalize=function(t,e){var r=e[0],s=e[1],l=e[2],p=r*r+s*s+l*l;return p>0&&(p=1/Math.sqrt(p)),t[0]=e[0]*p,t[1]=e[1]*p,t[2]=e[2]*p,t},h.number=Wr,h.offscreenCanvasSupported=ka,h.ortho=function(t,e,r,s,l,p,d){var v=1/(e-r),x=1/(s-l),S=1/(p-d);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*x,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*S,t[11]=0,t[12]=(e+r)*v,t[13]=(l+s)*x,t[14]=(d+p)*S,t[15]=1,t},h.parseGlyphPBF=function(t){return new Ju(t).readFields(wf,[])},h.pbf=Ju,h.performSymbolLayout=function(t,e,r,s,l,p,d){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var v=t.layers[0].layout,x=t.layers[0]._unevaluatedLayout._values,S={};if(t.textSizeData.kind==="composite"){var I=t.textSizeData,E=I.maxZoom;S.compositeTextSizes=[x["text-size"].possiblyEvaluate(new Ee(I.minZoom),d),x["text-size"].possiblyEvaluate(new Ee(E),d)]}if(t.iconSizeData.kind==="composite"){var k=t.iconSizeData,R=k.maxZoom;S.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new Ee(k.minZoom),d),x["icon-size"].possiblyEvaluate(new Ee(R),d)]}S.layoutTextSize=x["text-size"].possiblyEvaluate(new Ee(t.zoom+1),d),S.layoutIconSize=x["icon-size"].possiblyEvaluate(new Ee(t.zoom+1),d),S.textMaxSize=x["text-size"].possiblyEvaluate(new Ee(18));for(var Z=24*v.get("text-line-height"),j=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point",it=v.get("text-keep-upright"),J=v.get("text-size"),pt=function(){var xt=_t[dt],Pt=v.get("text-font").evaluate(xt,{},d).join(","),qt=J.evaluate(xt,{},d),Yt=S.layoutTextSize.evaluate(xt,{},d),se=S.layoutIconSize.evaluate(xt,{},d),$t={horizontal:{},vertical:void 0},fe=xt.text,Qt=[0,0];if(fe){var Ue=fe.toString(),be=24*v.get("text-letter-spacing").evaluate(xt,{},d),ue=function($e){for(var Br=0,Ar=$e;Br<Ar.length;Br+=1)if(hr=Ar[Br].charCodeAt(0),Dt.Arabic(hr)||Dt["Arabic Supplement"](hr)||Dt["Arabic Extended-A"](hr)||Dt["Arabic Presentation Forms-A"](hr)||Dt["Arabic Presentation Forms-B"](hr))return!1;var hr;return!0}(Ue)?be:0,Ge=v.get("text-anchor").evaluate(xt,{},d),Be=v.get("text-variable-anchor");if(!Be){var sr=v.get("text-radial-offset").evaluate(xt,{},d);Qt=sr?Tp(Ge,[24*sr,Ch]):v.get("text-offset").evaluate(xt,{},d).map(function($e){return 24*$e})}var me=j?"center":v.get("text-justify").evaluate(xt,{},d),gr=v.get("symbol-placement"),Nr=gr==="point"?24*v.get("text-max-width").evaluate(xt,{},d):0,Kr=function(){t.allowVerticalPlacement&&Tr(Ue)&&($t.vertical=Gc(fe,e,r,l,Pt,Nr,Z,Ge,"left",ue,Qt,qo.vertical,!0,gr,Yt,qt))};if(!j&&Be){for(var rn=me==="auto"?Be.map(function($e){return zh($e)}):[me],Yr=!1,tn=0;tn<rn.length;tn++){var Dn=rn[tn];if(!$t.horizontal[Dn])if(Yr)$t.horizontal[Dn]=$t.horizontal[0];else{var qn=Gc(fe,e,r,l,Pt,Nr,Z,"center",Dn,ue,Qt,qo.horizontal,!1,gr,Yt,qt);qn&&($t.horizontal[Dn]=qn,Yr=qn.positionedLines.length===1)}}Kr()}else{me==="auto"&&(me=zh(Ge));var Li=Gc(fe,e,r,l,Pt,Nr,Z,Ge,me,ue,Qt,qo.horizontal,!1,gr,Yt,qt);Li&&($t.horizontal[me]=Li),Kr(),Tr(Ue)&&j&&it&&($t.vertical=Gc(fe,e,r,l,Pt,Nr,Z,Ge,me,ue,Qt,qo.vertical,!1,gr,Yt,qt))}}var Kn=void 0,Di=!1;if(xt.icon&&xt.icon.name){var xn=s[xt.icon.name];xn&&(Kn=function($e,Br,Ar){var hr=Xc(Ar),qi=Br[0]-$e.displaySize[0]*hr.horizontalAlign,wi=Br[1]-$e.displaySize[1]*hr.verticalAlign;return{image:$e,top:wi,bottom:wi+$e.displaySize[1],left:qi,right:qi+$e.displaySize[0]}}(l[xt.icon.name],v.get("icon-offset").evaluate(xt,{},d),v.get("icon-anchor").evaluate(xt,{},d)),Di=xn.sdf,t.sdfIcons===void 0?t.sdfIcons=xn.sdf:t.sdfIcons!==xn.sdf&&Jr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xn.pixelRatio!==t.pixelRatio||v.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}var Yn=Ep($t.horizontal)||$t.vertical;t.iconsInText=!!Yn&&Yn.iconsInText,(Yn||Kn)&&function($e,Br,Ar,hr,qi,wi,fr,In,Si,Qe,Ne){var Zo=wi.textMaxSize.evaluate(Br,{});Zo===void 0&&(Zo=fr);var Rn,tr=$e.layers[0].layout,ds=tr.get("icon-offset").evaluate(Br,{},Ne),Ti=Ep(Ar.horizontal),Ol=fr/24,ol=$e.tilePixelRatio*Ol,Fl=$e.tilePixelRatio*Zo/24,Zs=$e.tilePixelRatio*In,Ul=$e.tilePixelRatio*tr.get("symbol-spacing"),Nl=tr.get("text-padding")*$e.tilePixelRatio,Vl=tr.get("icon-padding")*$e.tilePixelRatio,ra=tr.get("text-max-angle")/180*Math.PI,vc=tr.get("text-rotation-alignment")==="map"&&tr.get("symbol-placement")!=="point",al=tr.get("icon-rotation-alignment")==="map"&&tr.get("symbol-placement")!=="point",qr=tr.get("symbol-placement"),hn=Ul/2,sl=tr.get("icon-text-fit");hr&&sl!=="none"&&($e.allowVerticalPlacement&&Ar.vertical&&(Rn=pc(hr,Ar.vertical,sl,tr.get("icon-text-fit-padding"),ds,Ol)),Ti&&(hr=pc(hr,Ti,sl,tr.get("icon-text-fit-padding"),ds,Ol)));var Eu=function(Ta,jl){jl.x<0||jl.x>=8192||jl.y<0||jl.y>=8192||function(bn,dr,Nf,Ws,Gl,Np,nh,ms,ih,Ec,oh,ah,Fh,Vp,Ac,qp,Zp,jp,sh,Gp,io,uh,Wp,gs,Ri){var So,cl,Wl,Xl,hl,Hl=bn.addToLineVertexArray(dr,Nf),Xp=0,Hp=0,Uh=0,Kp=0,Nh=-1,Vh=-1,ys={},qh=$(""),Zh=0,jh=0;if(ms._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Zh=(So=ms.layout.get("text-offset").evaluate(io,{},gs).map(function(zc){return 24*zc}))[0],jh=So[1]):(Zh=24*ms.layout.get("text-radial-offset").evaluate(io,{},gs),jh=Ch),bn.allowVerticalPlacement&&Ws.vertical){var Yp=ms.layout.get("text-rotate").evaluate(io,{},gs)+90;Xl=new dc(ih,dr,Ec,oh,ah,Ws.vertical,Fh,Vp,Ac,Yp),nh&&(hl=new dc(ih,dr,Ec,oh,ah,nh,Zp,jp,Ac,Yp))}if(Gl){var Gh=ms.layout.get("icon-rotate").evaluate(io,{}),pl=ms.layout.get("icon-text-fit")!=="none",Jp=wp(Gl,Gh,Wp,pl),Wh=nh?wp(nh,Gh,Wp,pl):void 0;Wl=new dc(ih,dr,Ec,oh,ah,Gl,Zp,jp,!1,Gh),Xp=4*Jp.length;var $p=bn.iconSizeData,Pc=null;$p.kind==="source"?(Pc=[128*ms.layout.get("icon-size").evaluate(io,{})])[0]>32640&&Jr(bn.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):$p.kind==="composite"&&((Pc=[128*uh.compositeIconSizes[0].evaluate(io,{},gs),128*uh.compositeIconSizes[1].evaluate(io,{},gs)])[0]>32640||Pc[1]>32640)&&Jr(bn.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),bn.addSymbols(bn.icon,Jp,Pc,Gp,sh,io,!1,dr,Hl.lineStartIndex,Hl.lineLength,-1,gs),Nh=bn.icon.placedSymbolArray.length-1,Wh&&(Hp=4*Wh.length,bn.addSymbols(bn.icon,Wh,Pc,Gp,sh,io,qo.vertical,dr,Hl.lineStartIndex,Hl.lineLength,-1,gs),Vh=bn.icon.placedSymbolArray.length-1)}for(var Qp in Ws.horizontal){var Cc=Ws.horizontal[Qp];if(!cl){qh=$(Cc.text);var tf=ms.layout.get("text-rotate").evaluate(io,{},gs);cl=new dc(ih,dr,Ec,oh,ah,Cc,Fh,Vp,Ac,tf)}var ef=Cc.positionedLines.length===1;if(Uh+=Ip(bn,dr,Cc,Np,ms,Ac,io,qp,Hl,Ws.vertical?qo.horizontal:qo.horizontalOnly,ef?Object.keys(Ws.horizontal):[Qp],ys,Nh,uh,gs),ef)break}Ws.vertical&&(Kp+=Ip(bn,dr,Ws.vertical,Np,ms,Ac,io,qp,Hl,qo.vertical,["vertical"],ys,Vh,uh,gs));var Vf=cl?cl.boxStartIndex:bn.collisionBoxArray.length,qf=cl?cl.boxEndIndex:bn.collisionBoxArray.length,Zf=Xl?Xl.boxStartIndex:bn.collisionBoxArray.length,jf=Xl?Xl.boxEndIndex:bn.collisionBoxArray.length,Gf=Wl?Wl.boxStartIndex:bn.collisionBoxArray.length,Wf=Wl?Wl.boxEndIndex:bn.collisionBoxArray.length,Xf=hl?hl.boxStartIndex:bn.collisionBoxArray.length,Hf=hl?hl.boxEndIndex:bn.collisionBoxArray.length,vs=-1,lh=function(zc,nf){return zc&&zc.circleDiameter?Math.max(zc.circleDiameter,nf):nf};vs=lh(cl,vs),vs=lh(Xl,vs),vs=lh(Wl,vs);var rf=(vs=lh(hl,vs))>-1?1:0;rf&&(vs*=Ri/24),bn.glyphOffsetArray.length>=kr.MAX_GLYPHS&&Jr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),io.sortKey!==void 0&&bn.addToSortKeyRanges(bn.symbolInstances.length,io.sortKey),bn.symbolInstances.emplaceBack(dr.x,dr.y,ys.right>=0?ys.right:-1,ys.center>=0?ys.center:-1,ys.left>=0?ys.left:-1,ys.vertical||-1,Nh,Vh,qh,Vf,qf,Zf,jf,Gf,Wf,Xf,Hf,Ec,Uh,Kp,Xp,Hp,rf,0,Fh,Zh,jh,vs)}($e,jl,Ta,Ar,hr,qi,Rn,$e.layers[0],$e.collisionBoxArray,Br.index,Br.sourceLayerIndex,$e.index,ol,Nl,vc,Si,Zs,Vl,al,ds,Br,wi,Qe,Ne,fr)};if(qr==="line")for(var ql=0,th=bp(Br.geometry,0,0,8192,8192);ql<th.length;ql+=1)for(var eh=th[ql],_c=0,xc=If(eh,Ul,ra,Ar.vertical||Ti,hr,24,Fl,$e.overscaling,8192);_c<xc.length;_c+=1){var bc=xc[_c];Ti&&Cf($e,Ti.text,hn,bc)||Eu(eh,bc)}else if(qr==="line-center")for(var js=0,ul=Br.geometry;js<ul.length;js+=1){var wc=ul[js];if(wc.length>1){var Sc=Tf(wc,ra,Ar.vertical||Ti,hr,24,Fl);Sc&&Eu(wc,Sc)}}else if(Br.type==="Polygon")for(var Gs=0,no=yh(Br.geometry,0);Gs<no.length;Gs+=1){var Ga=no[Gs],Tc=Af(Ga,16);Eu(Ga[0],new $u(Tc.x,Tc.y,0))}else if(Br.type==="LineString")for(var ll=0,Ic=Br.geometry;ll<Ic.length;ll+=1){var Zl=Ic[ll];Eu(Zl,new $u(Zl[0].x,Zl[0].y,0))}else if(Br.type==="Point")for(var Bh=0,Oh=Br.geometry;Bh<Oh.length;Bh+=1)for(var Wa=0,ur=Oh[Bh];Wa<ur.length;Wa+=1){var rh=ur[Wa];Eu([rh],new $u(rh.x,rh.y,0))}}(t,xt,$t,Kn,s,S,Yt,se,Qt,Di,d)},dt=0,_t=t.features;dt<_t.length;dt+=1)pt();p&&t.generateCollisionDebugBuffers()},h.perspective=function(t,e,r,s,l){var p,d=1/Math.tan(e/2);return t[0]=d/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,l!=null&&l!==1/0?(t[10]=(l+s)*(p=1/(s-l)),t[14]=2*l*s*p):(t[10]=-1,t[14]=-2*s),t},h.pick=function(t,e){for(var r={},s=0;s<e.length;s++){var l=e[s];l in t&&(r[l]=t[l])}return r},h.plugin=he,h.polygonIntersectsPolygon=zi,h.postMapLoadEvent=Pa,h.postTurnstileEvent=Wo,h.potpack=hp,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=mt,h.registerForPluginStateChange=function(t){return t({pluginStatus:ze,pluginURL:Oe}),Ir.on("pluginStateChange",t),t},h.renderColorRamp=Lc,h.rotate=function(t,e,r){var s=e[0],l=e[1],p=e[2],d=e[3],v=Math.sin(r),x=Math.cos(r);return t[0]=s*x+p*v,t[1]=l*x+d*v,t[2]=s*-v+p*x,t[3]=l*-v+d*x,t},h.rotateX=function(t,e,r){var s=Math.sin(r),l=Math.cos(r),p=e[4],d=e[5],v=e[6],x=e[7],S=e[8],I=e[9],E=e[10],k=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=p*l+S*s,t[5]=d*l+I*s,t[6]=v*l+E*s,t[7]=x*l+k*s,t[8]=S*l-p*s,t[9]=I*l-d*s,t[10]=E*l-v*s,t[11]=k*l-x*s,t},h.rotateZ=function(t,e,r){var s=Math.sin(r),l=Math.cos(r),p=e[0],d=e[1],v=e[2],x=e[3],S=e[4],I=e[5],E=e[6],k=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*l+S*s,t[1]=d*l+I*s,t[2]=v*l+E*s,t[3]=x*l+k*s,t[4]=S*l-p*s,t[5]=I*l-d*s,t[6]=E*l-v*s,t[7]=k*l-x*s,t},h.scale=function(t,e,r){var s=r[0],l=r[1],p=r[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*l,t[5]=e[5]*l,t[6]=e[6]*l,t[7]=e[7]*l,t[8]=e[8]*p,t[9]=e[9]*p,t[10]=e[10]*p,t[11]=e[11]*p,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},h.scale$1=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},h.scale$2=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},h.setCacheLimits=function(t,e){oa=t,$a=e},h.setRTLTextPlugin=function(t,e,r){if(r===void 0&&(r=!1),ze==="deferred"||ze==="loading"||ze==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Oe=ci.resolveURL(t),ze="deferred",De=e,Xr(),r||gn()},h.sphericalToCartesian=function(t){var e=t[0],r=t[1],s=t[2];return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(s),y:e*Math.sin(r)*Math.sin(s),z:e*Math.cos(s)}},h.sqrLen=function(t){var e=t[0],r=t[1];return e*e+r*r},h.styleSpec=V,h.sub=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},h.symbolSize=gp,h.transformMat3=function(t,e,r){var s=e[0],l=e[1],p=e[2];return t[0]=s*r[0]+l*r[3]+p*r[6],t[1]=s*r[1]+l*r[4]+p*r[7],t[2]=s*r[2]+l*r[5]+p*r[8],t},h.transformMat4=Gu,h.translate=function(t,e,r){var s,l,p,d,v,x,S,I,E,k,R,Z,j=r[0],it=r[1],J=r[2];return e===t?(t[12]=e[0]*j+e[4]*it+e[8]*J+e[12],t[13]=e[1]*j+e[5]*it+e[9]*J+e[13],t[14]=e[2]*j+e[6]*it+e[10]*J+e[14],t[15]=e[3]*j+e[7]*it+e[11]*J+e[15]):(l=e[1],p=e[2],d=e[3],v=e[4],x=e[5],S=e[6],I=e[7],E=e[8],k=e[9],R=e[10],Z=e[11],t[0]=s=e[0],t[1]=l,t[2]=p,t[3]=d,t[4]=v,t[5]=x,t[6]=S,t[7]=I,t[8]=E,t[9]=k,t[10]=R,t[11]=Z,t[12]=s*j+v*it+E*J+e[12],t[13]=l*j+x*it+k*J+e[13],t[14]=p*j+S*it+R*J+e[14],t[15]=d*j+I*it+Z*J+e[15]),t},h.triggerPluginCompletionEvent=zn,h.uniqueId=_e,h.validateCustomStyleLayer=function(t){var e=[],r=t.id;return r===void 0&&e.push({message:"layers."+r+': missing required property "id"'}),t.render===void 0&&e.push({message:"layers."+r+': missing required method "render"'}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),e},h.validateLight=P,h.validateStyle=w,h.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},h.vectorTile=ps,h.version="1.15.2",h.warnOnce=Jr,h.webpSupported=Wi,h.window=Et,h.wrap=Zi}),Au(["./shared"],function(h){function Ei(A){var M=typeof A;if(M==="number"||M==="boolean"||M==="string"||A==null)return JSON.stringify(A);if(Array.isArray(A)){for(var L="[",N=0,X=A;N<X.length;N+=1)L+=Ei(X[N])+",";return L+"]"}for(var rt=Object.keys(A).sort(),st="{",nt=0;nt<rt.length;nt++)st+=JSON.stringify(rt[nt])+":"+Ei(A[rt[nt]])+",";return st+"}"}function Bt(A){for(var M="",L=0,N=h.refProperties;L<N.length;L+=1)M+="/"+Ei(A[N[L]]);return M}var En=function(A){this.keyCache={},A&&this.replace(A)};En.prototype.replace=function(A){this._layerConfigs={},this._layers={},this.update(A,[])},En.prototype.update=function(A,M){for(var L=this,N=0,X=A;N<X.length;N+=1){var rt=X[N];this._layerConfigs[rt.id]=rt;var st=this._layers[rt.id]=h.createStyleLayer(rt);st._featureFilter=h.featureFilter(st.filter),this.keyCache[rt.id]&&delete this.keyCache[rt.id]}for(var nt=0,V=M;nt<V.length;nt+=1){var Y=V[nt];delete this.keyCache[Y],delete this._layerConfigs[Y],delete this._layers[Y]}this.familiesBySource={};for(var Lt=0,Wt=function(Ht,kt){for(var Me={},Le=0;Le<Ht.length;Le++){var ne=kt&&kt[Ht[Le].id]||Bt(Ht[Le]);kt&&(kt[Ht[Le].id]=ne);var _r=Me[ne];_r||(_r=Me[ne]=[]),_r.push(Ht[Le])}var we=[];for(var br in Me)we.push(Me[br]);return we}(h.values(this._layerConfigs),this.keyCache);Lt<Wt.length;Lt+=1){var vt=Wt[Lt].map(function(Ht){return L._layers[Ht.id]}),Rt=vt[0];if(Rt.visibility!=="none"){var ee=Rt.source||"",re=this.familiesBySource[ee];re||(re=this.familiesBySource[ee]={});var ce=Rt.sourceLayer||"_geojsonTileLayer",At=re[ce];At||(At=re[ce]=[]),At.push(vt)}}};var Te=function(A){var M={},L=[];for(var N in A){var X=A[N],rt=M[N]={};for(var st in X){var nt=X[+st];if(nt&&nt.bitmap.width!==0&&nt.bitmap.height!==0){var V={x:0,y:0,w:nt.bitmap.width+2,h:nt.bitmap.height+2};L.push(V),rt[st]={rect:V,metrics:nt.metrics}}}}var Y=h.potpack(L),Lt=new h.AlphaImage({width:Y.w||1,height:Y.h||1});for(var Wt in A){var vt=A[Wt];for(var Rt in vt){var ee=vt[+Rt];if(ee&&ee.bitmap.width!==0&&ee.bitmap.height!==0){var re=M[Wt][Rt].rect;h.AlphaImage.copy(ee.bitmap,Lt,{x:0,y:0},{x:re.x+1,y:re.y+1},ee.bitmap)}}}this.image=Lt,this.positions=M};h.register("GlyphAtlas",Te);var pn=function(A){this.tileID=new h.OverscaledTileID(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId};function Et(A,M,L){for(var N=new h.EvaluationParameters(M),X=0,rt=A;X<rt.length;X+=1)rt[X].recalculate(N,L)}function je(A,M){var L=h.getArrayBuffer(A.request,function(N,X,rt,st){N?M(N):X&&M(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(X)),rawData:X,cacheControl:rt,expires:st})});return function(){L.cancel(),M()}}pn.prototype.parse=function(A,M,L,N,X){var rt=this;this.status="parsing",this.data=A,this.collisionBoxArray=new h.CollisionBoxArray;var st=new h.DictionaryCoder(Object.keys(A.layers).sort()),nt=new h.FeatureIndex(this.tileID,this.promoteId);nt.bucketLayerIDs=[];var V,Y,Lt,Wt,vt={},Rt={featureIndex:nt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:L},ee=M.familiesBySource[this.source];for(var re in ee){var ce=A.layers[re];if(ce){ce.version===1&&h.warnOnce('Vector tile source "'+this.source+'" layer "'+re+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var At=st.encode(re),Ht=[],kt=0;kt<ce.length;kt++){var Me=ce.feature(kt),Le=nt.getId(Me,re);Ht.push({feature:Me,id:Le,index:kt,sourceLayerIndex:At})}for(var ne=0,_r=ee[re];ne<_r.length;ne+=1){var we=_r[ne],br=we[0];br.minzoom&&this.zoom<Math.floor(br.minzoom)||br.maxzoom&&this.zoom>=br.maxzoom||br.visibility!=="none"&&(Et(we,this.zoom,L),(vt[br.id]=br.createBucket({index:nt.bucketLayerIDs.length,layers:we,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:At,sourceID:this.source})).populate(Ht,Rt,this.tileID.canonical),nt.bucketLayerIDs.push(we.map(function(Sr){return Sr.id})))}}}var Mr=h.mapObject(Rt.glyphDependencies,function(Sr){return Object.keys(Sr).map(Number)});Object.keys(Mr).length?N.send("getGlyphs",{uid:this.uid,stacks:Mr},function(Sr,Ve){V||(V=Sr,Y=Ve,Fr.call(rt))}):Y={};var rr=Object.keys(Rt.iconDependencies);rr.length?N.send("getImages",{icons:rr,source:this.source,tileID:this.tileID,type:"icons"},function(Sr,Ve){V||(V=Sr,Lt=Ve,Fr.call(rt))}):Lt={};var wr=Object.keys(Rt.patternDependencies);function Fr(){if(V)return X(V);if(Y&&Lt&&Wt){var Sr=new Te(Y),Ve=new h.ImageAtlas(Lt,Wt);for(var ts in vt){var Ye=vt[ts];Ye instanceof h.SymbolBucket?(Et(Ye.layers,this.zoom,L),h.performSymbolLayout(Ye,Y,Sr.positions,Lt,Ve.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ye.hasPattern&&(Ye instanceof h.LineBucket||Ye instanceof h.FillBucket||Ye instanceof h.FillExtrusionBucket)&&(Et(Ye.layers,this.zoom,L),Ye.addFeatures(Rt,this.tileID.canonical,Ve.patternPositions))}this.status="done",X(null,{buckets:h.values(vt).filter(function(Da){return!Da.isEmpty()}),featureIndex:nt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Sr.image,imageAtlas:Ve,glyphMap:this.returnDependencies?Y:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?Sr.positions:null})}}wr.length?N.send("getImages",{icons:wr,source:this.source,tileID:this.tileID,type:"patterns"},function(Sr,Ve){V||(V=Sr,Wt=Ve,Fr.call(rt))}):Wt={},Fr.call(this)};var Zn=function(A,M,L,N){this.actor=A,this.layerIndex=M,this.availableImages=L,this.loadVectorData=N||je,this.loading={},this.loaded={}};Zn.prototype.loadTile=function(A,M){var L=this,N=A.uid;this.loading||(this.loading={});var X=!!(A&&A.request&&A.request.collectResourceTiming)&&new h.RequestPerformance(A.request),rt=this.loading[N]=new pn(A);rt.abort=this.loadVectorData(A,function(st,nt){if(delete L.loading[N],st||!nt)return rt.status="done",L.loaded[N]=rt,M(st);var V=nt.rawData,Y={};nt.expires&&(Y.expires=nt.expires),nt.cacheControl&&(Y.cacheControl=nt.cacheControl);var Lt={};if(X){var Wt=X.finish();Wt&&(Lt.resourceTiming=JSON.parse(JSON.stringify(Wt)))}rt.vectorTile=nt.vectorTile,rt.parse(nt.vectorTile,L.layerIndex,L.availableImages,L.actor,function(vt,Rt){if(vt||!Rt)return M(vt);M(null,h.extend({rawTileData:V.slice(0)},Rt,Y,Lt))}),L.loaded=L.loaded||{},L.loaded[N]=rt})},Zn.prototype.reloadTile=function(A,M){var L=this,N=this.loaded,X=A.uid,rt=this;if(N&&N[X]){var st=N[X];st.showCollisionBoxes=A.showCollisionBoxes;var nt=function(V,Y){var Lt=st.reloadCallback;Lt&&(delete st.reloadCallback,st.parse(st.vectorTile,rt.layerIndex,L.availableImages,rt.actor,Lt)),M(V,Y)};st.status==="parsing"?st.reloadCallback=nt:st.status==="done"&&(st.vectorTile?st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,nt):nt())}},Zn.prototype.abortTile=function(A,M){var L=this.loading,N=A.uid;L&&L[N]&&L[N].abort&&(L[N].abort(),delete L[N]),M()},Zn.prototype.removeTile=function(A,M){var L=this.loaded,N=A.uid;L&&L[N]&&delete L[N],M()};var To=h.window.ImageBitmap,Zr=function(){this.loaded={}};function Zi(A,M){if(A.length!==0){Zt(A[0],M);for(var L=1;L<A.length;L++)Zt(A[L],!M)}}function Zt(A,M){for(var L=0,N=0,X=A.length,rt=X-1;N<X;rt=N++)L+=(A[N][0]-A[rt][0])*(A[rt][1]+A[N][1]);L>=0!=!!M&&A.reverse()}Zr.prototype.loadTile=function(A,M){var L=A.uid,N=A.encoding,X=A.rawImageData,rt=To&&X instanceof To?this.getImageData(X):X,st=new h.DEMData(L,rt,N);this.loaded=this.loaded||{},this.loaded[L]=st,M(null,st)},Zr.prototype.getImageData=function(A){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(A.width,A.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=A.width,this.offscreenCanvas.height=A.height,this.offscreenCanvasContext.drawImage(A,0,0,A.width,A.height);var M=this.offscreenCanvasContext.getImageData(-1,-1,A.width+2,A.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:M.width,height:M.height},M.data)},Zr.prototype.removeTile=function(A){var M=this.loaded,L=A.uid;M&&M[L]&&delete M[L]};var Jn=h.vectorTile.VectorTileFeature.prototype.toGeoJSON,_e=function(A){this._feature=A,this.extent=h.EXTENT,this.type=A.type,this.properties=A.tags,"id"in A&&!isNaN(A.id)&&(this.id=parseInt(A.id,10))};_e.prototype.loadGeometry=function(){if(this._feature.type===1){for(var A=[],M=0,L=this._feature.geometry;M<L.length;M+=1){var N=L[M];A.push([new h.Point$1(N[0],N[1])])}return A}for(var X=[],rt=0,st=this._feature.geometry;rt<st.length;rt+=1){for(var nt=[],V=0,Y=st[rt];V<Y.length;V+=1){var Lt=Y[V];nt.push(new h.Point$1(Lt[0],Lt[1]))}X.push(nt)}return X},_e.prototype.toGeoJSON=function(A,M,L){return Jn.call(this,A,M,L)};var Bn=function(A){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=A.length,this._features=A};Bn.prototype.feature=function(A){return new _e(this._features[A])};var ji=h.vectorTile.VectorTileFeature,Ai=oo;function oo(A,M){this.options=M||{},this.features=A,this.length=A.length}function On(A,M){this.id=typeof A.id=="number"?A.id:void 0,this.type=A.type,this.rawGeometry=A.type===1?[A.geometry]:A.geometry,this.properties=A.tags,this.extent=M||4096}oo.prototype.feature=function(A){return new On(this.features[A],this.options.extent)},On.prototype.loadGeometry=function(){var A=this.rawGeometry;this.geometry=[];for(var M=0;M<A.length;M++){for(var L=A[M],N=[],X=0;X<L.length;X++)N.push(new h.Point$1(L[X][0],L[X][1]));this.geometry.push(N)}return this.geometry},On.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var A=this.geometry,M=1/0,L=-1/0,N=1/0,X=-1/0,rt=0;rt<A.length;rt++)for(var st=A[rt],nt=0;nt<st.length;nt++){var V=st[nt];M=Math.min(M,V.x),L=Math.max(L,V.x),N=Math.min(N,V.y),X=Math.max(X,V.y)}return[M,N,L,X]},On.prototype.toGeoJSON=ji.prototype.toGeoJSON;var jo=Ka,ao=Ai;function Ka(A){var M=new h.pbf;return function(L,N){for(var X in L.layers)N.writeMessage(3,Jr,L.layers[X])}(A,M),M.finish()}function Jr(A,M){var L;M.writeVarintField(15,A.version||1),M.writeStringField(1,A.name||""),M.writeVarintField(5,A.extent||4096);var N={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<A.length;L++)N.feature=A.feature(L),M.writeMessage(2,ui,N);var X=N.keys;for(L=0;L<X.length;L++)M.writeStringField(3,X[L]);var rt=N.values;for(L=0;L<rt.length;L++)M.writeMessage(4,Ys,rt[L])}function ui(A,M){var L=A.feature;L.id!==void 0&&M.writeVarintField(1,L.id),M.writeMessage(2,Ks,A),M.writeVarintField(3,L.type),M.writeMessage(4,Bi,L)}function Ks(A,M){var L=A.feature,N=A.keys,X=A.values,rt=A.keycache,st=A.valuecache;for(var nt in L.properties){var V=rt[nt];V===void 0&&(N.push(nt),rt[nt]=V=N.length-1),M.writeVarint(V);var Y=L.properties[nt],Lt=typeof Y;Lt!=="string"&&Lt!=="boolean"&&Lt!=="number"&&(Y=JSON.stringify(Y));var Wt=Lt+":"+Y,vt=st[Wt];vt===void 0&&(X.push(Y),st[Wt]=vt=X.length-1),M.writeVarint(vt)}}function li(A,M){return(M<<3)+(7&A)}function Gi(A){return A<<1^A>>31}function Bi(A,M){for(var L=A.loadGeometry(),N=A.type,X=0,rt=0,st=L.length,nt=0;nt<st;nt++){var V=L[nt],Y=1;N===1&&(Y=V.length),M.writeVarint(li(1,Y));for(var Lt=N===3?V.length-1:V.length,Wt=0;Wt<Lt;Wt++){Wt===1&&N!==1&&M.writeVarint(li(2,Lt-1));var vt=V[Wt].x-X,Rt=V[Wt].y-rt;M.writeVarint(Gi(vt)),M.writeVarint(Gi(Rt)),X+=vt,rt+=Rt}N===3&&M.writeVarint(li(7,1))}}function Ys(A,M){var L=typeof A;L==="string"?M.writeStringField(1,A):L==="boolean"?M.writeBooleanField(7,A):L==="number"&&(A%1!=0?M.writeDoubleField(3,A):A<0?M.writeSVarintField(6,A):M.writeVarintField(5,A))}function so(A,M,L,N){fn(A,L,N),fn(M,2*L,2*N),fn(M,2*L+1,2*N+1)}function fn(A,M,L){var N=A[M];A[M]=A[L],A[L]=N}function Io(A,M,L,N){var X=A-L,rt=M-N;return X*X+rt*rt}jo.fromVectorTileJs=Ka,jo.fromGeojsonVt=function(A,M){M=M||{};var L={};for(var N in A)L[N]=new Ai(A[N].features,M),L[N].name=N,L[N].version=M.version,L[N].extent=M.extent;return Ka({layers:L})},jo.GeoJSONWrapper=ao;var Ea=function(A){return A[0]},Go=function(A){return A[1]},Oi=function(A,M,L,N,X){M===void 0&&(M=Ea),L===void 0&&(L=Go),N===void 0&&(N=64),X===void 0&&(X=Float64Array),this.nodeSize=N,this.points=A;for(var rt=A.length<65536?Uint16Array:Uint32Array,st=this.ids=new rt(A.length),nt=this.coords=new X(2*A.length),V=0;V<A.length;V++)st[V]=V,nt[2*V]=M(A[V]),nt[2*V+1]=L(A[V]);(function Y(Lt,Wt,vt,Rt,ee,re){if(!(ee-Rt<=vt)){var ce=Rt+ee>>1;(function At(Ht,kt,Me,Le,ne,_r){for(;ne>Le;){if(ne-Le>600){var we=ne-Le+1,br=Me-Le+1,Mr=Math.log(we),rr=.5*Math.exp(2*Mr/3),wr=.5*Math.sqrt(Mr*rr*(we-rr)/we)*(br-we/2<0?-1:1);At(Ht,kt,Me,Math.max(Le,Math.floor(Me-br*rr/we+wr)),Math.min(ne,Math.floor(Me+(we-br)*rr/we+wr)),_r)}var Fr=kt[2*Me+_r],Sr=Le,Ve=ne;for(so(Ht,kt,Le,Me),kt[2*ne+_r]>Fr&&so(Ht,kt,Le,ne);Sr<Ve;){for(so(Ht,kt,Sr,Ve),Sr++,Ve--;kt[2*Sr+_r]<Fr;)Sr++;for(;kt[2*Ve+_r]>Fr;)Ve--}kt[2*Le+_r]===Fr?so(Ht,kt,Le,Ve):so(Ht,kt,++Ve,ne),Ve<=Me&&(Le=Ve+1),Me<=Ve&&(ne=Ve-1)}})(Lt,Wt,ce,Rt,ee,re%2),Y(Lt,Wt,vt,Rt,ce-1,re+1),Y(Lt,Wt,vt,ce+1,ee,re+1)}})(st,nt,N,0,st.length-1,0)};Oi.prototype.range=function(A,M,L,N){return function(X,rt,st,nt,V,Y,Lt){for(var Wt,vt,Rt=[0,X.length-1,0],ee=[];Rt.length;){var re=Rt.pop(),ce=Rt.pop(),At=Rt.pop();if(ce-At<=Lt)for(var Ht=At;Ht<=ce;Ht++)vt=rt[2*Ht+1],(Wt=rt[2*Ht])>=st&&Wt<=V&&vt>=nt&&vt<=Y&&ee.push(X[Ht]);else{var kt=Math.floor((At+ce)/2);vt=rt[2*kt+1],(Wt=rt[2*kt])>=st&&Wt<=V&&vt>=nt&&vt<=Y&&ee.push(X[kt]);var Me=(re+1)%2;(re===0?st<=Wt:nt<=vt)&&(Rt.push(At),Rt.push(kt-1),Rt.push(Me)),(re===0?V>=Wt:Y>=vt)&&(Rt.push(kt+1),Rt.push(ce),Rt.push(Me))}}return ee}(this.ids,this.coords,A,M,L,N,this.nodeSize)},Oi.prototype.within=function(A,M,L){return function(N,X,rt,st,nt,V){for(var Y=[0,N.length-1,0],Lt=[],Wt=nt*nt;Y.length;){var vt=Y.pop(),Rt=Y.pop(),ee=Y.pop();if(Rt-ee<=V)for(var re=ee;re<=Rt;re++)Io(X[2*re],X[2*re+1],rt,st)<=Wt&&Lt.push(N[re]);else{var ce=Math.floor((ee+Rt)/2),At=X[2*ce],Ht=X[2*ce+1];Io(At,Ht,rt,st)<=Wt&&Lt.push(N[ce]);var kt=(vt+1)%2;(vt===0?rt-nt<=At:st-nt<=Ht)&&(Y.push(ee),Y.push(ce-1),Y.push(kt)),(vt===0?rt+nt>=At:st+nt>=Ht)&&(Y.push(ce+1),Y.push(Rt),Y.push(kt))}}return Lt}(this.ids,this.coords,A,M,L,this.nodeSize)};var Ya={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(A){return A}},$n=function(A){this.options=An(Object.create(Ya),A),this.trees=new Array(this.options.maxZoom+1)};function ci(A,M,L,N,X){return{x:A,y:M,zoom:1/0,id:L,parentId:-1,numPoints:N,properties:X}}function pr(A,M){var L=A.geometry.coordinates,N=L[1];return{x:hi(L[0]),y:He(N),zoom:1/0,index:M,parentId:-1}}function Wi(A){return{type:"Feature",id:A.id,properties:Eo(A),geometry:{type:"Point",coordinates:[(N=A.x,360*(N-.5)),(M=A.y,L=(180-360*M)*Math.PI/180,360*Math.atan(Math.exp(L))/Math.PI-90)]}};var M,L,N}function Eo(A){var M=A.numPoints,L=M>=1e4?Math.round(M/1e3)+"k":M>=1e3?Math.round(M/100)/10+"k":M;return An(An({},A.properties),{cluster:!0,cluster_id:A.id,point_count:M,point_count_abbreviated:L})}function hi(A){return A/360+.5}function He(A){var M=Math.sin(A*Math.PI/180),L=.5-.25*Math.log((1+M)/(1-M))/Math.PI;return L<0?0:L>1?1:L}function An(A,M){for(var L in M)A[L]=M[L];return A}function dn(A){return A.x}function Fi(A){return A.y}function Xi(A,M,L,N,X,rt){var st=X-L,nt=rt-N;if(st!==0||nt!==0){var V=((A-L)*st+(M-N)*nt)/(st*st+nt*nt);V>1?(L=X,N=rt):V>0&&(L+=st*V,N+=nt*V)}return(st=A-L)*st+(nt=M-N)*nt}function Ui(A,M,L,N){var X={id:A===void 0?null:A,type:M,geometry:L,tags:N,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(rt){var st=rt.geometry,nt=rt.type;if(nt==="Point"||nt==="MultiPoint"||nt==="LineString")Ja(rt,st);else if(nt==="Polygon"||nt==="MultiLineString")for(var V=0;V<st.length;V++)Ja(rt,st[V]);else if(nt==="MultiPolygon")for(V=0;V<st.length;V++)for(var Y=0;Y<st[V].length;Y++)Ja(rt,st[V][Y])}(X),X}function Ja(A,M){for(var L=0;L<M.length;L+=3)A.minX=Math.min(A.minX,M[L]),A.minY=Math.min(A.minY,M[L+1]),A.maxX=Math.max(A.maxX,M[L]),A.maxY=Math.max(A.maxY,M[L+1])}function Qn(A,M,L,N){if(M.geometry){var X=M.geometry.coordinates,rt=M.geometry.type,st=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),nt=[],V=M.id;if(L.promoteId?V=M.properties[L.promoteId]:L.generateId&&(V=N||0),rt==="Point")jn(X,nt);else if(rt==="MultiPoint")for(var Y=0;Y<X.length;Y++)jn(X[Y],nt);else if(rt==="LineString")Ao(X,nt,st,!1);else if(rt==="MultiLineString"){if(L.lineMetrics){for(Y=0;Y<X.length;Y++)Ao(X[Y],nt=[],st,!1),A.push(Ui(V,"LineString",nt,M.properties));return}pi(X,nt,st,!1)}else if(rt==="Polygon")pi(X,nt,st,!0);else{if(rt!=="MultiPolygon"){if(rt==="GeometryCollection"){for(Y=0;Y<M.geometry.geometries.length;Y++)Qn(A,{id:V,geometry:M.geometry.geometries[Y],properties:M.properties},L,N);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Y=0;Y<X.length;Y++){var Lt=[];pi(X[Y],Lt,st,!0),nt.push(Lt)}}A.push(Ui(V,rt,nt,M.properties))}}function jn(A,M){M.push(Hi(A[0])),M.push(uo(A[1])),M.push(0)}function Ao(A,M,L,N){for(var X,rt,st=0,nt=0;nt<A.length;nt++){var V=Hi(A[nt][0]),Y=uo(A[nt][1]);M.push(V),M.push(Y),M.push(0),nt>0&&(st+=N?(X*Y-V*rt)/2:Math.sqrt(Math.pow(V-X,2)+Math.pow(Y-rt,2))),X=V,rt=Y}var Lt=M.length-3;M[2]=1,function Wt(vt,Rt,ee,re){for(var ce,At=re,Ht=ee-Rt>>1,kt=ee-Rt,Me=vt[Rt],Le=vt[Rt+1],ne=vt[ee],_r=vt[ee+1],we=Rt+3;we<ee;we+=3){var br=Xi(vt[we],vt[we+1],Me,Le,ne,_r);if(br>At)ce=we,At=br;else if(br===At){var Mr=Math.abs(we-Ht);Mr<kt&&(ce=we,kt=Mr)}}At>re&&(ce-Rt>3&&Wt(vt,Rt,ce,re),vt[ce+2]=At,ee-ce>3&&Wt(vt,ce,ee,re))}(M,0,Lt,L),M[Lt+2]=1,M.size=Math.abs(st),M.start=0,M.end=M.size}function pi(A,M,L,N){for(var X=0;X<A.length;X++){var rt=[];Ao(A[X],rt,L,N),M.push(rt)}}function Hi(A){return A/360+.5}function uo(A){var M=Math.sin(A*Math.PI/180),L=.5-.25*Math.log((1+M)/(1-M))/Math.PI;return L<0?0:L>1?1:L}function lo(A,M,L,N,X,rt,st,nt){if(N/=M,rt>=(L/=M)&&st<N)return A;if(st<L||rt>=N)return null;for(var V=[],Y=0;Y<A.length;Y++){var Lt=A[Y],Wt=Lt.geometry,vt=Lt.type,Rt=X===0?Lt.minX:Lt.minY,ee=X===0?Lt.maxX:Lt.maxY;if(Rt>=L&&ee<N)V.push(Lt);else if(!(ee<L||Rt>=N)){var re=[];if(vt==="Point"||vt==="MultiPoint")ia(Wt,re,L,N,X);else if(vt==="LineString")Wo(Wt,re,L,N,X,!1,nt.lineMetrics);else if(vt==="MultiLineString")Pa(Wt,re,L,N,X,!1);else if(vt==="Polygon")Pa(Wt,re,L,N,X,!0);else if(vt==="MultiPolygon")for(var ce=0;ce<Wt.length;ce++){var At=[];Pa(Wt[ce],At,L,N,X,!0),At.length&&re.push(At)}if(re.length){if(nt.lineMetrics&&vt==="LineString"){for(ce=0;ce<re.length;ce++)V.push(Ui(Lt.id,vt,re[ce],Lt.tags));continue}vt!=="LineString"&&vt!=="MultiLineString"||(re.length===1?(vt="LineString",re=re[0]):vt="MultiLineString"),vt!=="Point"&&vt!=="MultiPoint"||(vt=re.length===3?"Point":"MultiPoint"),V.push(Ui(Lt.id,vt,re,Lt.tags))}}}return V.length?V:null}function ia(A,M,L,N,X){for(var rt=0;rt<A.length;rt+=3){var st=A[rt+X];st>=L&&st<=N&&(M.push(A[rt]),M.push(A[rt+1]),M.push(A[rt+2]))}}function Wo(A,M,L,N,X,rt,st){for(var nt,V,Y=Aa(A),Lt=X===0?$a:co,Wt=A.start,vt=0;vt<A.length-3;vt+=3){var Rt=A[vt],ee=A[vt+1],re=A[vt+2],ce=A[vt+3],At=A[vt+4],Ht=X===0?Rt:ee,kt=X===0?ce:At,Me=!1;st&&(nt=Math.sqrt(Math.pow(Rt-ce,2)+Math.pow(ee-At,2))),Ht<L?kt>L&&(V=Lt(Y,Rt,ee,ce,At,L),st&&(Y.start=Wt+nt*V)):Ht>N?kt<N&&(V=Lt(Y,Rt,ee,ce,At,N),st&&(Y.start=Wt+nt*V)):oa(Y,Rt,ee,re),kt<L&&Ht>=L&&(V=Lt(Y,Rt,ee,ce,At,L),Me=!0),kt>N&&Ht<=N&&(V=Lt(Y,Rt,ee,ce,At,N),Me=!0),!rt&&Me&&(st&&(Y.end=Wt+nt*V),M.push(Y),Y=Aa(A)),st&&(Wt+=nt)}var Le=A.length-3;Rt=A[Le],ee=A[Le+1],re=A[Le+2],(Ht=X===0?Rt:ee)>=L&&Ht<=N&&oa(Y,Rt,ee,re),Le=Y.length-3,rt&&Le>=3&&(Y[Le]!==Y[0]||Y[Le+1]!==Y[1])&&oa(Y,Y[0],Y[1],Y[2]),Y.length&&M.push(Y)}function Aa(A){var M=[];return M.size=A.size,M.start=A.start,M.end=A.end,M}function Pa(A,M,L,N,X,rt){for(var st=0;st<A.length;st++)Wo(A[st],M,L,N,X,rt,!1)}function oa(A,M,L,N){A.push(M),A.push(L),A.push(N)}function $a(A,M,L,N,X,rt){var st=(rt-M)/(N-M);return A.push(rt),A.push(L+(X-L)*st),A.push(1),st}function co(A,M,L,N,X,rt){var st=(rt-L)/(X-L);return A.push(M+(N-M)*st),A.push(rt),A.push(1),st}function Ca(A,M){for(var L=[],N=0;N<A.length;N++){var X,rt=A[N],st=rt.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")X=Po(rt.geometry,M);else if(st==="MultiLineString"||st==="Polygon"){X=[];for(var nt=0;nt<rt.geometry.length;nt++)X.push(Po(rt.geometry[nt],M))}else if(st==="MultiPolygon")for(X=[],nt=0;nt<rt.geometry.length;nt++){for(var V=[],Y=0;Y<rt.geometry[nt].length;Y++)V.push(Po(rt.geometry[nt][Y],M));X.push(V)}L.push(Ui(rt.id,st,X,rt.tags))}return L}function Po(A,M){var L=[];L.size=A.size,A.start!==void 0&&(L.start=A.start,L.end=A.end);for(var N=0;N<A.length;N+=3)L.push(A[N]+M,A[N+1],A[N+2]);return L}function za(A,M){if(A.transformed)return A;var L,N,X,rt=1<<A.z,st=A.x,nt=A.y;for(L=0;L<A.features.length;L++){var V=A.features[L],Y=V.geometry,Lt=V.type;if(V.geometry=[],Lt===1)for(N=0;N<Y.length;N+=2)V.geometry.push(ka(Y[N],Y[N+1],M,rt,st,nt));else for(N=0;N<Y.length;N++){var Wt=[];for(X=0;X<Y[N].length;X+=2)Wt.push(ka(Y[N][X],Y[N][X+1],M,rt,st,nt));V.geometry.push(Wt)}}return A.transformed=!0,A}function ka(A,M,L,N,X,rt){return[Math.round(L*(A*N-X)),Math.round(L*(M*N-rt))]}function Js(A,M,L,N,X){for(var rt=M===X.maxZoom?0:X.tolerance/((1<<M)*X.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:L,y:N,z:M,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},nt=0;nt<A.length;nt++){st.numFeatures++,xs(st,A[nt],rt,X);var V=A[nt].minX,Y=A[nt].minY,Lt=A[nt].maxX,Wt=A[nt].maxY;V<st.minX&&(st.minX=V),Y<st.minY&&(st.minY=Y),Lt>st.maxX&&(st.maxX=Lt),Wt>st.maxY&&(st.maxY=Wt)}return st}function xs(A,M,L,N){var X=M.geometry,rt=M.type,st=[];if(rt==="Point"||rt==="MultiPoint")for(var nt=0;nt<X.length;nt+=3)st.push(X[nt]),st.push(X[nt+1]),A.numPoints++,A.numSimplified++;else if(rt==="LineString")Ma(st,X,A,L,!1,!1);else if(rt==="MultiLineString"||rt==="Polygon")for(nt=0;nt<X.length;nt++)Ma(st,X[nt],A,L,rt==="Polygon",nt===0);else if(rt==="MultiPolygon")for(var V=0;V<X.length;V++){var Y=X[V];for(nt=0;nt<Y.length;nt++)Ma(st,Y[nt],A,L,!0,nt===0)}if(st.length){var Lt=M.tags||null;if(rt==="LineString"&&N.lineMetrics){for(var Wt in Lt={},M.tags)Lt[Wt]=M.tags[Wt];Lt.mapbox_clip_start=X.start/X.size,Lt.mapbox_clip_end=X.end/X.size}var vt={geometry:st,type:rt==="Polygon"||rt==="MultiPolygon"?3:rt==="LineString"||rt==="MultiLineString"?2:1,tags:Lt};M.id!==null&&(vt.id=M.id),A.features.push(vt)}}function Ma(A,M,L,N,X,rt){var st=N*N;if(N>0&&M.size<(X?st:N))L.numPoints+=M.length/3;else{for(var nt=[],V=0;V<M.length;V+=3)(N===0||M[V+2]>st)&&(L.numSimplified++,nt.push(M[V]),nt.push(M[V+1])),L.numPoints++;X&&function(Y,Lt){for(var Wt=0,vt=0,Rt=Y.length,ee=Rt-2;vt<Rt;ee=vt,vt+=2)Wt+=(Y[vt]-Y[ee])*(Y[vt+1]+Y[ee+1]);if(Wt>0===Lt)for(vt=0,Rt=Y.length;vt<Rt/2;vt+=2){var re=Y[vt],ce=Y[vt+1];Y[vt]=Y[Rt-2-vt],Y[vt+1]=Y[Rt-1-vt],Y[Rt-2-vt]=re,Y[Rt-1-vt]=ce}}(nt,rt),A.push(nt)}}function aa(A,M){var L=(M=this.options=function(X,rt){for(var st in rt)X[st]=rt[st];return X}(Object.create(this.options),M)).debug;if(L&&console.time("preprocess data"),M.maxZoom<0||M.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(M.promoteId&&M.generateId)throw new Error("promoteId and generateId cannot be used together.");var N=function(X,rt){var st=[];if(X.type==="FeatureCollection")for(var nt=0;nt<X.features.length;nt++)Qn(st,X.features[nt],rt,nt);else Qn(st,X.type==="Feature"?X:{geometry:X},rt);return st}(A,M);this.tiles={},this.tileCoords=[],L&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",M.indexMaxZoom,M.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(N=function(X,rt){var st=rt.buffer/rt.extent,nt=X,V=lo(X,1,-1-st,st,0,-1,2,rt),Y=lo(X,1,1-st,2+st,0,-1,2,rt);return(V||Y)&&(nt=lo(X,1,-st,1+st,0,-1,2,rt)||[],V&&(nt=Ca(V,1).concat(nt)),Y&&(nt=nt.concat(Ca(Y,-1)))),nt}(N,M)).length&&this.splitTile(N,0,0,0),L&&(N.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Co(A,M,L){return 32*((1<<A)*L+M)+A}function La(A,M){var L=A.tileID.canonical;if(!this._geoJSONIndex)return M(null,null);var N=this._geoJSONIndex.getTile(L.z,L.x,L.y);if(!N)return M(null,null);var X=new Bn(N.features),rt=jo(X);rt.byteOffset===0&&rt.byteLength===rt.buffer.byteLength||(rt=new Uint8Array(rt)),M(null,{vectorTile:X,rawData:rt.buffer})}$n.prototype.load=function(A){var M=this.options,L=M.log,N=M.minZoom,X=M.maxZoom,rt=M.nodeSize;L&&console.time("total time");var st="prepare "+A.length+" points";L&&console.time(st),this.points=A;for(var nt=[],V=0;V<A.length;V++)A[V].geometry&&nt.push(pr(A[V],V));this.trees[X+1]=new Oi(nt,dn,Fi,rt,Float32Array),L&&console.timeEnd(st);for(var Y=X;Y>=N;Y--){var Lt=+Date.now();nt=this._cluster(nt,Y),this.trees[Y]=new Oi(nt,dn,Fi,rt,Float32Array),L&&console.log("z%d: %d clusters in %dms",Y,nt.length,+Date.now()-Lt)}return L&&console.timeEnd("total time"),this},$n.prototype.getClusters=function(A,M){var L=((A[0]+180)%360+360)%360-180,N=Math.max(-90,Math.min(90,A[1])),X=A[2]===180?180:((A[2]+180)%360+360)%360-180,rt=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)L=-180,X=180;else if(L>X){var st=this.getClusters([L,N,180,rt],M),nt=this.getClusters([-180,N,X,rt],M);return st.concat(nt)}for(var V=this.trees[this._limitZoom(M)],Y=[],Lt=0,Wt=V.range(hi(L),He(rt),hi(X),He(N));Lt<Wt.length;Lt+=1){var vt=V.points[Wt[Lt]];Y.push(vt.numPoints?Wi(vt):this.points[vt.index])}return Y},$n.prototype.getChildren=function(A){var M=this._getOriginId(A),L=this._getOriginZoom(A),N="No cluster with the specified id.",X=this.trees[L];if(!X)throw new Error(N);var rt=X.points[M];if(!rt)throw new Error(N);for(var st=this.options.radius/(this.options.extent*Math.pow(2,L-1)),nt=[],V=0,Y=X.within(rt.x,rt.y,st);V<Y.length;V+=1){var Lt=X.points[Y[V]];Lt.parentId===A&&nt.push(Lt.numPoints?Wi(Lt):this.points[Lt.index])}if(nt.length===0)throw new Error(N);return nt},$n.prototype.getLeaves=function(A,M,L){var N=[];return this._appendLeaves(N,A,M=M||10,L=L||0,0),N},$n.prototype.getTile=function(A,M,L){var N=this.trees[this._limitZoom(A)],X=Math.pow(2,A),rt=this.options,st=rt.radius/rt.extent,nt=(L-st)/X,V=(L+1+st)/X,Y={features:[]};return this._addTileFeatures(N.range((M-st)/X,nt,(M+1+st)/X,V),N.points,M,L,X,Y),M===0&&this._addTileFeatures(N.range(1-st/X,nt,1,V),N.points,X,L,X,Y),M===X-1&&this._addTileFeatures(N.range(0,nt,st/X,V),N.points,-1,L,X,Y),Y.features.length?Y:null},$n.prototype.getClusterExpansionZoom=function(A){for(var M=this._getOriginZoom(A)-1;M<=this.options.maxZoom;){var L=this.getChildren(A);if(M++,L.length!==1)break;A=L[0].properties.cluster_id}return M},$n.prototype._appendLeaves=function(A,M,L,N,X){for(var rt=0,st=this.getChildren(M);rt<st.length;rt+=1){var nt=st[rt],V=nt.properties;if(V&&V.cluster?X+V.point_count<=N?X+=V.point_count:X=this._appendLeaves(A,V.cluster_id,L,N,X):X<N?X++:A.push(nt),A.length===L)break}return X},$n.prototype._addTileFeatures=function(A,M,L,N,X,rt){for(var st=0,nt=A;st<nt.length;st+=1){var V=M[nt[st]],Y=V.numPoints,Lt={type:1,geometry:[[Math.round(this.options.extent*(V.x*X-L)),Math.round(this.options.extent*(V.y*X-N))]],tags:Y?Eo(V):this.points[V.index].properties},Wt=void 0;Y?Wt=V.id:this.options.generateId?Wt=V.index:this.points[V.index].id&&(Wt=this.points[V.index].id),Wt!==void 0&&(Lt.id=Wt),rt.features.push(Lt)}},$n.prototype._limitZoom=function(A){return Math.max(this.options.minZoom,Math.min(+A,this.options.maxZoom+1))},$n.prototype._cluster=function(A,M){for(var L=[],N=this.options,X=N.reduce,rt=N.minPoints,st=N.radius/(N.extent*Math.pow(2,M)),nt=0;nt<A.length;nt++){var V=A[nt];if(!(V.zoom<=M)){V.zoom=M;for(var Y=this.trees[M+1],Lt=Y.within(V.x,V.y,st),Wt=V.numPoints||1,vt=Wt,Rt=0,ee=Lt;Rt<ee.length;Rt+=1){var re=Y.points[ee[Rt]];re.zoom>M&&(vt+=re.numPoints||1)}if(vt>=rt){for(var ce=V.x*Wt,At=V.y*Wt,Ht=X&&Wt>1?this._map(V,!0):null,kt=(nt<<5)+(M+1)+this.points.length,Me=0,Le=Lt;Me<Le.length;Me+=1){var ne=Y.points[Le[Me]];if(!(ne.zoom<=M)){ne.zoom=M;var _r=ne.numPoints||1;ce+=ne.x*_r,At+=ne.y*_r,ne.parentId=kt,X&&(Ht||(Ht=this._map(V,!0)),X(Ht,this._map(ne)))}}V.parentId=kt,L.push(ci(ce/vt,At/vt,kt,vt,Ht))}else if(L.push(V),vt>1)for(var we=0,br=Lt;we<br.length;we+=1){var Mr=Y.points[br[we]];Mr.zoom<=M||(Mr.zoom=M,L.push(Mr))}}}return L},$n.prototype._getOriginId=function(A){return A-this.points.length>>5},$n.prototype._getOriginZoom=function(A){return(A-this.points.length)%32},$n.prototype._map=function(A,M){if(A.numPoints)return M?An({},A.properties):A.properties;var L=this.points[A.index].properties,N=this.options.map(L);return M&&N===L?An({},N):N},aa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},aa.prototype.splitTile=function(A,M,L,N,X,rt,st){for(var nt=[A,M,L,N],V=this.options,Y=V.debug;nt.length;){N=nt.pop(),L=nt.pop(),M=nt.pop(),A=nt.pop();var Lt=1<<M,Wt=Co(M,L,N),vt=this.tiles[Wt];if(!vt&&(Y>1&&console.time("creation"),vt=this.tiles[Wt]=Js(A,M,L,N,V),this.tileCoords.push({z:M,x:L,y:N}),Y)){Y>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",M,L,N,vt.numFeatures,vt.numPoints,vt.numSimplified),console.timeEnd("creation"));var Rt="z"+M;this.stats[Rt]=(this.stats[Rt]||0)+1,this.total++}if(vt.source=A,X){if(M===V.maxZoom||M===X)continue;var ee=1<<X-M;if(L!==Math.floor(rt/ee)||N!==Math.floor(st/ee))continue}else if(M===V.indexMaxZoom||vt.numPoints<=V.indexMaxPoints)continue;if(vt.source=null,A.length!==0){Y>1&&console.time("clipping");var re,ce,At,Ht,kt,Me,Le=.5*V.buffer/V.extent,ne=.5-Le,_r=.5+Le,we=1+Le;re=ce=At=Ht=null,kt=lo(A,Lt,L-Le,L+_r,0,vt.minX,vt.maxX,V),Me=lo(A,Lt,L+ne,L+we,0,vt.minX,vt.maxX,V),A=null,kt&&(re=lo(kt,Lt,N-Le,N+_r,1,vt.minY,vt.maxY,V),ce=lo(kt,Lt,N+ne,N+we,1,vt.minY,vt.maxY,V),kt=null),Me&&(At=lo(Me,Lt,N-Le,N+_r,1,vt.minY,vt.maxY,V),Ht=lo(Me,Lt,N+ne,N+we,1,vt.minY,vt.maxY,V),Me=null),Y>1&&console.timeEnd("clipping"),nt.push(re||[],M+1,2*L,2*N),nt.push(ce||[],M+1,2*L,2*N+1),nt.push(At||[],M+1,2*L+1,2*N),nt.push(Ht||[],M+1,2*L+1,2*N+1)}}},aa.prototype.getTile=function(A,M,L){var N=this.options,X=N.extent,rt=N.debug;if(A<0||A>24)return null;var st=1<<A,nt=Co(A,M=(M%st+st)%st,L);if(this.tiles[nt])return za(this.tiles[nt],X);rt>1&&console.log("drilling down to z%d-%d-%d",A,M,L);for(var V,Y=A,Lt=M,Wt=L;!V&&Y>0;)Y--,Lt=Math.floor(Lt/2),Wt=Math.floor(Wt/2),V=this.tiles[Co(Y,Lt,Wt)];return V&&V.source?(rt>1&&console.log("found parent tile z%d-%d-%d",Y,Lt,Wt),rt>1&&console.time("drilling down"),this.splitTile(V.source,Y,Lt,Wt,A,M,L),rt>1&&console.timeEnd("drilling down"),this.tiles[nt]?za(this.tiles[nt],X):null):null};var Qa=function(A){function M(L,N,X,rt){A.call(this,L,N,X,La),rt&&(this.loadGeoJSON=rt)}return A&&(M.__proto__=A),(M.prototype=Object.create(A&&A.prototype)).constructor=M,M.prototype.loadData=function(L,N){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=N,this._pendingLoadDataParams=L,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},M.prototype._loadData=function(){var L=this;if(this._pendingCallback&&this._pendingLoadDataParams){var N=this._pendingCallback,X=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var rt=!!(X&&X.request&&X.request.collectResourceTiming)&&new h.RequestPerformance(X.request);this.loadGeoJSON(X,function(st,nt){if(st||!nt)return N(st);if(typeof nt!="object")return N(new Error("Input data given to '"+X.source+"' is not a valid GeoJSON object."));(function vt(Rt,ee){var re,ce=Rt&&Rt.type;if(ce==="FeatureCollection")for(re=0;re<Rt.features.length;re++)vt(Rt.features[re],ee);else if(ce==="GeometryCollection")for(re=0;re<Rt.geometries.length;re++)vt(Rt.geometries[re],ee);else if(ce==="Feature")vt(Rt.geometry,ee);else if(ce==="Polygon")Zi(Rt.coordinates,ee);else if(ce==="MultiPolygon")for(re=0;re<Rt.coordinates.length;re++)Zi(Rt.coordinates[re],ee);return Rt})(nt,!0);try{if(X.filter){var V=h.createExpression(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(V.result==="error")throw new Error(V.value.map(function(vt){return vt.key+": "+vt.message}).join(", "));var Y=nt.features.filter(function(vt){return V.value.evaluate({zoom:0},vt)});nt={type:"FeatureCollection",features:Y}}L._geoJSONIndex=X.cluster?new $n(function(vt){var Rt=vt.superclusterOptions,ee=vt.clusterProperties;if(!ee||!Rt)return Rt;for(var re={},ce={},At={accumulated:null,zoom:0},Ht={properties:null},kt=Object.keys(ee),Me=0,Le=kt;Me<Le.length;Me+=1){var ne=Le[Me],_r=ee[ne],we=_r[0],br=h.createExpression(_r[1]),Mr=h.createExpression(typeof we=="string"?[we,["accumulated"],["get",ne]]:we);re[ne]=br.value,ce[ne]=Mr.value}return Rt.map=function(rr){Ht.properties=rr;for(var wr={},Fr=0,Sr=kt;Fr<Sr.length;Fr+=1){var Ve=Sr[Fr];wr[Ve]=re[Ve].evaluate(At,Ht)}return wr},Rt.reduce=function(rr,wr){Ht.properties=wr;for(var Fr=0,Sr=kt;Fr<Sr.length;Fr+=1){var Ve=Sr[Fr];At.accumulated=rr[Ve],rr[Ve]=ce[Ve].evaluate(At,Ht)}},Rt}(X)).load(nt.features):function(vt,Rt){return new aa(vt,Rt)}(nt,X.geojsonVtOptions)}catch(vt){return N(vt)}L.loaded={};var Lt={};if(rt){var Wt=rt.finish();Wt&&(Lt.resourceTiming={},Lt.resourceTiming[X.source]=JSON.parse(JSON.stringify(Wt)))}N(null,Lt)})}},M.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},M.prototype.reloadTile=function(L,N){var X=this.loaded;return X&&X[L.uid]?A.prototype.reloadTile.call(this,L,N):this.loadTile(L,N)},M.prototype.loadGeoJSON=function(L,N){if(L.request)h.getJSON(L.request,N);else{if(typeof L.data!="string")return N(new Error("Input data given to '"+L.source+"' is not a valid GeoJSON object."));try{return N(null,JSON.parse(L.data))}catch{return N(new Error("Input data given to '"+L.source+"' is not a valid GeoJSON object."))}}},M.prototype.removeSource=function(L,N){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),N()},M.prototype.getClusterExpansionZoom=function(L,N){try{N(null,this._geoJSONIndex.getClusterExpansionZoom(L.clusterId))}catch(X){N(X)}},M.prototype.getClusterChildren=function(L,N){try{N(null,this._geoJSONIndex.getChildren(L.clusterId))}catch(X){N(X)}},M.prototype.getClusterLeaves=function(L,N){try{N(null,this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset))}catch(X){N(X)}},M}(Zn),Gr=function(A){var M=this;this.self=A,this.actor=new h.Actor(A,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Zn,geojson:Qa},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(L,N){if(M.workerSourceTypes[L])throw new Error('Worker source with name "'+L+'" already registered.');M.workerSourceTypes[L]=N},this.self.registerRTLTextPlugin=function(L){if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=L.applyArabicShaping,h.plugin.processBidirectionalText=L.processBidirectionalText,h.plugin.processStyledBidirectionalText=L.processStyledBidirectionalText}};return Gr.prototype.setReferrer=function(A,M){this.referrer=M},Gr.prototype.setImages=function(A,M,L){for(var N in this.availableImages[A]=M,this.workerSources[A]){var X=this.workerSources[A][N];for(var rt in X)X[rt].availableImages=M}L()},Gr.prototype.setLayers=function(A,M,L){this.getLayerIndex(A).replace(M),L()},Gr.prototype.updateLayers=function(A,M,L){this.getLayerIndex(A).update(M.layers,M.removedIds),L()},Gr.prototype.loadTile=function(A,M,L){this.getWorkerSource(A,M.type,M.source).loadTile(M,L)},Gr.prototype.loadDEMTile=function(A,M,L){this.getDEMWorkerSource(A,M.source).loadTile(M,L)},Gr.prototype.reloadTile=function(A,M,L){this.getWorkerSource(A,M.type,M.source).reloadTile(M,L)},Gr.prototype.abortTile=function(A,M,L){this.getWorkerSource(A,M.type,M.source).abortTile(M,L)},Gr.prototype.removeTile=function(A,M,L){this.getWorkerSource(A,M.type,M.source).removeTile(M,L)},Gr.prototype.removeDEMTile=function(A,M){this.getDEMWorkerSource(A,M.source).removeTile(M)},Gr.prototype.removeSource=function(A,M,L){if(this.workerSources[A]&&this.workerSources[A][M.type]&&this.workerSources[A][M.type][M.source]){var N=this.workerSources[A][M.type][M.source];delete this.workerSources[A][M.type][M.source],N.removeSource!==void 0?N.removeSource(M,L):L()}},Gr.prototype.loadWorkerSource=function(A,M,L){try{this.self.importScripts(M.url),L()}catch(N){L(N.toString())}},Gr.prototype.syncRTLPluginState=function(A,M,L){try{h.plugin.setState(M);var N=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&N!=null){this.self.importScripts(N);var X=h.plugin.isParsed();L(X?void 0:new Error("RTL Text Plugin failed to import scripts from "+N),X)}}catch(rt){L(rt.toString())}},Gr.prototype.getAvailableImages=function(A){var M=this.availableImages[A];return M||(M=[]),M},Gr.prototype.getLayerIndex=function(A){var M=this.layerIndexes[A];return M||(M=this.layerIndexes[A]=new En),M},Gr.prototype.getWorkerSource=function(A,M,L){var N=this;return this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][M]||(this.workerSources[A][M]={}),this.workerSources[A][M][L]||(this.workerSources[A][M][L]=new this.workerSourceTypes[M]({send:function(X,rt,st){N.actor.send(X,rt,st,A)}},this.getLayerIndex(A),this.getAvailableImages(A))),this.workerSources[A][M][L]},Gr.prototype.getDEMWorkerSource=function(A,M){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][M]||(this.demWorkerSources[A][M]=new Zr),this.demWorkerSources[A][M]},Gr.prototype.enforceCacheSizeLimit=function(A,M){h.enforceCacheSizeLimit(M)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Gr(self)),Gr}),Au(["./shared"],function(h){var Ei=h.createCommonjsModule(function(n){function o(f){return!i(f)}function i(f){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,_,T=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(T);try{_=new Worker(C),y=!0}catch{y=!1}return _&&_.terminate(),URL.revokeObjectURL(C),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var _=y.getContext("2d");if(!_)return!1;var T=_.getImageData(0,0,1,1);return T&&T.width===y.width}()?(u[m=f&&f.failIfMajorPerformanceCaveat]===void 0&&(u[m]=function(y){var _=function(C){var B=document.createElement("canvas"),U=Object.create(o.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=C,B.probablySupportsContext?B.probablySupportsContext("webgl",U)||B.probablySupportsContext("experimental-webgl",U):B.supportsContext?B.supportsContext("webgl",U)||B.supportsContext("experimental-webgl",U):B.getContext("webgl",U)||B.getContext("experimental-webgl",U)}(y);if(!_)return!1;var T=_.createShader(_.VERTEX_SHADER);return!(!T||_.isContextLost())&&(_.shaderSource(T,"void main() {}"),_.compileShader(T),_.getShaderParameter(T,_.COMPILE_STATUS)===!0)}(m)),u[m]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}n.exports?n.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o,window.mapboxgl.notSupportedReason=i);var u={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),Bt={create:function(n,o,i){var u=h.window.document.createElement(n);return o!==void 0&&(u.className=o),i&&i.appendChild(u),u},createNS:function(n,o){return h.window.document.createElementNS(n,o)}},En=h.window.document&&h.window.document.documentElement.style;function Te(n){if(!En)return n[0];for(var o=0;o<n.length;o++)if(n[o]in En)return n[o];return n[0]}var pn,Et=Te(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);Bt.disableDrag=function(){En&&Et&&(pn=En[Et],En[Et]="none")},Bt.enableDrag=function(){En&&Et&&(En[Et]=pn)};var je=Te(["transform","WebkitTransform"]);Bt.setTransform=function(n,o){n.style[je]=o};var Zn=!1;try{var To=Object.defineProperty({},"passive",{get:function(){Zn=!0}});h.window.addEventListener("test",To,To),h.window.removeEventListener("test",To,To)}catch{Zn=!1}Bt.addEventListener=function(n,o,i,u){u===void 0&&(u={}),n.addEventListener(o,i,"passive"in u&&Zn?u:u.capture)},Bt.removeEventListener=function(n,o,i,u){u===void 0&&(u={}),n.removeEventListener(o,i,"passive"in u&&Zn?u:u.capture)};var Zr=function(n){n.preventDefault(),n.stopPropagation(),h.window.removeEventListener("click",Zr,!0)};function Zi(n){var o=n.userImage;return!!(o&&o.render&&o.render())&&(n.data.replace(new Uint8Array(o.data.buffer)),!0)}Bt.suppressClick=function(){h.window.addEventListener("click",Zr,!0),h.window.setTimeout(function(){h.window.removeEventListener("click",Zr,!0)},0)},Bt.mousePos=function(n,o){var i=n.getBoundingClientRect();return new h.Point(o.clientX-i.left-n.clientLeft,o.clientY-i.top-n.clientTop)},Bt.touchPos=function(n,o){for(var i=n.getBoundingClientRect(),u=[],f=0;f<o.length;f++)u.push(new h.Point(o[f].clientX-i.left-n.clientLeft,o[f].clientY-i.top-n.clientTop));return u},Bt.mouseButton=function(n){return h.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},Bt.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Zt=function(n){function o(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.isLoaded=function(){return this.loaded},o.prototype.setLoaded=function(i){if(this.loaded!==i&&(this.loaded=i,i)){for(var u=0,f=this.requestors;u<f.length;u+=1){var m=f[u];this._notify(m.ids,m.callback)}this.requestors=[]}},o.prototype.getImage=function(i){return this.images[i]},o.prototype.addImage=function(i,u){this._validate(i,u)&&(this.images[i]=u)},o.prototype._validate=function(i,u){var f=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new h.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchX" value'))),f=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new h.ErrorEvent(new Error('Image "'+i+'" has invalid "stretchY" value'))),f=!1),this._validateContent(u.content,u)||(this.fire(new h.ErrorEvent(new Error('Image "'+i+'" has invalid "content" value'))),f=!1),f},o.prototype._validateStretch=function(i,u){if(!i)return!0;for(var f=0,m=0,y=i;m<y.length;m+=1){var _=y[m];if(_[0]<f||_[1]<_[0]||u<_[1])return!1;f=_[1]}return!0},o.prototype._validateContent=function(i,u){return!(i&&(i.length!==4||i[0]<0||u.data.width<i[0]||i[1]<0||u.data.height<i[1]||i[2]<0||u.data.width<i[2]||i[3]<0||u.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))},o.prototype.updateImage=function(i,u){u.version=this.images[i].version+1,this.images[i]=u,this.updatedImages[i]=!0},o.prototype.removeImage=function(i){var u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},o.prototype.listImages=function(){return Object.keys(this.images)},o.prototype.getImages=function(i,u){var f=!0;if(!this.isLoaded())for(var m=0,y=i;m<y.length;m+=1)this.images[y[m]]||(f=!1);this.isLoaded()||f?this._notify(i,u):this.requestors.push({ids:i,callback:u})},o.prototype._notify=function(i,u){for(var f={},m=0,y=i;m<y.length;m+=1){var _=y[m];this.images[_]||this.fire(new h.Event("styleimagemissing",{id:_}));var T=this.images[_];T?f[_]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:Boolean(T.userImage&&T.userImage.render)}:h.warnOnce('Image "'+_+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,f)},o.prototype.getPixelSize=function(){var i=this.atlasImage;return{width:i.width,height:i.height}},o.prototype.getPattern=function(i){var u=this.patterns[i],f=this.getImage(i);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{var m={w:f.data.width+2,h:f.data.height+2,x:0,y:0},y=new h.ImagePosition(m,f);this.patterns[i]={bin:m,position:y}}return this._updatePatternAtlas(),this.patterns[i].position},o.prototype.bind=function(i){var u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},o.prototype._updatePatternAtlas=function(){var i=[];for(var u in this.patterns)i.push(this.patterns[u].bin);var f=h.potpack(i),m=f.w,y=f.h,_=this.atlasImage;for(var T in _.resize({width:m||1,height:y||1}),this.patterns){var C=this.patterns[T].bin,B=C.x+1,U=C.y+1,O=this.images[T].data,K=O.width,W=O.height;h.RGBAImage.copy(O,_,{x:0,y:0},{x:B,y:U},{width:K,height:W}),h.RGBAImage.copy(O,_,{x:0,y:W-1},{x:B,y:U-1},{width:K,height:1}),h.RGBAImage.copy(O,_,{x:0,y:0},{x:B,y:U+W},{width:K,height:1}),h.RGBAImage.copy(O,_,{x:K-1,y:0},{x:B-1,y:U},{width:1,height:W}),h.RGBAImage.copy(O,_,{x:0,y:0},{x:B+K,y:U},{width:1,height:W})}this.dirty=!0},o.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},o.prototype.dispatchRenderCallbacks=function(i){for(var u=0,f=i;u<f.length;u+=1){var m=f[u];if(!this.callbackDispatchedThisFrame[m]){this.callbackDispatchedThisFrame[m]=!0;var y=this.images[m];Zi(y)&&this.updateImage(m,y)}}},o}(h.Evented),Jn=ji,_e=ji,Bn=1e20;function ji(n,o,i,u,f,m){this.fontSize=n||24,this.buffer=o===void 0?3:o,this.cutoff=u||.25,this.fontFamily=f||"sans-serif",this.fontWeight=m||"normal",this.radius=i||8;var y=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.d=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Int16Array(y),this.middle=Math.round(y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Ai(n,o,i,u,f,m,y){for(var _=0;_<o;_++){for(var T=0;T<i;T++)u[T]=n[T*o+_];for(oo(u,f,m,y,i),T=0;T<i;T++)n[T*o+_]=f[T]}for(T=0;T<i;T++){for(_=0;_<o;_++)u[_]=n[T*o+_];for(oo(u,f,m,y,o),_=0;_<o;_++)n[T*o+_]=Math.sqrt(f[_])}}function oo(n,o,i,u,f){i[0]=0,u[0]=-Bn,u[1]=+Bn;for(var m=1,y=0;m<f;m++){for(var _=(n[m]+m*m-(n[i[y]]+i[y]*i[y]))/(2*m-2*i[y]);_<=u[y];)y--,_=(n[m]+m*m-(n[i[y]]+i[y]*i[y]))/(2*m-2*i[y]);i[++y]=m,u[y]=_,u[y+1]=+Bn}for(m=0,y=0;m<f;m++){for(;u[y+1]<m;)y++;o[m]=(m-i[y])*(m-i[y])+n[i[y]]}}ji.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var o=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var f=o.data[4*u+3]/255;this.gridOuter[u]=f===1?0:f===0?Bn:Math.pow(Math.max(0,.5-f),2),this.gridInner[u]=f===1?Bn:f===0?0:Math.pow(Math.max(0,f-.5),2)}for(Ai(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Ai(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)i[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return i},Jn.default=_e;var On=function(n,o){this.requestManager=n,this.localIdeographFontFamily=o,this.entries={}};On.prototype.setURL=function(n){this.url=n},On.prototype.getGlyphs=function(n,o){var i=this,u=[];for(var f in n)for(var m=0,y=n[f];m<y.length;m+=1)u.push({stack:f,id:y[m]});h.asyncAll(u,function(_,T){var C=_.stack,B=_.id,U=i.entries[C];U||(U=i.entries[C]={glyphs:{},requests:{},ranges:{}});var O=U.glyphs[B];if(O===void 0){if(O=i._tinySDF(U,C,B))return U.glyphs[B]=O,void T(null,{stack:C,id:B,glyph:O});var K=Math.floor(B/256);if(256*K>65535)T(new Error("glyphs > 65535 not supported"));else if(U.ranges[K])T(null,{stack:C,id:B,glyph:O});else{var W=U.requests[K];W||(W=U.requests[K]=[],On.loadGlyphRange(C,K,i.url,i.requestManager,function(Q,G){if(G){for(var $ in G)i._doesCharSupportLocalGlyph(+$)||(U.glyphs[+$]=G[+$]);U.ranges[K]=!0}for(var at=0,ht=W;at<ht.length;at+=1)(0,ht[at])(Q,G);delete U.requests[K]})),W.push(function(Q,G){Q?T(Q):G&&T(null,{stack:C,id:B,glyph:G[B]||null})})}}else T(null,{stack:C,id:B,glyph:O})},function(_,T){if(_)o(_);else if(T){for(var C={},B=0,U=T;B<U.length;B+=1){var O=U[B],K=O.stack,W=O.id,Q=O.glyph;(C[K]||(C[K]={}))[W]=Q&&{id:Q.id,bitmap:Q.bitmap.clone(),metrics:Q.metrics}}o(null,C)}})},On.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(h.isChar["CJK Unified Ideographs"](n)||h.isChar["Hangul Syllables"](n)||h.isChar.Hiragana(n)||h.isChar.Katakana(n))},On.prototype._tinySDF=function(n,o,i){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(i)){var f=n.tinySDF;if(!f){var m="400";/bold/i.test(o)?m="900":/medium/i.test(o)?m="500":/light/i.test(o)&&(m="200"),f=n.tinySDF=new On.TinySDF(24,3,8,.25,u,m)}return{id:i,bitmap:new h.AlphaImage({width:30,height:30},f.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},On.loadGlyphRange=function(n,o,i,u,f){var m=256*o,y=m+255,_=u.transformRequest(u.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",m+"-"+y),h.ResourceType.Glyphs);h.getArrayBuffer(_,function(T,C){if(T)f(T);else if(C){for(var B={},U=0,O=h.parseGlyphPBF(C);U<O.length;U+=1){var K=O[U];B[K.id]=K}f(null,B)}})},On.TinySDF=Jn;var jo=function(){this.specification=h.styleSpec.light.position};jo.prototype.possiblyEvaluate=function(n,o){return h.sphericalToCartesian(n.expression.evaluate(o))},jo.prototype.interpolate=function(n,o,i){return{x:h.number(n.x,o.x,i),y:h.number(n.y,o.y,i),z:h.number(n.z,o.z,i)}};var ao=new h.Properties({anchor:new h.DataConstantProperty(h.styleSpec.light.anchor),position:new jo,color:new h.DataConstantProperty(h.styleSpec.light.color),intensity:new h.DataConstantProperty(h.styleSpec.light.intensity)}),Ka=function(n){function o(i){n.call(this),this._transitionable=new h.Transitionable(ao),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getLight=function(){return this._transitionable.serialize()},o.prototype.setLight=function(i,u){if(u===void 0&&(u={}),!this._validate(h.validateLight,i,u))for(var f in i){var m=i[f];h.endsWith(f,"-transition")?this._transitionable.setTransition(f.slice(0,-"-transition".length),m):this._transitionable.setValue(f,m)}},o.prototype.updateTransitions=function(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)},o.prototype.hasTransition=function(){return this._transitioning.hasTransition()},o.prototype.recalculate=function(i){this.properties=this._transitioning.possiblyEvaluate(i)},o.prototype._validate=function(i,u,f){return(!f||f.validate!==!1)&&h.emitValidationErrors(this,i.call(h.validateStyle,h.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:h.styleSpec})))},o}(h.Evented),Jr=function(n,o){this.width=n,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Jr.prototype.getDash=function(n,o){var i=n.join(",")+String(o);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(n,o)),this.dashEntry[i]},Jr.prototype.getDashRanges=function(n,o,i){var u=[],f=n.length%2==1?-n[n.length-1]*i:0,m=n[0]*i,y=!0;u.push({left:f,right:m,isDash:y,zeroLength:n[0]===0});for(var _=n[0],T=1;T<n.length;T++){var C=n[T];u.push({left:f=_*i,right:m=(_+=C)*i,isDash:y=!y,zeroLength:C===0})}return u},Jr.prototype.addRoundDash=function(n,o,i){for(var u=o/2,f=-i;f<=i;f++)for(var m=this.width*(this.nextRow+i+f),y=0,_=n[y],T=0;T<this.width;T++){T/_.right>1&&(_=n[++y]);var C=Math.abs(T-_.left),B=Math.abs(T-_.right),U=Math.min(C,B),O=void 0,K=f/i*(u+1);if(_.isDash){var W=u-Math.abs(K);O=Math.sqrt(U*U+W*W)}else O=u-Math.sqrt(U*U+K*K);this.data[m+T]=Math.max(0,Math.min(255,O+128))}},Jr.prototype.addRegularDash=function(n){for(var o=n.length-1;o>=0;--o){var i=n[o],u=n[o+1];i.zeroLength?n.splice(o,1):u&&u.isDash===i.isDash&&(u.left=i.left,n.splice(o,1))}var f=n[0],m=n[n.length-1];f.isDash===m.isDash&&(f.left=m.left-this.width,m.right=f.right+this.width);for(var y=this.width*this.nextRow,_=0,T=n[_],C=0;C<this.width;C++){C/T.right>1&&(T=n[++_]);var B=Math.abs(C-T.left),U=Math.abs(C-T.right),O=Math.min(B,U);this.data[y+C]=Math.max(0,Math.min(255,(T.isDash?O:-O)+128))}},Jr.prototype.addDash=function(n,o){var i=o?7:0,u=2*i+1;if(this.nextRow+u>this.height)return h.warnOnce("LineAtlas out of space"),null;for(var f=0,m=0;m<n.length;m++)f+=n[m];if(f!==0){var y=this.width/f,_=this.getDashRanges(n,this.width,y);o?this.addRoundDash(_,y,i):this.addRegularDash(_)}var T={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:f};return this.nextRow+=u,this.dirty=!0,T},Jr.prototype.bind=function(n){var o=n.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))};var ui=function n(o,i){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=h.uniqueId();for(var u=this.workerPool.acquire(this.id),f=0;f<u.length;f++){var m=new n.Actor(u[f],i,this.id);m.name="Worker "+f,this.actors.push(m)}};function Ks(n,o,i){var u=function(f,m){if(f)return i(f);if(m){var y=h.pick(h.extend(m,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(y.vectorLayers=m.vector_layers,y.vectorLayerIds=y.vectorLayers.map(function(_){return _.id})),y.tiles=o.canonicalizeTileset(y,n.url),i(null,y)}};return n.url?h.getJSON(o.transformRequest(o.normalizeSourceURL(n.url),h.ResourceType.Source),u):h.browser.frame(function(){return u(null,n)})}ui.prototype.broadcast=function(n,o,i){h.asyncAll(this.actors,function(u,f){u.send(n,o,f)},i=i||function(){})},ui.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ui.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},ui.Actor=h.Actor;var li=function(n,o,i){this.bounds=h.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=o||0,this.maxzoom=i||24};li.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},li.prototype.contains=function(n){var o=Math.pow(2,n.z),i=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*o),u=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*o),f=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*o),m=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*o);return n.x>=i&&n.x<f&&n.y>=u&&n.y<m};var Gi=function(n){function o(i,u,f,m){if(n.call(this),this.id=i,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(u,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ks(this._options,this.map._requestManager,function(u,f){i._tileJSONRequest=null,i._loaded=!0,u?i.fire(new h.ErrorEvent(u)):f&&(h.extend(i,f),f.bounds&&(i.tileBounds=new li(f.bounds,i.minzoom,i.maxzoom)),h.postTurnstileEvent(f.tiles,i.map._requestManager._customAccessToken),h.postMapLoadEvent(f.tiles,i.map._getMapId(),i.map._requestManager._skuToken,i.map._requestManager._customAccessToken),i.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setSourceProperty=function(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},o.prototype.setTiles=function(i){var u=this;return this.setSourceProperty(function(){u._options.tiles=i}),this},o.prototype.setUrl=function(i){var u=this;return this.setSourceProperty(function(){u.url=i,u._options.url=i}),this},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return h.extend({},this._options)},o.prototype.loadTile=function(i,u){var f=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(f,h.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(_,T){return delete i.request,i.aborted?u(null):_&&_.status!==404?u(_):(T&&T.resourceTiming&&(i.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&i.setExpiryData(T),i.loadVectorData(T,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}m.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=u:i.request=i.actor.send("reloadTile",m,y.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",m,y.bind(this)))},o.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)},o.prototype.unloadTile=function(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)},o.prototype.hasTransition=function(){return!1},o}(h.Evented),Bi=function(n){function o(i,u,f,m){n.call(this),this.id=i,this.dispatcher=f,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},u),h.extend(this,h.pick(u,["url","scheme","tileSize"]))}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ks(this._options,this.map._requestManager,function(u,f){i._tileJSONRequest=null,i._loaded=!0,u?i.fire(new h.ErrorEvent(u)):f&&(h.extend(i,f),f.bounds&&(i.tileBounds=new li(f.bounds,i.minzoom,i.maxzoom)),h.postTurnstileEvent(f.tiles),h.postMapLoadEvent(f.tiles,i.map._getMapId(),i.map._requestManager._skuToken),i.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),i.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return h.extend({},this._options)},o.prototype.hasTile=function(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)},o.prototype.loadTile=function(i,u){var f=this,m=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);i.request=h.getImage(this.map._requestManager.transformRequest(m,h.ResourceType.Tile),function(y,_){if(delete i.request,i.aborted)i.state="unloaded",u(null);else if(y)i.state="errored",u(y);else if(_){f.map._refreshExpiredTiles&&i.setExpiryData(_),delete _.cacheControl,delete _.expires;var T=f.map.painter.context,C=T.gl;i.texture=f.map.painter.getTileTexture(_.width),i.texture?i.texture.update(_,{useMipmap:!0}):(i.texture=new h.Texture(T,_,C.RGBA,{useMipmap:!0}),i.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),T.extTextureFilterAnisotropic&&C.texParameterf(C.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax)),i.state="loaded",h.cacheEntryPossiblyAdded(f.dispatcher),u(null)}})},o.prototype.abortTile=function(i,u){i.request&&(i.request.cancel(),delete i.request),u()},o.prototype.unloadTile=function(i,u){i.texture&&this.map.painter.saveTileTexture(i.texture),u()},o.prototype.hasTransition=function(){return!1},o}(h.Evented),Ys=function(n){function o(i,u,f,m){n.call(this,i,u,f,m),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},o.prototype.loadTile=function(i,u){var f=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function m(y,_){y&&(i.state="errored",u(y)),_&&(i.dem=_,i.needsHillshadePrepare=!0,i.state="loaded",u(null))}i.request=h.getImage(this.map._requestManager.transformRequest(f,h.ResourceType.Tile),function(y,_){if(delete i.request,i.aborted)i.state="unloaded",u(null);else if(y)i.state="errored",u(y);else if(_){this.map._refreshExpiredTiles&&i.setExpiryData(_),delete _.cacheControl,delete _.expires;var T=h.window.ImageBitmap&&_ instanceof h.window.ImageBitmap&&h.offscreenCanvasSupported()?_:h.browser.getImageData(_,1),C={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:T,encoding:this.encoding};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",C,m.bind(this)))}}.bind(this)),i.neighboringTiles=this._getNeighboringTiles(i.tileID)},o.prototype._getNeighboringTiles=function(i){var u=i.canonical,f=Math.pow(2,u.z),m=(u.x-1+f)%f,y=u.x===0?i.wrap-1:i.wrap,_=(u.x+1+f)%f,T=u.x+1===f?i.wrap+1:i.wrap,C={};return C[new h.OverscaledTileID(i.overscaledZ,y,u.z,m,u.y).key]={backfilled:!1},C[new h.OverscaledTileID(i.overscaledZ,T,u.z,_,u.y).key]={backfilled:!1},u.y>0&&(C[new h.OverscaledTileID(i.overscaledZ,y,u.z,m,u.y-1).key]={backfilled:!1},C[new h.OverscaledTileID(i.overscaledZ,i.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},C[new h.OverscaledTileID(i.overscaledZ,T,u.z,_,u.y-1).key]={backfilled:!1}),u.y+1<f&&(C[new h.OverscaledTileID(i.overscaledZ,y,u.z,m,u.y+1).key]={backfilled:!1},C[new h.OverscaledTileID(i.overscaledZ,i.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},C[new h.OverscaledTileID(i.overscaledZ,T,u.z,_,u.y+1).key]={backfilled:!1}),C},o.prototype.unloadTile=function(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})},o}(Bi),so=function(n){function o(i,u,f,m){n.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(m),this._data=u.data,this._options=h.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var y=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*y,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*y,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:h.EXTENT,radius:(u.clusterRadius||50)*y,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)i.fire(new h.ErrorEvent(u));else{var f={dataType:"source",sourceDataType:"metadata"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(f.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new h.Event("data",f))}})},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setData=function(i){var u=this;return this._data=i,this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(f){if(f)u.fire(new h.ErrorEvent(f));else{var m={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(m.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new h.Event("data",m))}}),this},o.prototype.getClusterExpansionZoom=function(i,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},u),this},o.prototype.getClusterChildren=function(i,u){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},u),this},o.prototype.getClusterLeaves=function(i,u,f,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:u,offset:f},m),this},o.prototype._updateWorkerData=function(i){var u=this;this._loaded=!1;var f=h.extend({},this.workerOptions),m=this._data;typeof m=="string"?(f.request=this.map._requestManager.transformRequest(h.browser.resolveURL(m),h.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(m),this.actor.send(this.type+".loadData",f,function(y,_){u._removed||_&&_.abandoned||(u._loaded=!0,_&&_.resourceTiming&&_.resourceTiming[u.id]&&(u._resourceTiming=_.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:f.source},null),i(y))})},o.prototype.loaded=function(){return this._loaded},o.prototype.loadTile=function(i,u){var f=this,m=i.actor?"reloadTile":"loadTile";i.actor=this.actor,i.request=this.actor.send(m,{type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(y,_){return delete i.request,i.unloadVectorData(),i.aborted?u(null):y?u(y):(i.loadVectorData(_,f.map.painter,m==="reloadTile"),u(null))})},o.prototype.abortTile=function(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0},o.prototype.unloadTile=function(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})},o.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},o.prototype.serialize=function(){return h.extend({},this._options,{type:this.type,data:this._data})},o.prototype.hasTransition=function(){return!1},o}(h.Evented),fn=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Io=function(n){function o(i,u,f,m){n.call(this),this.id=i,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=u}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(i,u){var f=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),function(m,y){f._loaded=!0,m?f.fire(new h.ErrorEvent(m)):y&&(f.image=y,i&&(f.coordinates=i),u&&u(),f._finishLoading())})},o.prototype.loaded=function(){return this._loaded},o.prototype.updateImage=function(i){var u=this;return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,function(){u.texture=null}),this):this},o.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))},o.prototype.onAdd=function(i){this.map=i,this.load()},o.prototype.setCoordinates=function(i){var u=this;this.coordinates=i;var f=i.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(y){for(var _=1/0,T=1/0,C=-1/0,B=-1/0,U=0,O=y;U<O.length;U+=1){var K=O[U];_=Math.min(_,K.x),T=Math.min(T,K.y),C=Math.max(C,K.x),B=Math.max(B,K.y)}var W=Math.max(C-_,B-T),Q=Math.max(0,Math.floor(-Math.log(W)/Math.LN2)),G=Math.pow(2,Q);return new h.CanonicalTileID(Q,Math.floor((_+C)/2*G),Math.floor((T+B)/2*G))}(f),this.minzoom=this.maxzoom=this.tileID.z;var m=f.map(function(y){return u.tileID.getTilePoint(y)._round()});return this._boundsArray=new h.StructArrayLayout4i8,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(m[2].x,m[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this},o.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var i=this.map.painter.context,u=i.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,fn.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new h.Texture(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var m=this.tiles[f];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture)}}},o.prototype.loadTile=function(i,u){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},u(null)):(i.state="errored",u(null))},o.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return!1},o}(h.Evented),Ea=function(n){function o(i,u,f,m){n.call(this,i,u,f,m),this.roundZoom=!0,this.type="video",this.options=u}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){var i=this;this._loaded=!1;var u=this.options;this.urls=[];for(var f=0,m=u.urls;f<m.length;f+=1)this.urls.push(this.map._requestManager.transformRequest(m[f],h.ResourceType.Source).url);h.getVideo(this.urls,function(y,_){i._loaded=!0,y?i.fire(new h.ErrorEvent(y)):_&&(i.video=_,i.video.loop=!0,i.video.addEventListener("playing",function(){i.map.triggerRepaint()}),i.map&&i.video.play(),i._finishLoading())})},o.prototype.pause=function(){this.video&&this.video.pause()},o.prototype.play=function(){this.video&&this.video.play()},o.prototype.seek=function(i){if(this.video){var u=this.video.seekable;i<u.start(0)||i>u.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=i}},o.prototype.getVideo=function(){return this.video},o.prototype.onAdd=function(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},o.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var i=this.map.painter.context,u=i.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,fn.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(i,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var m=this.tiles[f];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this.video&&!this.video.paused},o}(Io),Go=function(n){function o(i,u,f,m){n.call(this,i,u,f,m),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(y){return!Array.isArray(y)||y.length!==2||y.some(function(_){return typeof _!="number"})})||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+i,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},o.prototype.getCanvas=function(){return this.canvas},o.prototype.onAdd=function(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()},o.prototype.onRemove=function(){this.pause()},o.prototype.prepare=function(){var i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,f=u.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,fn.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(u,this.canvas,f.RGBA,{premultiply:!0}),this.tiles){var y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this._playing},o.prototype._hasInvalidDimensions=function(){for(var i=0,u=[this.canvas.width,this.canvas.height];i<u.length;i+=1){var f=u[i];if(isNaN(f)||f<=0)return!0}return!1},o}(Io),Oi={vector:Gi,raster:Bi,"raster-dem":Ys,geojson:so,video:Ea,image:Io,canvas:Go};function Ya(n,o){var i=h.identity([]);return h.translate(i,i,[1,1,0]),h.scale(i,i,[.5*n.width,.5*n.height,1]),h.multiply(i,i,n.calculatePosMatrix(o.toUnwrapped()))}function $n(n,o,i,u,f,m){var y=function(Q,G,$){if(Q)for(var at=0,ht=Q;at<ht.length;at+=1){var St=G[ht[at]];if(St&&St.source===$&&St.type==="fill-extrusion")return!0}else for(var bt in G){var Tt=G[bt];if(Tt.source===$&&Tt.type==="fill-extrusion")return!0}return!1}(f&&f.layers,o,n.id),_=m.maxPitchScaleFactor(),T=n.tilesIn(u,_,y);T.sort(ci);for(var C=[],B=0,U=T;B<U.length;B+=1){var O=U[B];C.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(o,i,n._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,f,m,_,Ya(n.transform,O.tileID))})}var K=function(Q){for(var G={},$={},at=0,ht=Q;at<ht.length;at+=1){var St=ht[at],bt=St.queryResults,Tt=St.wrappedTileID,Ct=$[Tt]=$[Tt]||{};for(var Vt in bt)for(var Ut=bt[Vt],Jt=Ct[Vt]=Ct[Vt]||{},ae=G[Vt]=G[Vt]||[],ve=0,de=Ut;ve<de.length;ve+=1){var ar=de[ve];Jt[ar.featureIndex]||(Jt[ar.featureIndex]=!0,ae.push(ar))}}return G}(C);for(var W in K)K[W].forEach(function(Q){var G=Q.feature,$=n.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=$});return K}function ci(n,o){var i=n.tileID,u=o.tileID;return i.overscaledZ-u.overscaledZ||i.canonical.y-u.canonical.y||i.wrap-u.wrap||i.canonical.x-u.canonical.x}var pr=function(n,o){this.max=n,this.onRemove=o,this.reset()};pr.prototype.reset=function(){for(var n in this.data)for(var o=0,i=this.data[n];o<i.length;o+=1){var u=i[o];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},pr.prototype.add=function(n,o,i){var u=this,f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);var m={value:o,timeout:void 0};if(i!==void 0&&(m.timeout=setTimeout(function(){u.remove(n,m)},i)),this.data[f].push(m),this.order.push(f),this.order.length>this.max){var y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this},pr.prototype.has=function(n){return n.wrapped().key in this.data},pr.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},pr.prototype._getAndRemoveByKey=function(n){var o=this.data[n].shift();return o.timeout&&clearTimeout(o.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),o.value},pr.prototype.getByKey=function(n){var o=this.data[n];return o?o[0].value:null},pr.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},pr.prototype.remove=function(n,o){if(!this.has(n))return this;var i=n.wrapped().key,u=o===void 0?0:this.data[i].indexOf(o),f=this.data[i][u];return this.data[i].splice(u,1),f.timeout&&clearTimeout(f.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(f.value),this.order.splice(this.order.indexOf(i),1),this},pr.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},pr.prototype.filter=function(n){var o=[];for(var i in this.data)for(var u=0,f=this.data[i];u<f.length;u+=1){var m=f[u];n(m.value)||o.push(m)}for(var y=0,_=o;y<_.length;y+=1){var T=_[y];this.remove(T.value.tileID,T)}};var Wi=function(n,o,i){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};Wi.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Wi.prototype.updateData=function(n){var o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Wi.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Eo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},hi=function(n,o,i,u){this.length=o.length,this.attributes=i,this.itemSize=o.bytesPerElement,this.dynamicDraw=u,this.context=n;var f=n.gl;this.buffer=f.createBuffer(),n.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};hi.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},hi.prototype.updateData=function(n){var o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,n.arrayBuffer)},hi.prototype.enableAttributes=function(n,o){for(var i=0;i<this.attributes.length;i++){var u=o.attributes[this.attributes[i].name];u!==void 0&&n.enableVertexAttribArray(u)}},hi.prototype.setVertexAttribPointers=function(n,o,i){for(var u=0;u<this.attributes.length;u++){var f=this.attributes[u],m=o.attributes[f.name];m!==void 0&&n.vertexAttribPointer(m,f.components,n[Eo[f.type]],!1,this.itemSize,f.offset+this.itemSize*(i||0))}},hi.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var He=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};He.prototype.get=function(){return this.current},He.prototype.set=function(n){},He.prototype.getDefault=function(){return this.default},He.prototype.setDefault=function(){this.set(this.default)};var An=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return h.Color.transparent},o.prototype.set=function(i){var u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},o}(He),dn=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 1},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)},o}(He),Fi=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)},o}(He),Xi=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return[!0,!0,!0,!0]},o.prototype.set=function(i){var u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},o}(He),Ui=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)},o}(He),Ja=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 255},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)},o}(He),Qn=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},o.prototype.set=function(i){var u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)},o}(He),jn=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]},o.prototype.set=function(i){var u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)},o}(He),Ao=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}},o}(He),pi=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return[0,1]},o.prototype.set=function(i){var u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)},o}(He),Hi=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}},o}(He),uo=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.LESS},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)},o}(He),lo=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}},o}(He),ia=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[i.ONE,i.ZERO]},o.prototype.set=function(i){var u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)},o}(He),Wo=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return h.Color.transparent},o.prototype.set=function(i){var u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)},o}(He),Aa=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.FUNC_ADD},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)},o}(He),Pa=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}},o}(He),oa=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.BACK},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)},o}(He),$a=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.CCW},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)},o}(He),co=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)},o}(He),Ca=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.TEXTURE0},o.prototype.set=function(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)},o}(He),Po=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){var i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]},o.prototype.set=function(i){var u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)},o}(He),za=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}},o}(He),ka=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}},o}(He),Js=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}},o}(He),xs=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}},o}(He),Ma=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1},o}(He),aa=function(n){function o(i){n.call(this,i),this.vao=i.extVertexArrayObject}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)},o}(He),Co=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return 4},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}},o}(He),La=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}},o}(He),Qa=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(i){if(i!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}},o}(He),Gr=function(n){function o(i,u){n.call(this,i),this.context=i,this.parent=u}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o}(He),A=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.setDirty=function(){this.dirty=!0},o.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}},o}(Gr),M=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.set=function(i){if(i!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}},o}(Gr),L=function(n,o,i,u){this.context=n,this.width=o,this.height=i;var f=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new A(n,f),u&&(this.depthAttachment=new M(n,f))};L.prototype.destroy=function(){var n=this.context.gl,o=this.colorAttachment.get();if(o&&n.deleteTexture(o),this.depthAttachment){var i=this.depthAttachment.get();i&&n.deleteRenderbuffer(i)}n.deleteFramebuffer(this.framebuffer)};var N=function(n,o,i){this.func=n,this.mask=o,this.range=i};N.ReadOnly=!1,N.ReadWrite=!0,N.disabled=new N(519,N.ReadOnly,[0,1]);var X=function(n,o,i,u,f,m){this.test=n,this.ref=o,this.mask=i,this.fail=u,this.depthFail=f,this.pass=m};X.disabled=new X({func:519,mask:0},0,0,7680,7680,7680);var rt=function(n,o,i){this.blendFunction=n,this.blendColor=o,this.mask=i};rt.disabled=new rt(rt.Replace=[1,0],h.Color.transparent,[!1,!1,!1,!1]),rt.unblended=new rt(rt.Replace,h.Color.transparent,[!0,!0,!0,!0]),rt.alphaBlended=new rt([1,771],h.Color.transparent,[!0,!0,!0,!0]);var st=function(n,o,i){this.enable=n,this.mode=o,this.frontFace=i};st.disabled=new st(!1,1029,2305),st.backCCW=new st(!0,1029,2305);var nt=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new An(this),this.clearDepth=new dn(this),this.clearStencil=new Fi(this),this.colorMask=new Xi(this),this.depthMask=new Ui(this),this.stencilMask=new Ja(this),this.stencilFunc=new Qn(this),this.stencilOp=new jn(this),this.stencilTest=new Ao(this),this.depthRange=new pi(this),this.depthTest=new Hi(this),this.depthFunc=new uo(this),this.blend=new lo(this),this.blendFunc=new ia(this),this.blendColor=new Wo(this),this.blendEquation=new Aa(this),this.cullFace=new Pa(this),this.cullFaceSide=new oa(this),this.frontFace=new $a(this),this.program=new co(this),this.activeTexture=new Ca(this),this.viewport=new Po(this),this.bindFramebuffer=new za(this),this.bindRenderbuffer=new ka(this),this.bindTexture=new Js(this),this.bindVertexBuffer=new xs(this),this.bindElementBuffer=new Ma(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new aa(this),this.pixelStoreUnpack=new Co(this),this.pixelStoreUnpackPremultiplyAlpha=new La(this),this.pixelStoreUnpackFlipY=new Qa(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};nt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},nt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},nt.prototype.createIndexBuffer=function(n,o){return new Wi(this,n,o)},nt.prototype.createVertexBuffer=function(n,o,i){return new hi(this,n,o,i)},nt.prototype.createRenderbuffer=function(n,o,i){var u=this.gl,f=u.createRenderbuffer();return this.bindRenderbuffer.set(f),u.renderbufferStorage(u.RENDERBUFFER,n,o,i),this.bindRenderbuffer.set(null),f},nt.prototype.createFramebuffer=function(n,o,i){return new L(this,n,o,i)},nt.prototype.clear=function(n){var o=n.color,i=n.depth,u=this.gl,f=0;o&&(f|=u.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(f|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),u.clear(f)},nt.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},nt.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},nt.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},nt.prototype.setColorMode=function(n){h.deepEqual(n.blendFunction,rt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},nt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var V=function(n){function o(i,u,f){var m=this;n.call(this),this.id=i,this.dispatcher=f,this.on("data",function(y){y.dataType==="source"&&y.sourceDataType==="metadata"&&(m._sourceLoaded=!0),m._sourceLoaded&&!m._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(m.reload(),m.transform&&m.update(m.transform))}),this.on("error",function(){m._sourceErrored=!0}),this._source=function(y,_,T,C){var B=new Oi[_.type](y,_,T,C);if(B.id!==y)throw new Error("Expected Source id to be "+y+" instead of "+B.id);return h.bindAll(["load","abort","unload","serialize","prepare"],B),B}(i,u,f,this),this._tiles={},this._cache=new pr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new h.SourceFeatureState}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.onAdd=function(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)},o.prototype.onRemove=function(i){this._source&&this._source.onRemove&&this._source.onRemove(i)},o.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var i in this._tiles){var u=this._tiles[i];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},o.prototype.getSource=function(){return this._source},o.prototype.pause=function(){this._paused=!0},o.prototype.resume=function(){if(this._paused){var i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}},o.prototype._loadTile=function(i,u){return this._source.loadTile(i,u)},o.prototype._unloadTile=function(i){if(this._source.unloadTile)return this._source.unloadTile(i,function(){})},o.prototype._abortTile=function(i){if(this._source.abortTile)return this._source.abortTile(i,function(){})},o.prototype.serialize=function(){return this._source.serialize()},o.prototype.prepare=function(i){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var f=this._tiles[u];f.upload(i),f.prepare(this.map.style.imageManager)}},o.prototype.getIds=function(){return h.values(this._tiles).map(function(i){return i.tileID}).sort(Y).map(function(i){return i.key})},o.prototype.getRenderableIds=function(i){var u=this,f=[];for(var m in this._tiles)this._isIdRenderable(m,i)&&f.push(this._tiles[m]);return i?f.sort(function(y,_){var T=y.tileID,C=_.tileID,B=new h.Point(T.canonical.x,T.canonical.y)._rotate(u.transform.angle),U=new h.Point(C.canonical.x,C.canonical.y)._rotate(u.transform.angle);return T.overscaledZ-C.overscaledZ||U.y-B.y||U.x-B.x}).map(function(y){return y.tileID.key}):f.map(function(y){return y.tileID}).sort(Y).map(function(y){return y.key})},o.prototype.hasRenderableParent=function(i){var u=this.findLoadedParent(i,0);return!!u&&this._isIdRenderable(u.tileID.key)},o.prototype._isIdRenderable=function(i,u){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(u||!this._tiles[i].holdingForFade())},o.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var i in this._cache.reset(),this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")},o.prototype._reloadTile=function(i,u){var f=this._tiles[i];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,i,u)))},o.prototype._tileLoaded=function(i,u,f,m){if(m)return i.state="errored",void(m.status!==404?this._source.fire(new h.ErrorEvent(m,{tile:i})):this.update(this.transform));i.timeAdded=h.browser.now(),f==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(u,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new h.Event("data",{dataType:"source",tile:i,coord:i.tileID}))},o.prototype._backfillDEM=function(i){for(var u=this.getRenderableIds(),f=0;f<u.length;f++){var m=u[f];if(i.neighboringTiles&&i.neighboringTiles[m]){var y=this.getTileByID(m);_(i,y),_(y,i)}}function _(T,C){T.needsHillshadePrepare=!0;var B=C.tileID.canonical.x-T.tileID.canonical.x,U=C.tileID.canonical.y-T.tileID.canonical.y,O=Math.pow(2,T.tileID.canonical.z),K=C.tileID.key;B===0&&U===0||Math.abs(U)>1||(Math.abs(B)>1&&(Math.abs(B+O)===1?B+=O:Math.abs(B-O)===1&&(B-=O)),C.dem&&T.dem&&(T.dem.backfillBorder(C.dem,B,U),T.neighboringTiles&&T.neighboringTiles[K]&&(T.neighboringTiles[K].backfilled=!0)))}},o.prototype.getTile=function(i){return this.getTileByID(i.key)},o.prototype.getTileByID=function(i){return this._tiles[i]},o.prototype._retainLoadedChildren=function(i,u,f,m){for(var y in this._tiles){var _=this._tiles[y];if(!(m[y]||!_.hasData()||_.tileID.overscaledZ<=u||_.tileID.overscaledZ>f)){for(var T=_.tileID;_&&_.tileID.overscaledZ>u+1;){var C=_.tileID.scaledTo(_.tileID.overscaledZ-1);(_=this._tiles[C.key])&&_.hasData()&&(T=C)}for(var B=T;B.overscaledZ>u;)if(i[(B=B.scaledTo(B.overscaledZ-1)).key]){m[T.key]=T;break}}}},o.prototype.findLoadedParent=function(i,u){if(i.key in this._loadedParentTiles){var f=this._loadedParentTiles[i.key];return f&&f.tileID.overscaledZ>=u?f:null}for(var m=i.overscaledZ-1;m>=u;m--){var y=i.scaledTo(m),_=this._getLoadedTile(y);if(_)return _}},o.prototype._getLoadedTile=function(i){var u=this._tiles[i.key];return u&&u.hasData()?u:this._cache.getByKey(i.wrapped().key)},o.prototype.updateCacheSize=function(i){var u=Math.ceil(i.width/this._source.tileSize)+1,f=Math.ceil(i.height/this._source.tileSize)+1,m=Math.floor(u*f*5),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(y)},o.prototype.handleWrapJump=function(i){var u=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,u){var f={};for(var m in this._tiles){var y=this._tiles[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+u),f[y.tileID.key]=y}for(var _ in this._tiles=f,this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(var T in this._tiles)this._setTileReloadTimer(T,this._tiles[T])}},o.prototype.update=function(i){var u=this;if(this.transform=i,this._sourceLoaded&&!this._paused){var f;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?f=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ct){return new h.OverscaledTileID(Ct.canonical.z,Ct.wrap,Ct.canonical.z,Ct.canonical.x,Ct.canonical.y)}):(f=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(f=f.filter(function(Ct){return u._source.hasTile(Ct)}))):f=[];var m=i.coveringZoomLevel(this._source),y=Math.max(m-o.maxOverzooming,this._source.minzoom),_=Math.max(m+o.maxUnderzooming,this._source.minzoom),T=this._updateRetainedTiles(f,m);if(Lt(this._source.type)){for(var C={},B={},U=0,O=Object.keys(T);U<O.length;U+=1){var K=O[U],W=T[K],Q=this._tiles[K];if(Q&&!(Q.fadeEndTime&&Q.fadeEndTime<=h.browser.now())){var G=this.findLoadedParent(W,y);G&&(this._addTile(G.tileID),C[G.tileID.key]=G.tileID),B[K]=W}}for(var $ in this._retainLoadedChildren(B,m,_,T),C)T[$]||(this._coveredTiles[$]=!0,T[$]=C[$])}for(var at in T)this._tiles[at].clearFadeHold();for(var ht=0,St=h.keysDifference(this._tiles,T);ht<St.length;ht+=1){var bt=St[ht],Tt=this._tiles[bt];Tt.hasSymbolBuckets&&!Tt.holdingForFade()?Tt.setHoldDuration(this.map._fadeDuration):Tt.hasSymbolBuckets&&!Tt.symbolFadeFinished()||this._removeTile(bt)}this._updateLoadedParentTileCache()}},o.prototype.releaseSymbolFadeTiles=function(){for(var i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)},o.prototype._updateRetainedTiles=function(i,u){for(var f={},m={},y=Math.max(u-o.maxOverzooming,this._source.minzoom),_=Math.max(u+o.maxUnderzooming,this._source.minzoom),T={},C=0,B=i;C<B.length;C+=1){var U=B[C],O=this._addTile(U);f[U.key]=U,O.hasData()||u<this._source.maxzoom&&(T[U.key]=U)}this._retainLoadedChildren(T,u,_,f);for(var K=0,W=i;K<W.length;K+=1){var Q=W[K],G=this._tiles[Q.key];if(!G.hasData()){if(u+1>this._source.maxzoom){var $=Q.children(this._source.maxzoom)[0],at=this.getTile($);if(at&&at.hasData()){f[$.key]=$;continue}}else{var ht=Q.children(this._source.maxzoom);if(f[ht[0].key]&&f[ht[1].key]&&f[ht[2].key]&&f[ht[3].key])continue}for(var St=G.wasRequested(),bt=Q.overscaledZ-1;bt>=y;--bt){var Tt=Q.scaledTo(bt);if(m[Tt.key]||(m[Tt.key]=!0,!(G=this.getTile(Tt))&&St&&(G=this._addTile(Tt)),G&&(f[Tt.key]=Tt,St=G.wasRequested(),G.hasData())))break}}}return f},o.prototype._updateLoadedParentTileCache=function(){for(var i in this._loadedParentTiles={},this._tiles){for(var u=[],f=void 0,m=this._tiles[i].tileID;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){f=this._loadedParentTiles[m.key];break}u.push(m.key);var y=m.scaledTo(m.overscaledZ-1);if(f=this._getLoadedTile(y))break;m=y}for(var _=0,T=u;_<T.length;_+=1)this._loadedParentTiles[T[_]]=f}},o.prototype._addTile=function(i){var u=this._tiles[i.key];if(u)return u;(u=this._cache.getAndRemove(i))&&(this._setTileReloadTimer(i.key,u),u.tileID=i,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,u)));var f=Boolean(u);return f||(u=new h.Tile(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,i.key,u.state))),u?(u.uses++,this._tiles[i.key]=u,f||this._source.fire(new h.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},o.prototype._setTileReloadTimer=function(i,u){var f=this;i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);var m=u.getExpiryTimeout();m&&(this._timers[i]=setTimeout(function(){f._reloadTile(i,"expired"),delete f._timers[i]},m))},o.prototype._removeTile=function(i){var u=this._tiles[i];u&&(u.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},o.prototype.clearTiles=function(){for(var i in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(i);this._cache.reset()},o.prototype.tilesIn=function(i,u,f){var m=this,y=[],_=this.transform;if(!_)return y;for(var T=f?_.getCameraQueryGeometry(i):i,C=i.map(function(bt){return _.pointCoordinate(bt)}),B=T.map(function(bt){return _.pointCoordinate(bt)}),U=this.getIds(),O=1/0,K=1/0,W=-1/0,Q=-1/0,G=0,$=B;G<$.length;G+=1){var at=$[G];O=Math.min(O,at.x),K=Math.min(K,at.y),W=Math.max(W,at.x),Q=Math.max(Q,at.y)}for(var ht=function(bt){var Tt=m._tiles[U[bt]];if(!Tt.holdingForFade()){var Ct=Tt.tileID,Vt=Math.pow(2,_.zoom-Tt.tileID.overscaledZ),Ut=u*Tt.queryPadding*h.EXTENT/Tt.tileSize/Vt,Jt=[Ct.getTilePoint(new h.MercatorCoordinate(O,K)),Ct.getTilePoint(new h.MercatorCoordinate(W,Q))];if(Jt[0].x-Ut<h.EXTENT&&Jt[0].y-Ut<h.EXTENT&&Jt[1].x+Ut>=0&&Jt[1].y+Ut>=0){var ae=C.map(function(de){return Ct.getTilePoint(de)}),ve=B.map(function(de){return Ct.getTilePoint(de)});y.push({tile:Tt,tileID:Ct,queryGeometry:ae,cameraQueryGeometry:ve,scale:Vt})}}},St=0;St<U.length;St++)ht(St);return y},o.prototype.getVisibleCoordinates=function(i){for(var u=this,f=this.getRenderableIds(i).map(function(T){return u._tiles[T].tileID}),m=0,y=f;m<y.length;m+=1){var _=y[m];_.posMatrix=this.transform.calculatePosMatrix(_.toUnwrapped())}return f},o.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Lt(this._source.type))for(var i in this._tiles){var u=this._tiles[i];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=h.browser.now())return!0}return!1},o.prototype.setFeatureState=function(i,u,f){this._state.updateState(i=i||"_geojsonTileLayer",u,f)},o.prototype.removeFeatureState=function(i,u,f){this._state.removeFeatureState(i=i||"_geojsonTileLayer",u,f)},o.prototype.getFeatureState=function(i,u){return this._state.getState(i=i||"_geojsonTileLayer",u)},o.prototype.setDependencies=function(i,u,f){var m=this._tiles[i];m&&m.setDependencies(u,f)},o.prototype.reloadTilesForDependencies=function(i,u){for(var f in this._tiles)this._tiles[f].hasDependency(i,u)&&this._reloadTile(f,"reloading");this._cache.filter(function(m){return!m.hasDependency(i,u)})},o}(h.Evented);function Y(n,o){var i=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*o.wrap)-+(o.wrap<0);return n.overscaledZ-o.overscaledZ||u-i||o.canonical.y-n.canonical.y||o.canonical.x-n.canonical.x}function Lt(n){return n==="raster"||n==="image"||n==="video"}function Wt(){return new h.window.Worker(Fo.workerUrl)}V.maxOverzooming=10,V.maxUnderzooming=3;var vt="mapboxgl_preloaded_worker_pool",Rt=function(){this.active={}};Rt.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Rt.workerCount;)this.workers.push(new Wt);return this.active[n]=!0,this.workers.slice()},Rt.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(o){o.terminate()}),this.workers=null)},Rt.prototype.isPreloaded=function(){return!!this.active[vt]},Rt.prototype.numActive=function(){return Object.keys(this.active).length};var ee,re=Math.floor(h.browser.hardwareConcurrency/2);function ce(){return ee||(ee=new Rt),ee}function At(n,o){var i={};for(var u in n)u!=="ref"&&(i[u]=n[u]);return h.refProperties.forEach(function(f){f in o&&(i[f]=o[f])}),i}function Ht(n){n=n.slice();for(var o=Object.create(null),i=0;i<n.length;i++)o[n[i].id]=n[i];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=At(n[u],o[n[u].ref]));return n}Rt.workerCount=Math.max(Math.min(re,6),1);var kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Me(n,o,i){i.push({command:kt.addSource,args:[n,o[n]]})}function Le(n,o,i){o.push({command:kt.removeSource,args:[n]}),i[n]=!0}function ne(n,o,i,u){Le(n,i,u),Me(n,o,i)}function _r(n,o,i){var u;for(u in n[i])if(n[i].hasOwnProperty(u)&&u!=="data"&&!h.deepEqual(n[i][u],o[i][u]))return!1;for(u in o[i])if(o[i].hasOwnProperty(u)&&u!=="data"&&!h.deepEqual(n[i][u],o[i][u]))return!1;return!0}function we(n,o,i,u,f,m){var y;for(y in o=o||{},n=n||{})n.hasOwnProperty(y)&&(h.deepEqual(n[y],o[y])||i.push({command:m,args:[u,y,o[y],f]}));for(y in o)o.hasOwnProperty(y)&&!n.hasOwnProperty(y)&&(h.deepEqual(n[y],o[y])||i.push({command:m,args:[u,y,o[y],f]}))}function br(n){return n.id}function Mr(n,o){return n[o.id]=o,n}var rr=function(n,o){this.reset(n,o)};rr.prototype.reset=function(n,o){this.points=n||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding},rr.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=h.clamp(n,0,1);for(var o=1,i=this._distances[o],u=n*this.paddedLength+this.padding;i<u&&o<this._distances.length;)i=this._distances[++o];var f=o-1,m=this._distances[f],y=i-m,_=y>0?(u-m)/y:0;return this.points[f].mult(1-_).add(this.points[o].mult(_))};var wr=function(n,o,i){var u=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(n/i),this.yCellCount=Math.ceil(o/i);for(var m=0;m<this.xCellCount*this.yCellCount;m++)u.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=o,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0};function Fr(n,o,i,u,f){var m=h.create();return o?(h.scale(m,m,[1/f,1/f,1]),i||h.rotateZ(m,m,u.angle)):h.multiply(m,u.labelPlaneMatrix,n),m}function Sr(n,o,i,u,f){if(o){var m=h.clone(n);return h.scale(m,m,[f,f,1]),i||h.rotateZ(m,m,-u.angle),m}return u.glCoordMatrix}function Ve(n,o){var i=[n.x,n.y,0,1];fi(i,i,o);var u=i[3];return{point:new h.Point(i[0]/u,i[1]/u),signedDistanceFromCamera:u}}function ts(n,o){return .5+n/o*.5}function Ye(n,o){var i=n[0]/n[3],u=n[1]/n[3];return i>=-o[0]&&i<=o[0]&&u>=-o[1]&&u<=o[1]}function Da(n,o,i,u,f,m,y,_){var T=u?n.textSizeData:n.iconSizeData,C=h.evaluateSizeForZoom(T,i.transform.zoom),B=[256/i.width*2+1,256/i.height*2+1],U=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;U.clear();for(var O=n.lineVertexArray,K=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,W=i.transform.width/i.transform.height,Q=!1,G=0;G<K.length;G++){var $=K.get(G);if($.hidden||$.writingMode===h.WritingMode.vertical&&!Q)ho($.numGlyphs,U);else{Q=!1;var at=[$.anchorX,$.anchorY,0,1];if(h.transformMat4(at,at,o),Ye(at,B)){var ht=ts(i.transform.cameraToCenterDistance,at[3]),St=h.evaluateSizeForFeature(T,C,$),bt=y?St/ht:St*ht,Tt=new h.Point($.anchorX,$.anchorY),Ct=Ve(Tt,f).point,Vt={},Ut=Gn($,bt,!1,_,o,f,m,n.glyphOffsetArray,O,U,Ct,Tt,Vt,W);Q=Ut.useVertical,(Ut.notEnoughRoom||Q||Ut.needsFlipping&&Gn($,bt,!0,_,o,f,m,n.glyphOffsetArray,O,U,Ct,Tt,Vt,W).notEnoughRoom)&&ho($.numGlyphs,U)}else ho($.numGlyphs,U)}}u?n.text.dynamicLayoutVertexBuffer.updateData(U):n.icon.dynamicLayoutVertexBuffer.updateData(U)}function es(n,o,i,u,f,m,y,_,T,C,B){var U=_.glyphStartIndex+_.numGlyphs,O=_.lineStartIndex,K=_.lineStartIndex+_.lineLength,W=o.getoffsetX(_.glyphStartIndex),Q=o.getoffsetX(U-1),G=Xo(n*W,i,u,f,m,y,_.segment,O,K,T,C,B);if(!G)return null;var $=Xo(n*Q,i,u,f,m,y,_.segment,O,K,T,C,B);return $?{first:G,last:$}:null}function nn(n,o,i,u){return n===h.WritingMode.horizontal&&Math.abs(i.y-o.y)>Math.abs(i.x-o.x)*u?{useVertical:!0}:(n===h.WritingMode.vertical?o.y<i.y:o.x>i.x)?{needsFlipping:!0}:null}function Gn(n,o,i,u,f,m,y,_,T,C,B,U,O,K){var W,Q=o/24,G=n.lineOffsetX*Q,$=n.lineOffsetY*Q;if(n.numGlyphs>1){var at=n.glyphStartIndex+n.numGlyphs,ht=n.lineStartIndex,St=n.lineStartIndex+n.lineLength,bt=es(Q,_,G,$,i,B,U,n,T,m,O);if(!bt)return{notEnoughRoom:!0};var Tt=Ve(bt.first.point,y).point,Ct=Ve(bt.last.point,y).point;if(u&&!i){var Vt=nn(n.writingMode,Tt,Ct,K);if(Vt)return Vt}W=[bt.first];for(var Ut=n.glyphStartIndex+1;Ut<at-1;Ut++)W.push(Xo(Q*_.getoffsetX(Ut),G,$,i,B,U,n.segment,ht,St,T,m,O));W.push(bt.last)}else{if(u&&!i){var Jt=Ve(U,f).point,ae=n.lineStartIndex+n.segment+1,ve=new h.Point(T.getx(ae),T.gety(ae)),de=Ve(ve,f),ar=de.signedDistanceFromCamera>0?de.point:$s(U,ve,Jt,1,f),te=nn(n.writingMode,Jt,ar,K);if(te)return te}var Se=Xo(Q*_.getoffsetX(n.glyphStartIndex),G,$,i,B,U,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,T,m,O);if(!Se)return{notEnoughRoom:!0};W=[Se]}for(var Ze=0,Re=W;Ze<Re.length;Ze+=1){var Pe=Re[Ze];h.addDynamicAttributes(C,Pe.point,Pe.angle)}return{}}function $s(n,o,i,u,f){var m=Ve(n.add(n.sub(o)._unit()),f).point,y=i.sub(m);return i.add(y._mult(u/y.mag()))}function Xo(n,o,i,u,f,m,y,_,T,C,B,U){var O=u?n-o:n+o,K=O>0?1:-1,W=0;u&&(K*=-1,W=Math.PI),K<0&&(W+=Math.PI);for(var Q=K>0?_+y:_+y+1,G=f,$=f,at=0,ht=0,St=Math.abs(O),bt=[];at+ht<=St;){if((Q+=K)<_||Q>=T)return null;if($=G,bt.push(G),(G=U[Q])===void 0){var Tt=new h.Point(C.getx(Q),C.gety(Q)),Ct=Ve(Tt,B);if(Ct.signedDistanceFromCamera>0)G=U[Q]=Ct.point;else{var Vt=Q-K;G=$s(at===0?m:new h.Point(C.getx(Vt),C.gety(Vt)),Tt,$,St-at+1,B)}}at+=ht,ht=$.dist(G)}var Ut=(St-at)/ht,Jt=G.sub($),ae=Jt.mult(Ut)._add($);ae._add(Jt._unit()._perp()._mult(i*K));var ve=W+Math.atan2(G.y-$.y,G.x-$.x);return bt.push(ae),{point:ae,angle:ve,path:bt}}wr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},wr.prototype.insert=function(n,o,i,u,f){this._forEachCell(o,i,u,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(o),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(f)},wr.prototype.insertCircle=function(n,o,i,u){this._forEachCell(o-u,i-u,o+u,i+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(o),this.circles.push(i),this.circles.push(u)},wr.prototype._insertBoxCell=function(n,o,i,u,f,m){this.boxCells[f].push(m)},wr.prototype._insertCircleCell=function(n,o,i,u,f,m){this.circleCells[f].push(m)},wr.prototype._query=function(n,o,i,u,f,m){if(i<0||n>this.width||u<0||o>this.height)return!f&&[];var y=[];if(n<=0&&o<=0&&this.width<=i&&this.height<=u){if(f)return!0;for(var _=0;_<this.boxKeys.length;_++)y.push({key:this.boxKeys[_],x1:this.bboxes[4*_],y1:this.bboxes[4*_+1],x2:this.bboxes[4*_+2],y2:this.bboxes[4*_+3]});for(var T=0;T<this.circleKeys.length;T++){var C=this.circles[3*T],B=this.circles[3*T+1],U=this.circles[3*T+2];y.push({key:this.circleKeys[T],x1:C-U,y1:B-U,x2:C+U,y2:B+U})}return m?y.filter(m):y}return this._forEachCell(n,o,i,u,this._queryCell,y,{hitTest:f,seenUids:{box:{},circle:{}}},m),f?y.length>0:y},wr.prototype._queryCircle=function(n,o,i,u,f){var m=n-i,y=n+i,_=o-i,T=o+i;if(y<0||m>this.width||T<0||_>this.height)return!u&&[];var C=[];return this._forEachCell(m,_,y,T,this._queryCellCircle,C,{hitTest:u,circle:{x:n,y:o,radius:i},seenUids:{box:{},circle:{}}},f),u?C.length>0:C},wr.prototype.query=function(n,o,i,u,f){return this._query(n,o,i,u,!1,f)},wr.prototype.hitTest=function(n,o,i,u,f){return this._query(n,o,i,u,!0,f)},wr.prototype.hitTestCircle=function(n,o,i,u){return this._queryCircle(n,o,i,!0,u)},wr.prototype._queryCell=function(n,o,i,u,f,m,y,_){var T=y.seenUids,C=this.boxCells[f];if(C!==null)for(var B=this.bboxes,U=0,O=C;U<O.length;U+=1){var K=O[U];if(!T.box[K]){T.box[K]=!0;var W=4*K;if(n<=B[W+2]&&o<=B[W+3]&&i>=B[W+0]&&u>=B[W+1]&&(!_||_(this.boxKeys[K]))){if(y.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[K],x1:B[W],y1:B[W+1],x2:B[W+2],y2:B[W+3]})}}}var Q=this.circleCells[f];if(Q!==null)for(var G=this.circles,$=0,at=Q;$<at.length;$+=1){var ht=at[$];if(!T.circle[ht]){T.circle[ht]=!0;var St=3*ht;if(this._circleAndRectCollide(G[St],G[St+1],G[St+2],n,o,i,u)&&(!_||_(this.circleKeys[ht]))){if(y.hitTest)return m.push(!0),!0;var bt=G[St],Tt=G[St+1],Ct=G[St+2];m.push({key:this.circleKeys[ht],x1:bt-Ct,y1:Tt-Ct,x2:bt+Ct,y2:Tt+Ct})}}}},wr.prototype._queryCellCircle=function(n,o,i,u,f,m,y,_){var T=y.circle,C=y.seenUids,B=this.boxCells[f];if(B!==null)for(var U=this.bboxes,O=0,K=B;O<K.length;O+=1){var W=K[O];if(!C.box[W]){C.box[W]=!0;var Q=4*W;if(this._circleAndRectCollide(T.x,T.y,T.radius,U[Q+0],U[Q+1],U[Q+2],U[Q+3])&&(!_||_(this.boxKeys[W])))return m.push(!0),!0}}var G=this.circleCells[f];if(G!==null)for(var $=this.circles,at=0,ht=G;at<ht.length;at+=1){var St=ht[at];if(!C.circle[St]){C.circle[St]=!0;var bt=3*St;if(this._circlesCollide($[bt],$[bt+1],$[bt+2],T.x,T.y,T.radius)&&(!_||_(this.circleKeys[St])))return m.push(!0),!0}}},wr.prototype._forEachCell=function(n,o,i,u,f,m,y,_){for(var T=this._convertToXCellCoord(n),C=this._convertToYCellCoord(o),B=this._convertToXCellCoord(i),U=this._convertToYCellCoord(u),O=T;O<=B;O++)for(var K=C;K<=U;K++)if(f.call(this,n,o,i,u,this.xCellCount*K+O,m,y,_))return},wr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},wr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},wr.prototype._circlesCollide=function(n,o,i,u,f,m){var y=u-n,_=f-o,T=i+m;return T*T>y*y+_*_},wr.prototype._circleAndRectCollide=function(n,o,i,u,f,m,y){var _=(m-u)/2,T=Math.abs(n-(u+_));if(T>_+i)return!1;var C=(y-f)/2,B=Math.abs(o-(f+C));if(B>C+i)return!1;if(T<=_||B<=C)return!0;var U=T-_,O=B-C;return U*U+O*O<=i*i};var wn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ho(n,o){for(var i=0;i<n;i++){var u=o.length;o.resize(u+4),o.float32.set(wn,3*u)}}function fi(n,o,i){var u=o[0],f=o[1];return n[0]=i[0]*u+i[4]*f+i[12],n[1]=i[1]*u+i[5]*f+i[13],n[3]=i[3]*u+i[7]*f+i[15],n}var Ur=function(n,o,i){o===void 0&&(o=new wr(n.width+200,n.height+200,25)),i===void 0&&(i=new wr(n.width+200,n.height+200,25)),this.transform=n,this.grid=o,this.ignoredGrid=i,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function di(n,o,i){return o*(h.EXTENT/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}Ur.prototype.placeCollisionBox=function(n,o,i,u,f){var m=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),y=i*m.perspectiveRatio,_=n.x1*y+m.point.x,T=n.y1*y+m.point.y,C=n.x2*y+m.point.x,B=n.y2*y+m.point.y;return!this.isInsideGrid(_,T,C,B)||!o&&this.grid.hitTest(_,T,C,B,f)?{box:[],offscreen:!1}:{box:[_,T,C,B],offscreen:this.isOffscreen(_,T,C,B)}},Ur.prototype.placeCollisionCircles=function(n,o,i,u,f,m,y,_,T,C,B,U,O){var K=[],W=new h.Point(o.anchorX,o.anchorY),Q=Ve(W,m),G=ts(this.transform.cameraToCenterDistance,Q.signedDistanceFromCamera),$=(C?f/G:f*G)/h.ONE_EM,at=Ve(W,y).point,ht=es($,u,o.lineOffsetX*$,o.lineOffsetY*$,!1,at,W,o,i,y,{}),St=!1,bt=!1,Tt=!0;if(ht){for(var Ct=.5*U*G+O,Vt=new h.Point(-100,-100),Ut=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),Jt=new rr,ae=ht.first,ve=ht.last,de=[],ar=ae.path.length-1;ar>=1;ar--)de.push(ae.path[ar]);for(var te=1;te<ve.path.length;te++)de.push(ve.path[te]);var Se=2.5*Ct;if(_){var Ze=de.map(function(bo){return Ve(bo,_)});de=Ze.some(function(bo){return bo.signedDistanceFromCamera<=0})?[]:Ze.map(function(bo){return bo.point})}var Re=[];if(de.length>0){for(var Pe=de[0].clone(),ke=de[0].clone(),Ae=1;Ae<de.length;Ae++)Pe.x=Math.min(Pe.x,de[Ae].x),Pe.y=Math.min(Pe.y,de[Ae].y),ke.x=Math.max(ke.x,de[Ae].x),ke.y=Math.max(ke.y,de[Ae].y);Re=Pe.x>=Vt.x&&ke.x<=Ut.x&&Pe.y>=Vt.y&&ke.y<=Ut.y?[de]:ke.x<Vt.x||Pe.x>Ut.x||ke.y<Vt.y||Pe.y>Ut.y?[]:h.clipLine([de],Vt.x,Vt.y,Ut.x,Ut.y)}for(var ie=0,Er=Re;ie<Er.length;ie+=1){var sn;Jt.reset(Er[ie],.25*Ct),sn=Jt.length<=.5*Ct?1:Math.ceil(Jt.paddedLength/Se)+1;for(var en=0;en<sn;en++){var Tn=en/Math.max(sn-1,1),vn=Jt.lerp(Tn),Vr=vn.x+100,oi=vn.y+100;K.push(Vr,oi,Ct,0);var un=Vr-Ct,ai=oi-Ct,zi=Vr+Ct,ga=oi+Ct;if(Tt=Tt&&this.isOffscreen(un,ai,zi,ga),bt=bt||this.isInsideGrid(un,ai,zi,ga),!n&&this.grid.hitTestCircle(Vr,oi,Ct,B)&&(St=!0,!T))return{circles:[],offscreen:!1,collisionDetected:St}}}}return{circles:!T&&St||!bt?[]:K,offscreen:Tt,collisionDetected:St}},Ur.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var o=[],i=1/0,u=1/0,f=-1/0,m=-1/0,y=0,_=n;y<_.length;y+=1){var T=_[y],C=new h.Point(T.x+100,T.y+100);i=Math.min(i,C.x),u=Math.min(u,C.y),f=Math.max(f,C.x),m=Math.max(m,C.y),o.push(C)}for(var B={},U={},O=0,K=this.grid.query(i,u,f,m).concat(this.ignoredGrid.query(i,u,f,m));O<K.length;O+=1){var W=K[O],Q=W.key;if(B[Q.bucketInstanceId]===void 0&&(B[Q.bucketInstanceId]={}),!B[Q.bucketInstanceId][Q.featureIndex]){var G=[new h.Point(W.x1,W.y1),new h.Point(W.x2,W.y1),new h.Point(W.x2,W.y2),new h.Point(W.x1,W.y2)];h.polygonIntersectsPolygon(o,G)&&(B[Q.bucketInstanceId][Q.featureIndex]=!0,U[Q.bucketInstanceId]===void 0&&(U[Q.bucketInstanceId]=[]),U[Q.bucketInstanceId].push(Q.featureIndex))}}return U},Ur.prototype.insertCollisionBox=function(n,o,i,u,f){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:u,collisionGroupID:f},n[0],n[1],n[2],n[3])},Ur.prototype.insertCollisionCircles=function(n,o,i,u,f){for(var m=o?this.ignoredGrid:this.grid,y={bucketInstanceId:i,featureIndex:u,collisionGroupID:f},_=0;_<n.length;_+=4)m.insertCircle(y,n[_],n[_+1],n[_+2])},Ur.prototype.projectAndGetPerspectiveRatio=function(n,o,i){var u=[o,i,0,1];return fi(u,u,n),{point:new h.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},Ur.prototype.isOffscreen=function(n,o,i,u){return i<100||n>=this.screenRightBoundary||u<100||o>this.screenBottomBoundary},Ur.prototype.isInsideGrid=function(n,o,i,u){return i>=0&&n<this.gridRightBoundary&&u>=0&&o<this.gridBottomBoundary},Ur.prototype.getViewportMatrix=function(){var n=h.identity([]);return h.translate(n,n,[-100,-100,0]),n};var Fn=function(n,o,i,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?o:-o))):u&&i?1:0,this.placed=i};Fn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var mi=function(n,o,i,u,f){this.text=new Fn(n?n.text:null,o,i,f),this.icon=new Fn(n?n.icon:null,o,u,f)};mi.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var po=function(n,o,i){this.text=n,this.icon=o,this.skipFade=i},Yl=function(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]},Pi=function(n,o,i,u,f){this.bucketInstanceId=n,this.featureIndex=o,this.sourceLayerIndex=i,this.bucketIndex=u,this.tileID=f},Qs=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function fo(n,o,i,u,f){var m=h.getAnchorAlignment(n),y=-(m.horizontalAlign-.5)*o,_=-(m.verticalAlign-.5)*i,T=h.evaluateVariableOffset(n,u);return new h.Point(y+T[0]*f,_+T[1]*f)}function $r(n,o,i,u,f,m){var y=n.x1,_=n.x2,T=n.y1,C=n.y2,B=n.anchorPointX,U=n.anchorPointY,O=new h.Point(o,i);return u&&O._rotate(f?m:-m),{x1:y+O.x,y1:T+O.y,x2:_+O.x,y2:C+O.y,anchorPointX:B,anchorPointY:U}}Qs.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var o=++this.maxGroupID;this.collisionGroups[n]={ID:o,predicate:function(i){return i.collisionGroupID===o}}}return this.collisionGroups[n]};var on=function(n,o,i,u){this.transform=n.clone(),this.collisionIndex=new Ur(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new Qs(i),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function Ra(n,o,i,u,f){n.emplaceBack(o?1:0,i?1:0,u||0,f||0),n.emplaceBack(o?1:0,i?1:0,u||0,f||0),n.emplaceBack(o?1:0,i?1:0,u||0,f||0),n.emplaceBack(o?1:0,i?1:0,u||0,f||0)}on.prototype.getBucketParts=function(n,o,i,u){var f=i.getBucket(o),m=i.latestFeatureIndex;if(f&&m&&o.id===f.layerIds[0]){var y=i.collisionBoxArray,_=f.layers[0].layout,T=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),C=i.tileSize/h.EXTENT,B=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),U=_.get("text-pitch-alignment")==="map",O=_.get("text-rotation-alignment")==="map",K=di(i,1,this.transform.zoom),W=Fr(B,U,O,this.transform,K),Q=null;if(U){var G=Sr(B,U,O,this.transform,K);Q=h.multiply([],this.transform.labelPlaneMatrix,G)}this.retainedQueryData[f.bucketInstanceId]=new Pi(f.bucketInstanceId,m,f.sourceLayerIndex,f.index,i.tileID);var $={bucket:f,layout:_,posMatrix:B,textLabelPlaneMatrix:W,labelToScreenMatrix:Q,scale:T,textPixelRatio:C,holdingForFade:i.holdingForFade(),collisionBoxArray:y,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(u)for(var at=0,ht=f.sortKeyRanges;at<ht.length;at+=1){var St=ht[at];n.push({sortKey:St.sortKey,symbolInstanceStart:St.symbolInstanceStart,symbolInstanceEnd:St.symbolInstanceEnd,parameters:$})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:$})}},on.prototype.attemptAnchorPlacement=function(n,o,i,u,f,m,y,_,T,C,B,U,O,K,W){var Q,G=[U.textOffset0,U.textOffset1],$=fo(n,i,u,G,f),at=this.collisionIndex.placeCollisionBox($r(o,$.x,$.y,m,y,this.transform.angle),B,_,T,C.predicate);if(!W||this.collisionIndex.placeCollisionBox($r(W,$.x,$.y,m,y,this.transform.angle),B,_,T,C.predicate).box.length!==0)return at.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(Q=this.prevPlacement.variableOffsets[U.crossTileID].anchor),this.variableOffsets[U.crossTileID]={textOffset:G,width:i,height:u,anchor:n,textBoxScale:f,prevAnchor:Q},this.markUsedJustification(O,n,U,K),O.allowVerticalPlacement&&(this.markUsedOrientation(O,K,U),this.placedOrientations[U.crossTileID]=K),{shift:$,placedGlyphBoxes:at}):void 0},on.prototype.placeLayerBucketPart=function(n,o,i){var u=this,f=n.parameters,m=f.bucket,y=f.layout,_=f.posMatrix,T=f.textLabelPlaneMatrix,C=f.labelToScreenMatrix,B=f.textPixelRatio,U=f.holdingForFade,O=f.collisionBoxArray,K=f.partiallyEvaluatedTextSize,W=f.collisionGroup,Q=y.get("text-optional"),G=y.get("icon-optional"),$=y.get("text-allow-overlap"),at=y.get("icon-allow-overlap"),ht=y.get("text-rotation-alignment")==="map",St=y.get("text-pitch-alignment")==="map",bt=y.get("icon-text-fit")!=="none",Tt=y.get("symbol-z-order")==="viewport-y",Ct=$&&(at||!m.hasIconData()||G),Vt=at&&($||!m.hasTextData()||Q);!m.collisionArrays&&O&&m.deserializeCollisionBoxes(O);var Ut=function(te,Se){if(!o[te.crossTileID])if(U)u.placements[te.crossTileID]=new po(!1,!1,!1);else{var Ze,Re=!1,Pe=!1,ke=!0,Ae=null,ie={box:null,offscreen:null},Er={box:null,offscreen:null},sn=null,en=null,Tn=0,vn=0,Vr=0;Se.textFeatureIndex?Tn=Se.textFeatureIndex:te.useRuntimeCollisionCircles&&(Tn=te.featureIndex),Se.verticalTextFeatureIndex&&(vn=Se.verticalTextFeatureIndex);var oi=Se.textBox;if(oi){var un=function(_n){var ln=h.WritingMode.horizontal;if(m.allowVerticalPlacement&&!_n&&u.prevPlacement){var bi=u.prevPlacement.placedOrientations[te.crossTileID];bi&&(u.placedOrientations[te.crossTileID]=bi,u.markUsedOrientation(m,ln=bi,te))}return ln},ai=function(_n,ln){if(m.allowVerticalPlacement&&te.numVerticalGlyphVertices>0&&Se.verticalTextBox)for(var bi=0,Rs=m.writingModes;bi<Rs.length&&(Rs[bi]===h.WritingMode.vertical?(ie=ln(),Er=ie):ie=_n(),!(ie&&ie.box&&ie.box.length));bi+=1);else ie=_n()};if(y.get("text-variable-anchor")){var zi=y.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[te.crossTileID]){var ga=u.prevPlacement.variableOffsets[te.crossTileID];zi.indexOf(ga.anchor)>0&&(zi=zi.filter(function(_n){return _n!==ga.anchor})).unshift(ga.anchor)}var bo=function(_n,ln,bi){for(var Rs=_n.x2-_n.x1,Sl=_n.y2-_n.y1,ic=te.textBoxScale,Gu=bt&&!at?ln:null,Wu={box:[],offscreen:!1},oc=$?2*zi.length:zi.length,cs=0;cs<oc;++cs){var Xu=u.attemptAnchorPlacement(zi[cs%zi.length],_n,Rs,Sl,ic,ht,St,B,_,W,cs>=zi.length,te,m,bi,Gu);if(Xu&&(Wu=Xu.placedGlyphBoxes)&&Wu.box&&Wu.box.length){Re=!0,Ae=Xu.shift;break}}return Wu};ai(function(){return bo(oi,Se.iconBox,h.WritingMode.horizontal)},function(){var _n=Se.verticalTextBox;return m.allowVerticalPlacement&&!(ie&&ie.box&&ie.box.length)&&te.numVerticalGlyphVertices>0&&_n?bo(_n,Se.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),ie&&(Re=ie.box,ke=ie.offscreen);var Zu=un(ie&&ie.box);if(!Re&&u.prevPlacement){var us=u.prevPlacement.variableOffsets[te.crossTileID];us&&(u.variableOffsets[te.crossTileID]=us,u.markUsedJustification(m,us.anchor,te,Zu))}}else{var ya=function(_n,ln){var bi=u.collisionIndex.placeCollisionBox(_n,$,B,_,W.predicate);return bi&&bi.box&&bi.box.length&&(u.markUsedOrientation(m,ln,te),u.placedOrientations[te.crossTileID]=ln),bi};ai(function(){return ya(oi,h.WritingMode.horizontal)},function(){var _n=Se.verticalTextBox;return m.allowVerticalPlacement&&te.numVerticalGlyphVertices>0&&_n?ya(_n,h.WritingMode.vertical):{box:null,offscreen:null}}),un(ie&&ie.box&&ie.box.length)}}if(Re=(Ze=ie)&&Ze.box&&Ze.box.length>0,ke=Ze&&Ze.offscreen,te.useRuntimeCollisionCircles){var ls=m.text.placedSymbolArray.get(te.centerJustifiedTextSymbolIndex),ju=h.evaluateSizeForFeature(m.textSizeData,K,ls),mu=y.get("text-padding");sn=u.collisionIndex.placeCollisionCircles($,ls,m.lineVertexArray,m.glyphOffsetArray,ju,_,T,C,i,St,W.predicate,te.collisionCircleDiameter,mu),Re=$||sn.circles.length>0&&!sn.collisionDetected,ke=ke&&sn.offscreen}if(Se.iconFeatureIndex&&(Vr=Se.iconFeatureIndex),Se.iconBox){var to=function(_n){var ln=bt&&Ae?$r(_n,Ae.x,Ae.y,ht,St,u.transform.angle):_n;return u.collisionIndex.placeCollisionBox(ln,at,B,_,W.predicate)};Pe=Er&&Er.box&&Er.box.length&&Se.verticalIconBox?(en=to(Se.verticalIconBox)).box.length>0:(en=to(Se.iconBox)).box.length>0,ke=ke&&en.offscreen}var gu=Q||te.numHorizontalGlyphVertices===0&&te.numVerticalGlyphVertices===0,kn=G||te.numIconVertices===0;if(gu||kn?kn?gu||(Pe=Pe&&Re):Re=Pe&&Re:Pe=Re=Pe&&Re,Re&&Ze&&Ze.box&&u.collisionIndex.insertCollisionBox(Ze.box,y.get("text-ignore-placement"),m.bucketInstanceId,Er&&Er.box&&vn?vn:Tn,W.ID),Pe&&en&&u.collisionIndex.insertCollisionBox(en.box,y.get("icon-ignore-placement"),m.bucketInstanceId,Vr,W.ID),sn&&(Re&&u.collisionIndex.insertCollisionCircles(sn.circles,y.get("text-ignore-placement"),m.bucketInstanceId,Tn,W.ID),i)){var ea=m.bucketInstanceId,Uo=u.collisionCircleArrays[ea];Uo===void 0&&(Uo=u.collisionCircleArrays[ea]=new Yl);for(var Ds=0;Ds<sn.circles.length;Ds+=4)Uo.circles.push(sn.circles[Ds+0]),Uo.circles.push(sn.circles[Ds+1]),Uo.circles.push(sn.circles[Ds+2]),Uo.circles.push(sn.collisionDetected?1:0)}u.placements[te.crossTileID]=new po(Re||Ct,Pe||Vt,ke||m.justReloaded),o[te.crossTileID]=!0}};if(Tt)for(var Jt=m.getSortedSymbolIndexes(this.transform.angle),ae=Jt.length-1;ae>=0;--ae){var ve=Jt[ae];Ut(m.symbolInstances.get(ve),m.collisionArrays[ve])}else for(var de=n.symbolInstanceStart;de<n.symbolInstanceEnd;de++)Ut(m.symbolInstances.get(de),m.collisionArrays[de]);if(i&&m.bucketInstanceId in this.collisionCircleArrays){var ar=this.collisionCircleArrays[m.bucketInstanceId];h.invert(ar.invProjMatrix,_),ar.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1},on.prototype.markUsedJustification=function(n,o,i,u){var f;f=u===h.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(o)];for(var m=0,y=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];m<y.length;m+=1){var _=y[m];_>=0&&(n.text.placedSymbolArray.get(_).crossTileID=f>=0&&_!==f?0:i.crossTileID)}},on.prototype.markUsedOrientation=function(n,o,i){for(var u=o===h.WritingMode.horizontal||o===h.WritingMode.horizontalOnly?o:0,f=o===h.WritingMode.vertical?o:0,m=0,y=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];m<y.length;m+=1)n.text.placedSymbolArray.get(y[m]).placedOrientation=u;i.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=f)},on.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var o=this.prevPlacement,i=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;var u=o?o.symbolFadeChange(n):1,f=o?o.opacities:{},m=o?o.variableOffsets:{},y=o?o.placedOrientations:{};for(var _ in this.placements){var T=this.placements[_],C=f[_];C?(this.opacities[_]=new mi(C,u,T.text,T.icon),i=i||T.text!==C.text.placed||T.icon!==C.icon.placed):(this.opacities[_]=new mi(null,u,T.text,T.icon,T.skipFade),i=i||T.text||T.icon)}for(var B in f){var U=f[B];if(!this.opacities[B]){var O=new mi(U,u,!1,!1);O.isHidden()||(this.opacities[B]=O,i=i||U.text.placed||U.icon.placed)}}for(var K in m)this.variableOffsets[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.variableOffsets[K]=m[K]);for(var W in y)this.placedOrientations[W]||!this.opacities[W]||this.opacities[W].isHidden()||(this.placedOrientations[W]=y[W]);i?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:n)},on.prototype.updateLayerOpacities=function(n,o){for(var i={},u=0,f=o;u<f.length;u+=1){var m=f[u],y=m.getBucket(n);y&&m.latestFeatureIndex&&n.id===y.layerIds[0]&&this.updateBucketOpacities(y,i,m.collisionBoxArray)}},on.prototype.updateBucketOpacities=function(n,o,i){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var f=n.layers[0].layout,m=new mi(null,0,!1,!1,!0),y=f.get("text-allow-overlap"),_=f.get("icon-allow-overlap"),T=f.get("text-variable-anchor"),C=f.get("text-rotation-alignment")==="map",B=f.get("text-pitch-alignment")==="map",U=f.get("icon-text-fit")!=="none",O=new mi(null,0,y&&(_||!n.hasIconData()||f.get("icon-optional")),_&&(y||!n.hasTextData()||f.get("text-optional")),!0);!n.collisionArrays&&i&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(i);for(var K=function($,at,ht){for(var St=0;St<at/4;St++)$.opacityVertexArray.emplaceBack(ht)},W=function($){var at=n.symbolInstances.get($),ht=at.numHorizontalGlyphVertices,St=at.numVerticalGlyphVertices,bt=at.crossTileID,Tt=u.opacities[bt];o[bt]?Tt=m:Tt||(u.opacities[bt]=Tt=O),o[bt]=!0;var Ct=at.numIconVertices>0,Vt=u.placedOrientations[at.crossTileID],Ut=Vt===h.WritingMode.vertical,Jt=Vt===h.WritingMode.horizontal||Vt===h.WritingMode.horizontalOnly;if(ht>0||St>0){var ae=Pu(Tt.text);K(n.text,ht,Ut?ws:ae),K(n.text,St,Jt?ws:ae);var ve=Tt.text.isHidden();[at.rightJustifiedTextSymbolIndex,at.centerJustifiedTextSymbolIndex,at.leftJustifiedTextSymbolIndex].forEach(function(ie){ie>=0&&(n.text.placedSymbolArray.get(ie).hidden=ve||Ut?1:0)}),at.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(at.verticalPlacedTextSymbolIndex).hidden=ve||Jt?1:0);var de=u.variableOffsets[at.crossTileID];de&&u.markUsedJustification(n,de.anchor,at,Vt);var ar=u.placedOrientations[at.crossTileID];ar&&(u.markUsedJustification(n,"left",at,ar),u.markUsedOrientation(n,ar,at))}if(Ct){var te=Pu(Tt.icon),Se=!(U&&at.verticalPlacedIconSymbolIndex&&Ut);at.placedIconSymbolIndex>=0&&(K(n.icon,at.numIconVertices,Se?te:ws),n.icon.placedSymbolArray.get(at.placedIconSymbolIndex).hidden=Tt.icon.isHidden()),at.verticalPlacedIconSymbolIndex>=0&&(K(n.icon,at.numVerticalIconVertices,Se?ws:te),n.icon.placedSymbolArray.get(at.verticalPlacedIconSymbolIndex).hidden=Tt.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Ze=n.collisionArrays[$];if(Ze){var Re=new h.Point(0,0);if(Ze.textBox||Ze.verticalTextBox){var Pe=!0;if(T){var ke=u.variableOffsets[bt];ke?(Re=fo(ke.anchor,ke.width,ke.height,ke.textOffset,ke.textBoxScale),C&&Re._rotate(B?u.transform.angle:-u.transform.angle)):Pe=!1}Ze.textBox&&Ra(n.textCollisionBox.collisionVertexArray,Tt.text.placed,!Pe||Ut,Re.x,Re.y),Ze.verticalTextBox&&Ra(n.textCollisionBox.collisionVertexArray,Tt.text.placed,!Pe||Jt,Re.x,Re.y)}var Ae=Boolean(!Jt&&Ze.verticalIconBox);Ze.iconBox&&Ra(n.iconCollisionBox.collisionVertexArray,Tt.icon.placed,Ae,U?Re.x:0,U?Re.y:0),Ze.verticalIconBox&&Ra(n.iconCollisionBox.collisionVertexArray,Tt.icon.placed,!Ae,U?Re.x:0,U?Re.y:0)}}},Q=0;Q<n.symbolInstances.length;Q++)W(Q);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var G=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=G.invProjMatrix,n.placementViewportMatrix=G.viewportMatrix,n.collisionCircleArray=G.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},on.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},on.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},on.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},on.prototype.stillRecent=function(n,o){var i=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*i>n},on.prototype.setStale=function(){this.stale=!0};var tu=Math.pow(2,25),dl=Math.pow(2,24),ml=Math.pow(2,17),bs=Math.pow(2,16),gl=Math.pow(2,9),yl=Math.pow(2,8),Jl=Math.pow(2,1);function Pu(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var o=n.placed?1:0,i=Math.floor(127*n.opacity);return i*tu+o*dl+i*ml+o*bs+i*gl+o*yl+i*Jl+o}var ws=0,eu=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};eu.prototype.continuePlacement=function(n,o,i,u,f){for(var m=this._bucketParts;this._currentTileIndex<n.length;)if(o.getBucketParts(m,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,m.sort(function(y,_){return y.sortKey-_.sortKey}));this._currentPartIndex<m.length;)if(o.placeLayerBucketPart(m[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,f())return!0;return!1};var zo=function(n,o,i,u,f,m,y){this.placement=new on(n,f,m,y),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=u,this._done=!1};zo.prototype.isDone=function(){return this._done},zo.prototype.continuePlacement=function(n,o,i){for(var u=this,f=h.browser.now(),m=function(){var T=h.browser.now()-f;return!u._forceFullPlacement&&T>2};this._currentPlacementIndex>=0;){var y=o[n[this._currentPlacementIndex]],_=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=_)&&(!y.maxzoom||y.maxzoom>_)){if(this._inProgressLayer||(this._inProgressLayer=new eu(y)),this._inProgressLayer.continuePlacement(i[y.source],this.placement,this._showCollisionBoxes,y,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},zo.prototype.commit=function(n){return this.placement.commit(n),this.placement};var vl=512/h.EXTENT/2,ru=function(n,o,i){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var u=0;u<o.length;u++){var f=o.get(u),m=f.key;this.indexedSymbolInstances[m]||(this.indexedSymbolInstances[m]=[]),this.indexedSymbolInstances[m].push({crossTileID:f.crossTileID,coord:this.getScaledCoordinates(f,n)})}};ru.prototype.getScaledCoordinates=function(n,o){var i=vl/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*h.EXTENT+n.anchorX)*i),y:Math.floor((o.canonical.y*h.EXTENT+n.anchorY)*i)}},ru.prototype.findMatches=function(n,o,i){for(var u=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),f=0;f<n.length;f++){var m=n.get(f);if(!m.crossTileID){var y=this.indexedSymbolInstances[m.key];if(y)for(var _=this.getScaledCoordinates(m,o),T=0,C=y;T<C.length;T+=1){var B=C[T];if(Math.abs(B.coord.x-_.x)<=u&&Math.abs(B.coord.y-_.y)<=u&&!i[B.crossTileID]){i[B.crossTileID]=!0,m.crossTileID=B.crossTileID;break}}}}};var Ss=function(){this.maxCrossTileID=0};Ss.prototype.generate=function(){return++this.maxCrossTileID};var gi=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};gi.prototype.handleWrapJump=function(n){var o=Math.round((n-this.lng)/360);if(o!==0)for(var i in this.indexes){var u=this.indexes[i],f={};for(var m in u){var y=u[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+o),f[y.tileID.key]=y}this.indexes[i]=f}this.lng=n},gi.prototype.addBucket=function(n,o,i){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<o.symbolInstances.length;u++)o.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var f=this.usedCrossTileIDs[n.overscaledZ];for(var m in this.indexes){var y=this.indexes[m];if(Number(m)>n.overscaledZ)for(var _ in y){var T=y[_];T.tileID.isChildOf(n)&&T.findMatches(o.symbolInstances,n,f)}else{var C=y[n.scaledTo(Number(m)).key];C&&C.findMatches(o.symbolInstances,n,f)}}for(var B=0;B<o.symbolInstances.length;B++){var U=o.symbolInstances.get(B);U.crossTileID||(U.crossTileID=i.generate(),f[U.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new ru(n,o.symbolInstances,o.bucketInstanceId),!0},gi.prototype.removeBucketCrossTileIDs=function(n,o){for(var i in o.indexedSymbolInstances)for(var u=0,f=o.indexedSymbolInstances[i];u<f.length;u+=1)delete this.usedCrossTileIDs[n][f[u].crossTileID]},gi.prototype.removeStaleBuckets=function(n){var o=!1;for(var i in this.indexes){var u=this.indexes[i];for(var f in u)n[u[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,u[f]),delete u[f],o=!0)}return o};var Ba=function(){this.layerIndexes={},this.crossTileIDs=new Ss,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ba.prototype.addLayer=function(n,o,i){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new gi);var f=!1,m={};u.handleWrapJump(i);for(var y=0,_=o;y<_.length;y+=1){var T=_[y],C=T.getBucket(n);C&&n.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(T.tileID,C,this.crossTileIDs)&&(f=!0),m[C.bucketInstanceId]=!0)}return u.removeStaleBuckets(m)&&(f=!0),f},Ba.prototype.pruneUnusedLayers=function(n){var o={};for(var i in n.forEach(function(u){o[u]=!0}),this.layerIndexes)o[i]||delete this.layerIndexes[i]};var sa=function(n,o){return h.emitValidationErrors(n,o&&o.filter(function(i){return i.identifier!=="source.canvas"}))},nu=h.pick(kt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ua=h.pick(kt,["setCenter","setZoom","setBearing","setPitch"]),xr=function(){var n={},o=h.styleSpec.$version;for(var i in h.styleSpec.$root){var u,f=h.styleSpec.$root[i];f.required&&(u=i==="version"?o:f.type==="array"?[]:{})!=null&&(n[i]=u)}return n}(),mr=function(n){function o(i,u){var f=this;u===void 0&&(u={}),n.call(this),this.map=i,this.dispatcher=new ui(ce(),this),this.imageManager=new Zt,this.imageManager.setEventedParent(this),this.glyphManager=new On(i._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Jr(256,512),this.crossTileSymbolIndex=new Ba,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());var m=this;this._rtlTextPluginCallback=o.registerForPluginStateChange(function(y){m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},function(_,T){if(h.triggerPluginCompletionEvent(_),T&&T.every(function(B){return B}))for(var C in m.sourceCaches)m.sourceCaches[C].reload()})}),this.on("data",function(y){if(y.dataType==="source"&&y.sourceDataType==="metadata"){var _=f.sourceCaches[y.sourceId];if(_){var T=_.getSource();if(T&&T.vectorLayerIds)for(var C in f._layers){var B=f._layers[C];B.source===T.id&&f._validateLayer(B)}}}})}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.loadURL=function(i,u){var f=this;u===void 0&&(u={}),this.fire(new h.Event("dataloading",{dataType:"style"}));var m=typeof u.validate=="boolean"?u.validate:!h.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,u.accessToken);var y=this.map._requestManager.transformRequest(i,h.ResourceType.Style);this._request=h.getJSON(y,function(_,T){f._request=null,_?f.fire(new h.ErrorEvent(_)):T&&f._load(T,m)})},o.prototype.loadJSON=function(i,u){var f=this;u===void 0&&(u={}),this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.browser.frame(function(){f._request=null,f._load(i,u.validate!==!1)})},o.prototype.loadEmpty=function(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(xr,!1)},o.prototype._load=function(i,u){if(!u||!sa(this,h.validateStyle(i))){for(var f in this._loaded=!0,this.stylesheet=i,i.sources)this.addSource(f,i.sources[f],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs);var m=Ht(this.stylesheet.layers);this._order=m.map(function(C){return C.id}),this._layers={},this._serializedLayers={};for(var y=0,_=m;y<_.length;y+=1){var T=_[y];(T=h.createStyleLayer(T)).setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ka(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}},o.prototype._loadSprite=function(i){var u=this;this._spriteRequest=function(f,m,y){var _,T,C,B=h.browser.devicePixelRatio>1?"@2x":"",U=h.getJSON(m.transformRequest(m.normalizeSpriteURL(f,B,".json"),h.ResourceType.SpriteJSON),function(W,Q){U=null,C||(C=W,_=Q,K())}),O=h.getImage(m.transformRequest(m.normalizeSpriteURL(f,B,".png"),h.ResourceType.SpriteImage),function(W,Q){O=null,C||(C=W,T=Q,K())});function K(){if(C)y(C);else if(_&&T){var W=h.browser.getImageData(T),Q={};for(var G in _){var $=_[G],at=$.width,ht=$.height,St=$.x,bt=$.y,Tt=$.sdf,Ct=$.pixelRatio,Vt=$.stretchX,Ut=$.stretchY,Jt=$.content,ae=new h.RGBAImage({width:at,height:ht});h.RGBAImage.copy(W,ae,{x:St,y:bt},{x:0,y:0},{width:at,height:ht}),Q[G]={data:ae,pixelRatio:Ct,sdf:Tt,stretchX:Vt,stretchY:Ut,content:Jt}}y(null,Q)}}return{cancel:function(){U&&(U.cancel(),U=null),O&&(O.cancel(),O=null)}}}(i,this.map._requestManager,function(f,m){if(u._spriteRequest=null,f)u.fire(new h.ErrorEvent(f));else if(m)for(var y in m)u.imageManager.addImage(y,m[y]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new h.Event("data",{dataType:"style"}))})},o.prototype._validateLayer=function(i){var u=this.sourceCaches[i.source];if(u){var f=i.sourceLayer;if(f){var m=u.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(f)===-1)&&this.fire(new h.ErrorEvent(new Error('Source layer "'+f+'" does not exist on source "'+m.id+'" as specified by style layer "'+i.id+'"')))}}},o.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()},o.prototype._serializeLayers=function(i){for(var u=[],f=0,m=i;f<m.length;f+=1){var y=this._layers[m[f]];y.type!=="custom"&&u.push(y.serialize())}return u},o.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},o.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},o.prototype.update=function(i){if(this._loaded){var u=this._changed;if(this._changed){var f=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);for(var y in(f.length||m.length)&&this._updateWorkerLayers(f,m),this._updatedSources){var _=this._updatedSources[y];_==="reload"?this._reloadSource(y):_==="clear"&&this._clearSource(y)}for(var T in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[T].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}var C={};for(var B in this.sourceCaches){var U=this.sourceCaches[B];C[B]=U.used,U.used=!1}for(var O=0,K=this._order;O<K.length;O+=1){var W=this._layers[K[O]];W.recalculate(i,this._availableImages),!W.isHidden(i.zoom)&&W.source&&(this.sourceCaches[W.source].used=!0)}for(var Q in C){var G=this.sourceCaches[Q];C[Q]!==G.used&&G.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Q}))}this.light.recalculate(i),this.z=i.zoom,u&&this.fire(new h.Event("data",{dataType:"style"}))}},o.prototype._updateTilesForChangedImages=function(){var i=Object.keys(this._changedImages);if(i.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}},o.prototype._updateWorkerLayers=function(i,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:u})},o.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},o.prototype.setState=function(i){var u=this;if(this._checkLoaded(),sa(this,h.validateStyle(i)))return!1;(i=h.clone$1(i)).layers=Ht(i.layers);var f=function(y,_){if(!y)return[{command:kt.setStyle,args:[_]}];var T=[];try{if(!h.deepEqual(y.version,_.version))return[{command:kt.setStyle,args:[_]}];h.deepEqual(y.center,_.center)||T.push({command:kt.setCenter,args:[_.center]}),h.deepEqual(y.zoom,_.zoom)||T.push({command:kt.setZoom,args:[_.zoom]}),h.deepEqual(y.bearing,_.bearing)||T.push({command:kt.setBearing,args:[_.bearing]}),h.deepEqual(y.pitch,_.pitch)||T.push({command:kt.setPitch,args:[_.pitch]}),h.deepEqual(y.sprite,_.sprite)||T.push({command:kt.setSprite,args:[_.sprite]}),h.deepEqual(y.glyphs,_.glyphs)||T.push({command:kt.setGlyphs,args:[_.glyphs]}),h.deepEqual(y.transition,_.transition)||T.push({command:kt.setTransition,args:[_.transition]}),h.deepEqual(y.light,_.light)||T.push({command:kt.setLight,args:[_.light]});var C={},B=[];(function(O,K,W,Q){var G;for(G in K=K||{},O=O||{})O.hasOwnProperty(G)&&(K.hasOwnProperty(G)||Le(G,W,Q));for(G in K)K.hasOwnProperty(G)&&(O.hasOwnProperty(G)?h.deepEqual(O[G],K[G])||(O[G].type==="geojson"&&K[G].type==="geojson"&&_r(O,K,G)?W.push({command:kt.setGeoJSONSourceData,args:[G,K[G].data]}):ne(G,K,W,Q)):Me(G,K,W))})(y.sources,_.sources,B,C);var U=[];y.layers&&y.layers.forEach(function(O){C[O.source]?T.push({command:kt.removeLayer,args:[O.id]}):U.push(O)}),T=T.concat(B),function(O,K,W){K=K||[];var Q,G,$,at,ht,St,bt,Tt=(O=O||[]).map(br),Ct=K.map(br),Vt=O.reduce(Mr,{}),Ut=K.reduce(Mr,{}),Jt=Tt.slice(),ae=Object.create(null);for(Q=0,G=0;Q<Tt.length;Q++)Ut.hasOwnProperty($=Tt[Q])?G++:(W.push({command:kt.removeLayer,args:[$]}),Jt.splice(Jt.indexOf($,G),1));for(Q=0,G=0;Q<Ct.length;Q++)Jt[Jt.length-1-Q]!==($=Ct[Ct.length-1-Q])&&(Vt.hasOwnProperty($)?(W.push({command:kt.removeLayer,args:[$]}),Jt.splice(Jt.lastIndexOf($,Jt.length-G),1)):G++,W.push({command:kt.addLayer,args:[Ut[$],St=Jt[Jt.length-Q]]}),Jt.splice(Jt.length-Q,0,$),ae[$]=!0);for(Q=0;Q<Ct.length;Q++)if(at=Vt[$=Ct[Q]],ht=Ut[$],!ae[$]&&!h.deepEqual(at,ht))if(h.deepEqual(at.source,ht.source)&&h.deepEqual(at["source-layer"],ht["source-layer"])&&h.deepEqual(at.type,ht.type)){for(bt in we(at.layout,ht.layout,W,$,null,kt.setLayoutProperty),we(at.paint,ht.paint,W,$,null,kt.setPaintProperty),h.deepEqual(at.filter,ht.filter)||W.push({command:kt.setFilter,args:[$,ht.filter]}),h.deepEqual(at.minzoom,ht.minzoom)&&h.deepEqual(at.maxzoom,ht.maxzoom)||W.push({command:kt.setLayerZoomRange,args:[$,ht.minzoom,ht.maxzoom]}),at)at.hasOwnProperty(bt)&&bt!=="layout"&&bt!=="paint"&&bt!=="filter"&&bt!=="metadata"&&bt!=="minzoom"&&bt!=="maxzoom"&&(bt.indexOf("paint.")===0?we(at[bt],ht[bt],W,$,bt.slice(6),kt.setPaintProperty):h.deepEqual(at[bt],ht[bt])||W.push({command:kt.setLayerProperty,args:[$,bt,ht[bt]]}));for(bt in ht)ht.hasOwnProperty(bt)&&!at.hasOwnProperty(bt)&&bt!=="layout"&&bt!=="paint"&&bt!=="filter"&&bt!=="metadata"&&bt!=="minzoom"&&bt!=="maxzoom"&&(bt.indexOf("paint.")===0?we(at[bt],ht[bt],W,$,bt.slice(6),kt.setPaintProperty):h.deepEqual(at[bt],ht[bt])||W.push({command:kt.setLayerProperty,args:[$,bt,ht[bt]]}))}else W.push({command:kt.removeLayer,args:[$]}),St=Jt[Jt.lastIndexOf($)+1],W.push({command:kt.addLayer,args:[ht,St]})}(U,_.layers,T)}catch(O){console.warn("Unable to compute style diff:",O),T=[{command:kt.setStyle,args:[_]}]}return T}(this.serialize(),i).filter(function(y){return!(y.command in ua)});if(f.length===0)return!1;var m=f.filter(function(y){return!(y.command in nu)});if(m.length>0)throw new Error("Unimplemented: "+m.map(function(y){return y.command}).join(", ")+".");return f.forEach(function(y){y.command!=="setTransition"&&u[y.command].apply(u,y.args)}),this.stylesheet=i,!0},o.prototype.addImage=function(i,u){if(this.getImage(i))return this.fire(new h.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(i,u),this._afterImageUpdated(i)},o.prototype.updateImage=function(i,u){this.imageManager.updateImage(i,u)},o.prototype.getImage=function(i){return this.imageManager.getImage(i)},o.prototype.removeImage=function(i){if(!this.getImage(i))return this.fire(new h.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(i),this._afterImageUpdated(i)},o.prototype._afterImageUpdated=function(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))},o.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},o.prototype.addSource=function(i,u,f){var m=this;if(f===void 0&&(f={}),this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(h.validateStyle.source,"sources."+i,u,null,f))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var y=this.sourceCaches[i]=new V(i,u,this.dispatcher);y.style=this,y.setEventedParent(this,function(){return{isSourceLoaded:m.loaded(),source:y.serialize(),sourceId:i}}),y.onAdd(this.map),this._changed=!0}},o.prototype.removeSource=function(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===i)return this.fire(new h.ErrorEvent(new Error('Source "'+i+'" cannot be removed while layer "'+u+'" is using it.')));var f=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],f.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),f.setEventedParent(null),f.clearTiles(),f.onRemove&&f.onRemove(this.map),this._changed=!0},o.prototype.setGeoJSONSourceData=function(i,u){this._checkLoaded(),this.sourceCaches[i].getSource().setData(u),this._changed=!0},o.prototype.getSource=function(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()},o.prototype.addLayer=function(i,u,f){f===void 0&&(f={}),this._checkLoaded();var m=i.id;if(this.getLayer(m))this.fire(new h.ErrorEvent(new Error('Layer with id "'+m+'" already exists on this map')));else{var y;if(i.type==="custom"){if(sa(this,h.validateCustomStyleLayer(i)))return;y=h.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(m,i.source),i=h.clone$1(i),i=h.extend(i,{source:m})),this._validate(h.validateStyle.layer,"layers."+m,i,{arrayIndex:-1},f))return;y=h.createStyleLayer(i),this._validateLayer(y),y.setEventedParent(this,{layer:{id:m}}),this._serializedLayers[y.id]=y.serialize()}var _=u?this._order.indexOf(u):this._order.length;if(u&&_===-1)this.fire(new h.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(_,0,m),this._layerOrderChanged=!0,this._layers[m]=y,this._removedLayers[m]&&y.source&&y.type!=="custom"){var T=this._removedLayers[m];delete this._removedLayers[m],T.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}},o.prototype.moveLayer=function(i,u){if(this._checkLoaded(),this._changed=!0,this._layers[i]){if(i!==u){var f=this._order.indexOf(i);this._order.splice(f,1);var m=u?this._order.indexOf(u):this._order.length;u&&m===-1?this.fire(new h.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(m,0,i),this._layerOrderChanged=!0)}}else this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be moved.")))},o.prototype.removeLayer=function(i){this._checkLoaded();var u=this._layers[i];if(u){u.setEventedParent(null);var f=this._order.indexOf(i);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map)}else this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be removed.")))},o.prototype.getLayer=function(i){return this._layers[i]},o.prototype.hasLayer=function(i){return i in this._layers},o.prototype.setLayerZoomRange=function(i,u,f){this._checkLoaded();var m=this.getLayer(i);m?m.minzoom===u&&m.maxzoom===f||(u!=null&&(m.minzoom=u),f!=null&&(m.maxzoom=f),this._updateLayer(m)):this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot have zoom extent.")))},o.prototype.setFilter=function(i,u,f){f===void 0&&(f={}),this._checkLoaded();var m=this.getLayer(i);if(m){if(!h.deepEqual(m.filter,u))return u==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(h.validateStyle.filter,"layers."+m.id+".filter",u,null,f)||(m.filter=h.clone$1(u),this._updateLayer(m)))}else this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be filtered.")))},o.prototype.getFilter=function(i){return h.clone$1(this.getLayer(i).filter)},o.prototype.setLayoutProperty=function(i,u,f,m){m===void 0&&(m={}),this._checkLoaded();var y=this.getLayer(i);y?h.deepEqual(y.getLayoutProperty(u),f)||(y.setLayoutProperty(u,f,m),this._updateLayer(y)):this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getLayoutProperty=function(i,u){var f=this.getLayer(i);if(f)return f.getLayoutProperty(u);this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style.")))},o.prototype.setPaintProperty=function(i,u,f,m){m===void 0&&(m={}),this._checkLoaded();var y=this.getLayer(i);y?h.deepEqual(y.getPaintProperty(u),f)||(y.setPaintProperty(u,f,m)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new h.ErrorEvent(new Error("The layer '"+i+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getPaintProperty=function(i,u){return this.getLayer(i).getPaintProperty(u)},o.prototype.setFeatureState=function(i,u){this._checkLoaded();var f=i.source,m=i.sourceLayer,y=this.sourceCaches[f];if(y!==void 0){var _=y.getSource().type;_==="geojson"&&m?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||m?(i.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),y.setFeatureState(m,i.id,u)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+f+"' does not exist in the map's style.")))},o.prototype.removeFeatureState=function(i,u){this._checkLoaded();var f=i.source,m=this.sourceCaches[f];if(m!==void 0){var y=m.getSource().type,_=y==="vector"?i.sourceLayer:void 0;y!=="vector"||_?u&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(_,i.id,u):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+f+"' does not exist in the map's style.")))},o.prototype.getFeatureState=function(i){this._checkLoaded();var u=i.source,f=i.sourceLayer,m=this.sourceCaches[u];if(m!==void 0){if(m.getSource().type!=="vector"||f)return i.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),m.getFeatureState(f,i.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},o.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},o.prototype.serialize=function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(i){return i.serialize()}),layers:this._serializeLayers(this._order)},function(i){return i!==void 0})},o.prototype._updateLayer=function(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0},o.prototype._flattenAndSortRenderedFeatures=function(i){for(var u=this,f=function(Vt){return u._layers[Vt].type==="fill-extrusion"},m={},y=[],_=this._order.length-1;_>=0;_--){var T=this._order[_];if(f(T)){m[T]=_;for(var C=0,B=i;C<B.length;C+=1){var U=B[C][T];if(U)for(var O=0,K=U;O<K.length;O+=1)y.push(K[O])}}}y.sort(function(Vt,Ut){return Ut.intersectionZ-Vt.intersectionZ});for(var W=[],Q=this._order.length-1;Q>=0;Q--){var G=this._order[Q];if(f(G))for(var $=y.length-1;$>=0;$--){var at=y[$].feature;if(m[at.layer.id]<Q)break;W.push(at),y.pop()}else for(var ht=0,St=i;ht<St.length;ht+=1){var bt=St[ht][G];if(bt)for(var Tt=0,Ct=bt;Tt<Ct.length;Tt+=1)W.push(Ct[Tt].feature)}}return W},o.prototype.queryRenderedFeatures=function(i,u,f){u&&u.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var m={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var y=0,_=u.layers;y<_.length;y+=1){var T=_[y],C=this._layers[T];if(!C)return this.fire(new h.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be queried for features."))),[];m[C.source]=!0}}var B=[];for(var U in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!m[U]||B.push($n(this.sourceCaches[U],this._layers,this._serializedLayers,i,u,f));return this.placement&&B.push(function(O,K,W,Q,G,$,at){for(var ht={},St=$.queryRenderedSymbols(Q),bt=[],Tt=0,Ct=Object.keys(St).map(Number);Tt<Ct.length;Tt+=1)bt.push(at[Ct[Tt]]);bt.sort(ci);for(var Vt=function(){var de=Jt[Ut],ar=de.featureIndex.lookupSymbolFeatures(St[de.bucketInstanceId],K,de.bucketIndex,de.sourceLayerIndex,G.filter,G.layers,G.availableImages,O);for(var te in ar){var Se=ht[te]=ht[te]||[],Ze=ar[te];Ze.sort(function(ke,Ae){var ie=de.featureSortOrder;if(ie){var Er=ie.indexOf(ke.featureIndex);return ie.indexOf(Ae.featureIndex)-Er}return Ae.featureIndex-ke.featureIndex});for(var Re=0,Pe=Ze;Re<Pe.length;Re+=1)Se.push(Pe[Re])}},Ut=0,Jt=bt;Ut<Jt.length;Ut+=1)Vt();var ae=function(de){ht[de].forEach(function(ar){var te=ar.feature,Se=W[O[de].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=Se})};for(var ve in ht)ae(ve);return ht}(this._layers,this._serializedLayers,this.sourceCaches,i,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(B)},o.prototype.querySourceFeatures=function(i,u){u&&u.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var f=this.sourceCaches[i];return f?function(m,y){for(var _=m.getRenderableIds().map(function(K){return m.getTileByID(K)}),T=[],C={},B=0;B<_.length;B++){var U=_[B],O=U.tileID.canonical.key;C[O]||(C[O]=!0,U.querySourceFeatures(T,y))}return T}(f,u):[]},o.prototype.addSourceType=function(i,u,f){return o.getSourceType(i)?f(new Error('A source type called "'+i+'" already exists.')):(o.setSourceType(i,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:u.workerSourceURL},f):f(null,null))},o.prototype.getLight=function(){return this.light.getLight()},o.prototype.setLight=function(i,u){u===void 0&&(u={}),this._checkLoaded();var f=this.light.getLight(),m=!1;for(var y in i)if(!h.deepEqual(i[y],f[y])){m=!0;break}if(m){var _={now:h.browser.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,u),this.light.updateTransitions(_)}},o.prototype._validate=function(i,u,f,m,y){return y===void 0&&(y={}),(!y||y.validate!==!1)&&sa(this,i.call(h.validateStyle,h.extend({key:u,style:this.serialize(),value:f,styleSpec:h.styleSpec},m)))},o.prototype._remove=function(){for(var i in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[i].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},o.prototype._clearSource=function(i){this.sourceCaches[i].clearTiles()},o.prototype._reloadSource=function(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()},o.prototype._updateSources=function(i){for(var u in this.sourceCaches)this.sourceCaches[u].update(i)},o.prototype._generateCollisionBoxes=function(){for(var i in this.sourceCaches)this._reloadSource(i)},o.prototype._updatePlacement=function(i,u,f,m,y){y===void 0&&(y=!1);for(var _=!1,T=!1,C={},B=0,U=this._order;B<U.length;B+=1){var O=this._layers[U[B]];if(O.type==="symbol"){if(!C[O.source]){var K=this.sourceCaches[O.source];C[O.source]=K.getRenderableIds(!0).map(function(at){return K.getTileByID(at)}).sort(function(at,ht){return ht.tileID.overscaledZ-at.tileID.overscaledZ||(at.tileID.isLessThan(ht.tileID)?-1:1)})}var W=this.crossTileSymbolIndex.addLayer(O,C[O.source],i.center.lng);_=_||W}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.browser.now(),i.zoom))&&(this.pauseablePlacement=new zo(i,this._order,y,u,f,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.browser.now()),T=!0),_&&this.pauseablePlacement.placement.setStale()),T||_)for(var Q=0,G=this._order;Q<G.length;Q+=1){var $=this._layers[G[Q]];$.type==="symbol"&&this.placement.updateLayerOpacities($,C[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.browser.now())},o.prototype._releaseSymbolFadeTiles=function(){for(var i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()},o.prototype.getImages=function(i,u,f){this.imageManager.getImages(u.icons,f),this._updateTilesForChangedImages();var m=this.sourceCaches[u.source];m&&m.setDependencies(u.tileID.key,u.type,u.icons)},o.prototype.getGlyphs=function(i,u,f){this.glyphManager.getGlyphs(u.stacks,f)},o.prototype.getResource=function(i,u,f){return h.makeRequest(u,f)},o}(h.Evented);mr.getSourceType=function(n){return Oi[n]},mr.setSourceType=function(n,o){Oi[n]=o},mr.registerForPluginStateChange=h.registerForPluginStateChange;var Ki=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),Wr=Lr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),iu=Lr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Cu=Lr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),$l=Lr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ql=Lr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ou=Lr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),zu=Lr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Pn=Lr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ts=Lr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),la=Lr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ku=Lr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Mu=Lr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ti=Lr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ca=Lr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),ei=Lr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Sn=Lr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Is=Lr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ko=Lr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ho=Lr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),mn=Lr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Yi=Lr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Cn=Lr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Oa=Lr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ji=Lr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ri=Lr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Es=Lr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Lr(n,o){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=o.match(/attribute ([\w]+) ([\w]+)/g),f=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=m?m.concat(f):f,_={};return{fragmentSource:n=n.replace(i,function(T,C,B,U,O){return _[O]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_`+O+`
varying `+B+" "+U+" "+O+`;
#else
uniform `+B+" "+U+" u_"+O+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+O+`
    `+B+" "+U+" "+O+" = u_"+O+`;
#endif
`}),vertexSource:o=o.replace(i,function(T,C,B,U,O){var K=U==="float"?"vec2":"vec4",W=O.match(/color/)?"color":K;return _[O]?C==="define"?`
#ifndef HAS_UNIFORM_u_`+O+`
uniform lowp float u_`+O+`_t;
attribute `+B+" "+K+" a_"+O+`;
varying `+B+" "+U+" "+O+`;
#else
uniform `+B+" "+U+" u_"+O+`;
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_`+O+`
    `+O+" = a_"+O+`;
#else
    `+B+" "+U+" "+O+" = u_"+O+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+O+`
    `+O+" = unpack_mix_"+W+"(a_"+O+", u_"+O+`_t);
#else
    `+B+" "+U+" "+O+" = u_"+O+`;
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_`+O+`
uniform lowp float u_`+O+`_t;
attribute `+B+" "+K+" a_"+O+`;
#else
uniform `+B+" "+U+" u_"+O+`;
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_`+O+`
    `+B+" "+U+" "+O+" = a_"+O+`;
#else
    `+B+" "+U+" "+O+" = u_"+O+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+O+`
    `+B+" "+U+" "+O+" = unpack_mix_"+W+"(a_"+O+", u_"+O+`_t);
#else
    `+B+" "+U+" "+O+" = u_"+O+`;
#endif
`}),staticAttributes:u,staticUniforms:y}}var Dr=Object.freeze({__proto__:null,prelude:Wr,background:iu,backgroundPattern:Cu,circle:$l,clippingMask:Ql,heatmap:ou,heatmapTexture:zu,collisionBox:Pn,collisionCircle:Ts,debug:la,fill:ku,fillOutline:Mu,fillOutlinePattern:ti,fillPattern:ca,fillExtrusion:ei,fillExtrusionPattern:Sn,hillshadePrepare:Is,hillshade:ko,line:Ho,lineGradient:mn,linePattern:Yi,lineSDF:Cn,raster:Oa,symbolIcon:Ji,symbolSDF:ri,symbolTextAndIcon:Es}),mo=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function au(n){for(var o=[],i=0;i<n.length;i++)if(n[i]!==null){var u=n[i].split(" ");o.push(u.pop())}return o}mo.prototype.bind=function(n,o,i,u,f,m,y,_){this.context=n;for(var T=this.boundPaintVertexBuffers.length!==u.length,C=0;!T&&C<u.length;C++)this.boundPaintVertexBuffers[C]!==u[C]&&(T=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===i&&!T&&this.boundIndexBuffer===f&&this.boundVertexOffset===m&&this.boundDynamicVertexBuffer===y&&this.boundDynamicVertexBuffer2===_?(n.bindVertexArrayOES.set(this.vao),y&&y.bind(),f&&f.dynamicDraw&&f.bind(),_&&_.bind()):this.freshBind(o,i,u,f,m,y,_)},mo.prototype.freshBind=function(n,o,i,u,f,m,y){var _,T=n.numAttributes,C=this.context,B=C.gl;if(C.extVertexArrayObject)this.vao&&this.destroy(),this.vao=C.extVertexArrayObject.createVertexArrayOES(),C.bindVertexArrayOES.set(this.vao),_=0,this.boundProgram=n,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=u,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=m,this.boundDynamicVertexBuffer2=y;else{_=C.currentNumAttributes||0;for(var U=T;U<_;U++)B.disableVertexAttribArray(U)}o.enableAttributes(B,n);for(var O=0,K=i;O<K.length;O+=1)K[O].enableAttributes(B,n);m&&m.enableAttributes(B,n),y&&y.enableAttributes(B,n),o.bind(),o.setVertexAttribPointers(B,n,f);for(var W=0,Q=i;W<Q.length;W+=1){var G=Q[W];G.bind(),G.setVertexAttribPointers(B,n,f)}m&&(m.bind(),m.setVertexAttribPointers(B,n,f)),u&&u.bind(),y&&(y.bind(),y.setVertexAttribPointers(B,n,f)),C.currentNumAttributes=T},mo.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var _l=function(n,o,i,u,f,m){var y=n.gl;this.program=y.createProgram();for(var _=au(i.staticAttributes),T=u?u.getBinderAttributes():[],C=_.concat(T),B=i.staticUniforms?au(i.staticUniforms):[],U=u?u.getBinderUniforms():[],O=[],K=0,W=B.concat(U);K<W.length;K+=1){var Q=W[K];O.indexOf(Q)<0&&O.push(Q)}var G=u?u.defines():[];m&&G.push("#define OVERDRAW_INSPECTOR;");var $=G.concat(Wr.fragmentSource,i.fragmentSource).join(`
`),at=G.concat(Wr.vertexSource,i.vertexSource).join(`
`),ht=y.createShader(y.FRAGMENT_SHADER);if(y.isContextLost())this.failedToCreate=!0;else{y.shaderSource(ht,$),y.compileShader(ht),y.attachShader(this.program,ht);var St=y.createShader(y.VERTEX_SHADER);if(y.isContextLost())this.failedToCreate=!0;else{y.shaderSource(St,at),y.compileShader(St),y.attachShader(this.program,St),this.attributes={};var bt={};this.numAttributes=C.length;for(var Tt=0;Tt<this.numAttributes;Tt++)C[Tt]&&(y.bindAttribLocation(this.program,Tt,C[Tt]),this.attributes[C[Tt]]=Tt);y.linkProgram(this.program),y.deleteShader(St),y.deleteShader(ht);for(var Ct=0;Ct<O.length;Ct++){var Vt=O[Ct];if(Vt&&!bt[Vt]){var Ut=y.getUniformLocation(this.program,Vt);Ut&&(bt[Vt]=Ut)}}this.fixedUniforms=f(n,bt),this.binderUniforms=u?u.getUniforms(n,bt):[]}}};function rs(n,o,i){var u=1/di(i,1,o.transform.tileZoom),f=Math.pow(2,i.tileID.overscaledZ),m=i.tileSize*Math.pow(2,o.transform.tileZoom)/f,y=m*(i.tileID.canonical.x+i.tileID.wrap*f),_=m*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[y>>16,_>>16],u_pixel_coord_lower:[65535&y,65535&_]}}_l.prototype.draw=function(n,o,i,u,f,m,y,_,T,C,B,U,O,K,W,Q){var G,$=n.gl;if(!this.failedToCreate){for(var at in n.program.set(this.program),n.setDepthMode(i),n.setStencilMode(u),n.setColorMode(f),n.setCullFace(m),this.fixedUniforms)this.fixedUniforms[at].set(y[at]);K&&K.setUniforms(n,this.binderUniforms,U,{zoom:O});for(var ht=(G={},G[$.LINES]=2,G[$.TRIANGLES]=3,G[$.LINE_STRIP]=1,G)[o],St=0,bt=B.get();St<bt.length;St+=1){var Tt=bt[St],Ct=Tt.vaos||(Tt.vaos={});(Ct[_]||(Ct[_]=new mo)).bind(n,this,T,K?K.getPaintVertexBuffers():[],C,Tt.vertexOffset,W,Q),$.drawElements(o,Tt.primitiveLength*ht,$.UNSIGNED_SHORT,Tt.primitiveOffset*ht*2)}}};var su=function(n,o,i,u){var f=o.style.light,m=f.properties.get("position"),y=[m.x,m.y,m.z],_=h.create$1();f.properties.get("anchor")==="viewport"&&h.fromRotation(_,-o.transform.angle),h.transformMat3(y,y,_);var T=f.properties.get("color");return{u_matrix:n,u_lightpos:y,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+i,u_opacity:u}},Lu=function(n,o,i,u,f,m,y){return h.extend(su(n,o,i,u),rs(m,o,y),{u_height_factor:-Math.pow(2,f.overscaledZ)/y.tileSize/8})},Ko=function(n){return{u_matrix:n}},Mo=function(n,o,i,u){return h.extend(Ko(n),rs(i,o,u))},Yo=function(n,o){return{u_matrix:n,u_world:o}},Fa=function(n,o,i,u,f){return h.extend(Mo(n,o,i,u),{u_world:f})},xl=function(n,o,i,u){var f,m,y=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var _=di(i,1,y.zoom);f=!0,m=[_,_]}else f=!1,m=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(o.posMatrix,i,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:h.browser.devicePixelRatio,u_extrude_scale:m}},Jo=function(n,o,i){var u=di(i,1,o.zoom),f=Math.pow(2,o.zoom-i.tileID.overscaledZ),m=i.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[o.pixelsToGLUnits[0]/(u*f),o.pixelsToGLUnits[1]/(u*f)],u_overscale_factor:m}},ha=function(n,o,i){return{u_matrix:n,u_inv_matrix:o,u_camera_to_center_distance:i.cameraToCenterDistance,u_viewport_size:[i.width,i.height]}},pa=function(n,o,i){return i===void 0&&(i=1),{u_matrix:n,u_color:o,u_overlay:0,u_overlay_scale:i}},$o=function(n){return{u_matrix:n}},Qo=function(n,o,i,u){return{u_matrix:n,u_extrude_scale:di(o,1,i),u_intensity:u}},uu=function(n,o,i){var u=n.transform;return{u_matrix:Un(n,o,i),u_ratio:1/di(o,1,u.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},yi=function(n,o,i,u){return h.extend(uu(n,o,i),{u_image:0,u_image_height:u})},nr=function(n,o,i,u){var f=n.transform,m=Du(o,f);return{u_matrix:Un(n,o,i),u_texsize:o.imageAtlasTexture.size,u_ratio:1/di(o,1,f.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_image:0,u_scale:[m,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},go=function(n,o,i,u,f){var m=n.lineAtlas,y=Du(o,n.transform),_=i.layout.get("line-cap")==="round",T=m.getDash(u.from,_),C=m.getDash(u.to,_),B=T.width*f.fromScale,U=C.width*f.toScale;return h.extend(uu(n,o,i),{u_patternscale_a:[y/B,-T.height/2],u_patternscale_b:[y/U,-C.height/2],u_sdfgamma:m.width/(256*Math.min(B,U)*h.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:T.y,u_tex_y_b:C.y,u_mix:f.t})};function Du(n,o){return 1/di(n,1,o.tileZoom)}function Un(n,o,i){return n.translatePosMatrix(o.tileID.posMatrix,o,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var Ru=function(n,o,i,u,f){return{u_matrix:n,u_tl_parent:o,u_scale_parent:i,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(y=f.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(m=f.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:As(f.paint.get("raster-hue-rotate"))};var m,y};function As(n){n*=Math.PI/180;var o=Math.sin(n),i=Math.cos(n);return[(2*i+1)/3,(-Math.sqrt(3)*o-i+1)/3,(Math.sqrt(3)*o-i+1)/3]}var ns,Bu=function(n,o,i,u,f,m,y,_,T,C){var B=f.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:B.width/B.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:y,u_coord_matrix:_,u_is_text:+T,u_pitch_with_map:+u,u_texsize:C,u_texture:0}},is=function(n,o,i,u,f,m,y,_,T,C,B){var U=f.transform;return h.extend(Bu(n,o,i,u,f,m,y,_,T,C),{u_gamma_scale:u?Math.cos(U._pitch)*U.cameraToCenterDistance:1,u_device_pixel_ratio:h.browser.devicePixelRatio,u_is_halo:+B})},lu=function(n,o,i,u,f,m,y,_,T,C){return h.extend(is(n,o,i,u,f,m,y,_,!0,T,!0),{u_texsize_icon:C,u_texture_icon:1})},cu=function(n,o,i){return{u_matrix:n,u_opacity:o,u_color:i}},Ua=function(n,o,i,u,f,m){return h.extend(function(y,_,T,C){var B=T.imageManager.getPattern(y.from.toString()),U=T.imageManager.getPattern(y.to.toString()),O=T.imageManager.getPixelSize(),K=O.width,W=O.height,Q=Math.pow(2,C.tileID.overscaledZ),G=C.tileSize*Math.pow(2,T.transform.tileZoom)/Q,$=G*(C.tileID.canonical.x+C.tileID.wrap*Q),at=G*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[K,W],u_mix:_.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:_.fromScale,u_scale_b:_.toScale,u_tile_units_to_pixels:1/di(C,1,T.transform.tileZoom),u_pixel_coord_upper:[$>>16,at>>16],u_pixel_coord_lower:[65535&$,65535&at]}}(u,m,i,f),{u_matrix:n,u_opacity:o})},os={fillExtrusion:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_lightpos:new h.Uniform3f(n,o.u_lightpos),u_lightintensity:new h.Uniform1f(n,o.u_lightintensity),u_lightcolor:new h.Uniform3f(n,o.u_lightcolor),u_vertical_gradient:new h.Uniform1f(n,o.u_vertical_gradient),u_opacity:new h.Uniform1f(n,o.u_opacity)}},fillExtrusionPattern:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_lightpos:new h.Uniform3f(n,o.u_lightpos),u_lightintensity:new h.Uniform1f(n,o.u_lightintensity),u_lightcolor:new h.Uniform3f(n,o.u_lightcolor),u_vertical_gradient:new h.Uniform1f(n,o.u_vertical_gradient),u_height_factor:new h.Uniform1f(n,o.u_height_factor),u_image:new h.Uniform1i(n,o.u_image),u_texsize:new h.Uniform2f(n,o.u_texsize),u_pixel_coord_upper:new h.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,o.u_pixel_coord_lower),u_scale:new h.Uniform3f(n,o.u_scale),u_fade:new h.Uniform1f(n,o.u_fade),u_opacity:new h.Uniform1f(n,o.u_opacity)}},fill:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix)}},fillPattern:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_image:new h.Uniform1i(n,o.u_image),u_texsize:new h.Uniform2f(n,o.u_texsize),u_pixel_coord_upper:new h.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,o.u_pixel_coord_lower),u_scale:new h.Uniform3f(n,o.u_scale),u_fade:new h.Uniform1f(n,o.u_fade)}},fillOutline:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_world:new h.Uniform2f(n,o.u_world)}},fillOutlinePattern:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_world:new h.Uniform2f(n,o.u_world),u_image:new h.Uniform1i(n,o.u_image),u_texsize:new h.Uniform2f(n,o.u_texsize),u_pixel_coord_upper:new h.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,o.u_pixel_coord_lower),u_scale:new h.Uniform3f(n,o.u_scale),u_fade:new h.Uniform1f(n,o.u_fade)}},circle:function(n,o){return{u_camera_to_center_distance:new h.Uniform1f(n,o.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(n,o.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(n,o.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(n,o.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(n,o.u_matrix)}},collisionBox:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_camera_to_center_distance:new h.Uniform1f(n,o.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(n,o.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(n,o.u_extrude_scale),u_overscale_factor:new h.Uniform1f(n,o.u_overscale_factor)}},collisionCircle:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_inv_matrix:new h.UniformMatrix4f(n,o.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(n,o.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(n,o.u_viewport_size)}},debug:function(n,o){return{u_color:new h.UniformColor(n,o.u_color),u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_overlay:new h.Uniform1i(n,o.u_overlay),u_overlay_scale:new h.Uniform1f(n,o.u_overlay_scale)}},clippingMask:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix)}},heatmap:function(n,o){return{u_extrude_scale:new h.Uniform1f(n,o.u_extrude_scale),u_intensity:new h.Uniform1f(n,o.u_intensity),u_matrix:new h.UniformMatrix4f(n,o.u_matrix)}},heatmapTexture:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_world:new h.Uniform2f(n,o.u_world),u_image:new h.Uniform1i(n,o.u_image),u_color_ramp:new h.Uniform1i(n,o.u_color_ramp),u_opacity:new h.Uniform1f(n,o.u_opacity)}},hillshade:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_image:new h.Uniform1i(n,o.u_image),u_latrange:new h.Uniform2f(n,o.u_latrange),u_light:new h.Uniform2f(n,o.u_light),u_shadow:new h.UniformColor(n,o.u_shadow),u_highlight:new h.UniformColor(n,o.u_highlight),u_accent:new h.UniformColor(n,o.u_accent)}},hillshadePrepare:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_image:new h.Uniform1i(n,o.u_image),u_dimension:new h.Uniform2f(n,o.u_dimension),u_zoom:new h.Uniform1f(n,o.u_zoom),u_unpack:new h.Uniform4f(n,o.u_unpack)}},line:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_ratio:new h.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(n,o.u_units_to_pixels)}},lineGradient:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_ratio:new h.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(n,o.u_units_to_pixels),u_image:new h.Uniform1i(n,o.u_image),u_image_height:new h.Uniform1f(n,o.u_image_height)}},linePattern:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_texsize:new h.Uniform2f(n,o.u_texsize),u_ratio:new h.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_image:new h.Uniform1i(n,o.u_image),u_units_to_pixels:new h.Uniform2f(n,o.u_units_to_pixels),u_scale:new h.Uniform3f(n,o.u_scale),u_fade:new h.Uniform1f(n,o.u_fade)}},lineSDF:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_ratio:new h.Uniform1f(n,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(n,o.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(n,o.u_patternscale_a),u_patternscale_b:new h.Uniform2f(n,o.u_patternscale_b),u_sdfgamma:new h.Uniform1f(n,o.u_sdfgamma),u_image:new h.Uniform1i(n,o.u_image),u_tex_y_a:new h.Uniform1f(n,o.u_tex_y_a),u_tex_y_b:new h.Uniform1f(n,o.u_tex_y_b),u_mix:new h.Uniform1f(n,o.u_mix)}},raster:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_tl_parent:new h.Uniform2f(n,o.u_tl_parent),u_scale_parent:new h.Uniform1f(n,o.u_scale_parent),u_buffer_scale:new h.Uniform1f(n,o.u_buffer_scale),u_fade_t:new h.Uniform1f(n,o.u_fade_t),u_opacity:new h.Uniform1f(n,o.u_opacity),u_image0:new h.Uniform1i(n,o.u_image0),u_image1:new h.Uniform1i(n,o.u_image1),u_brightness_low:new h.Uniform1f(n,o.u_brightness_low),u_brightness_high:new h.Uniform1f(n,o.u_brightness_high),u_saturation_factor:new h.Uniform1f(n,o.u_saturation_factor),u_contrast_factor:new h.Uniform1f(n,o.u_contrast_factor),u_spin_weights:new h.Uniform3f(n,o.u_spin_weights)}},symbolIcon:function(n,o){return{u_is_size_zoom_constant:new h.Uniform1i(n,o.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(n,o.u_is_size_feature_constant),u_size_t:new h.Uniform1f(n,o.u_size_t),u_size:new h.Uniform1f(n,o.u_size),u_camera_to_center_distance:new h.Uniform1f(n,o.u_camera_to_center_distance),u_pitch:new h.Uniform1f(n,o.u_pitch),u_rotate_symbol:new h.Uniform1i(n,o.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(n,o.u_aspect_ratio),u_fade_change:new h.Uniform1f(n,o.u_fade_change),u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(n,o.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(n,o.u_coord_matrix),u_is_text:new h.Uniform1i(n,o.u_is_text),u_pitch_with_map:new h.Uniform1i(n,o.u_pitch_with_map),u_texsize:new h.Uniform2f(n,o.u_texsize),u_texture:new h.Uniform1i(n,o.u_texture)}},symbolSDF:function(n,o){return{u_is_size_zoom_constant:new h.Uniform1i(n,o.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(n,o.u_is_size_feature_constant),u_size_t:new h.Uniform1f(n,o.u_size_t),u_size:new h.Uniform1f(n,o.u_size),u_camera_to_center_distance:new h.Uniform1f(n,o.u_camera_to_center_distance),u_pitch:new h.Uniform1f(n,o.u_pitch),u_rotate_symbol:new h.Uniform1i(n,o.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(n,o.u_aspect_ratio),u_fade_change:new h.Uniform1f(n,o.u_fade_change),u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(n,o.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(n,o.u_coord_matrix),u_is_text:new h.Uniform1i(n,o.u_is_text),u_pitch_with_map:new h.Uniform1i(n,o.u_pitch_with_map),u_texsize:new h.Uniform2f(n,o.u_texsize),u_texture:new h.Uniform1i(n,o.u_texture),u_gamma_scale:new h.Uniform1f(n,o.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(n,o.u_is_halo)}},symbolTextAndIcon:function(n,o){return{u_is_size_zoom_constant:new h.Uniform1i(n,o.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(n,o.u_is_size_feature_constant),u_size_t:new h.Uniform1f(n,o.u_size_t),u_size:new h.Uniform1f(n,o.u_size),u_camera_to_center_distance:new h.Uniform1f(n,o.u_camera_to_center_distance),u_pitch:new h.Uniform1f(n,o.u_pitch),u_rotate_symbol:new h.Uniform1i(n,o.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(n,o.u_aspect_ratio),u_fade_change:new h.Uniform1f(n,o.u_fade_change),u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(n,o.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(n,o.u_coord_matrix),u_is_text:new h.Uniform1i(n,o.u_is_text),u_pitch_with_map:new h.Uniform1i(n,o.u_pitch_with_map),u_texsize:new h.Uniform2f(n,o.u_texsize),u_texsize_icon:new h.Uniform2f(n,o.u_texsize_icon),u_texture:new h.Uniform1i(n,o.u_texture),u_texture_icon:new h.Uniform1i(n,o.u_texture_icon),u_gamma_scale:new h.Uniform1f(n,o.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(n,o.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(n,o.u_is_halo)}},background:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_opacity:new h.Uniform1f(n,o.u_opacity),u_color:new h.UniformColor(n,o.u_color)}},backgroundPattern:function(n,o){return{u_matrix:new h.UniformMatrix4f(n,o.u_matrix),u_opacity:new h.Uniform1f(n,o.u_opacity),u_image:new h.Uniform1i(n,o.u_image),u_pattern_tl_a:new h.Uniform2f(n,o.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(n,o.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(n,o.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(n,o.u_pattern_br_b),u_texsize:new h.Uniform2f(n,o.u_texsize),u_mix:new h.Uniform1f(n,o.u_mix),u_pattern_size_a:new h.Uniform2f(n,o.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(n,o.u_pattern_size_b),u_scale_a:new h.Uniform1f(n,o.u_scale_a),u_scale_b:new h.Uniform1f(n,o.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(n,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,o.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(n,o.u_tile_units_to_pixels)}}};function fa(n,o,i,u,f,m,y){for(var _=n.context,T=_.gl,C=n.useProgram("collisionBox"),B=[],U=0,O=0,K=0;K<u.length;K++){var W=u[K],Q=o.getTile(W),G=Q.getBucket(i);if(G){var $=W.posMatrix;f[0]===0&&f[1]===0||($=n.translatePosMatrix(W.posMatrix,Q,f,m));var at=y?G.textCollisionBox:G.iconCollisionBox,ht=G.collisionCircleArray;if(ht.length>0){var St=h.create(),bt=$;h.mul(St,G.placementInvProjMatrix,n.transform.glCoordMatrix),h.mul(St,St,G.placementViewportMatrix),B.push({circleArray:ht,circleOffset:O,transform:bt,invTransform:St}),O=U+=ht.length/4}at&&C.draw(_,T.LINES,N.disabled,X.disabled,n.colorModeForRenderPass(),st.disabled,Jo($,n.transform,Q),i.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,n.transform.zoom,null,null,at.collisionVertexBuffer)}}if(y&&B.length){var Tt=n.useProgram("collisionCircle"),Ct=new h.StructArrayLayout2f1f2i16;Ct.resize(4*U),Ct._trim();for(var Vt=0,Ut=0,Jt=B;Ut<Jt.length;Ut+=1)for(var ae=Jt[Ut],ve=0;ve<ae.circleArray.length/4;ve++){var de=4*ve,ar=ae.circleArray[de+0],te=ae.circleArray[de+1],Se=ae.circleArray[de+2],Ze=ae.circleArray[de+3];Ct.emplace(Vt++,ar,te,Se,Ze,0),Ct.emplace(Vt++,ar,te,Se,Ze,1),Ct.emplace(Vt++,ar,te,Se,Ze,2),Ct.emplace(Vt++,ar,te,Se,Ze,3)}(!ns||ns.length<2*U)&&(ns=function(sn){var en=2*sn,Tn=new h.StructArrayLayout3ui6;Tn.resize(en),Tn._trim();for(var vn=0;vn<en;vn++){var Vr=6*vn;Tn.uint16[Vr+0]=4*vn+0,Tn.uint16[Vr+1]=4*vn+1,Tn.uint16[Vr+2]=4*vn+2,Tn.uint16[Vr+3]=4*vn+2,Tn.uint16[Vr+4]=4*vn+3,Tn.uint16[Vr+5]=4*vn+0}return Tn}(U));for(var Re=_.createIndexBuffer(ns,!0),Pe=_.createVertexBuffer(Ct,h.collisionCircleLayout.members,!0),ke=0,Ae=B;ke<Ae.length;ke+=1){var ie=Ae[ke],Er=ha(ie.transform,ie.invTransform,n.transform);Tt.draw(_,T.TRIANGLES,N.disabled,X.disabled,n.colorModeForRenderPass(),st.disabled,Er,i.id,Pe,Re,h.SegmentVector.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,n.transform.zoom,null,null,null)}Pe.destroy(),Re.destroy()}}var Ps=h.identity(new Float32Array(16));function yo(n,o,i,u,f,m){var y=h.getAnchorAlignment(n),_=-(y.horizontalAlign-.5)*o,T=-(y.verticalAlign-.5)*i,C=h.evaluateVariableOffset(n,u);return new h.Point((_/f+C[0])*m,(T/f+C[1])*m)}function hu(n,o,i,u,f,m,y,_,T,C,B){var U=n.text.placedSymbolArray,O=n.text.dynamicLayoutVertexArray,K=n.icon.dynamicLayoutVertexArray,W={};O.clear();for(var Q=0;Q<U.length;Q++){var G=U.get(Q),$=G.hidden||!G.crossTileID||n.allowVerticalPlacement&&!G.placedOrientation?null:u[G.crossTileID];if($){var at=new h.Point(G.anchorX,G.anchorY),ht=Ve(at,i?_:y),St=ts(m.cameraToCenterDistance,ht.signedDistanceFromCamera),bt=f.evaluateSizeForFeature(n.textSizeData,C,G)*St/h.ONE_EM;i&&(bt*=n.tilePixelRatio/T);for(var Tt=yo($.anchor,$.width,$.height,$.textOffset,$.textBoxScale,bt),Ct=i?Ve(at.add(Tt),y).point:ht.point.add(o?Tt.rotate(-m.angle):Tt),Vt=n.allowVerticalPlacement&&G.placedOrientation===h.WritingMode.vertical?Math.PI/2:0,Ut=0;Ut<G.numGlyphs;Ut++)h.addDynamicAttributes(O,Ct,Vt);B&&G.associatedIconIndex>=0&&(W[G.associatedIconIndex]={shiftedAnchor:Ct,angle:Vt})}else ho(G.numGlyphs,O)}if(B){K.clear();for(var Jt=n.icon.placedSymbolArray,ae=0;ae<Jt.length;ae++){var ve=Jt.get(ae);if(ve.hidden)ho(ve.numGlyphs,K);else{var de=W[ae];if(de)for(var ar=0;ar<ve.numGlyphs;ar++)h.addDynamicAttributes(K,de.shiftedAnchor,de.angle);else ho(ve.numGlyphs,K)}}n.icon.dynamicLayoutVertexBuffer.updateData(K)}n.text.dynamicLayoutVertexBuffer.updateData(O)}function Ou(n,o,i){return i.iconsInText&&o?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Lo(n,o,i,u,f,m,y,_,T,C,B,U){for(var O=n.context,K=O.gl,W=n.transform,Q=_==="map",G=T==="map",$=Q&&i.layout.get("symbol-placement")!=="point",at=Q&&!G&&!$,ht=!i.layout.get("symbol-sort-key").isConstant(),St=!1,bt=n.depthModeForSublayer(0,N.ReadOnly),Tt=i.layout.get("text-variable-anchor"),Ct=[],Vt=0,Ut=u;Vt<Ut.length;Vt+=1){var Jt=Ut[Vt],ae=o.getTile(Jt),ve=ae.getBucket(i);if(ve){var de=f?ve.text:ve.icon;if(de&&de.segments.get().length){var ar=de.programConfigurations.get(i.id),te=f||ve.sdfIcons,Se=f?ve.textSizeData:ve.iconSizeData,Ze=G||W.pitch!==0,Re=n.useProgram(Ou(te,f,ve),ar),Pe=h.evaluateSizeForZoom(Se,W.zoom),ke=void 0,Ae=[0,0],ie=void 0,Er=void 0,sn=null,en=void 0;if(f)ie=ae.glyphAtlasTexture,Er=K.LINEAR,ke=ae.glyphAtlasTexture.size,ve.iconsInText&&(Ae=ae.imageAtlasTexture.size,sn=ae.imageAtlasTexture,en=Ze||n.options.rotating||n.options.zooming||Se.kind==="composite"||Se.kind==="camera"?K.LINEAR:K.NEAREST);else{var Tn=i.layout.get("icon-size").constantOr(0)!==1||ve.iconsNeedLinear;ie=ae.imageAtlasTexture,Er=te||n.options.rotating||n.options.zooming||Tn||Ze?K.LINEAR:K.NEAREST,ke=ae.imageAtlasTexture.size}var vn=di(ae,1,n.transform.zoom),Vr=Fr(Jt.posMatrix,G,Q,n.transform,vn),oi=Sr(Jt.posMatrix,G,Q,n.transform,vn),un=Tt&&ve.hasTextData(),ai=i.layout.get("icon-text-fit")!=="none"&&un&&ve.hasIconData();$&&Da(ve,Jt.posMatrix,n,f,Vr,oi,G,C);var zi=n.translatePosMatrix(Jt.posMatrix,ae,m,y),ga=$||f&&Tt||ai?Ps:Vr,bo=n.translatePosMatrix(oi,ae,m,y,!0),Zu=te&&i.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0,us={program:Re,buffers:de,uniformValues:te?ve.iconsInText?lu(Se.kind,Pe,at,G,n,zi,ga,bo,ke,Ae):is(Se.kind,Pe,at,G,n,zi,ga,bo,f,ke,!0):Bu(Se.kind,Pe,at,G,n,zi,ga,bo,f,ke),atlasTexture:ie,atlasTextureIcon:sn,atlasInterpolation:Er,atlasInterpolationIcon:en,isSDF:te,hasHalo:Zu};if(ht&&ve.canOverlap){St=!0;for(var ya=0,ls=de.segments.get();ya<ls.length;ya+=1){var ju=ls[ya];Ct.push({segments:new h.SegmentVector([ju]),sortKey:ju.sortKey,state:us})}}else Ct.push({segments:de.segments,sortKey:0,state:us})}}}St&&Ct.sort(function(Uo,Ds){return Uo.sortKey-Ds.sortKey});for(var mu=0,to=Ct;mu<to.length;mu+=1){var gu=to[mu],kn=gu.state;if(O.activeTexture.set(K.TEXTURE0),kn.atlasTexture.bind(kn.atlasInterpolation,K.CLAMP_TO_EDGE),kn.atlasTextureIcon&&(O.activeTexture.set(K.TEXTURE1),kn.atlasTextureIcon&&kn.atlasTextureIcon.bind(kn.atlasInterpolationIcon,K.CLAMP_TO_EDGE)),kn.isSDF){var ea=kn.uniformValues;kn.hasHalo&&(ea.u_is_halo=1,Do(kn.buffers,gu.segments,i,n,kn.program,bt,B,U,ea)),ea.u_is_halo=0}Do(kn.buffers,gu.segments,i,n,kn.program,bt,B,U,kn.uniformValues)}}function Do(n,o,i,u,f,m,y,_,T){var C=u.context;f.draw(C,C.gl.TRIANGLES,m,y,_,st.disabled,T,i.id,n.layoutVertexBuffer,n.indexBuffer,o,i.paint,u.transform.zoom,n.programConfigurations.get(i.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Cs(n,o,i,u,f,m,y){var _,T,C,B,U,O=n.context.gl,K=i.paint.get("fill-pattern"),W=K&&K.constantOr(1),Q=i.getCrossfadeParameters();y?(T=W&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",_=O.LINES):(T=W?"fillPattern":"fill",_=O.TRIANGLES);for(var G=0,$=u;G<$.length;G+=1){var at=$[G],ht=o.getTile(at);if(!W||ht.patternsLoaded()){var St=ht.getBucket(i);if(St){var bt=St.programConfigurations.get(i.id),Tt=n.useProgram(T,bt);W&&(n.context.activeTexture.set(O.TEXTURE0),ht.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),bt.updatePaintBuffers(Q));var Ct=K.constantOr(null);if(Ct&&ht.imageAtlas){var Vt=ht.imageAtlas,Ut=Vt.patternPositions[Ct.to.toString()],Jt=Vt.patternPositions[Ct.from.toString()];Ut&&Jt&&bt.setConstantPatternPositions(Ut,Jt)}var ae=n.translatePosMatrix(at.posMatrix,ht,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(y){B=St.indexBuffer2,U=St.segments2;var ve=[O.drawingBufferWidth,O.drawingBufferHeight];C=T==="fillOutlinePattern"&&W?Fa(ae,n,Q,ht,ve):Yo(ae,ve)}else B=St.indexBuffer,U=St.segments,C=W?Mo(ae,n,Q,ht):Ko(ae);Tt.draw(n.context,_,f,n.stencilModeForClipping(at),m,st.disabled,C,i.id,St.layoutVertexBuffer,B,U,i.paint,n.transform.zoom,bt)}}}}function zs(n,o,i,u,f,m,y){for(var _=n.context,T=_.gl,C=i.paint.get("fill-extrusion-pattern"),B=C.constantOr(1),U=i.getCrossfadeParameters(),O=i.paint.get("fill-extrusion-opacity"),K=0,W=u;K<W.length;K+=1){var Q=W[K],G=o.getTile(Q),$=G.getBucket(i);if($){var at=$.programConfigurations.get(i.id),ht=n.useProgram(B?"fillExtrusionPattern":"fillExtrusion",at);B&&(n.context.activeTexture.set(T.TEXTURE0),G.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),at.updatePaintBuffers(U));var St=C.constantOr(null);if(St&&G.imageAtlas){var bt=G.imageAtlas,Tt=bt.patternPositions[St.to.toString()],Ct=bt.patternPositions[St.from.toString()];Tt&&Ct&&at.setConstantPatternPositions(Tt,Ct)}var Vt=n.translatePosMatrix(Q.posMatrix,G,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Ut=i.paint.get("fill-extrusion-vertical-gradient"),Jt=B?Lu(Vt,n,Ut,O,Q,U,G):su(Vt,n,Ut,O);ht.draw(_,_.gl.TRIANGLES,f,m,y,st.backCCW,Jt,i.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,i.paint,n.transform.zoom,at)}}}function bl(n,o,i,u,f,m){var y=n.context,_=y.gl,T=o.fbo;if(T){var C=n.useProgram("hillshade");y.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,T.colorAttachment.get());var B=function(U,O,K){var W=K.paint.get("hillshade-shadow-color"),Q=K.paint.get("hillshade-highlight-color"),G=K.paint.get("hillshade-accent-color"),$=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&($-=U.transform.angle);var at,ht,St,bt=!U.options.moving;return{u_matrix:U.transform.calculatePosMatrix(O.tileID.toUnwrapped(),bt),u_image:0,u_latrange:(at=O.tileID,ht=Math.pow(2,at.canonical.z),St=at.canonical.y,[new h.MercatorCoordinate(0,St/ht).toLngLat().lat,new h.MercatorCoordinate(0,(St+1)/ht).toLngLat().lat]),u_light:[K.paint.get("hillshade-exaggeration"),$],u_shadow:W,u_highlight:Q,u_accent:G}}(n,o,i);C.draw(y,_.TRIANGLES,u,f,m,st.disabled,B,i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function ta(n,o,i,u,f,m){var y=n.context,_=y.gl,T=o.dem;if(T&&T.data){var C=T.dim,B=T.stride,U=T.getPixels();if(y.activeTexture.set(_.TEXTURE1),y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||n.getTileTexture(B),o.demTexture){var O=o.demTexture;O.update(U,{premultiply:!1}),O.bind(_.NEAREST,_.CLAMP_TO_EDGE)}else o.demTexture=new h.Texture(y,U,_.RGBA,{premultiply:!1}),o.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE);y.activeTexture.set(_.TEXTURE0);var K=o.fbo;if(!K){var W=new h.Texture(y,{width:C,height:C,data:null},_.RGBA);W.bind(_.LINEAR,_.CLAMP_TO_EDGE),(K=o.fbo=y.createFramebuffer(C,C,!0)).colorAttachment.set(W.texture)}y.bindFramebuffer.set(K.framebuffer),y.viewport.set([0,0,C,C]),n.useProgram("hillshadePrepare").draw(y,_.TRIANGLES,u,f,m,st.disabled,function(Q,G){var $=G.stride,at=h.create();return h.ortho(at,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(at,at,[0,-h.EXTENT,0]),{u_matrix:at,u_image:1,u_dimension:[$,$],u_zoom:Q.overscaledZ,u_unpack:G.getUnpackVector()}}(o.tileID,T),i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function vo(n,o,i,u,f){var m=u.paint.get("raster-fade-duration");if(m>0){var y=h.browser.now(),_=(y-n.timeAdded)/m,T=o?(y-o.timeAdded)/m:-1,C=i.getSource(),B=f.coveringZoomLevel({tileSize:C.tileSize,roundZoom:C.roundZoom}),U=!o||Math.abs(o.tileID.overscaledZ-B)>Math.abs(n.tileID.overscaledZ-B),O=U&&n.refreshedUponExpiration?1:h.clamp(U?_:1-T,0,1);return n.refreshedUponExpiration&&_>=1&&(n.refreshedUponExpiration=!1),o?{opacity:1,mix:1-O}:{opacity:O,mix:0}}return{opacity:1,mix:0}}var ks=new h.Color(1,0,0,1),pu=new h.Color(0,1,0,1),Fu=new h.Color(0,0,1,1),Uu=new h.Color(1,0,1,1),fu=new h.Color(0,1,1,1);function Na(n,o,i,u){ft(n,0,o+i/2,n.transform.width,i,u)}function da(n,o,i,u){ft(n,o-i/2,0,i,n.transform.height,u)}function ft(n,o,i,u,f,m){var y=n.context,_=y.gl;_.enable(_.SCISSOR_TEST),_.scissor(o*h.browser.devicePixelRatio,i*h.browser.devicePixelRatio,u*h.browser.devicePixelRatio,f*h.browser.devicePixelRatio),y.clear({color:m}),_.disable(_.SCISSOR_TEST)}function zt(n,o,i){var u=n.context,f=u.gl,m=i.posMatrix,y=n.useProgram("debug"),_=N.disabled,T=X.disabled,C=n.colorModeForRenderPass();u.activeTexture.set(f.TEXTURE0),n.emptyTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),y.draw(u,f.LINE_STRIP,_,T,C,st.disabled,pa(m,h.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var B=o.getTileByID(i.key).latestRawTileData,U=Math.floor((B&&B.byteLength||0)/1024),O=o.getTile(i).tileSize,K=512/Math.min(O,512)*(i.overscaledZ/n.transform.zoom)*.5,W=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(W+=" => "+i.overscaledZ),function(Q,G){Q.initDebugOverlayCanvas();var $=Q.debugOverlayCanvas,at=Q.context.gl,ht=Q.debugOverlayCanvas.getContext("2d");ht.clearRect(0,0,$.width,$.height),ht.shadowColor="white",ht.shadowBlur=2,ht.lineWidth=1.5,ht.strokeStyle="white",ht.textBaseline="top",ht.font="bold 36px Open Sans, sans-serif",ht.fillText(G,5,5),ht.strokeText(G,5,5),Q.debugOverlayTexture.update($),Q.debugOverlayTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE)}(n,W+" "+U+"kb"),y.draw(u,f.TRIANGLES,_,T,rt.alphaBlended,st.disabled,pa(m,h.Color.transparent,K),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var It={symbol:function(n,o,i,u,f){if(n.renderPass==="translucent"){var m=X.disabled,y=n.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(_,T,C,B,U,O,K){for(var W=T.transform,Q=U==="map",G=O==="map",$=0,at=_;$<at.length;$+=1){var ht=at[$],St=B.getTile(ht),bt=St.getBucket(C);if(bt&&bt.text&&bt.text.segments.get().length){var Tt=h.evaluateSizeForZoom(bt.textSizeData,W.zoom),Ct=di(St,1,T.transform.zoom),Vt=Fr(ht.posMatrix,G,Q,T.transform,Ct),Ut=C.layout.get("icon-text-fit")!=="none"&&bt.hasIconData();if(Tt){var Jt=Math.pow(2,W.zoom-St.tileID.overscaledZ);hu(bt,Q,G,K,h.symbolSize,W,Vt,ht.posMatrix,Jt,Tt,Ut)}}}}(u,n,i,o,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),f),i.paint.get("icon-opacity").constantOr(1)!==0&&Lo(n,o,i,u,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),m,y),i.paint.get("text-opacity").constantOr(1)!==0&&Lo(n,o,i,u,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),m,y),o.map.showCollisionBoxes&&(fa(n,o,i,u,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),fa(n,o,i,u,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(n,o,i,u){if(n.renderPass==="translucent"){var f=i.paint.get("circle-opacity"),m=i.paint.get("circle-stroke-width"),y=i.paint.get("circle-stroke-opacity"),_=!i.layout.get("circle-sort-key").isConstant();if(f.constantOr(1)!==0||m.constantOr(1)!==0&&y.constantOr(1)!==0){for(var T=n.context,C=T.gl,B=n.depthModeForSublayer(0,N.ReadOnly),U=X.disabled,O=n.colorModeForRenderPass(),K=[],W=0;W<u.length;W++){var Q=u[W],G=o.getTile(Q),$=G.getBucket(i);if($){var at=$.programConfigurations.get(i.id),ht={programConfiguration:at,program:n.useProgram("circle",at),layoutVertexBuffer:$.layoutVertexBuffer,indexBuffer:$.indexBuffer,uniformValues:xl(n,Q,G,i)};if(_)for(var St=0,bt=$.segments.get();St<bt.length;St+=1){var Tt=bt[St];K.push({segments:new h.SegmentVector([Tt]),sortKey:Tt.sortKey,state:ht})}else K.push({segments:$.segments,sortKey:0,state:ht})}}_&&K.sort(function(ae,ve){return ae.sortKey-ve.sortKey});for(var Ct=0,Vt=K;Ct<Vt.length;Ct+=1){var Ut=Vt[Ct],Jt=Ut.state;Jt.program.draw(T,C.TRIANGLES,B,U,O,st.disabled,Jt.uniformValues,i.id,Jt.layoutVertexBuffer,Jt.indexBuffer,Ut.segments,i.paint,n.transform.zoom,Jt.programConfiguration)}}}},heatmap:function(n,o,i,u){if(i.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var f=n.context,m=f.gl,y=X.disabled,_=new rt([m.ONE,m.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(K,W,Q){var G=K.gl;K.activeTexture.set(G.TEXTURE1),K.viewport.set([0,0,W.width/4,W.height/4]);var $=Q.heatmapFbo;if($)G.bindTexture(G.TEXTURE_2D,$.colorAttachment.get()),K.bindFramebuffer.set($.framebuffer);else{var at=G.createTexture();G.bindTexture(G.TEXTURE_2D,at),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR),$=Q.heatmapFbo=K.createFramebuffer(W.width/4,W.height/4,!1),function(ht,St,bt,Tt){var Ct=ht.gl;Ct.texImage2D(Ct.TEXTURE_2D,0,Ct.RGBA,St.width/4,St.height/4,0,Ct.RGBA,ht.extRenderToTextureHalfFloat?ht.extTextureHalfFloat.HALF_FLOAT_OES:Ct.UNSIGNED_BYTE,null),Tt.colorAttachment.set(bt)}(K,W,at,$)}})(f,n,i),f.clear({color:h.Color.transparent});for(var T=0;T<u.length;T++){var C=u[T];if(!o.hasRenderableParent(C)){var B=o.getTile(C),U=B.getBucket(i);if(U){var O=U.programConfigurations.get(i.id);n.useProgram("heatmap",O).draw(f,m.TRIANGLES,N.disabled,y,_,st.disabled,Qo(C.posMatrix,B,n.transform.zoom,i.paint.get("heatmap-intensity")),i.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,i.paint,n.transform.zoom,O)}}}f.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(K,W){var Q=K.context,G=Q.gl,$=W.heatmapFbo;if($){Q.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,$.colorAttachment.get()),Q.activeTexture.set(G.TEXTURE1);var at=W.colorRampTexture;at||(at=W.colorRampTexture=new h.Texture(Q,W.colorRamp,G.RGBA)),at.bind(G.LINEAR,G.CLAMP_TO_EDGE),K.useProgram("heatmapTexture").draw(Q,G.TRIANGLES,N.disabled,X.disabled,K.colorModeForRenderPass(),st.disabled,function(ht,St,bt,Tt){var Ct=h.create();h.ortho(Ct,0,ht.width,ht.height,0,0,1);var Vt=ht.context.gl;return{u_matrix:Ct,u_world:[Vt.drawingBufferWidth,Vt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:St.paint.get("heatmap-opacity")}}(K,W),W.id,K.viewportBuffer,K.quadTriangleIndexBuffer,K.viewportSegments,W.paint,K.transform.zoom)}}(n,i))},line:function(n,o,i,u){if(n.renderPass==="translucent"){var f=i.paint.get("line-opacity"),m=i.paint.get("line-width");if(f.constantOr(1)!==0&&m.constantOr(1)!==0)for(var y=n.depthModeForSublayer(0,N.ReadOnly),_=n.colorModeForRenderPass(),T=i.paint.get("line-dasharray"),C=i.paint.get("line-pattern"),B=C.constantOr(1),U=i.paint.get("line-gradient"),O=i.getCrossfadeParameters(),K=B?"linePattern":T?"lineSDF":U?"lineGradient":"line",W=n.context,Q=W.gl,G=!0,$=0,at=u;$<at.length;$+=1){var ht=at[$],St=o.getTile(ht);if(!B||St.patternsLoaded()){var bt=St.getBucket(i);if(bt){var Tt=bt.programConfigurations.get(i.id),Ct=n.context.program.get(),Vt=n.useProgram(K,Tt),Ut=G||Vt.program!==Ct,Jt=C.constantOr(null);if(Jt&&St.imageAtlas){var ae=St.imageAtlas,ve=ae.patternPositions[Jt.to.toString()],de=ae.patternPositions[Jt.from.toString()];ve&&de&&Tt.setConstantPatternPositions(ve,de)}var ar=B?nr(n,St,i,O):T?go(n,St,i,T,O):U?yi(n,St,i,bt.lineClipsArray.length):uu(n,St,i);if(B)W.activeTexture.set(Q.TEXTURE0),St.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Tt.updatePaintBuffers(O);else if(T&&(Ut||n.lineAtlas.dirty))W.activeTexture.set(Q.TEXTURE0),n.lineAtlas.bind(W);else if(U){var te=bt.gradients[i.id],Se=te.texture;if(i.gradientVersion!==te.version){var Ze=256;if(i.stepInterpolant){var Re=o.getSource().maxzoom,Pe=ht.canonical.z===Re?Math.ceil(1<<n.transform.maxZoom-ht.canonical.z):1;Ze=h.clamp(h.nextPowerOfTwo(bt.maxLineLength/h.EXTENT*1024*Pe),256,W.maxTextureSize)}te.gradient=h.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Ze,image:te.gradient||void 0,clips:bt.lineClipsArray}),te.texture?te.texture.update(te.gradient):te.texture=new h.Texture(W,te.gradient,Q.RGBA),te.version=i.gradientVersion,Se=te.texture}W.activeTexture.set(Q.TEXTURE0),Se.bind(i.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}Vt.draw(W,Q.TRIANGLES,y,n.stencilModeForClipping(ht),_,st.disabled,ar,i.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,i.paint,n.transform.zoom,Tt,bt.layoutVertexBuffer2),G=!1}}}}},fill:function(n,o,i,u){var f=i.paint.get("fill-color"),m=i.paint.get("fill-opacity");if(m.constantOr(1)!==0){var y=n.colorModeForRenderPass(),_=i.paint.get("fill-pattern"),T=n.opaquePassEnabledForLayer()&&!_.constantOr(1)&&f.constantOr(h.Color.transparent).a===1&&m.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===T){var C=n.depthModeForSublayer(1,n.renderPass==="opaque"?N.ReadWrite:N.ReadOnly);Cs(n,o,i,u,C,y,!1)}if(n.renderPass==="translucent"&&i.paint.get("fill-antialias")){var B=n.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,N.ReadOnly);Cs(n,o,i,u,B,y,!0)}}},"fill-extrusion":function(n,o,i,u){var f=i.paint.get("fill-extrusion-opacity");if(f!==0&&n.renderPass==="translucent"){var m=new N(n.context.gl.LEQUAL,N.ReadWrite,n.depthRangeFor3D);if(f!==1||i.paint.get("fill-extrusion-pattern").constantOr(1))zs(n,o,i,u,m,X.disabled,rt.disabled),zs(n,o,i,u,m,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var y=n.colorModeForRenderPass();zs(n,o,i,u,m,X.disabled,y)}}},hillshade:function(n,o,i,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var f=n.context,m=n.depthModeForSublayer(0,N.ReadOnly),y=n.colorModeForRenderPass(),_=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],T=_[0],C=0,B=_[1];C<B.length;C+=1){var U=B[C],O=o.getTile(U);O.needsHillshadePrepare&&n.renderPass==="offscreen"?ta(n,O,i,m,X.disabled,y):n.renderPass==="translucent"&&bl(n,O,i,m,T[U.overscaledZ],y)}f.viewport.set([0,0,n.width,n.height])}},raster:function(n,o,i,u){if(n.renderPass==="translucent"&&i.paint.get("raster-opacity")!==0&&u.length)for(var f=n.context,m=f.gl,y=o.getSource(),_=n.useProgram("raster"),T=n.colorModeForRenderPass(),C=y instanceof Io?[{},u]:n.stencilConfigForOverlap(u),B=C[0],U=C[1],O=U[U.length-1].overscaledZ,K=!n.options.moving,W=0,Q=U;W<Q.length;W+=1){var G=Q[W],$=n.depthModeForSublayer(G.overscaledZ-O,i.paint.get("raster-opacity")===1?N.ReadWrite:N.ReadOnly,m.LESS),at=o.getTile(G),ht=n.transform.calculatePosMatrix(G.toUnwrapped(),K);at.registerFadeDuration(i.paint.get("raster-fade-duration"));var St=o.findLoadedParent(G,0),bt=vo(at,St,o,i,n.transform),Tt=void 0,Ct=void 0,Vt=i.paint.get("raster-resampling")==="nearest"?m.NEAREST:m.LINEAR;f.activeTexture.set(m.TEXTURE0),at.texture.bind(Vt,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST),f.activeTexture.set(m.TEXTURE1),St?(St.texture.bind(Vt,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST),Tt=Math.pow(2,St.tileID.overscaledZ-at.tileID.overscaledZ),Ct=[at.tileID.canonical.x*Tt%1,at.tileID.canonical.y*Tt%1]):at.texture.bind(Vt,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST);var Ut=Ru(ht,Ct||[0,0],Tt||1,bt,i);y instanceof Io?_.draw(f,m.TRIANGLES,$,X.disabled,T,st.disabled,Ut,i.id,y.boundsBuffer,n.quadTriangleIndexBuffer,y.boundsSegments):_.draw(f,m.TRIANGLES,$,B[G.overscaledZ],T,st.disabled,Ut,i.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,o,i){var u=i.paint.get("background-color"),f=i.paint.get("background-opacity");if(f!==0){var m=n.context,y=m.gl,_=n.transform,T=_.tileSize,C=i.paint.get("background-pattern");if(!n.isPatternMissing(C)){var B=!C&&u.a===1&&f===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===B){var U=X.disabled,O=n.depthModeForSublayer(0,B==="opaque"?N.ReadWrite:N.ReadOnly),K=n.colorModeForRenderPass(),W=n.useProgram(C?"backgroundPattern":"background"),Q=_.coveringTiles({tileSize:T});C&&(m.activeTexture.set(y.TEXTURE0),n.imageManager.bind(n.context));for(var G=i.getCrossfadeParameters(),$=0,at=Q;$<at.length;$+=1){var ht=at[$],St=n.transform.calculatePosMatrix(ht.toUnwrapped()),bt=C?Ua(St,f,n,C,{tileID:ht,tileSize:T},G):cu(St,f,u);W.draw(m,y.TRIANGLES,O,U,K,st.disabled,bt,i.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,o,i){for(var u=0;u<i.length;u++)zt(n,o,i[u])},custom:function(n,o,i){var u=n.context,f=i.implementation;if(n.renderPass==="offscreen"){var m=f.prerender;m&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),m.call(f,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(X.disabled);var y=f.renderingMode==="3d"?new N(n.context.gl.LEQUAL,N.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,N.ReadOnly);u.setDepthMode(y),f.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},jt=function(n,o){this.context=new nt(n),this.transform=o,this._tileTextures={},this.setup(),this.numSublayers=V.maxUnderzooming+V.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ba,this.gpuTimers={}};jt.prototype.resize=function(n,o){if(this.width=n*h.browser.devicePixelRatio,this.height=o*h.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,u=this.style._order;i<u.length;i+=1)this.style._layers[u[i]].resize()},jt.prototype.setup=function(){var n=this.context,o=new h.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(h.EXTENT,0),o.emplaceBack(0,h.EXTENT),o.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(o,Ki.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);var i=new h.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(h.EXTENT,0),i.emplaceBack(0,h.EXTENT),i.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=n.createVertexBuffer(i,Ki.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);var u=new h.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(h.EXTENT,0,h.EXTENT,0),u.emplaceBack(0,h.EXTENT,0,h.EXTENT),u.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,fn.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);var f=new h.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(f,Ki.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);var m=new h.StructArrayLayout1ui2;m.emplaceBack(0),m.emplaceBack(1),m.emplaceBack(3),m.emplaceBack(2),m.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(m);var y=new h.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(y),this.emptyTexture=new h.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var _=this.context.gl;this.stencilClearMode=new X({func:_.ALWAYS,mask:0},0,255,_.ZERO,_.ZERO,_.ZERO)},jt.prototype.clearStencil=function(){var n=this.context,o=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=h.create();h.ortho(i,0,this.width,this.height,0,0,1),h.scale(i,i,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,o.TRIANGLES,N.disabled,this.stencilClearMode,rt.disabled,st.disabled,$o(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},jt.prototype._renderTileClippingMasks=function(n,o){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&o&&o.length){this.currentStencilSource=n.source;var i=this.context,u=i.gl;this.nextStencilID+o.length>256&&this.clearStencil(),i.setColorMode(rt.disabled),i.setDepthMode(N.disabled);var f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var m=0,y=o;m<y.length;m+=1){var _=y[m],T=this._tileClippingMaskIDs[_.key]=this.nextStencilID++;f.draw(i,u.TRIANGLES,N.disabled,new X({func:u.ALWAYS,mask:0},T,255,u.KEEP,u.KEEP,u.REPLACE),rt.disabled,st.disabled,$o(_.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},jt.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,o=this.context.gl;return new X({func:o.NOTEQUAL,mask:255},n,255,o.KEEP,o.KEEP,o.REPLACE)},jt.prototype.stencilModeForClipping=function(n){var o=this.context.gl;return new X({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,o.KEEP,o.KEEP,o.REPLACE)},jt.prototype.stencilConfigForOverlap=function(n){var o,i=this.context.gl,u=n.sort(function(T,C){return C.overscaledZ-T.overscaledZ}),f=u[u.length-1].overscaledZ,m=u[0].overscaledZ-f+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();for(var y={},_=0;_<m;_++)y[_+f]=new X({func:i.GEQUAL,mask:255},_+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=m,[y,u]}return[(o={},o[f]=X.disabled,o),u]},jt.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new rt([n.CONSTANT_COLOR,n.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?rt.unblended:rt.alphaBlended},jt.prototype.depthModeForSublayer=function(n,o,i){if(!this.opaquePassEnabledForLayer())return N.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new N(i||this.context.gl.LEQUAL,o,[u,u])},jt.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},jt.prototype.render=function(n,o){var i=this;this.style=n,this.options=o,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(h.browser.now()),this.imageManager.beginFrame();var u=this.style._order,f=this.style.sourceCaches;for(var m in f){var y=f[m];y.used&&y.prepare(this.context)}var _,T,C={},B={},U={};for(var O in f){var K=f[O];C[O]=K.getVisibleCoordinates(),B[O]=C[O].slice().reverse(),U[O]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var W=0;W<u.length;W++)if(this.style._layers[u[W]].is3D()){this.opaquePassCutoff=W;break}this.renderPass="offscreen";for(var Q=0,G=u;Q<G.length;Q+=1){var $=this.style._layers[G[Q]];if($.hasOffscreenPass()&&!$.isHidden(this.transform.zoom)){var at=B[$.source];($.type==="custom"||at.length)&&this.renderLayer(this,f[$.source],$,at)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ht=this.style._layers[u[this.currentLayer]],St=f[ht.source],bt=C[ht.source];this._renderTileClippingMasks(ht,bt),this.renderLayer(this,St,ht,bt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Tt=this.style._layers[u[this.currentLayer]],Ct=f[Tt.source],Vt=(Tt.type==="symbol"?U:B)[Tt.source];this._renderTileClippingMasks(Tt,C[Tt.source]),this.renderLayer(this,Ct,Tt,Vt)}this.options.showTileBoundaries&&(h.values(this.style._layers).forEach(function(Ut){Ut.source&&!Ut.isHidden(i.transform.zoom)&&(Ut.source!==(T&&T.id)&&(T=i.style.sourceCaches[Ut.source]),(!_||_.getSource().maxzoom<T.getSource().maxzoom)&&(_=T))}),_&&It.debug(this,_,_.getVisibleCoordinates())),this.options.showPadding&&function(Ut){var Jt=Ut.transform.padding;Na(Ut,Ut.transform.height-(Jt.top||0),3,ks),Na(Ut,Jt.bottom||0,3,pu),da(Ut,Jt.left||0,3,Fu),da(Ut,Ut.transform.width-(Jt.right||0),3,Uu);var ae=Ut.transform.centerPoint;(function(ve,de,ar,te){ft(ve,de-1,ar-10,2,20,te),ft(ve,de-10,ar-1,20,2,te)})(Ut,ae.x,Ut.transform.height-ae.y,fu)}(this),this.context.setDefault()},jt.prototype.renderLayer=function(n,o,i,u){i.isHidden(this.transform.zoom)||(i.type==="background"||i.type==="custom"||u.length)&&(this.id=i.id,this.gpuTimingStart(i),It[i.type](n,o,i,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},jt.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var o=this.context.extTimerQuery,i=this.gpuTimers[n.id];i||(i=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),i.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,i.query)}},jt.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},jt.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},jt.prototype.queryGpuTimers=function(n){var o={};for(var i in n){var u=n[i],f=this.context.extTimerQuery,m=f.getQueryObjectEXT(u.query,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(u.query),o[i]=m}return o},jt.prototype.translatePosMatrix=function(n,o,i,u,f){if(!i[0]&&!i[1])return n;var m=f?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(m){var y=Math.sin(m),_=Math.cos(m);i=[i[0]*_-i[1]*y,i[0]*y+i[1]*_]}var T=[f?i[0]:di(o,i[0],this.transform.zoom),f?i[1]:di(o,i[1],this.transform.zoom),0],C=new Float32Array(16);return h.translate(C,n,T),C},jt.prototype.saveTileTexture=function(n){var o=this._tileTextures[n.size[0]];o?o.push(n):this._tileTextures[n.size[0]]=[n]},jt.prototype.getTileTexture=function(n){var o=this._tileTextures[n];return o&&o.length>0?o.pop():null},jt.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var o=this.imageManager.getPattern(n.from.toString()),i=this.imageManager.getPattern(n.to.toString());return!o||!i},jt.prototype.useProgram=function(n,o){this.cache=this.cache||{};var i=""+n+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new _l(this.context,n,Dr[n],o,os[n],this._showOverdrawInspector)),this.cache[i]},jt.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},jt.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},jt.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},jt.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var qe=function(n,o){this.points=n,this.planes=o};qe.fromInvProjectionMatrix=function(n,o,i){var u=Math.pow(2,i),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(y){return h.transformMat4([],y,n)}).map(function(y){return h.scale$1([],y,1/y[3]/o*u)}),m=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(y){var _=h.sub([],f[y[0]],f[y[1]]),T=h.sub([],f[y[2]],f[y[1]]),C=h.normalize([],h.cross([],_,T)),B=-h.dot(C,f[y[1]]);return C.concat(B)});return new qe(f,m)};var lr=function(n,o){this.min=n,this.max=o,this.center=h.scale$2([],h.add([],this.min,this.max),.5)};lr.prototype.quadrant=function(n){for(var o=[n%2==0,n<2],i=h.clone$2(this.min),u=h.clone$2(this.max),f=0;f<o.length;f++)i[f]=o[f]?this.min[f]:this.center[f],u[f]=o[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new lr(i,u)},lr.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},lr.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},lr.prototype.intersects=function(n){for(var o=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,u=0;u<n.planes.length;u++){for(var f=n.planes[u],m=0,y=0;y<o.length;y++)m+=h.dot$1(f,o[y])>=0;if(m===0)return 0;m!==o.length&&(i=!1)}if(i)return 2;for(var _=0;_<3;_++){for(var T=Number.MAX_VALUE,C=-Number.MAX_VALUE,B=0;B<n.points.length;B++){var U=n.points[B][_]-this.min[_];T=Math.min(T,U),C=Math.max(C,U)}if(C<0||T>this.max[_]-this.min[_])return 0}return 1};var jr=function(n,o,i,u){if(n===void 0&&(n=0),o===void 0&&(o=0),i===void 0&&(i=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(o)||o<0||isNaN(i)||i<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=o,this.left=i,this.right=u};jr.prototype.interpolate=function(n,o,i){return o.top!=null&&n.top!=null&&(this.top=h.number(n.top,o.top,i)),o.bottom!=null&&n.bottom!=null&&(this.bottom=h.number(n.bottom,o.bottom,i)),o.left!=null&&n.left!=null&&(this.left=h.number(n.left,o.left,i)),o.right!=null&&n.right!=null&&(this.right=h.number(n.right,o.right,i)),this},jr.prototype.getCenter=function(n,o){var i=h.clamp((this.left+n-this.right)/2,0,n),u=h.clamp((this.top+o-this.bottom)/2,0,o);return new h.Point(i,u)},jr.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},jr.prototype.clone=function(){return new jr(this.top,this.bottom,this.left,this.right)},jr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var xe=function(n,o,i,u,f){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=f===void 0||f,this._minZoom=n||0,this._maxZoom=o||22,this._minPitch=i==null?0:i,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new jr,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ke={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};xe.prototype.clone=function(){var n=new xe(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Ke.minZoom.get=function(){return this._minZoom},Ke.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Ke.maxZoom.get=function(){return this._maxZoom},Ke.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Ke.minPitch.get=function(){return this._minPitch},Ke.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Ke.maxPitch.get=function(){return this._maxPitch},Ke.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Ke.renderWorldCopies.get=function(){return this._renderWorldCopies},Ke.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Ke.worldSize.get=function(){return this.tileSize*this.scale},Ke.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ke.size.get=function(){return new h.Point(this.width,this.height)},Ke.bearing.get=function(){return-this.angle/Math.PI*180},Ke.bearing.set=function(n){var o=-h.wrap(n,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ke.pitch.get=function(){return this._pitch/Math.PI*180},Ke.pitch.set=function(n){var o=h.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())},Ke.fov.get=function(){return this._fov/Math.PI*180},Ke.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Ke.zoom.get=function(){return this._zoom},Ke.zoom.set=function(n){var o=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom,this._constrain(),this._calcMatrices())},Ke.center.get=function(){return this._center},Ke.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Ke.padding.get=function(){return this._edgeInsets.toJSON()},Ke.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Ke.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},xe.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},xe.prototype.interpolatePadding=function(n,o,i){this._unmodified=!1,this._edgeInsets.interpolate(n,o,i),this._constrain(),this._calcMatrices()},xe.prototype.coveringZoomLevel=function(n){var o=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,o)},xe.prototype.getVisibleUnwrappedCoordinates=function(n){var o=[new h.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new h.Point(0,0)),u=this.pointCoordinate(new h.Point(this.width,0)),f=this.pointCoordinate(new h.Point(this.width,this.height)),m=this.pointCoordinate(new h.Point(0,this.height)),y=Math.floor(Math.min(i.x,u.x,f.x,m.x)),_=Math.floor(Math.max(i.x,u.x,f.x,m.x)),T=y-1;T<=_+1;T++)T!==0&&o.push(new h.UnwrappedTileID(T,n));return o},xe.prototype.coveringTiles=function(n){var o=this.coveringZoomLevel(n),i=o;if(n.minzoom!==void 0&&o<n.minzoom)return[];n.maxzoom!==void 0&&o>n.maxzoom&&(o=n.maxzoom);var u=h.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,o),m=[f*u.x,f*u.y,0],y=qe.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o),_=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(_=o);var T=function(Ut){return{aabb:new lr([Ut*f,0,0],[(Ut+1)*f,f,0]),zoom:0,x:0,y:0,wrap:Ut,fullyVisible:!1}},C=[],B=[],U=o,O=n.reparseOverscaled?i:o;if(this._renderWorldCopies)for(var K=1;K<=3;K++)C.push(T(-K)),C.push(T(K));for(C.push(T(0));C.length>0;){var W=C.pop(),Q=W.x,G=W.y,$=W.fullyVisible;if(!$){var at=W.aabb.intersects(y);if(at===0)continue;$=at===2}var ht=W.aabb.distanceX(m),St=W.aabb.distanceY(m),bt=Math.max(Math.abs(ht),Math.abs(St));if(W.zoom===U||bt>3+(1<<U-W.zoom)-2&&W.zoom>=_)B.push({tileID:new h.OverscaledTileID(W.zoom===U?O:W.zoom,W.wrap,W.zoom,Q,G),distanceSq:h.sqrLen([m[0]-.5-Q,m[1]-.5-G])});else for(var Tt=0;Tt<4;Tt++){var Ct=(Q<<1)+Tt%2,Vt=(G<<1)+(Tt>>1);C.push({aabb:W.aabb.quadrant(Tt),zoom:W.zoom+1,x:Ct,y:Vt,wrap:W.wrap,fullyVisible:$})}}return B.sort(function(Ut,Jt){return Ut.distanceSq-Jt.distanceSq}).map(function(Ut){return Ut.tileID})},xe.prototype.resize=function(n,o){this.width=n,this.height=o,this.pixelsToGLUnits=[2/n,-2/o],this._constrain(),this._calcMatrices()},Ke.unmodified.get=function(){return this._unmodified},xe.prototype.zoomScale=function(n){return Math.pow(2,n)},xe.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},xe.prototype.project=function(n){var o=h.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.Point(h.mercatorXfromLng(n.lng)*this.worldSize,h.mercatorYfromLat(o)*this.worldSize)},xe.prototype.unproject=function(n){return new h.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Ke.point.get=function(){return this.project(this.center)},xe.prototype.setLocationAtPoint=function(n,o){var i=this.pointCoordinate(o),u=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(n),m=new h.MercatorCoordinate(f.x-(i.x-u.x),f.y-(i.y-u.y));this.center=this.coordinateLocation(m),this._renderWorldCopies&&(this.center=this.center.wrap())},xe.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},xe.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},xe.prototype.locationCoordinate=function(n){return h.MercatorCoordinate.fromLngLat(n)},xe.prototype.coordinateLocation=function(n){return n.toLngLat()},xe.prototype.pointCoordinate=function(n){var o=[n.x,n.y,0,1],i=[n.x,n.y,1,1];h.transformMat4(o,o,this.pixelMatrixInverse),h.transformMat4(i,i,this.pixelMatrixInverse);var u=o[3],f=i[3],m=o[1]/u,y=i[1]/f,_=o[2]/u,T=i[2]/f,C=_===T?0:(0-_)/(T-_);return new h.MercatorCoordinate(h.number(o[0]/u,i[0]/f,C)/this.worldSize,h.number(m,y,C)/this.worldSize)},xe.prototype.coordinatePoint=function(n){var o=[n.x*this.worldSize,n.y*this.worldSize,0,1];return h.transformMat4(o,o,this.pixelMatrix),new h.Point(o[0]/o[3],o[1]/o[3])},xe.prototype.getBounds=function(){return new h.LngLatBounds().extend(this.pointLocation(new h.Point(0,0))).extend(this.pointLocation(new h.Point(this.width,0))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))},xe.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},xe.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},xe.prototype.calculatePosMatrix=function(n,o){o===void 0&&(o=!1);var i=n.key,u=o?this._alignedPosMatrixCache:this._posMatrixCache;if(u[i])return u[i];var f=n.canonical,m=this.worldSize/this.zoomScale(f.z),y=f.x+Math.pow(2,f.z)*n.wrap,_=h.identity(new Float64Array(16));return h.translate(_,_,[y*m,f.y*m,0]),h.scale(_,_,[m/h.EXTENT,m/h.EXTENT,1]),h.multiply(_,o?this.alignedProjMatrix:this.projMatrix,_),u[i]=new Float32Array(_),u[i]},xe.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},xe.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,o,i,u,f=-90,m=90,y=-180,_=180,T=this.size,C=this._unmodified;if(this.latRange){var B=this.latRange;f=h.mercatorYfromLat(B[1])*this.worldSize,n=(m=h.mercatorYfromLat(B[0])*this.worldSize)-f<T.y?T.y/(m-f):0}if(this.lngRange){var U=this.lngRange;y=h.mercatorXfromLng(U[0])*this.worldSize,o=(_=h.mercatorXfromLng(U[1])*this.worldSize)-y<T.x?T.x/(_-y):0}var O=this.point,K=Math.max(o||0,n||0);if(K)return this.center=this.unproject(new h.Point(o?(_+y)/2:O.x,n?(m+f)/2:O.y)),this.zoom+=this.scaleZoom(K),this._unmodified=C,void(this._constraining=!1);if(this.latRange){var W=O.y,Q=T.y/2;W-Q<f&&(u=f+Q),W+Q>m&&(u=m-Q)}if(this.lngRange){var G=O.x,$=T.x/2;G-$<y&&(i=y+$),G+$>_&&(i=_-$)}i===void 0&&u===void 0||(this.center=this.unproject(new h.Point(i!==void 0?i:O.x,u!==void 0?u:O.y))),this._unmodified=C,this._constraining=!1}},xe.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var o=Math.PI/2+this._pitch,i=this._fov*(.5+n.y/this.height),u=Math.sin(i)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-o-i,.01,Math.PI-.01)),f=this.point,m=f.x,y=f.y,_=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),T=this.height/50,C=new Float64Array(16);h.perspective(C,this._fov,this.width/this.height,T,_),C[8]=2*-n.x/this.width,C[9]=2*n.y/this.height,h.scale(C,C,[1,-1,1]),h.translate(C,C,[0,0,-this.cameraToCenterDistance]),h.rotateX(C,C,this._pitch),h.rotateZ(C,C,this.angle),h.translate(C,C,[-m,-y,0]),this.mercatorMatrix=h.scale([],C,[this.worldSize,this.worldSize,this.worldSize]),h.scale(C,C,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=C,this.invProjMatrix=h.invert([],this.projMatrix);var B=this.width%2/2,U=this.height%2/2,O=Math.cos(this.angle),K=Math.sin(this.angle),W=m-Math.round(m)+O*B+K*U,Q=y-Math.round(y)+O*U+K*B,G=new Float64Array(C);if(h.translate(G,G,[W>.5?W-1:W,Q>.5?Q-1:Q,0]),this.alignedProjMatrix=G,C=h.create(),h.scale(C,C,[this.width/2,-this.height/2,1]),h.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=h.create(),h.scale(C,C,[1,-1,1]),h.translate(C,C,[-1,-1,0]),h.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(C=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this._posMatrixCache={},this._alignedPosMatrixCache={}}},xe.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new h.Point(0,0)),o=[n.x*this.worldSize,n.y*this.worldSize,0,1];return h.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance},xe.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,n))},xe.prototype.getCameraQueryGeometry=function(n){var o=this.getCameraPoint();if(n.length===1)return[n[0],o];for(var i=o.x,u=o.y,f=o.x,m=o.y,y=0,_=n;y<_.length;y+=1){var T=_[y];i=Math.min(i,T.x),u=Math.min(u,T.y),f=Math.max(f,T.x),m=Math.max(m,T.y)}return[new h.Point(i,u),new h.Point(f,u),new h.Point(f,m),new h.Point(i,m),new h.Point(i,u)]},Object.defineProperties(xe.prototype,Ke);var ma=function(n){var o,i,u,f;this._hashName=n&&encodeURIComponent(n),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(o=this._updateHashUnthrottled.bind(this),i=!1,u=null,f=function(){u=null,i&&(o(),u=setTimeout(f,300),i=!1)},function(){return i=!0,u||f(),u})};ma.prototype.addTo=function(n){return this._map=n,h.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ma.prototype.remove=function(){return h.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ma.prototype.getHashString=function(n){var o=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,u=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,u),m=Math.round(o.lng*f)/f,y=Math.round(o.lat*f)/f,_=this._map.getBearing(),T=this._map.getPitch(),C="";if(C+=n?"/"+m+"/"+y+"/"+i:i+"/"+y+"/"+m,(_||T)&&(C+="/"+Math.round(10*_)/10),T&&(C+="/"+Math.round(T)),this._hashName){var B=this._hashName,U=!1,O=h.window.location.hash.slice(1).split("&").map(function(K){var W=K.split("=")[0];return W===B?(U=!0,W+"="+C):K}).filter(function(K){return K});return U||O.push(B+"="+C),"#"+O.join("&")}return"#"+C},ma.prototype._getCurrentHash=function(){var n,o=this,i=h.window.location.hash.replace("#","");return this._hashName?(i.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===o._hashName&&(n=u)}),(n&&n[1]||"").split("/")):i.split("/")},ma.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(i){return isNaN(i)})){var o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:o,pitch:+(n[4]||0)}),!0}return!1},ma.prototype._updateHashUnthrottled=function(){var n=h.window.location.href.replace(/(#.+)?$/,this.getHashString());try{h.window.history.replaceState(h.window.history.state,null,n)}catch{}};var an={linearity:.3,easing:h.bezier(0,0,.3,1)},Ms=h.extend({deceleration:2500,maxSpeed:1400},an),as=h.extend({deceleration:20,maxSpeed:1400},an),w=h.extend({deceleration:1e3,maxSpeed:360},an),P=h.extend({deceleration:1e3,maxSpeed:90},an),D=function(n){this._map=n,this.clear()};function H(n,o){(!n.duration||n.duration<o.duration)&&(n.duration=o.duration,n.easing=o.easing)}function ct(n,o,i){var u=i.maxSpeed,f=i.linearity,m=i.deceleration,y=h.clamp(n*f/(o/1e3),-u,u),_=Math.abs(y)/(m*f);return{easing:i.easing,duration:1e3*_,amount:y*(_/2)}}D.prototype.clear=function(){this._inertiaBuffer=[]},D.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.browser.now(),settings:n})},D.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,o=h.browser.now();n.length>0&&o-n[0].time>160;)n.shift()},D.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var o={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0},i=0,u=this._inertiaBuffer;i<u.length;i+=1){var f=u[i].settings;o.zoom+=f.zoomDelta||0,o.bearing+=f.bearingDelta||0,o.pitch+=f.pitchDelta||0,f.panDelta&&o.pan._add(f.panDelta),f.around&&(o.around=f.around),f.pinchAround&&(o.pinchAround=f.pinchAround)}var m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(o.pan.mag()){var _=ct(o.pan.mag(),m,h.extend({},Ms,n||{}));y.offset=o.pan.mult(_.amount/o.pan.mag()),y.center=this._map.transform.center,H(y,_)}if(o.zoom){var T=ct(o.zoom,m,as);y.zoom=this._map.transform.zoom+T.amount,H(y,T)}if(o.bearing){var C=ct(o.bearing,m,w);y.bearing=this._map.transform.bearing+h.clamp(C.amount,-179,179),H(y,C)}if(o.pitch){var B=ct(o.pitch,m,P);y.pitch=this._map.transform.pitch+B.amount,H(y,B)}if(y.zoom||y.bearing){var U=o.pinchAround===void 0?o.around:o.pinchAround;y.around=U?this._map.unproject(U):this._map.getCenter()}return this.clear(),h.extend(y,{noMoveStart:!0})}};var ut=function(n){function o(u,f,m,y){y===void 0&&(y={});var _=Bt.mousePos(f.getCanvasContainer(),m),T=f.unproject(_);n.call(this,u,h.extend({point:_,lngLat:T,originalEvent:m},y)),this._defaultPrevented=!1,this.target=f}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(h.Event),ot=function(n){function o(u,f,m){var y=u==="touchend"?m.changedTouches:m.touches,_=Bt.touchPos(f.getCanvasContainer(),y),T=_.map(function(U){return f.unproject(U)}),C=_.reduce(function(U,O,K,W){return U.add(O.div(W.length))},new h.Point(0,0)),B=f.unproject(C);n.call(this,u,{points:_,point:C,lngLats:T,lngLat:B,originalEvent:m}),this._defaultPrevented=!1}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(h.Event),wt=function(n){function o(u,f,m){n.call(this,u,{originalEvent:m}),this._defaultPrevented=!1}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,i),o}(h.Event),gt=function(n,o){this._map=n,this._clickTolerance=o.clickTolerance};gt.prototype.reset=function(){delete this._mousedownPos},gt.prototype.wheel=function(n){return this._firePreventable(new wt(n.type,this._map,n))},gt.prototype.mousedown=function(n,o){return this._mousedownPos=o,this._firePreventable(new ut(n.type,this._map,n))},gt.prototype.mouseup=function(n){this._map.fire(new ut(n.type,this._map,n))},gt.prototype.click=function(n,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new ut(n.type,this._map,n))},gt.prototype.dblclick=function(n){return this._firePreventable(new ut(n.type,this._map,n))},gt.prototype.mouseover=function(n){this._map.fire(new ut(n.type,this._map,n))},gt.prototype.mouseout=function(n){this._map.fire(new ut(n.type,this._map,n))},gt.prototype.touchstart=function(n){return this._firePreventable(new ot(n.type,this._map,n))},gt.prototype.touchmove=function(n){this._map.fire(new ot(n.type,this._map,n))},gt.prototype.touchend=function(n){this._map.fire(new ot(n.type,this._map,n))},gt.prototype.touchcancel=function(n){this._map.fire(new ot(n.type,this._map,n))},gt.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},gt.prototype.isEnabled=function(){return!0},gt.prototype.isActive=function(){return!1},gt.prototype.enable=function(){},gt.prototype.disable=function(){};var Mt=function(n){this._map=n};Mt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Mt.prototype.mousemove=function(n){this._map.fire(new ut(n.type,this._map,n))},Mt.prototype.mousedown=function(){this._delayContextMenu=!0},Mt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ut("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Mt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ut(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},Mt.prototype.isEnabled=function(){return!0},Mt.prototype.isActive=function(){return!1},Mt.prototype.enable=function(){},Mt.prototype.disable=function(){};var mt=function(n,o){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=o.clickTolerance||1};function Ft(n,o){for(var i={},u=0;u<n.length;u++)i[n[u].identifier]=o[u];return i}mt.prototype.isEnabled=function(){return!!this._enabled},mt.prototype.isActive=function(){return!!this._active},mt.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},mt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},mt.prototype.mousedown=function(n,o){this.isEnabled()&&n.shiftKey&&n.button===0&&(Bt.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)},mt.prototype.mousemoveWindow=function(n,o){if(this._active){var i=o;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=i,this._box||(this._box=Bt.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var f=Math.min(u.x,i.x),m=Math.max(u.x,i.x),y=Math.min(u.y,i.y),_=Math.max(u.y,i.y);Bt.setTransform(this._box,"translate("+f+"px,"+y+"px)"),this._box.style.width=m-f+"px",this._box.style.height=_-y+"px"}}},mt.prototype.mouseupWindow=function(n,o){var i=this;if(this._active&&n.button===0){var u=this._startPos,f=o;if(this.reset(),Bt.suppressClick(),u.x!==f.x||u.y!==f.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(m){return m.fitScreenCoordinates(u,f,i._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},mt.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},mt.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(Bt.remove(this._box),this._box=null),Bt.enableDrag(),delete this._startPos,delete this._lastPos},mt.prototype._fireEvent=function(n,o){return this._map.fire(new h.Event(n,{originalEvent:o}))};var le=function(n){this.reset(),this.numTouches=n.numTouches};le.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},le.prototype.touchstart=function(n,o,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),i.length===this.numTouches&&(this.centroid=function(u){for(var f=new h.Point(0,0),m=0,y=u;m<y.length;m+=1)f._add(y[m]);return f.div(u.length)}(o),this.touches=Ft(i,o)))},le.prototype.touchmove=function(n,o,i){if(!this.aborted&&this.centroid){var u=Ft(i,o);for(var f in this.touches){var m=u[f];(!m||m.dist(this.touches[f])>30)&&(this.aborted=!0)}}},le.prototype.touchend=function(n,o,i){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),i.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var oe=function(n){this.singleTap=new le(n),this.numTaps=n.numTaps,this.reset()};oe.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},oe.prototype.touchstart=function(n,o,i){this.singleTap.touchstart(n,o,i)},oe.prototype.touchmove=function(n,o,i){this.singleTap.touchmove(n,o,i)},oe.prototype.touchend=function(n,o,i){var u=this.singleTap.touchend(n,o,i);if(u){var f=n.timeStamp-this.lastTime<500,m=!this.lastTap||this.lastTap.dist(u)<30;if(f&&m||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var ge=function(){this._zoomIn=new oe({numTouches:1,numTaps:2}),this._zoomOut=new oe({numTouches:2,numTaps:1}),this.reset()};ge.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ge.prototype.touchstart=function(n,o,i){this._zoomIn.touchstart(n,o,i),this._zoomOut.touchstart(n,o,i)},ge.prototype.touchmove=function(n,o,i){this._zoomIn.touchmove(n,o,i),this._zoomOut.touchmove(n,o,i)},ge.prototype.touchend=function(n,o,i){var u=this,f=this._zoomIn.touchend(n,o,i),m=this._zoomOut.touchend(n,o,i);return f?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(y){return y.easeTo({duration:300,zoom:y.getZoom()+1,around:y.unproject(f)},{originalEvent:n})}}):m?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(y){return y.easeTo({duration:300,zoom:y.getZoom()-1,around:y.unproject(m)},{originalEvent:n})}}):void 0},ge.prototype.touchcancel=function(){this.reset()},ge.prototype.enable=function(){this._enabled=!0},ge.prototype.disable=function(){this._enabled=!1,this.reset()},ge.prototype.isEnabled=function(){return this._enabled},ge.prototype.isActive=function(){return this._active};var Je={0:1,2:2},Ie=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Ie.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ie.prototype._correctButton=function(n,o){return!1},Ie.prototype._move=function(n,o){return{}},Ie.prototype.mousedown=function(n,o){if(!this._lastPoint){var i=Bt.mouseButton(n);this._correctButton(n,i)&&(this._lastPoint=o,this._eventButton=i)}},Ie.prototype.mousemoveWindow=function(n,o){var i=this._lastPoint;if(i){if(n.preventDefault(),function(u,f){var m=Je[f];return u.buttons===void 0||(u.buttons&m)!==m}(n,this._eventButton))this.reset();else if(this._moved||!(o.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(i,o)}},Ie.prototype.mouseupWindow=function(n){this._lastPoint&&Bt.mouseButton(n)===this._eventButton&&(this._moved&&Bt.suppressClick(),this.reset())},Ie.prototype.enable=function(){this._enabled=!0},Ie.prototype.disable=function(){this._enabled=!1,this.reset()},Ie.prototype.isEnabled=function(){return this._enabled},Ie.prototype.isActive=function(){return this._active};var Dt=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.mousedown=function(i,u){n.prototype.mousedown.call(this,i,u),this._lastPoint&&(this._active=!0)},o.prototype._correctButton=function(i,u){return u===0&&!i.ctrlKey},o.prototype._move=function(i,u){return{around:u,panDelta:u.sub(i)}},o}(Ie),Tr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype._correctButton=function(i,u){return u===0&&i.ctrlKey||u===2},o.prototype._move=function(i,u){var f=.8*(u.x-i.x);if(f)return this._active=!0,{bearingDelta:f}},o.prototype.contextmenu=function(i){i.preventDefault()},o}(Ie),Qr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype._correctButton=function(i,u){return u===0&&i.ctrlKey||u===2},o.prototype._move=function(i,u){var f=-.5*(u.y-i.y);if(f)return this._active=!0,{pitchDelta:f}},o.prototype.contextmenu=function(i){i.preventDefault()},o}(Ie),yr=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};yr.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)},yr.prototype.touchstart=function(n,o,i){return this._calculateTransform(n,o,i)},yr.prototype.touchmove=function(n,o,i){if(this._active&&!(i.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,o,i)},yr.prototype.touchend=function(n,o,i){this._calculateTransform(n,o,i),this._active&&i.length<this._minTouches&&this.reset()},yr.prototype.touchcancel=function(){this.reset()},yr.prototype._calculateTransform=function(n,o,i){i.length>0&&(this._active=!0);var u=Ft(i,o),f=new h.Point(0,0),m=new h.Point(0,0),y=0;for(var _ in u){var T=u[_],C=this._touches[_];C&&(f._add(T),m._add(T.sub(C)),y++,u[_]=T)}if(this._touches=u,!(y<this._minTouches)&&m.mag()){var B=m.div(y);if(this._sum._add(B),!(this._sum.mag()<this._clickTolerance))return{around:f.div(y),panDelta:B}}},yr.prototype.enable=function(){this._enabled=!0},yr.prototype.disable=function(){this._enabled=!1,this.reset()},yr.prototype.isEnabled=function(){return this._enabled},yr.prototype.isActive=function(){return this._active};var Cr=function(){this.reset()};function ir(n,o,i){for(var u=0;u<n.length;u++)if(n[u].identifier===i)return o[u]}function Xt(n,o){return Math.log(n/o)/Math.LN2}Cr.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Cr.prototype._start=function(n){},Cr.prototype._move=function(n,o,i){return{}},Cr.prototype.touchstart=function(n,o,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([o[0],o[1]]))},Cr.prototype.touchmove=function(n,o,i){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,f=u[1],m=ir(i,o,u[0]),y=ir(i,o,f);if(m&&y){var _=this._aroundCenter?null:m.add(y).div(2);return this._move([m,y],_,n)}}},Cr.prototype.touchend=function(n,o,i){if(this._firstTwoTouches){var u=this._firstTwoTouches,f=u[1],m=ir(i,o,u[0]),y=ir(i,o,f);m&&y||(this._active&&Bt.suppressClick(),this.reset())}},Cr.prototype.touchcancel=function(){this.reset()},Cr.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Cr.prototype.disable=function(){this._enabled=!1,this.reset()},Cr.prototype.isEnabled=function(){return this._enabled},Cr.prototype.isActive=function(){return this._active};var De=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},o.prototype._start=function(i){this._startDistance=this._distance=i[0].dist(i[1])},o.prototype._move=function(i,u){var f=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Xt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xt(this._distance,f),pinchAround:u}},o}(Cr);function ze(n,o){return 180*n.angleWith(o)/Math.PI}var Oe=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},o.prototype._start=function(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])},o.prototype._move=function(i,u){var f=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ze(this._vector,f),pinchAround:u}},o.prototype._isBelowThreshold=function(i){this._minDiameter=Math.min(this._minDiameter,i.mag());var u=25/(Math.PI*this._minDiameter)*360,f=ze(i,this._startVector);return Math.abs(f)<u},o}(Cr);function zn(n){return Math.abs(n.y)>Math.abs(n.x)}var Xr=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},o.prototype._start=function(i){this._lastPoints=i,zn(i[0].sub(i[1]))&&(this._valid=!1)},o.prototype._move=function(i,u,f){var m=i[0].sub(this._lastPoints[0]),y=i[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(m,y,f.timeStamp),this._valid)return this._lastPoints=i,this._active=!0,{pitchDelta:(m.y+y.y)/2*-.5}},o.prototype.gestureBeginsVertically=function(i,u,f){if(this._valid!==void 0)return this._valid;var m=i.mag()>=2,y=u.mag()>=2;if(m||y){if(!m||!y)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;var _=i.y>0==u.y>0;return zn(i)&&zn(u)&&_}},o}(Cr),Ir={panStep:100,bearingStep:15,pitchStep:10},or=function(){var n=Ir;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function gn(n){return n*(2-n)}or.prototype.reset=function(){this._active=!1},or.prototype.keydown=function(n){var o=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var i=0,u=0,f=0,m=0,y=0;switch(n.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),m=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),m=1);break;case 38:n.shiftKey?f=1:(n.preventDefault(),y=-1);break;case 40:n.shiftKey?f=-1:(n.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(u=0,f=0),{cameraAnimation:function(_){var T=_.getZoom();_.easeTo({duration:300,easeId:"keyboardHandler",easing:gn,zoom:i?Math.round(T)+i*(n.shiftKey?2:1):T,bearing:_.getBearing()+u*o._bearingStep,pitch:_.getPitch()+f*o._pitchStep,offset:[-m*o._panStep,-y*o._panStep],center:_.getCenter()},{originalEvent:n})}}}},or.prototype.enable=function(){this._enabled=!0},or.prototype.disable=function(){this._enabled=!1,this.reset()},or.prototype.isEnabled=function(){return this._enabled},or.prototype.isActive=function(){return this._active},or.prototype.disableRotation=function(){this._rotationDisabled=!0},or.prototype.enableRotation=function(){this._rotationDisabled=!1};var he=function(n,o){this._map=n,this._el=n.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,h.bindAll(["_onTimeout"],this)};he.prototype.setZoomRate=function(n){this._defaultZoomRate=n},he.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},he.prototype.isEnabled=function(){return!!this._enabled},he.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},he.prototype.isZooming=function(){return!!this._zooming},he.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},he.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},he.prototype.wheel=function(n){if(this.isEnabled()){var o=n.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,i=h.browser.now(),u=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,o!==0&&o%4.000244140625==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),n.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=n,this._delta-=o,this._active||this._start(n)),n.preventDefault()}},he.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},he.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var o=Bt.mousePos(this._el,n);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(o)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},he.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var o=this._map.transform;if(this._delta!==0){var i=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&u!==0&&(u=1/u);var f=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(f*u))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var m,y=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,_=this._startZoom,T=this._easing,C=!1;if(this._type==="wheel"&&_&&T){var B=Math.min((h.browser.now()-this._lastWheelEventTime)/200,1),U=T(B);m=h.number(_,y,U),B<1?this._frameId||(this._frameId=!0):C=!0}else m=y,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:m-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},he.prototype._smoothOutEasing=function(n){var o=h.ease;if(this._prevEase){var i=this._prevEase,u=(h.browser.now()-i.start)/i.duration,f=i.easing(u+.01)-i.easing(u),m=.27/Math.sqrt(f*f+1e-4)*.01,y=Math.sqrt(.0729-m*m);o=h.bezier(m,y,.25,1)}return this._prevEase={start:h.browser.now(),duration:n,easing:o},o},he.prototype.reset=function(){this._active=!1};var Ee=function(n,o){this._clickZoom=n,this._tapZoom=o};Ee.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ee.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ee.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ee.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Wn=function(){this.reset()};Wn.prototype.reset=function(){this._active=!1},Wn.prototype.dblclick=function(n,o){return n.preventDefault(),{cameraAnimation:function(i){i.easeTo({duration:300,zoom:i.getZoom()+(n.shiftKey?-1:1),around:i.unproject(o)},{originalEvent:n})}}},Wn.prototype.enable=function(){this._enabled=!0},Wn.prototype.disable=function(){this._enabled=!1,this.reset()},Wn.prototype.isEnabled=function(){return this._enabled},Wn.prototype.isActive=function(){return this._active};var Nn=function(){this._tap=new oe({numTouches:1,numTaps:1}),this.reset()};Nn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Nn.prototype.touchstart=function(n,o,i){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=o[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(n,o,i))},Nn.prototype.touchmove=function(n,o,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var u=o[0],f=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(n,o,i)},Nn.prototype.touchend=function(n,o,i){this._tapTime?this._swipePoint&&i.length===0&&this.reset():this._tap.touchend(n,o,i)&&(this._tapTime=n.timeStamp)},Nn.prototype.touchcancel=function(){this.reset()},Nn.prototype.enable=function(){this._enabled=!0},Nn.prototype.disable=function(){this._enabled=!1,this.reset()},Nn.prototype.isEnabled=function(){return this._enabled},Nn.prototype.isActive=function(){return this._active};var ni=function(n,o,i){this._el=n,this._mousePan=o,this._touchPan=i};ni.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},ni.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},ni.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ni.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ro=function(n,o,i){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=o,this._mousePitch=i};Ro.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ro.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ro.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ro.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Vn=function(n,o,i,u){this._el=n,this._touchZoom=o,this._touchRotate=i,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};Vn.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Vn.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Vn.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Vn.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Vn.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Vn.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ii=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Xn=function(n){function o(){n.apply(this,arguments)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o}(h.Event);function Ci(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var Kt=function(n,o){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new D(n),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o),h.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[h.window,"blur",void 0]];for(var u=0,f=this._listeners;u<f.length;u+=1){var m=f[u],y=m[0];Bt.addEventListener(y,m[1],y===h.window.document?this.handleWindowEvent:this.handleEvent,m[2])}};Kt.prototype.destroy=function(){for(var n=0,o=this._listeners;n<o.length;n+=1){var i=o[n],u=i[0];Bt.removeEventListener(u,i[1],u===h.window.document?this.handleWindowEvent:this.handleEvent,i[2])}},Kt.prototype._addDefaultHandlers=function(n){var o=this._map,i=o.getCanvasContainer();this._add("mapEvent",new gt(o,n));var u=o.boxZoom=new mt(o,n);this._add("boxZoom",u);var f=new ge,m=new Wn;o.doubleClickZoom=new Ee(m,f),this._add("tapZoom",f),this._add("clickZoom",m);var y=new Nn;this._add("tapDragZoom",y);var _=o.touchPitch=new Xr;this._add("touchPitch",_);var T=new Tr(n),C=new Qr(n);o.dragRotate=new Ro(n,T,C),this._add("mouseRotate",T,["mousePitch"]),this._add("mousePitch",C,["mouseRotate"]);var B=new Dt(n),U=new yr(n);o.dragPan=new ni(i,B,U),this._add("mousePan",B),this._add("touchPan",U,["touchZoom","touchRotate"]);var O=new Oe,K=new De;o.touchZoomRotate=new Vn(i,K,O,y),this._add("touchRotate",O,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]);var W=o.scrollZoom=new he(o,this);this._add("scrollZoom",W,["mousePan"]);var Q=o.keyboard=new or;this._add("keyboard",Q),this._add("blockableMapEvent",new Mt(o));for(var G=0,$=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];G<$.length;G+=1){var at=$[G];n.interactive&&n[at]&&o[at].enable(n[at])}},Kt.prototype._add=function(n,o,i){this._handlers.push({handlerName:n,handler:o,allowed:i}),this._handlersById[n]=o},Kt.prototype.stop=function(n){if(!this._updatingCamera){for(var o=0,i=this._handlers;o<i.length;o+=1)i[o].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},Kt.prototype.isActive=function(){for(var n=0,o=this._handlers;n<o.length;n+=1)if(o[n].handler.isActive())return!0;return!1},Kt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Kt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Kt.prototype.isMoving=function(){return Boolean(ii(this._eventsInProgress))||this.isZooming()},Kt.prototype._blockedByActive=function(n,o,i){for(var u in n)if(u!==i&&(!o||o.indexOf(u)<0))return!0;return!1},Kt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},Kt.prototype._getMapTouches=function(n){for(var o=[],i=0,u=n;i<u.length;i+=1){var f=u[i];this._el.contains(f.target)&&o.push(f)}return o},Kt.prototype.handleEvent=function(n,o){if(n.type!=="blur"){this._updatingCamera=!0;for(var i=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},f={},m={},y=n.touches?this._getMapTouches(n.touches):void 0,_=y?Bt.touchPos(this._el,y):Bt.mousePos(this._el,n),T=0,C=this._handlers;T<C.length;T+=1){var B=C[T],U=B.handlerName,O=B.handler,K=B.allowed;if(O.isEnabled()){var W=void 0;this._blockedByActive(m,K,U)?O.reset():O[o||n.type]&&(W=O[o||n.type](n,_,y),this.mergeHandlerResult(u,f,W,U,i),W&&W.needsRenderFrame&&this._triggerRenderFrame()),(W||O.isActive())&&(m[U]=O)}}var Q={};for(var G in this._previousActiveHandlers)m[G]||(Q[G]=i);this._previousActiveHandlers=m,(Object.keys(Q).length||Ci(u))&&(this._changes.push([u,f,Q]),this._triggerRenderFrame()),(Object.keys(m).length||Ci(u))&&this._map._stop(!0),this._updatingCamera=!1;var $=u.cameraAnimation;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))}else this.stop(!0)},Kt.prototype.mergeHandlerResult=function(n,o,i,u,f){if(i){h.extend(n,i);var m={handlerName:u,originalEvent:i.originalEvent||f};i.zoomDelta!==void 0&&(o.zoom=m),i.panDelta!==void 0&&(o.drag=m),i.pitchDelta!==void 0&&(o.pitch=m),i.bearingDelta!==void 0&&(o.rotate=m)}},Kt.prototype._applyChanges=function(){for(var n={},o={},i={},u=0,f=this._changes;u<f.length;u+=1){var m=f[u],y=m[0],_=m[1],T=m[2];y.panDelta&&(n.panDelta=(n.panDelta||new h.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(n.around=y.around),y.pinchAround!==void 0&&(n.pinchAround=y.pinchAround),y.noInertia&&(n.noInertia=y.noInertia),h.extend(o,_),h.extend(i,T)}this._updateMapTransform(n,o,i),this._changes=[]},Kt.prototype._updateMapTransform=function(n,o,i){var u=this._map,f=u.transform;if(!Ci(n))return this._fireEvents(o,i,!0);var m=n.panDelta,y=n.zoomDelta,_=n.bearingDelta,T=n.pitchDelta,C=n.around,B=n.pinchAround;B!==void 0&&(C=B),u._stop(!0),C=C||u.transform.centerPoint;var U=f.pointLocation(m?C.sub(m):C);_&&(f.bearing+=_),T&&(f.pitch+=T),y&&(f.zoom+=y),f.setLocationAtPoint(U,C),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(o,i,!0)},Kt.prototype._fireEvents=function(n,o,i){var u=this,f=ii(this._eventsInProgress),m=ii(n),y={};for(var _ in n)this._eventsInProgress[_]||(y[_+"start"]=n[_].originalEvent),this._eventsInProgress[_]=n[_];for(var T in!f&&m&&this._fireEvent("movestart",m.originalEvent),y)this._fireEvent(T,y[T]);for(var C in m&&this._fireEvent("move",m.originalEvent),n)this._fireEvent(C,n[C].originalEvent);var B,U={};for(var O in this._eventsInProgress){var K=this._eventsInProgress[O],W=K.handlerName,Q=K.originalEvent;this._handlersById[W].isActive()||(delete this._eventsInProgress[O],U[O+"end"]=B=o[W]||Q)}for(var G in U)this._fireEvent(G,U[G]);var $=ii(this._eventsInProgress);if(i&&(f||m)&&!$){this._updatingCamera=!0;var at=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ht=function(St){return St!==0&&-u._bearingSnap<St&&St<u._bearingSnap};at?(ht(at.bearing||this._map.getBearing())&&(at.bearing=0),this._map.easeTo(at,{originalEvent:B})):(this._map.fire(new h.Event("moveend",{originalEvent:B})),ht(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Kt.prototype._fireEvent=function(n,o){this._map.fire(new h.Event(n,o?{originalEvent:o}:{}))},Kt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(o){delete n._frameId,n.handleEvent(new Xn("renderFrame",{timeStamp:o})),n._applyChanges()})},Kt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var ye=function(n){function o(i,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=u.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.getCenter=function(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)},o.prototype.setCenter=function(i,u){return this.jumpTo({center:i},u)},o.prototype.panBy=function(i,u,f){return i=h.Point.convert(i).mult(-1),this.panTo(this.transform.center,h.extend({offset:i},u),f)},o.prototype.panTo=function(i,u,f){return this.easeTo(h.extend({center:i},u),f)},o.prototype.getZoom=function(){return this.transform.zoom},o.prototype.setZoom=function(i,u){return this.jumpTo({zoom:i},u),this},o.prototype.zoomTo=function(i,u,f){return this.easeTo(h.extend({zoom:i},u),f)},o.prototype.zoomIn=function(i,u){return this.zoomTo(this.getZoom()+1,i,u),this},o.prototype.zoomOut=function(i,u){return this.zoomTo(this.getZoom()-1,i,u),this},o.prototype.getBearing=function(){return this.transform.bearing},o.prototype.setBearing=function(i,u){return this.jumpTo({bearing:i},u),this},o.prototype.getPadding=function(){return this.transform.padding},o.prototype.setPadding=function(i,u){return this.jumpTo({padding:i},u),this},o.prototype.rotateTo=function(i,u,f){return this.easeTo(h.extend({bearing:i},u),f)},o.prototype.resetNorth=function(i,u){return this.rotateTo(0,h.extend({duration:1e3},i),u),this},o.prototype.resetNorthPitch=function(i,u){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},i),u),this},o.prototype.snapToNorth=function(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this},o.prototype.getPitch=function(){return this.transform.pitch},o.prototype.setPitch=function(i,u){return this.jumpTo({pitch:i},u),this},o.prototype.cameraForBounds=function(i,u){i=h.LngLatBounds.convert(i);var f=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),f,u)},o.prototype._cameraForBoxAndBearing=function(i,u,f,m){var y={top:0,bottom:0,right:0,left:0};if(typeof(m=h.extend({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){var _=m.padding;m.padding={top:_,bottom:_,right:_,left:_}}m.padding=h.extend(y,m.padding);var T=this.transform,C=T.padding,B=T.project(h.LngLat.convert(i)),U=T.project(h.LngLat.convert(u)),O=B.rotate(-f*Math.PI/180),K=U.rotate(-f*Math.PI/180),W=new h.Point(Math.max(O.x,K.x),Math.max(O.y,K.y)),Q=new h.Point(Math.min(O.x,K.x),Math.min(O.y,K.y)),G=W.sub(Q),$=(T.width-(C.left+C.right+m.padding.left+m.padding.right))/G.x,at=(T.height-(C.top+C.bottom+m.padding.top+m.padding.bottom))/G.y;if(!(at<0||$<0)){var ht=Math.min(T.scaleZoom(T.scale*Math.min($,at)),m.maxZoom),St=typeof m.offset.x=="number"?new h.Point(m.offset.x,m.offset.y):h.Point.convert(m.offset),bt=new h.Point((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(f*Math.PI/180),Tt=St.add(bt).mult(T.scale/T.zoomScale(ht));return{center:T.unproject(B.add(U).div(2).sub(Tt)),zoom:ht,bearing:f}}h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},o.prototype.fitBounds=function(i,u,f){return this._fitInternal(this.cameraForBounds(i,u),u,f)},o.prototype.fitScreenCoordinates=function(i,u,f,m,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(i)),this.transform.pointLocation(h.Point.convert(u)),f,m),m,y)},o.prototype._fitInternal=function(i,u,f){return i?(delete(u=h.extend(i,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this},o.prototype.jumpTo=function(i,u){this.stop();var f=this.transform,m=!1,y=!1,_=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(m=!0,f.zoom=+i.zoom),i.center!==void 0&&(f.center=h.LngLat.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(y=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(_=!0,f.pitch=+i.pitch),i.padding==null||f.isPaddingEqual(i.padding)||(f.padding=i.padding),this.fire(new h.Event("movestart",u)).fire(new h.Event("move",u)),m&&this.fire(new h.Event("zoomstart",u)).fire(new h.Event("zoom",u)).fire(new h.Event("zoomend",u)),y&&this.fire(new h.Event("rotatestart",u)).fire(new h.Event("rotate",u)).fire(new h.Event("rotateend",u)),_&&this.fire(new h.Event("pitchstart",u)).fire(new h.Event("pitch",u)).fire(new h.Event("pitchend",u)),this.fire(new h.Event("moveend",u))},o.prototype.easeTo=function(i,u){var f=this;this._stop(!1,i.easeId),((i=h.extend({offset:[0,0],duration:500,easing:h.ease},i)).animate===!1||!i.essential&&h.browser.prefersReducedMotion)&&(i.duration=0);var m=this.transform,y=this.getZoom(),_=this.getBearing(),T=this.getPitch(),C=this.getPadding(),B="zoom"in i?+i.zoom:y,U="bearing"in i?this._normalizeBearing(i.bearing,_):_,O="pitch"in i?+i.pitch:T,K="padding"in i?i.padding:m.padding,W=h.Point.convert(i.offset),Q=m.centerPoint.add(W),G=m.pointLocation(Q),$=h.LngLat.convert(i.center||G);this._normalizeCenter($);var at,ht,St=m.project(G),bt=m.project($).sub(St),Tt=m.zoomScale(B-y);i.around&&(at=h.LngLat.convert(i.around),ht=m.locationPoint(at));var Ct={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||B!==y,this._rotating=this._rotating||_!==U,this._pitching=this._pitching||O!==T,this._padding=!m.isPaddingEqual(K),this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,Ct),this._ease(function(Vt){if(f._zooming&&(m.zoom=h.number(y,B,Vt)),f._rotating&&(m.bearing=h.number(_,U,Vt)),f._pitching&&(m.pitch=h.number(T,O,Vt)),f._padding&&(m.interpolatePadding(C,K,Vt),Q=m.centerPoint.add(W)),at)m.setLocationAtPoint(at,ht);else{var Ut=m.zoomScale(m.zoom-y),Jt=B>y?Math.min(2,Tt):Math.max(.5,Tt),ae=Math.pow(Jt,1-Vt),ve=m.unproject(St.add(bt.mult(Vt*ae)).mult(Ut));m.setLocationAtPoint(m.renderWorldCopies?ve.wrap():ve,Q)}f._fireMoveEvents(u)},function(Vt){f._afterEase(u,Vt)},i),this},o.prototype._prepareEase=function(i,u,f){f===void 0&&(f={}),this._moving=!0,u||f.moving||this.fire(new h.Event("movestart",i)),this._zooming&&!f.zooming&&this.fire(new h.Event("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new h.Event("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new h.Event("pitchstart",i))},o.prototype._fireMoveEvents=function(i){this.fire(new h.Event("move",i)),this._zooming&&this.fire(new h.Event("zoom",i)),this._rotating&&this.fire(new h.Event("rotate",i)),this._pitching&&this.fire(new h.Event("pitch",i))},o.prototype._afterEase=function(i,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var f=this._zooming,m=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new h.Event("zoomend",i)),m&&this.fire(new h.Event("rotateend",i)),y&&this.fire(new h.Event("pitchend",i)),this.fire(new h.Event("moveend",i))}},o.prototype.flyTo=function(i,u){var f=this;if(!i.essential&&h.browser.prefersReducedMotion){var m=h.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(m,u)}this.stop(),i=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},i);var y=this.transform,_=this.getZoom(),T=this.getBearing(),C=this.getPitch(),B=this.getPadding(),U="zoom"in i?h.clamp(+i.zoom,y.minZoom,y.maxZoom):_,O="bearing"in i?this._normalizeBearing(i.bearing,T):T,K="pitch"in i?+i.pitch:C,W="padding"in i?i.padding:y.padding,Q=y.zoomScale(U-_),G=h.Point.convert(i.offset),$=y.centerPoint.add(G),at=y.pointLocation($),ht=h.LngLat.convert(i.center||at);this._normalizeCenter(ht);var St=y.project(at),bt=y.project(ht).sub(St),Tt=i.curve,Ct=Math.max(y.width,y.height),Vt=Ct/Q,Ut=bt.mag();if("minZoom"in i){var Jt=h.clamp(Math.min(i.minZoom,_,U),y.minZoom,y.maxZoom),ae=Ct/y.zoomScale(Jt-_);Tt=Math.sqrt(ae/Ut*2)}var ve=Tt*Tt;function de(Ae){var ie=(Vt*Vt-Ct*Ct+(Ae?-1:1)*ve*ve*Ut*Ut)/(2*(Ae?Vt:Ct)*ve*Ut);return Math.log(Math.sqrt(ie*ie+1)-ie)}function ar(Ae){return(Math.exp(Ae)-Math.exp(-Ae))/2}function te(Ae){return(Math.exp(Ae)+Math.exp(-Ae))/2}var Se=de(0),Ze=function(Ae){return te(Se)/te(Se+Tt*Ae)},Re=function(Ae){return Ct*((te(Se)*(ar(ie=Se+Tt*Ae)/te(ie))-ar(Se))/ve)/Ut;var ie},Pe=(de(1)-Se)/Tt;if(Math.abs(Ut)<1e-6||!isFinite(Pe)){if(Math.abs(Ct-Vt)<1e-6)return this.easeTo(i,u);var ke=Vt<Ct?-1:1;Pe=Math.abs(Math.log(Vt/Ct))/Tt,Re=function(){return 0},Ze=function(Ae){return Math.exp(ke*Tt*Ae)}}return i.duration="duration"in i?+i.duration:1e3*Pe/("screenSpeed"in i?+i.screenSpeed/Tt:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=T!==O,this._pitching=K!==C,this._padding=!y.isPaddingEqual(W),this._prepareEase(u,!1),this._ease(function(Ae){var ie=Ae*Pe,Er=1/Ze(ie);y.zoom=Ae===1?U:_+y.scaleZoom(Er),f._rotating&&(y.bearing=h.number(T,O,Ae)),f._pitching&&(y.pitch=h.number(C,K,Ae)),f._padding&&(y.interpolatePadding(B,W,Ae),$=y.centerPoint.add(G));var sn=Ae===1?ht:y.unproject(St.add(bt.mult(Re(ie))).mult(Er));y.setLocationAtPoint(y.renderWorldCopies?sn.wrap():sn,$),f._fireMoveEvents(u)},function(){return f._afterEase(u)},i),this},o.prototype.isEasing=function(){return!!this._easeFrameId},o.prototype.stop=function(){return this._stop()},o.prototype._stop=function(i,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,u)}if(!i){var m=this.handlers;m&&m.stop(!1)}return this},o.prototype._ease=function(i,u,f){f.animate===!1||f.duration===0?(i(1),u()):(this._easeStart=h.browser.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},o.prototype._renderFrameCallback=function(){var i=Math.min((h.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},o.prototype._normalizeBearing=function(i,u){i=h.wrap(i,-180,180);var f=Math.abs(i-u);return Math.abs(i-360-u)<f&&(i-=360),Math.abs(i+360-u)<f&&(i+=360),i},o.prototype._normalizeCenter=function(i){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var f=i.lng-u.center.lng;i.lng+=f>180?-360:f<-180?360:0}},o}(h.Evented),vi=function(n){n===void 0&&(n={}),this.options=n,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};vi.prototype.getDefaultPosition=function(){return"bottom-right"},vi.prototype.onAdd=function(n){var o=this.options&&this.options.compact;return this._map=n,this._container=Bt.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Bt.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Bt.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),o&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},vi.prototype.onRemove=function(){Bt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},vi.prototype._setElementTitle=function(n,o){var i=this._map._getUIString("AttributionControl."+o);n.title=i,n.setAttribute("aria-label",i)},vi.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},vi.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(n){var i=o.reduce(function(u,f,m){return f.value&&(u+=f.key+"="+f.value+(m<o.length-1?"&":"")),u},"?");n.href=h.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},vi.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},vi.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(_){return typeof _!="string"?"":_})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var o=this._map.style.stylesheet;this.styleOwner=o.owner,this.styleId=o.id}var i=this._map.style.sourceCaches;for(var u in i){var f=i[u];if(f.used){var m=f.getSource();m.attribution&&n.indexOf(m.attribution)<0&&n.push(m.attribution)}}n.sort(function(_,T){return _.length-T.length});var y=(n=n.filter(function(_,T){for(var C=T+1;C<n.length;C++)if(n[C].indexOf(_)>=0)return!1;return!0})).join(" | ");y!==this._attribHTML&&(this._attribHTML=y,n.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},vi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var _i=function(){h.bindAll(["_updateLogo"],this),h.bindAll(["_updateCompact"],this)};_i.prototype.onAdd=function(n){this._map=n,this._container=Bt.create("div","maplibregl-ctrl mapboxgl-ctrl");var o=Bt.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},_i.prototype.onRemove=function(){Bt.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},_i.prototype.getDefaultPosition=function(){return"bottom-left"},_i.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},_i.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var o in n)if(n[o].getSource().mapbox_logo)return!0;return!1}},_i.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var o=n[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("maplibregl-compact","mapboxgl-compact"):o.classList.remove("maplibregl-compact","mapboxgl-compact")}};var Va=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Va.prototype.add=function(n){var o=++this._id;return this._queue.push({callback:n,id:o,cancelled:!1}),o},Va.prototype.remove=function(n){for(var o=this._currentlyRunning,i=0,u=o?this._queue.concat(o):this._queue;i<u.length;i+=1){var f=u[i];if(f.id===n)return void(f.cancelled=!0)}},Va.prototype.run=function(n){n===void 0&&(n=0);var o=this._currentlyRunning=this._queue;this._queue=[];for(var i=0,u=o;i<u.length;i+=1){var f=u[i];if(!f.cancelled&&(f.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Va.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var $i={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Bo=h.window.HTMLImageElement,hh=h.window.HTMLElement,qa=h.window.ImageBitmap,zr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},yn=function(n){function o(u){var f=this;if((u=h.extend({},zr,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var m=new xe(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,m,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new Va,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},$i,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new h.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=h.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof hh))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return f._update(!1)}),this.on("moveend",function(){return f._update(!1)}),this.on("zoom",function(){return f._update(!0)}),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Kt(this,u),this._hash=u.hash&&new ma(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,h.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new vi({customAttribution:u.customAttribution})),this.addControl(new _i,u.logoPosition),this.on("style.load",function(){f.transform.unmodified&&f.jumpTo(f.style.stylesheet)}),this.on("data",function(y){f._update(y.dataType==="style"),f.fire(new h.Event(y.dataType+"data",y))}),this.on("dataloading",function(y){f.fire(new h.Event(y.dataType+"dataloading",y))})}n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o;var i={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(u,f){if(f===void 0&&(f=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var m=u.onAdd(this);this._controls.push(u);var y=this._controlPositions[f];return f.indexOf("bottom")!==-1?y.insertBefore(m,y.firstChild):y.appendChild(m),this},o.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var f=this._controls.indexOf(u);return f>-1&&this._controls.splice(f,1),u.onRemove(this),this},o.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},o.prototype.resize=function(u){var f=this._containerDimensions(),m=f[0],y=f[1];this._resizeCanvas(m,y),this.transform.resize(m,y),this.painter.resize(m,y);var _=!this._moving;return _&&(this.stop(),this.fire(new h.Event("movestart",u)).fire(new h.Event("move",u))),this.fire(new h.Event("resize",u)),_&&this.fire(new h.Event("moveend",u)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(h.LngLatBounds.convert(u)),this._update()},o.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},o.prototype.project=function(u){return this.transform.locationPoint(h.LngLat.convert(u))},o.prototype.unproject=function(u){return this.transform.pointLocation(h.Point.convert(u))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(u,f,m){var y,_=this;if(u==="mouseenter"||u==="mouseover"){var T=!1;return{layer:f,listener:m,delegates:{mousemove:function(B){var U=_.getLayer(f)?_.queryRenderedFeatures(B.point,{layers:[f]}):[];U.length?T||(T=!0,m.call(_,new ut(u,_,B.originalEvent,{features:U}))):T=!1},mouseout:function(){T=!1}}}}if(u==="mouseleave"||u==="mouseout"){var C=!1;return{layer:f,listener:m,delegates:{mousemove:function(B){(_.getLayer(f)?_.queryRenderedFeatures(B.point,{layers:[f]}):[]).length?C=!0:C&&(C=!1,m.call(_,new ut(u,_,B.originalEvent)))},mouseout:function(B){C&&(C=!1,m.call(_,new ut(u,_,B.originalEvent)))}}}}return{layer:f,listener:m,delegates:(y={},y[u]=function(B){var U=_.getLayer(f)?_.queryRenderedFeatures(B.point,{layers:[f]}):[];U.length&&(B.features=U,m.call(_,B),delete B.features)},y)}},o.prototype.on=function(u,f,m){if(m===void 0)return n.prototype.on.call(this,u,f);var y=this._createDelegatedListener(u,f,m);for(var _ in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(y),y.delegates)this.on(_,y.delegates[_]);return this},o.prototype.once=function(u,f,m){if(m===void 0)return n.prototype.once.call(this,u,f);var y=this._createDelegatedListener(u,f,m);for(var _ in y.delegates)this.once(_,y.delegates[_]);return this},o.prototype.off=function(u,f,m){var y=this;return m===void 0?n.prototype.off.call(this,u,f):(this._delegatedListeners&&this._delegatedListeners[u]&&function(_){for(var T=_[u],C=0;C<T.length;C++){var B=T[C];if(B.layer===f&&B.listener===m){for(var U in B.delegates)y.off(U,B.delegates[U]);return T.splice(C,1),y}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(u,f){if(!this.style)return[];var m;if(f!==void 0||u===void 0||u instanceof h.Point||Array.isArray(u)||(f=u,u=void 0),f=f||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof h.Point||typeof u[0]=="number")m=[h.Point.convert(u)];else{var y=h.Point.convert(u[0]),_=h.Point.convert(u[1]);m=[y,new h.Point(_.x,y.y),_,new h.Point(y.x,_.y),y]}return this.style.queryRenderedFeatures(m,f,this.transform)},o.prototype.querySourceFeatures=function(u,f){return this.style.querySourceFeatures(u,f)},o.prototype.setStyle=function(u,f){return(f=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},f)).diff!==!1&&f.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,f),this):(this._localIdeographFontFamily=f.localIdeographFontFamily,this._updateStyle(u,f))},o.prototype.setTransformRequest=function(u){return this._requestManager.setTransformRequest(u),this},o.prototype._getUIString=function(u){var f=this._locale[u];if(f==null)throw new Error("Missing UI string '"+u+"'");return f},o.prototype._updateStyle=function(u,f){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new mr(this,f||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(u,f){var m=this;if(typeof u=="string"){var y=this._requestManager.normalizeStyleURL(u),_=this._requestManager.transformRequest(y,h.ResourceType.Style);h.getJSON(_,function(T,C){T?m.fire(new h.ErrorEvent(T)):C&&m._updateDiff(C,f)})}else typeof u=="object"&&this._updateDiff(u,f)},o.prototype._updateDiff=function(u,f){try{this.style.setState(u)&&this._update(!0)}catch(m){h.warnOnce("Unable to perform style diff: "+(m.message||m.error||m)+".  Rebuilding the style from scratch."),this._updateStyle(u,f)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(u,f){return this._lazyInitEmptyStyle(),this.style.addSource(u,f),this._update(!0)},o.prototype.isSourceLoaded=function(u){var f=this.style&&this.style.sourceCaches[u];if(f!==void 0)return f.loaded();this.fire(new h.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},o.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var f in u){var m=u[f]._tiles;for(var y in m){var _=m[y];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0},o.prototype.addSourceType=function(u,f,m){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,f,m)},o.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},o.prototype.getSource=function(u){return this.style.getSource(u)},o.prototype.addImage=function(u,f,m){m===void 0&&(m={});var y=m.pixelRatio;y===void 0&&(y=1);var _=m.sdf;_===void 0&&(_=!1);var T=m.stretchX,C=m.stretchY,B=m.content;if(this._lazyInitEmptyStyle(),f instanceof Bo||qa&&f instanceof qa){var U=h.browser.getImageData(f);this.style.addImage(u,{data:new h.RGBAImage({width:U.width,height:U.height},U.data),pixelRatio:y,stretchX:T,stretchY:C,content:B,sdf:_,version:0})}else{if(f.width===void 0||f.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var O=f;this.style.addImage(u,{data:new h.RGBAImage({width:f.width,height:f.height},new Uint8Array(f.data)),pixelRatio:y,stretchX:T,stretchY:C,content:B,sdf:_,version:0,userImage:O}),O.onAdd&&O.onAdd(this,u)}},o.prototype.updateImage=function(u,f){var m=this.style.getImage(u);if(!m)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var y=f instanceof Bo||qa&&f instanceof qa?h.browser.getImageData(f):f,_=y.width,T=y.height,C=y.data;return _===void 0||T===void 0?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):_!==m.data.width||T!==m.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(m.data.replace(C,!(f instanceof Bo||qa&&f instanceof qa)),void this.style.updateImage(u,m))},o.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(u){this.style.removeImage(u)},o.prototype.loadImage=function(u,f){h.getImage(this._requestManager.transformRequest(u,h.ResourceType.Image),f)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(u,f){return this._lazyInitEmptyStyle(),this.style.addLayer(u,f),this._update(!0)},o.prototype.moveLayer=function(u,f){return this.style.moveLayer(u,f),this._update(!0)},o.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},o.prototype.getLayer=function(u){return this.style.getLayer(u)},o.prototype.setLayerZoomRange=function(u,f,m){return this.style.setLayerZoomRange(u,f,m),this._update(!0)},o.prototype.setFilter=function(u,f,m){return m===void 0&&(m={}),this.style.setFilter(u,f,m),this._update(!0)},o.prototype.getFilter=function(u){return this.style.getFilter(u)},o.prototype.setPaintProperty=function(u,f,m,y){return y===void 0&&(y={}),this.style.setPaintProperty(u,f,m,y),this._update(!0)},o.prototype.getPaintProperty=function(u,f){return this.style.getPaintProperty(u,f)},o.prototype.setLayoutProperty=function(u,f,m,y){return y===void 0&&(y={}),this.style.setLayoutProperty(u,f,m,y),this._update(!0)},o.prototype.getLayoutProperty=function(u,f){return this.style.getLayoutProperty(u,f)},o.prototype.setLight=function(u,f){return f===void 0&&(f={}),this._lazyInitEmptyStyle(),this.style.setLight(u,f),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(u,f){return this.style.setFeatureState(u,f),this._update()},o.prototype.removeFeatureState=function(u,f){return this.style.removeFeatureState(u,f),this._update()},o.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var u=0,f=0;return this._container&&(u=this._container.clientWidth||400,f=this._container.clientHeight||300),[u,f]},o.prototype._setupContainer=function(){var u=this._container;u.classList.add("maplibregl-map","mapboxgl-map");var f=this._canvasContainer=Bt.create("div","maplibregl-canvas-container mapboxgl-canvas-container",u);this._interactive&&f.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=Bt.create("canvas","maplibregl-canvas mapboxgl-canvas",f),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var m=this._containerDimensions();this._resizeCanvas(m[0],m[1]);var y=this._controlContainer=Bt.create("div","maplibregl-control-container mapboxgl-control-container",u),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(T){_[T]=Bt.create("div","maplibregl-ctrl-"+T+" mapboxgl-ctrl-"+T,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},o.prototype._resizeCanvas=function(u,f){var m=h.browser.devicePixelRatio||1;this._canvas.width=m*u,this._canvas.height=m*f,this._canvas.style.width=u+"px",this._canvas.style.height=f+"px"},o.prototype._setupPainter=function(){var u=h.extend({},Ei.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),f=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);f?(this.painter=new jt(f,this.transform),h.webpSupported.testSupport(f)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:u}))},o.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:u}))},o.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},o.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},o.prototype._render=function(u){var f,m=this,y=0,_=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(f=_.createQueryEXT(),_.beginQueryEXT(_.TIME_ELAPSED_EXT,f),y=h.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var T=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var C=this.transform.zoom,B=h.browser.now();this.style.zoomHistory.update(C,B);var U=new h.EvaluationParameters(C,{now:B,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=U.crossFadingFactor();O===1&&O===this._crossFadingFactor||(T=!0,this._crossFadingFactor=O),this.style.update(U)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var K=h.browser.now()-y;_.endQueryEXT(_.TIME_ELAPSED_EXT,f),setTimeout(function(){var G=_.getQueryObjectEXT(f,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(f),m.fire(new h.Event("gpu-timing-frame",{cpuTime:K,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){var W=this.painter.collectGpuTimers();setTimeout(function(){var G=m.painter.queryGpuTimers(W);m.fire(new h.Event("gpu-timing-layer",{layerTimes:G}))},50)}var Q=this._sourcesDirty||this._styleDirty||this._placementDirty;return Q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||Q||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,f=this._controls;u<f.length;u+=1)f[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1));var m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),wl(this._canvasContainer),wl(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new h.Event("remove"))},o.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=h.browser.frame(function(f){u._frame=null,u._render(f)}))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},i.showPadding.get=function(){return!!this._showPadding},i.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(u){this._vertices=u,this._update()},o.prototype._setCacheLimits=function(u,f){h.setCacheLimits(u,f)},i.version.get=function(){return h.version},Object.defineProperties(o.prototype,i),o}(ye);function wl(n){n.parentNode&&n.parentNode.removeChild(n)}var F={showCompass:!0,showZoom:!0,visualizePitch:!1},Qi=function(n){var o=this;this.options=h.extend({},F,n),this._container=Bt.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(i){return i.preventDefault()}),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(i){return o._map.zoomIn({},{originalEvent:i})}),Bt.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(i){return o._map.zoomOut({},{originalEvent:i})}),Bt.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(i){o.options.visualizePitch?o._map.resetNorthPitch({},{originalEvent:i}):o._map.resetNorth({},{originalEvent:i})}),this._compassIcon=Bt.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Qi.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),o=n===this._map.getMaxZoom(),i=n===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},Qi.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Qi.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xi(this._map,this._compass,this.options.visualizePitch)),this._container},Qi.prototype.onRemove=function(){Bt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Qi.prototype._createButton=function(n,o){var i=Bt.create("button",n,this._container);return i.type="button",i.addEventListener("click",o),i},Qi.prototype._setButtonTitle=function(n,o){var i=this._map._getUIString("NavigationControl."+o);n.title=i,n.setAttribute("aria-label",i)};var xi=function(n,o,i){i===void 0&&(i=!1),this._clickTolerance=10,this.element=o,this.mouseRotate=new Tr({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,i&&(this.mousePitch=new Qr({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Bt.addEventListener(o,"mousedown",this.mousedown),Bt.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),Bt.addEventListener(o,"touchmove",this.touchmove),Bt.addEventListener(o,"touchend",this.touchend),Bt.addEventListener(o,"touchcancel",this.reset)};function Ni(n,o,i){if(n=new h.LngLat(n.lng,n.lat),o){var u=new h.LngLat(n.lng-360,n.lat),f=new h.LngLat(n.lng+360,n.lat),m=i.locationPoint(n).distSqr(o);i.locationPoint(u).distSqr(o)<m?n=u:i.locationPoint(f).distSqr(o)<m&&(n=f)}for(;Math.abs(n.lng-i.center.lng)>180;){var y=i.locationPoint(n);if(y.x>=0&&y.y>=0&&y.x<=i.width&&y.y<=i.height)break;n.lng>i.center.lng?n.lng-=360:n.lng+=360}return n}xi.prototype.down=function(n,o){this.mouseRotate.mousedown(n,o),this.mousePitch&&this.mousePitch.mousedown(n,o),Bt.disableDrag()},xi.prototype.move=function(n,o){var i=this.map,u=this.mouseRotate.mousemoveWindow(n,o);if(u&&u.bearingDelta&&i.setBearing(i.getBearing()+u.bearingDelta),this.mousePitch){var f=this.mousePitch.mousemoveWindow(n,o);f&&f.pitchDelta&&i.setPitch(i.getPitch()+f.pitchDelta)}},xi.prototype.off=function(){var n=this.element;Bt.removeEventListener(n,"mousedown",this.mousedown),Bt.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),Bt.removeEventListener(n,"touchmove",this.touchmove),Bt.removeEventListener(n,"touchend",this.touchend),Bt.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},xi.prototype.offTemp=function(){Bt.enableDrag(),Bt.removeEventListener(h.window,"mousemove",this.mousemove),Bt.removeEventListener(h.window,"mouseup",this.mouseup)},xi.prototype.mousedown=function(n){this.down(h.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),Bt.mousePos(this.element,n)),Bt.addEventListener(h.window,"mousemove",this.mousemove),Bt.addEventListener(h.window,"mouseup",this.mouseup)},xi.prototype.mousemove=function(n){this.move(n,Bt.mousePos(this.element,n))},xi.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},xi.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Bt.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},xi.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=Bt.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},xi.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},xi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var er={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Za(n,o,i){var u=n.classList;for(var f in er)u.remove("maplibregl-"+i+"-anchor-"+f,"mapboxgl-"+i+"-anchor-"+f);u.add("maplibregl-"+i+"-anchor-"+o,"mapboxgl-"+i+"-anchor-"+o)}var du,Nu=function(n){function o(i,u){if(n.call(this),(i instanceof h.window.HTMLElement||u)&&(i=h.extend({element:i},u)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=h.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=Bt.create("div"),this._element.setAttribute("aria-label","Map marker");var f=Bt.createNS("http://www.w3.org/2000/svg","svg");f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height","41px"),f.setAttributeNS(null,"width","27px"),f.setAttributeNS(null,"viewBox","0 0 27 41");var m=Bt.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");var y=Bt.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");var _=Bt.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(3.0, 29.0)"),_.setAttributeNS(null,"fill","#000000");for(var T=0,C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];T<C.length;T+=1){var B=C[T],U=Bt.createNS("http://www.w3.org/2000/svg","ellipse");U.setAttributeNS(null,"opacity","0.04"),U.setAttributeNS(null,"cx","10.5"),U.setAttributeNS(null,"cy","5.80029008"),U.setAttributeNS(null,"rx",B.rx),U.setAttributeNS(null,"ry",B.ry),_.appendChild(U)}var O=Bt.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);var K=Bt.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(K);var W=Bt.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"fill","#000000");var Q=Bt.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),W.appendChild(Q);var G=Bt.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");var $=Bt.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(8.0, 8.0)");var at=Bt.createNS("http://www.w3.org/2000/svg","circle");at.setAttributeNS(null,"fill","#000000"),at.setAttributeNS(null,"opacity","0.25"),at.setAttributeNS(null,"cx","5.5"),at.setAttributeNS(null,"cy","5.5"),at.setAttributeNS(null,"r","5.4999962");var ht=Bt.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#FFFFFF"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962"),$.appendChild(at),$.appendChild(ht),y.appendChild(_),y.appendChild(O),y.appendChild(W),y.appendChild(G),y.appendChild($),f.appendChild(y),f.setAttributeNS(null,"height",41*this._scale+"px"),f.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(f),this._offset=h.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(St){St.preventDefault()}),this._element.addEventListener("mousedown",function(St){St.preventDefault()}),Za(this._element,this._anchor,"marker"),this._popup=null}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.addTo=function(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},o.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Bt.remove(this._element),this._popup&&this._popup.remove(),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(i){return this._lngLat=h.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},o.prototype.getElement=function(){return this._element},o.prototype.setPopup=function(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},o.prototype._onKeyPress=function(i){var u=i.code,f=i.charCode||i.keyCode;u!=="Space"&&u!=="Enter"&&f!==32&&f!==13||this.togglePopup()},o.prototype._onMapClick=function(i){var u=i.originalEvent.target,f=this._element;this._popup&&(u===f||f.contains(u))&&this.togglePopup()},o.prototype.getPopup=function(){return this._popup},o.prototype.togglePopup=function(){var i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this},o.prototype._update=function(i){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ni(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f="rotateX("+this._map.getPitch()+"deg)"),i&&i.type!=="moveend"||(this._pos=this._pos.round()),Bt.setTransform(this._element,er[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+f+" "+u)}},o.prototype.getOffset=function(){return this._offset},o.prototype.setOffset=function(i){return this._offset=h.Point.convert(i),this._update(),this},o.prototype._onMove=function(i){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))},o.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"},o.prototype._addDragHandler=function(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},o.prototype.setDraggable=function(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},o.prototype.isDraggable=function(){return this._draggable},o.prototype.setRotation=function(i){return this._rotation=i||0,this._update(),this},o.prototype.getRotation=function(){return this._rotation},o.prototype.setRotationAlignment=function(i){return this._rotationAlignment=i||"auto",this._update(),this},o.prototype.getRotationAlignment=function(){return this._rotationAlignment},o.prototype.setPitchAlignment=function(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this},o.prototype.getPitchAlignment=function(){return this._pitchAlignment},o}(h.Evented),ja={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Vu=0,ss=!1,tc=function(n){function o(i){n.call(this),this.options=h.extend({},ja,i),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.onAdd=function(i){var u;return this._map=i,this._container=Bt.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,du!==void 0?u(du):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then(function(f){u(du=f.state!=="denied")}):u(du=!!h.window.navigator.geolocation),this._container},o.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Bt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Vu=0,ss=!1},o.prototype._isOutOfMapMaxBounds=function(i){var u=this._map.getMaxBounds(),f=i.coords;return u&&(f.longitude<u.getWest()||f.longitude>u.getEast()||f.latitude<u.getSouth()||f.latitude>u.getNorth())},o.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(i){if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",i)),this._finish()}},o.prototype._updateCamera=function(i){var u=new h.LngLat(i.coords.longitude,i.coords.latitude),f=i.coords.accuracy,m=this._map.getBearing(),y=h.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(f),y,{geolocateSource:!0})},o.prototype._updateMarker=function(i){if(i){var u=new h.LngLat(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var i=this._map._container.clientHeight/2,u=this._map.unproject([0,i]),f=this._map.unproject([1,i]),m=u.distanceTo(f),y=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=y+"px",this._circleElement.style.height=y+"px"},o.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(i){if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&ss)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",i)),this._finish()}},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(i){var u=this;if(this._container.addEventListener("contextmenu",function(y){return y.preventDefault()}),this._geolocateButton=Bt.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),Bt.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",i===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}else{var m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Bt.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Nu(this._dotElement),this._circleElement=Bt.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Nu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(y){y.geolocateSource||u._watchState!=="ACTIVE_LOCK"||y.originalEvent&&y.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),u.fire(new h.Event("trackuserlocationend")))})},o.prototype.trigger=function(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Vu--,ss=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var i;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Vu>1?(i={maximumAge:6e5,timeout:0},ss=!0):(i=this.options.positionOptions,ss=!1),this._geolocationWatchID=h.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,i)}}else h.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},o.prototype._clearWatch=function(){h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(h.Evented),ec={maxWidth:100,unit:"metric"},_o=function(n){this.options=h.extend({},ec,n),h.bindAll(["_onMove","setUnit"],this)};function Oo(n,o,i){var u=i&&i.maxWidth||100,f=n._container.clientHeight/2,m=n.unproject([0,f]),y=n.unproject([u,f]),_=m.distanceTo(y);if(i&&i.unit==="imperial"){var T=3.2808*_;T>5280?Ls(o,u,T/5280,n._getUIString("ScaleControl.Miles")):Ls(o,u,T,n._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?Ls(o,u,_/1852,n._getUIString("ScaleControl.NauticalMiles")):_>=1e3?Ls(o,u,_/1e3,n._getUIString("ScaleControl.Kilometers")):Ls(o,u,_,n._getUIString("ScaleControl.Meters"))}function Ls(n,o,i,u){var f,m,y,_=(f=i,(m=Math.pow(10,(""+Math.floor(f)).length-1))*(y=(y=f/m)>=10?10:y>=5?5:y>=3?3:y>=2?2:y>=1?1:function(T){var C=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*C)/C}(y)));n.style.width=o*(_/i)+"px",n.innerHTML=_+"&nbsp;"+u}_o.prototype.getDefaultPosition=function(){return"bottom-left"},_o.prototype._onMove=function(){Oo(this._map,this._container,this.options)},_o.prototype.onAdd=function(n){return this._map=n,this._container=Bt.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},_o.prototype.onRemove=function(){Bt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},_o.prototype.setUnit=function(n){this.options.unit=n,Oo(this._map,this._container,this.options)};var xo=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof h.window.HTMLElement?this._container=n.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in h.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in h.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in h.window.document&&(this._fullscreenchange="MSFullscreenChange")};xo.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=Bt.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},xo.prototype.onRemove=function(){Bt.remove(this._controlContainer),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},xo.prototype._checkFullscreenSupport=function(){return!!(h.window.document.fullscreenEnabled||h.window.document.mozFullScreenEnabled||h.window.document.msFullscreenEnabled||h.window.document.webkitFullscreenEnabled)},xo.prototype._setupUI=function(){var n=this._fullscreenButton=Bt.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);Bt.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},xo.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},xo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},xo.prototype._isFullscreen=function(){return this._fullscreen},xo.prototype._changeIcon=function(){(h.window.document.fullscreenElement||h.window.document.mozFullScreenElement||h.window.document.webkitFullscreenElement||h.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},xo.prototype._onClickFullscreen=function(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.mozCancelFullScreen?h.window.document.mozCancelFullScreen():h.window.document.msExitFullscreen?h.window.document.msExitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var rc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},nc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),qu=function(n){function o(i){n.call(this),this.options=h.extend(Object.create(rc),i),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(o.__proto__=n),(o.prototype=Object.create(n&&n.prototype)).constructor=o,o.prototype.addTo=function(i){return this._map&&this.remove(),this._map=i,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&Bt.remove(this._content),this._container&&(Bt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(i){return this._lngLat=h.LngLat.convert(i),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},o.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},o.prototype.getElement=function(){return this._container},o.prototype.setText=function(i){return this.setDOMContent(h.window.document.createTextNode(i))},o.prototype.setHTML=function(i){var u,f=h.window.document.createDocumentFragment(),m=h.window.document.createElement("body");for(m.innerHTML=i;u=m.firstChild;)f.appendChild(u);return this.setDOMContent(f)},o.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},o.prototype.setMaxWidth=function(i){return this.options.maxWidth=i,this._update(),this},o.prototype.setDOMContent=function(i){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Bt.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(i),this._createCloseButton(),this._update(),this._focusFirstElement(),this},o.prototype.addClassName=function(i){this._container&&this._container.classList.add(i)},o.prototype.removeClassName=function(i){this._container&&this._container.classList.remove(i)},o.prototype.setOffset=function(i){return this.options.offset=i,this._update(),this},o.prototype.toggleClassName=function(i){if(this._container)return this._container.classList.toggle(i)},o.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=Bt.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},o.prototype._onMouseUp=function(i){this._update(i.point)},o.prototype._onMouseMove=function(i){this._update(i.point)},o.prototype._onDrag=function(i){this._update(i.point)},o.prototype._update=function(i){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=Bt.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=Bt.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(U){return u._container.classList.add(U)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ni(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||i)){var f=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat),m=this.options.anchor,y=function U(O){if(O){if(typeof O=="number"){var K=Math.round(Math.sqrt(.5*Math.pow(O,2)));return{center:new h.Point(0,0),top:new h.Point(0,O),"top-left":new h.Point(K,K),"top-right":new h.Point(-K,K),bottom:new h.Point(0,-O),"bottom-left":new h.Point(K,-K),"bottom-right":new h.Point(-K,-K),left:new h.Point(O,0),right:new h.Point(-O,0)}}if(O instanceof h.Point||Array.isArray(O)){var W=h.Point.convert(O);return{center:W,top:W,"top-left":W,"top-right":W,bottom:W,"bottom-left":W,"bottom-right":W,left:W,right:W}}return{center:h.Point.convert(O.center||[0,0]),top:h.Point.convert(O.top||[0,0]),"top-left":h.Point.convert(O["top-left"]||[0,0]),"top-right":h.Point.convert(O["top-right"]||[0,0]),bottom:h.Point.convert(O.bottom||[0,0]),"bottom-left":h.Point.convert(O["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(O["bottom-right"]||[0,0]),left:h.Point.convert(O.left||[0,0]),right:h.Point.convert(O.right||[0,0])}}return U(new h.Point(0,0))}(this.options.offset);if(!m){var _,T=this._container.offsetWidth,C=this._container.offsetHeight;_=f.y+y.bottom.y<C?["top"]:f.y>this._map.transform.height-C?["bottom"]:[],f.x<T/2?_.push("left"):f.x>this._map.transform.width-T/2&&_.push("right"),m=_.length===0?"bottom":_.join("-")}var B=f.add(y[m]).round();Bt.setTransform(this._container,er[m]+" translate("+B.x+"px,"+B.y+"px)"),Za(this._container,m,"popup")}},o.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var i=this._container.querySelector(nc);i&&i.focus()}},o.prototype._onClose=function(){this.remove()},o}(h.Evented),Fo={version:h.version,supported:Ei,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:yn,NavigationControl:Qi,GeolocateControl:tc,AttributionControl:vi,ScaleControl:_o,FullscreenControl:xo,Popup:qu,Marker:Nu,Style:mr,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,config:h.config,prewarm:function(){ce().acquire(vt)},clearPrewarmedResources:function(){var n=ee;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(vt),ee=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(n){h.config.ACCESS_TOKEN=n},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(n){h.config.API_URL=n},get workerCount(){return Rt.workerCount},set workerCount(n){Rt.workerCount=n},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){h.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){h.clearTileCache(n)},workerUrl:"",addProtocol:function(n,o){h.config.REGISTERED_PROTOCOLS[n]=o},removeProtocol:function(n){delete h.config.REGISTERED_PROTOCOLS[n]}};return Fo}),Hs})})(sd);var om=sd.exports,ud={exports:{}};/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */(function(Kl,ch){(function(tt,_s){Kl.exports=_s()})(kc,function(){for(var tt=function(w,P,D){return P===void 0&&(P=0),D===void 0&&(D=1),w<P?P:w>D?D:w},_s=function(w){w._clipped=!1,w._unclipped=w.slice(0);for(var P=0;P<=3;P++)P<3?((w[P]<0||w[P]>255)&&(w._clipped=!0),w[P]=tt(w[P],0,255)):P===3&&(w[P]=tt(w[P],0,1));return w},Hs={},Au=0,h=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];Au<h.length;Au+=1){var Ei=h[Au];Hs["[object "+Ei+"]"]=Ei.toLowerCase()}var Bt=function(w){return Hs[Object.prototype.toString.call(w)]||"object"},En=function(w,P){return P===void 0&&(P=null),w.length>=3?Array.prototype.slice.call(w):Bt(w[0])=="object"&&P?P.split("").filter(function(D){return w[0][D]!==void 0}).map(function(D){return w[0][D]}):w[0]},Te=function(w){if(w.length<2)return null;var P=w.length-1;return Bt(w[P])=="string"?w[P].toLowerCase():null},pn=Math.PI,Et={clip_rgb:_s,limit:tt,type:Bt,unpack:En,last:Te,PI:pn,TWOPI:pn*2,PITHIRD:pn/3,DEG2RAD:pn/180,RAD2DEG:180/pn},je={format:{},autodetect:[]},Zn=Et.last,To=Et.clip_rgb,Zr=Et.type,Zi=function(){for(var P=[],D=arguments.length;D--;)P[D]=arguments[D];var H=this;if(Zr(P[0])==="object"&&P[0].constructor&&P[0].constructor===this.constructor)return P[0];var ct=Zn(P),ut=!1;if(!ct){ut=!0,je.sorted||(je.autodetect=je.autodetect.sort(function(mt,Ft){return Ft.p-mt.p}),je.sorted=!0);for(var ot=0,wt=je.autodetect;ot<wt.length;ot+=1){var gt=wt[ot];if(ct=gt.test.apply(gt,P),ct)break}}if(je.format[ct]){var Mt=je.format[ct].apply(null,ut?P:P.slice(0,-1));H._rgb=To(Mt)}else throw new Error("unknown format: "+P);H._rgb.length===3&&H._rgb.push(1)};Zi.prototype.toString=function(){return Zr(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var Zt=Zi,Jn=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Jn.Color,[null].concat(w)))};Jn.Color=Zt,Jn.version="2.1.2";var _e=Jn,Bn=Et.unpack,ji=Math.max,Ai=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=Bn(w,"rgb"),H=D[0],ct=D[1],ut=D[2];H=H/255,ct=ct/255,ut=ut/255;var ot=1-ji(H,ji(ct,ut)),wt=ot<1?1/(1-ot):0,gt=(1-H-ot)*wt,Mt=(1-ct-ot)*wt,mt=(1-ut-ot)*wt;return[gt,Mt,mt,ot]},oo=Ai,On=Et.unpack,jo=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];w=On(w,"cmyk");var D=w[0],H=w[1],ct=w[2],ut=w[3],ot=w.length>4?w[4]:1;return ut===1?[0,0,0,ot]:[D>=1?0:255*(1-D)*(1-ut),H>=1?0:255*(1-H)*(1-ut),ct>=1?0:255*(1-ct)*(1-ut),ot]},ao=jo,Ka=Et.unpack,Jr=Et.type;Zt.prototype.cmyk=function(){return oo(this._rgb)},_e.cmyk=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["cmyk"])))},je.format.cmyk=ao,je.autodetect.push({p:2,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=Ka(w,"cmyk"),Jr(w)==="array"&&w.length===4)return"cmyk"}});var ui=Et.unpack,Ks=Et.last,li=function(w){return Math.round(w*100)/100},Gi=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=ui(w,"hsla"),H=Ks(w)||"lsa";return D[0]=li(D[0]||0),D[1]=li(D[1]*100)+"%",D[2]=li(D[2]*100)+"%",H==="hsla"||D.length>3&&D[3]<1?(D[3]=D.length>3?D[3]:1,H="hsla"):D.length=3,H+"("+D.join(",")+")"},Bi=Gi,Ys=Et.unpack,so=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];w=Ys(w,"rgba");var D=w[0],H=w[1],ct=w[2];D/=255,H/=255,ct/=255;var ut=Math.min(D,H,ct),ot=Math.max(D,H,ct),wt=(ot+ut)/2,gt,Mt;return ot===ut?(gt=0,Mt=Number.NaN):gt=wt<.5?(ot-ut)/(ot+ut):(ot-ut)/(2-ot-ut),D==ot?Mt=(H-ct)/(ot-ut):H==ot?Mt=2+(ct-D)/(ot-ut):ct==ot&&(Mt=4+(D-H)/(ot-ut)),Mt*=60,Mt<0&&(Mt+=360),w.length>3&&w[3]!==void 0?[Mt,gt,wt,w[3]]:[Mt,gt,wt]},fn=so,Io=Et.unpack,Ea=Et.last,Go=Math.round,Oi=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=Io(w,"rgba"),H=Ea(w)||"rgb";return H.substr(0,3)=="hsl"?Bi(fn(D),H):(D[0]=Go(D[0]),D[1]=Go(D[1]),D[2]=Go(D[2]),(H==="rgba"||D.length>3&&D[3]<1)&&(D[3]=D.length>3?D[3]:1,H="rgba"),H+"("+D.slice(0,H==="rgb"?3:4).join(",")+")")},Ya=Oi,$n=Et.unpack,ci=Math.round,pr=function(){for(var w,P=[],D=arguments.length;D--;)P[D]=arguments[D];P=$n(P,"hsl");var H=P[0],ct=P[1],ut=P[2],ot,wt,gt;if(ct===0)ot=wt=gt=ut*255;else{var Mt=[0,0,0],mt=[0,0,0],Ft=ut<.5?ut*(1+ct):ut+ct-ut*ct,le=2*ut-Ft,oe=H/360;Mt[0]=oe+1/3,Mt[1]=oe,Mt[2]=oe-1/3;for(var ge=0;ge<3;ge++)Mt[ge]<0&&(Mt[ge]+=1),Mt[ge]>1&&(Mt[ge]-=1),6*Mt[ge]<1?mt[ge]=le+(Ft-le)*6*Mt[ge]:2*Mt[ge]<1?mt[ge]=Ft:3*Mt[ge]<2?mt[ge]=le+(Ft-le)*(2/3-Mt[ge])*6:mt[ge]=le;w=[ci(mt[0]*255),ci(mt[1]*255),ci(mt[2]*255)],ot=w[0],wt=w[1],gt=w[2]}return P.length>3?[ot,wt,gt,P[3]]:[ot,wt,gt,1]},Wi=pr,Eo=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,hi=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,He=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,An=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,dn=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Fi=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Xi=Math.round,Ui=function(w){w=w.toLowerCase().trim();var P;if(je.format.named)try{return je.format.named(w)}catch{}if(P=w.match(Eo)){for(var D=P.slice(1,4),H=0;H<3;H++)D[H]=+D[H];return D[3]=1,D}if(P=w.match(hi)){for(var ct=P.slice(1,5),ut=0;ut<4;ut++)ct[ut]=+ct[ut];return ct}if(P=w.match(He)){for(var ot=P.slice(1,4),wt=0;wt<3;wt++)ot[wt]=Xi(ot[wt]*2.55);return ot[3]=1,ot}if(P=w.match(An)){for(var gt=P.slice(1,5),Mt=0;Mt<3;Mt++)gt[Mt]=Xi(gt[Mt]*2.55);return gt[3]=+gt[3],gt}if(P=w.match(dn)){var mt=P.slice(1,4);mt[1]*=.01,mt[2]*=.01;var Ft=Wi(mt);return Ft[3]=1,Ft}if(P=w.match(Fi)){var le=P.slice(1,4);le[1]*=.01,le[2]*=.01;var oe=Wi(le);return oe[3]=+P[4],oe}};Ui.test=function(w){return Eo.test(w)||hi.test(w)||He.test(w)||An.test(w)||dn.test(w)||Fi.test(w)};var Ja=Ui,Qn=Et.type;Zt.prototype.css=function(w){return Ya(this._rgb,w)},_e.css=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["css"])))},je.format.css=Ja,je.autodetect.push({p:5,test:function(w){for(var P=[],D=arguments.length-1;D-- >0;)P[D]=arguments[D+1];if(!P.length&&Qn(w)==="string"&&Ja.test(w))return"css"}});var jn=Et.unpack;je.format.gl=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=jn(w,"rgba");return D[0]*=255,D[1]*=255,D[2]*=255,D},_e.gl=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["gl"])))},Zt.prototype.gl=function(){var w=this._rgb;return[w[0]/255,w[1]/255,w[2]/255,w[3]]};var Ao=Et.unpack,pi=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=Ao(w,"rgb"),H=D[0],ct=D[1],ut=D[2],ot=Math.min(H,ct,ut),wt=Math.max(H,ct,ut),gt=wt-ot,Mt=gt*100/255,mt=ot/(255-gt)*100,Ft;return gt===0?Ft=Number.NaN:(H===wt&&(Ft=(ct-ut)/gt),ct===wt&&(Ft=2+(ut-H)/gt),ut===wt&&(Ft=4+(H-ct)/gt),Ft*=60,Ft<0&&(Ft+=360)),[Ft,Mt,mt]},Hi=pi,uo=Et.unpack,lo=Math.floor,ia=function(){for(var w,P,D,H,ct,ut,ot=[],wt=arguments.length;wt--;)ot[wt]=arguments[wt];ot=uo(ot,"hcg");var gt=ot[0],Mt=ot[1],mt=ot[2],Ft,le,oe;mt=mt*255;var ge=Mt*255;if(Mt===0)Ft=le=oe=mt;else{gt===360&&(gt=0),gt>360&&(gt-=360),gt<0&&(gt+=360),gt/=60;var Je=lo(gt),Ie=gt-Je,Dt=mt*(1-Mt),Tr=Dt+ge*(1-Ie),Qr=Dt+ge*Ie,yr=Dt+ge;switch(Je){case 0:w=[yr,Qr,Dt],Ft=w[0],le=w[1],oe=w[2];break;case 1:P=[Tr,yr,Dt],Ft=P[0],le=P[1],oe=P[2];break;case 2:D=[Dt,yr,Qr],Ft=D[0],le=D[1],oe=D[2];break;case 3:H=[Dt,Tr,yr],Ft=H[0],le=H[1],oe=H[2];break;case 4:ct=[Qr,Dt,yr],Ft=ct[0],le=ct[1],oe=ct[2];break;case 5:ut=[yr,Dt,Tr],Ft=ut[0],le=ut[1],oe=ut[2];break}}return[Ft,le,oe,ot.length>3?ot[3]:1]},Wo=ia,Aa=Et.unpack,Pa=Et.type;Zt.prototype.hcg=function(){return Hi(this._rgb)},_e.hcg=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["hcg"])))},je.format.hcg=Wo,je.autodetect.push({p:1,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=Aa(w,"hcg"),Pa(w)==="array"&&w.length===3)return"hcg"}});var oa=Et.unpack,$a=Et.last,co=Math.round,Ca=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=oa(w,"rgba"),H=D[0],ct=D[1],ut=D[2],ot=D[3],wt=$a(w)||"auto";ot===void 0&&(ot=1),wt==="auto"&&(wt=ot<1?"rgba":"rgb"),H=co(H),ct=co(ct),ut=co(ut);var gt=H<<16|ct<<8|ut,Mt="000000"+gt.toString(16);Mt=Mt.substr(Mt.length-6);var mt="0"+co(ot*255).toString(16);switch(mt=mt.substr(mt.length-2),wt.toLowerCase()){case"rgba":return"#"+Mt+mt;case"argb":return"#"+mt+Mt;default:return"#"+Mt}},Po=Ca,za=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,ka=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Js=function(w){if(w.match(za)){(w.length===4||w.length===7)&&(w=w.substr(1)),w.length===3&&(w=w.split(""),w=w[0]+w[0]+w[1]+w[1]+w[2]+w[2]);var P=parseInt(w,16),D=P>>16,H=P>>8&255,ct=P&255;return[D,H,ct,1]}if(w.match(ka)){(w.length===5||w.length===9)&&(w=w.substr(1)),w.length===4&&(w=w.split(""),w=w[0]+w[0]+w[1]+w[1]+w[2]+w[2]+w[3]+w[3]);var ut=parseInt(w,16),ot=ut>>24&255,wt=ut>>16&255,gt=ut>>8&255,Mt=Math.round((ut&255)/255*100)/100;return[ot,wt,gt,Mt]}throw new Error("unknown hex color: "+w)},xs=Js,Ma=Et.type;Zt.prototype.hex=function(w){return Po(this._rgb,w)},_e.hex=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["hex"])))},je.format.hex=xs,je.autodetect.push({p:4,test:function(w){for(var P=[],D=arguments.length-1;D-- >0;)P[D]=arguments[D+1];if(!P.length&&Ma(w)==="string"&&[3,4,5,6,7,8,9].indexOf(w.length)>=0)return"hex"}});var aa=Et.unpack,Co=Et.TWOPI,La=Math.min,Qa=Math.sqrt,Gr=Math.acos,A=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=aa(w,"rgb"),H=D[0],ct=D[1],ut=D[2];H/=255,ct/=255,ut/=255;var ot,wt=La(H,ct,ut),gt=(H+ct+ut)/3,Mt=gt>0?1-wt/gt:0;return Mt===0?ot=NaN:(ot=(H-ct+(H-ut))/2,ot/=Qa((H-ct)*(H-ct)+(H-ut)*(ct-ut)),ot=Gr(ot),ut>ct&&(ot=Co-ot),ot/=Co),[ot*360,Mt,gt]},M=A,L=Et.unpack,N=Et.limit,X=Et.TWOPI,rt=Et.PITHIRD,st=Math.cos,nt=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];w=L(w,"hsi");var D=w[0],H=w[1],ct=w[2],ut,ot,wt;return isNaN(D)&&(D=0),isNaN(H)&&(H=0),D>360&&(D-=360),D<0&&(D+=360),D/=360,D<1/3?(wt=(1-H)/3,ut=(1+H*st(X*D)/st(rt-X*D))/3,ot=1-(wt+ut)):D<2/3?(D-=1/3,ut=(1-H)/3,ot=(1+H*st(X*D)/st(rt-X*D))/3,wt=1-(ut+ot)):(D-=2/3,ot=(1-H)/3,wt=(1+H*st(X*D)/st(rt-X*D))/3,ut=1-(ot+wt)),ut=N(ct*ut*3),ot=N(ct*ot*3),wt=N(ct*wt*3),[ut*255,ot*255,wt*255,w.length>3?w[3]:1]},V=nt,Y=Et.unpack,Lt=Et.type;Zt.prototype.hsi=function(){return M(this._rgb)},_e.hsi=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["hsi"])))},je.format.hsi=V,je.autodetect.push({p:2,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=Y(w,"hsi"),Lt(w)==="array"&&w.length===3)return"hsi"}});var Wt=Et.unpack,vt=Et.type;Zt.prototype.hsl=function(){return fn(this._rgb)},_e.hsl=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["hsl"])))},je.format.hsl=Wi,je.autodetect.push({p:2,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=Wt(w,"hsl"),vt(w)==="array"&&w.length===3)return"hsl"}});var Rt=Et.unpack,ee=Math.min,re=Math.max,ce=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];w=Rt(w,"rgb");var D=w[0],H=w[1],ct=w[2],ut=ee(D,H,ct),ot=re(D,H,ct),wt=ot-ut,gt,Mt,mt;return mt=ot/255,ot===0?(gt=Number.NaN,Mt=0):(Mt=wt/ot,D===ot&&(gt=(H-ct)/wt),H===ot&&(gt=2+(ct-D)/wt),ct===ot&&(gt=4+(D-H)/wt),gt*=60,gt<0&&(gt+=360)),[gt,Mt,mt]},At=ce,Ht=Et.unpack,kt=Math.floor,Me=function(){for(var w,P,D,H,ct,ut,ot=[],wt=arguments.length;wt--;)ot[wt]=arguments[wt];ot=Ht(ot,"hsv");var gt=ot[0],Mt=ot[1],mt=ot[2],Ft,le,oe;if(mt*=255,Mt===0)Ft=le=oe=mt;else{gt===360&&(gt=0),gt>360&&(gt-=360),gt<0&&(gt+=360),gt/=60;var ge=kt(gt),Je=gt-ge,Ie=mt*(1-Mt),Dt=mt*(1-Mt*Je),Tr=mt*(1-Mt*(1-Je));switch(ge){case 0:w=[mt,Tr,Ie],Ft=w[0],le=w[1],oe=w[2];break;case 1:P=[Dt,mt,Ie],Ft=P[0],le=P[1],oe=P[2];break;case 2:D=[Ie,mt,Tr],Ft=D[0],le=D[1],oe=D[2];break;case 3:H=[Ie,Dt,mt],Ft=H[0],le=H[1],oe=H[2];break;case 4:ct=[Tr,Ie,mt],Ft=ct[0],le=ct[1],oe=ct[2];break;case 5:ut=[mt,Ie,Dt],Ft=ut[0],le=ut[1],oe=ut[2];break}}return[Ft,le,oe,ot.length>3?ot[3]:1]},Le=Me,ne=Et.unpack,_r=Et.type;Zt.prototype.hsv=function(){return At(this._rgb)},_e.hsv=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["hsv"])))},je.format.hsv=Le,je.autodetect.push({p:2,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=ne(w,"hsv"),_r(w)==="array"&&w.length===3)return"hsv"}});var we={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},br=Et.unpack,Mr=Math.pow,rr=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=br(w,"rgb"),H=D[0],ct=D[1],ut=D[2],ot=Sr(H,ct,ut),wt=ot[0],gt=ot[1],Mt=ot[2],mt=116*gt-16;return[mt<0?0:mt,500*(wt-gt),200*(gt-Mt)]},wr=function(w){return(w/=255)<=.04045?w/12.92:Mr((w+.055)/1.055,2.4)},Fr=function(w){return w>we.t3?Mr(w,1/3):w/we.t2+we.t0},Sr=function(w,P,D){w=wr(w),P=wr(P),D=wr(D);var H=Fr((.4124564*w+.3575761*P+.1804375*D)/we.Xn),ct=Fr((.2126729*w+.7151522*P+.072175*D)/we.Yn),ut=Fr((.0193339*w+.119192*P+.9503041*D)/we.Zn);return[H,ct,ut]},Ve=rr,ts=Et.unpack,Ye=Math.pow,Da=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];w=ts(w,"lab");var D=w[0],H=w[1],ct=w[2],ut,ot,wt,gt,Mt,mt;return ot=(D+16)/116,ut=isNaN(H)?ot:ot+H/500,wt=isNaN(ct)?ot:ot-ct/200,ot=we.Yn*nn(ot),ut=we.Xn*nn(ut),wt=we.Zn*nn(wt),gt=es(3.2404542*ut-1.5371385*ot-.4985314*wt),Mt=es(-.969266*ut+1.8760108*ot+.041556*wt),mt=es(.0556434*ut-.2040259*ot+1.0572252*wt),[gt,Mt,mt,w.length>3?w[3]:1]},es=function(w){return 255*(w<=.00304?12.92*w:1.055*Ye(w,1/2.4)-.055)},nn=function(w){return w>we.t1?w*w*w:we.t2*(w-we.t0)},Gn=Da,$s=Et.unpack,Xo=Et.type;Zt.prototype.lab=function(){return Ve(this._rgb)},_e.lab=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["lab"])))},je.format.lab=Gn,je.autodetect.push({p:2,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=$s(w,"lab"),Xo(w)==="array"&&w.length===3)return"lab"}});var wn=Et.unpack,ho=Et.RAD2DEG,fi=Math.sqrt,Ur=Math.atan2,di=Math.round,Fn=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=wn(w,"lab"),H=D[0],ct=D[1],ut=D[2],ot=fi(ct*ct+ut*ut),wt=(Ur(ut,ct)*ho+360)%360;return di(ot*1e4)===0&&(wt=Number.NaN),[H,ot,wt]},mi=Fn,po=Et.unpack,Yl=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=po(w,"rgb"),H=D[0],ct=D[1],ut=D[2],ot=Ve(H,ct,ut),wt=ot[0],gt=ot[1],Mt=ot[2];return mi(wt,gt,Mt)},Pi=Yl,Qs=Et.unpack,fo=Et.DEG2RAD,$r=Math.sin,on=Math.cos,Ra=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=Qs(w,"lch"),H=D[0],ct=D[1],ut=D[2];return isNaN(ut)&&(ut=0),ut=ut*fo,[H,on(ut)*ct,$r(ut)*ct]},tu=Ra,dl=Et.unpack,ml=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];w=dl(w,"lch");var D=w[0],H=w[1],ct=w[2],ut=tu(D,H,ct),ot=ut[0],wt=ut[1],gt=ut[2],Mt=Gn(ot,wt,gt),mt=Mt[0],Ft=Mt[1],le=Mt[2];return[mt,Ft,le,w.length>3?w[3]:1]},bs=ml,gl=Et.unpack,yl=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=gl(w,"hcl").reverse();return bs.apply(void 0,D)},Jl=yl,Pu=Et.unpack,ws=Et.type;Zt.prototype.lch=function(){return Pi(this._rgb)},Zt.prototype.hcl=function(){return Pi(this._rgb).reverse()},_e.lch=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["lch"])))},_e.hcl=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["hcl"])))},je.format.lch=bs,je.format.hcl=Jl,["lch","hcl"].forEach(function(w){return je.autodetect.push({p:2,test:function(){for(var P=[],D=arguments.length;D--;)P[D]=arguments[D];if(P=Pu(P,w),ws(P)==="array"&&P.length===3)return w}})});var eu={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},zo=eu,vl=Et.type;Zt.prototype.name=function(){for(var w=Po(this._rgb,"rgb"),P=0,D=Object.keys(zo);P<D.length;P+=1){var H=D[P];if(zo[H]===w)return H.toLowerCase()}return w},je.format.named=function(w){if(w=w.toLowerCase(),zo[w])return xs(zo[w]);throw new Error("unknown color name: "+w)},je.autodetect.push({p:5,test:function(w){for(var P=[],D=arguments.length-1;D-- >0;)P[D]=arguments[D+1];if(!P.length&&vl(w)==="string"&&zo[w.toLowerCase()])return"named"}});var ru=Et.unpack,Ss=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=ru(w,"rgb"),H=D[0],ct=D[1],ut=D[2];return(H<<16)+(ct<<8)+ut},gi=Ss,Ba=Et.type,sa=function(w){if(Ba(w)=="number"&&w>=0&&w<=16777215){var P=w>>16,D=w>>8&255,H=w&255;return[P,D,H,1]}throw new Error("unknown num color: "+w)},nu=sa,ua=Et.type;Zt.prototype.num=function(){return gi(this._rgb)},_e.num=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["num"])))},je.format.num=nu,je.autodetect.push({p:5,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w.length===1&&ua(w[0])==="number"&&w[0]>=0&&w[0]<=16777215)return"num"}});var xr=Et.unpack,mr=Et.type,Ki=Math.round;Zt.prototype.rgb=function(w){return w===void 0&&(w=!0),w===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Ki)},Zt.prototype.rgba=function(w){return w===void 0&&(w=!0),this._rgb.slice(0,4).map(function(P,D){return D<3?w===!1?P:Ki(P):P})},_e.rgb=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["rgb"])))},je.format.rgb=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];var D=xr(w,"rgba");return D[3]===void 0&&(D[3]=1),D},je.autodetect.push({p:3,test:function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];if(w=xr(w,"rgba"),mr(w)==="array"&&(w.length===3||w.length===4&&mr(w[3])=="number"&&w[3]>=0&&w[3]<=1))return"rgb"}});var Wr=Math.log,iu=function(w){var P=w/100,D,H,ct;return P<66?(D=255,H=-155.25485562709179-.44596950469579133*(H=P-2)+104.49216199393888*Wr(H),ct=P<20?0:-254.76935184120902+.8274096064007395*(ct=P-10)+115.67994401066147*Wr(ct)):(D=351.97690566805693+.114206453784165*(D=P-55)-40.25366309332127*Wr(D),H=325.4494125711974+.07943456536662342*(H=P-50)-28.0852963507957*Wr(H),ct=255),[D,H,ct,1]},Cu=iu,$l=Et.unpack,Ql=Math.round,ou=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];for(var D=$l(w,"rgb"),H=D[0],ct=D[2],ut=1e3,ot=4e4,wt=.4,gt;ot-ut>wt;){gt=(ot+ut)*.5;var Mt=Cu(gt);Mt[2]/Mt[0]>=ct/H?ot=gt:ut=gt}return Ql(gt)},zu=ou;Zt.prototype.temp=Zt.prototype.kelvin=Zt.prototype.temperature=function(){return zu(this._rgb)},_e.temp=_e.kelvin=_e.temperature=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];return new(Function.prototype.bind.apply(Zt,[null].concat(w,["temp"])))},je.format.temp=je.format.kelvin=je.format.temperature=Cu;var Pn=Et.type;Zt.prototype.alpha=function(w,P){return P===void 0&&(P=!1),w!==void 0&&Pn(w)==="number"?P?(this._rgb[3]=w,this):new Zt([this._rgb[0],this._rgb[1],this._rgb[2],w],"rgb"):this._rgb[3]},Zt.prototype.clipped=function(){return this._rgb._clipped||!1},Zt.prototype.darken=function(w){w===void 0&&(w=1);var P=this,D=P.lab();return D[0]-=we.Kn*w,new Zt(D,"lab").alpha(P.alpha(),!0)},Zt.prototype.brighten=function(w){return w===void 0&&(w=1),this.darken(-w)},Zt.prototype.darker=Zt.prototype.darken,Zt.prototype.brighter=Zt.prototype.brighten,Zt.prototype.get=function(w){var P=w.split("."),D=P[0],H=P[1],ct=this[D]();if(H){var ut=D.indexOf(H);if(ut>-1)return ct[ut];throw new Error("unknown channel "+H+" in mode "+D)}else return ct};var Ts=Et.type,la=Math.pow,ku=1e-7,Mu=20;Zt.prototype.luminance=function(w){if(w!==void 0&&Ts(w)==="number"){if(w===0)return new Zt([0,0,0,this._rgb[3]],"rgb");if(w===1)return new Zt([255,255,255,this._rgb[3]],"rgb");var P=this.luminance(),D="rgb",H=Mu,ct=function(ot,wt){var gt=ot.interpolate(wt,.5,D),Mt=gt.luminance();return Math.abs(w-Mt)<ku||!H--?gt:Mt>w?ct(ot,gt):ct(gt,wt)},ut=(P>w?ct(new Zt([0,0,0]),this):ct(this,new Zt([255,255,255]))).rgb();return new Zt(ut.concat([this._rgb[3]]))}return ti.apply(void 0,this._rgb.slice(0,3))};var ti=function(w,P,D){return w=ca(w),P=ca(P),D=ca(D),.2126*w+.7152*P+.0722*D},ca=function(w){return w/=255,w<=.03928?w/12.92:la((w+.055)/1.055,2.4)},ei={},Sn=Et.type,Is=function(w,P,D){D===void 0&&(D=.5);for(var H=[],ct=arguments.length-3;ct-- >0;)H[ct]=arguments[ct+3];var ut=H[0]||"lrgb";if(!ei[ut]&&!H.length&&(ut=Object.keys(ei)[0]),!ei[ut])throw new Error("interpolation mode "+ut+" is not defined");return Sn(w)!=="object"&&(w=new Zt(w)),Sn(P)!=="object"&&(P=new Zt(P)),ei[ut](w,P,D).alpha(w.alpha()+D*(P.alpha()-w.alpha()))};Zt.prototype.mix=Zt.prototype.interpolate=function(w,P){P===void 0&&(P=.5);for(var D=[],H=arguments.length-2;H-- >0;)D[H]=arguments[H+2];return Is.apply(void 0,[this,w,P].concat(D))},Zt.prototype.premultiply=function(w){w===void 0&&(w=!1);var P=this._rgb,D=P[3];return w?(this._rgb=[P[0]*D,P[1]*D,P[2]*D,D],this):new Zt([P[0]*D,P[1]*D,P[2]*D,D],"rgb")},Zt.prototype.saturate=function(w){w===void 0&&(w=1);var P=this,D=P.lch();return D[1]+=we.Kn*w,D[1]<0&&(D[1]=0),new Zt(D,"lch").alpha(P.alpha(),!0)},Zt.prototype.desaturate=function(w){return w===void 0&&(w=1),this.saturate(-w)};var ko=Et.type;Zt.prototype.set=function(w,P,D){D===void 0&&(D=!1);var H=w.split("."),ct=H[0],ut=H[1],ot=this[ct]();if(ut){var wt=ct.indexOf(ut);if(wt>-1){if(ko(P)=="string")switch(P.charAt(0)){case"+":ot[wt]+=+P;break;case"-":ot[wt]+=+P;break;case"*":ot[wt]*=+P.substr(1);break;case"/":ot[wt]/=+P.substr(1);break;default:ot[wt]=+P}else if(ko(P)==="number")ot[wt]=P;else throw new Error("unsupported value for Color.set");var gt=new Zt(ot,ct);return D?(this._rgb=gt._rgb,this):gt}throw new Error("unknown channel "+ut+" in mode "+ct)}else return ot};var Ho=function(w,P,D){var H=w._rgb,ct=P._rgb;return new Zt(H[0]+D*(ct[0]-H[0]),H[1]+D*(ct[1]-H[1]),H[2]+D*(ct[2]-H[2]),"rgb")};ei.rgb=Ho;var mn=Math.sqrt,Yi=Math.pow,Cn=function(w,P,D){var H=w._rgb,ct=H[0],ut=H[1],ot=H[2],wt=P._rgb,gt=wt[0],Mt=wt[1],mt=wt[2];return new Zt(mn(Yi(ct,2)*(1-D)+Yi(gt,2)*D),mn(Yi(ut,2)*(1-D)+Yi(Mt,2)*D),mn(Yi(ot,2)*(1-D)+Yi(mt,2)*D),"rgb")};ei.lrgb=Cn;var Oa=function(w,P,D){var H=w.lab(),ct=P.lab();return new Zt(H[0]+D*(ct[0]-H[0]),H[1]+D*(ct[1]-H[1]),H[2]+D*(ct[2]-H[2]),"lab")};ei.lab=Oa;var Ji=function(w,P,D,H){var ct,ut,ot,wt;H==="hsl"?(ot=w.hsl(),wt=P.hsl()):H==="hsv"?(ot=w.hsv(),wt=P.hsv()):H==="hcg"?(ot=w.hcg(),wt=P.hcg()):H==="hsi"?(ot=w.hsi(),wt=P.hsi()):(H==="lch"||H==="hcl")&&(H="hcl",ot=w.hcl(),wt=P.hcl());var gt,Mt,mt,Ft,le,oe;H.substr(0,1)==="h"&&(ct=ot,gt=ct[0],mt=ct[1],le=ct[2],ut=wt,Mt=ut[0],Ft=ut[1],oe=ut[2]);var ge,Je,Ie,Dt;return!isNaN(gt)&&!isNaN(Mt)?(Mt>gt&&Mt-gt>180?Dt=Mt-(gt+360):Mt<gt&&gt-Mt>180?Dt=Mt+360-gt:Dt=Mt-gt,Je=gt+D*Dt):isNaN(gt)?isNaN(Mt)?Je=Number.NaN:(Je=Mt,(le==1||le==0)&&H!="hsv"&&(ge=Ft)):(Je=gt,(oe==1||oe==0)&&H!="hsv"&&(ge=mt)),ge===void 0&&(ge=mt+D*(Ft-mt)),Ie=le+D*(oe-le),new Zt([Je,ge,Ie],H)},ri=function(w,P,D){return Ji(w,P,D,"lch")};ei.lch=ri,ei.hcl=ri;var Es=function(w,P,D){var H=w.num(),ct=P.num();return new Zt(H+D*(ct-H),"num")};ei.num=Es;var Lr=function(w,P,D){return Ji(w,P,D,"hcg")};ei.hcg=Lr;var Dr=function(w,P,D){return Ji(w,P,D,"hsi")};ei.hsi=Dr;var mo=function(w,P,D){return Ji(w,P,D,"hsl")};ei.hsl=mo;var au=function(w,P,D){return Ji(w,P,D,"hsv")};ei.hsv=au;var _l=Et.clip_rgb,rs=Math.pow,su=Math.sqrt,Lu=Math.PI,Ko=Math.cos,Mo=Math.sin,Yo=Math.atan2,Fa=function(w,P,D){P===void 0&&(P="lrgb"),D===void 0&&(D=null);var H=w.length;D||(D=Array.from(new Array(H)).map(function(){return 1}));var ct=H/D.reduce(function(Je,Ie){return Je+Ie});if(D.forEach(function(Je,Ie){D[Ie]*=ct}),w=w.map(function(Je){return new Zt(Je)}),P==="lrgb")return xl(w,D);for(var ut=w.shift(),ot=ut.get(P),wt=[],gt=0,Mt=0,mt=0;mt<ot.length;mt++)if(ot[mt]=(ot[mt]||0)*D[0],wt.push(isNaN(ot[mt])?0:D[0]),P.charAt(mt)==="h"&&!isNaN(ot[mt])){var Ft=ot[mt]/180*Lu;gt+=Ko(Ft)*D[0],Mt+=Mo(Ft)*D[0]}var le=ut.alpha()*D[0];w.forEach(function(Je,Ie){var Dt=Je.get(P);le+=Je.alpha()*D[Ie+1];for(var Tr=0;Tr<ot.length;Tr++)if(!isNaN(Dt[Tr]))if(wt[Tr]+=D[Ie+1],P.charAt(Tr)==="h"){var Qr=Dt[Tr]/180*Lu;gt+=Ko(Qr)*D[Ie+1],Mt+=Mo(Qr)*D[Ie+1]}else ot[Tr]+=Dt[Tr]*D[Ie+1]});for(var oe=0;oe<ot.length;oe++)if(P.charAt(oe)==="h"){for(var ge=Yo(Mt/wt[oe],gt/wt[oe])/Lu*180;ge<0;)ge+=360;for(;ge>=360;)ge-=360;ot[oe]=ge}else ot[oe]=ot[oe]/wt[oe];return le/=H,new Zt(ot,P).alpha(le>.99999?1:le,!0)},xl=function(w,P){for(var D=w.length,H=[0,0,0,0],ct=0;ct<w.length;ct++){var ut=w[ct],ot=P[ct]/D,wt=ut._rgb;H[0]+=rs(wt[0],2)*ot,H[1]+=rs(wt[1],2)*ot,H[2]+=rs(wt[2],2)*ot,H[3]+=wt[3]*ot}return H[0]=su(H[0]),H[1]=su(H[1]),H[2]=su(H[2]),H[3]>.9999999&&(H[3]=1),new Zt(_l(H))},Jo=Et.type,ha=Math.pow,pa=function(w){var P="rgb",D=_e("#ccc"),H=0,ct=[0,1],ut=[],ot=[0,0],wt=!1,gt=[],Mt=!1,mt=0,Ft=1,le=!1,oe={},ge=!0,Je=1,Ie=function(Xt){if(Xt=Xt||["#fff","#000"],Xt&&Jo(Xt)==="string"&&_e.brewer&&_e.brewer[Xt.toLowerCase()]&&(Xt=_e.brewer[Xt.toLowerCase()]),Jo(Xt)==="array"){Xt.length===1&&(Xt=[Xt[0],Xt[0]]),Xt=Xt.slice(0);for(var De=0;De<Xt.length;De++)Xt[De]=_e(Xt[De]);ut.length=0;for(var ze=0;ze<Xt.length;ze++)ut.push(ze/(Xt.length-1))}return Cr(),gt=Xt},Dt=function(Xt){if(wt!=null){for(var De=wt.length-1,ze=0;ze<De&&Xt>=wt[ze];)ze++;return ze-1}return 0},Tr=function(Xt){return Xt},Qr=function(Xt){return Xt},yr=function(Xt,De){var ze,Oe;if(De==null&&(De=!1),isNaN(Xt)||Xt===null)return D;if(De)Oe=Xt;else if(wt&&wt.length>2){var zn=Dt(Xt);Oe=zn/(wt.length-2)}else Ft!==mt?Oe=(Xt-mt)/(Ft-mt):Oe=1;Oe=Qr(Oe),De||(Oe=Tr(Oe)),Je!==1&&(Oe=ha(Oe,Je)),Oe=ot[0]+Oe*(1-ot[0]-ot[1]),Oe=Math.min(1,Math.max(0,Oe));var Xr=Math.floor(Oe*1e4);if(ge&&oe[Xr])ze=oe[Xr];else{if(Jo(gt)==="array")for(var Ir=0;Ir<ut.length;Ir++){var or=ut[Ir];if(Oe<=or){ze=gt[Ir];break}if(Oe>=or&&Ir===ut.length-1){ze=gt[Ir];break}if(Oe>or&&Oe<ut[Ir+1]){Oe=(Oe-or)/(ut[Ir+1]-or),ze=_e.interpolate(gt[Ir],gt[Ir+1],Oe,P);break}}else Jo(gt)==="function"&&(ze=gt(Oe));ge&&(oe[Xr]=ze)}return ze},Cr=function(){return oe={}};Ie(w);var ir=function(Xt){var De=_e(yr(Xt));return Mt&&De[Mt]?De[Mt]():De};return ir.classes=function(Xt){if(Xt!=null){if(Jo(Xt)==="array")wt=Xt,ct=[Xt[0],Xt[Xt.length-1]];else{var De=_e.analyze(ct);Xt===0?wt=[De.min,De.max]:wt=_e.limits(De,"e",Xt)}return ir}return wt},ir.domain=function(Xt){if(!arguments.length)return ct;mt=Xt[0],Ft=Xt[Xt.length-1],ut=[];var De=gt.length;if(Xt.length===De&&mt!==Ft)for(var ze=0,Oe=Array.from(Xt);ze<Oe.length;ze+=1){var zn=Oe[ze];ut.push((zn-mt)/(Ft-mt))}else{for(var Xr=0;Xr<De;Xr++)ut.push(Xr/(De-1));if(Xt.length>2){var Ir=Xt.map(function(gn,he){return he/(Xt.length-1)}),or=Xt.map(function(gn){return(gn-mt)/(Ft-mt)});or.every(function(gn,he){return Ir[he]===gn})||(Qr=function(gn){if(gn<=0||gn>=1)return gn;for(var he=0;gn>=or[he+1];)he++;var Ee=(gn-or[he])/(or[he+1]-or[he]),Wn=Ir[he]+Ee*(Ir[he+1]-Ir[he]);return Wn})}}return ct=[mt,Ft],ir},ir.mode=function(Xt){return arguments.length?(P=Xt,Cr(),ir):P},ir.range=function(Xt,De){return Ie(Xt),ir},ir.out=function(Xt){return Mt=Xt,ir},ir.spread=function(Xt){return arguments.length?(H=Xt,ir):H},ir.correctLightness=function(Xt){return Xt==null&&(Xt=!0),le=Xt,Cr(),le?Tr=function(De){for(var ze=yr(0,!0).lab()[0],Oe=yr(1,!0).lab()[0],zn=ze>Oe,Xr=yr(De,!0).lab()[0],Ir=ze+(Oe-ze)*De,or=Xr-Ir,gn=0,he=1,Ee=20;Math.abs(or)>.01&&Ee-- >0;)(function(){return zn&&(or*=-1),or<0?(gn=De,De+=(he-De)*.5):(he=De,De+=(gn-De)*.5),Xr=yr(De,!0).lab()[0],or=Xr-Ir})();return De}:Tr=function(De){return De},ir},ir.padding=function(Xt){return Xt!=null?(Jo(Xt)==="number"&&(Xt=[Xt,Xt]),ot=Xt,ir):ot},ir.colors=function(Xt,De){arguments.length<2&&(De="hex");var ze=[];if(arguments.length===0)ze=gt.slice(0);else if(Xt===1)ze=[ir(.5)];else if(Xt>1){var Oe=ct[0],zn=ct[1]-Oe;ze=$o(0,Xt,!1).map(function(he){return ir(Oe+he/(Xt-1)*zn)})}else{w=[];var Xr=[];if(wt&&wt.length>2)for(var Ir=1,or=wt.length,gn=1<=or;gn?Ir<or:Ir>or;gn?Ir++:Ir--)Xr.push((wt[Ir-1]+wt[Ir])*.5);else Xr=ct;ze=Xr.map(function(he){return ir(he)})}return _e[De]&&(ze=ze.map(function(he){return he[De]()})),ze},ir.cache=function(Xt){return Xt!=null?(ge=Xt,ir):ge},ir.gamma=function(Xt){return Xt!=null?(Je=Xt,ir):Je},ir.nodata=function(Xt){return Xt!=null?(D=_e(Xt),ir):D},ir};function $o(w,P,D){for(var H=[],ct=w<P,ut=D?ct?P+1:P-1:P,ot=w;ct?ot<ut:ot>ut;ct?ot++:ot--)H.push(ot);return H}var Qo=function(w){var P,D,H,ct,ut,ot,wt;if(w=w.map(function(Ft){return new Zt(Ft)}),w.length===2)P=w.map(function(Ft){return Ft.lab()}),ut=P[0],ot=P[1],ct=function(Ft){var le=[0,1,2].map(function(oe){return ut[oe]+Ft*(ot[oe]-ut[oe])});return new Zt(le,"lab")};else if(w.length===3)D=w.map(function(Ft){return Ft.lab()}),ut=D[0],ot=D[1],wt=D[2],ct=function(Ft){var le=[0,1,2].map(function(oe){return(1-Ft)*(1-Ft)*ut[oe]+2*(1-Ft)*Ft*ot[oe]+Ft*Ft*wt[oe]});return new Zt(le,"lab")};else if(w.length===4){var gt;H=w.map(function(Ft){return Ft.lab()}),ut=H[0],ot=H[1],wt=H[2],gt=H[3],ct=function(Ft){var le=[0,1,2].map(function(oe){return(1-Ft)*(1-Ft)*(1-Ft)*ut[oe]+3*(1-Ft)*(1-Ft)*Ft*ot[oe]+3*(1-Ft)*Ft*Ft*wt[oe]+Ft*Ft*Ft*gt[oe]});return new Zt(le,"lab")}}else if(w.length===5){var Mt=Qo(w.slice(0,3)),mt=Qo(w.slice(2,5));ct=function(Ft){return Ft<.5?Mt(Ft*2):mt((Ft-.5)*2)}}return ct},uu=function(w){var P=Qo(w);return P.scale=function(){return pa(P)},P},yi=function(w,P,D){if(!yi[D])throw new Error("unknown blend mode "+D);return yi[D](w,P)},nr=function(w){return function(P,D){var H=_e(D).rgb(),ct=_e(P).rgb();return _e.rgb(w(H,ct))}},go=function(w){return function(P,D){var H=[];return H[0]=w(P[0],D[0]),H[1]=w(P[1],D[1]),H[2]=w(P[2],D[2]),H}},Du=function(w){return w},Un=function(w,P){return w*P/255},Ru=function(w,P){return w>P?P:w},As=function(w,P){return w>P?w:P},ns=function(w,P){return 255*(1-(1-w/255)*(1-P/255))},Bu=function(w,P){return P<128?2*w*P/255:255*(1-2*(1-w/255)*(1-P/255))},is=function(w,P){return 255*(1-(1-P/255)/(w/255))},lu=function(w,P){return w===255?255:(w=255*(P/255)/(1-w/255),w>255?255:w)};yi.normal=nr(go(Du)),yi.multiply=nr(go(Un)),yi.screen=nr(go(ns)),yi.overlay=nr(go(Bu)),yi.darken=nr(go(Ru)),yi.lighten=nr(go(As)),yi.dodge=nr(go(lu)),yi.burn=nr(go(is));for(var cu=yi,Ua=Et.type,os=Et.clip_rgb,fa=Et.TWOPI,Ps=Math.pow,yo=Math.sin,hu=Math.cos,Ou=function(w,P,D,H,ct){w===void 0&&(w=300),P===void 0&&(P=-1.5),D===void 0&&(D=1),H===void 0&&(H=1),ct===void 0&&(ct=[0,1]);var ut=0,ot;Ua(ct)==="array"?ot=ct[1]-ct[0]:(ot=0,ct=[ct,ct]);var wt=function(gt){var Mt=fa*((w+120)/360+P*gt),mt=Ps(ct[0]+ot*gt,H),Ft=ut!==0?D[0]+gt*ut:D,le=Ft*mt*(1-mt)/2,oe=hu(Mt),ge=yo(Mt),Je=mt+le*(-.14861*oe+1.78277*ge),Ie=mt+le*(-.29227*oe-.90649*ge),Dt=mt+le*(1.97294*oe);return _e(os([Je*255,Ie*255,Dt*255,1]))};return wt.start=function(gt){return gt==null?w:(w=gt,wt)},wt.rotations=function(gt){return gt==null?P:(P=gt,wt)},wt.gamma=function(gt){return gt==null?H:(H=gt,wt)},wt.hue=function(gt){return gt==null?D:(D=gt,Ua(D)==="array"?(ut=D[1]-D[0],ut===0&&(D=D[1])):ut=0,wt)},wt.lightness=function(gt){return gt==null?ct:(Ua(gt)==="array"?(ct=gt,ot=gt[1]-gt[0]):(ct=[gt,gt],ot=0),wt)},wt.scale=function(){return _e.scale(wt)},wt.hue(D),wt},Lo="0123456789abcdef",Do=Math.floor,Cs=Math.random,zs=function(){for(var w="#",P=0;P<6;P++)w+=Lo.charAt(Do(Cs()*16));return new Zt(w,"hex")},bl=Math.log,ta=Math.pow,vo=Math.floor,ks=Math.abs,pu=function(w,P){P===void 0&&(P=null);var D={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Bt(w)==="object"&&(w=Object.values(w)),w.forEach(function(H){P&&Bt(H)==="object"&&(H=H[P]),H!=null&&!isNaN(H)&&(D.values.push(H),D.sum+=H,H<D.min&&(D.min=H),H>D.max&&(D.max=H),D.count+=1)}),D.domain=[D.min,D.max],D.limits=function(H,ct){return Fu(D,H,ct)},D},Fu=function(w,P,D){P===void 0&&(P="equal"),D===void 0&&(D=7),Bt(w)=="array"&&(w=pu(w));var H=w.min,ct=w.max,ut=w.values.sort(function(Kt,ye){return Kt-ye});if(D===1)return[H,ct];var ot=[];if(P.substr(0,1)==="c"&&(ot.push(H),ot.push(ct)),P.substr(0,1)==="e"){ot.push(H);for(var wt=1;wt<D;wt++)ot.push(H+wt/D*(ct-H));ot.push(ct)}else if(P.substr(0,1)==="l"){if(H<=0)throw new Error("Logarithmic scales are only possible for values > 0");var gt=Math.LOG10E*bl(H),Mt=Math.LOG10E*bl(ct);ot.push(H);for(var mt=1;mt<D;mt++)ot.push(ta(10,gt+mt/D*(Mt-gt)));ot.push(ct)}else if(P.substr(0,1)==="q"){ot.push(H);for(var Ft=1;Ft<D;Ft++){var le=(ut.length-1)*Ft/D,oe=vo(le);if(oe===le)ot.push(ut[oe]);else{var ge=le-oe;ot.push(ut[oe]*(1-ge)+ut[oe+1]*ge)}}ot.push(ct)}else if(P.substr(0,1)==="k"){var Je,Ie=ut.length,Dt=new Array(Ie),Tr=new Array(D),Qr=!0,yr=0,Cr=null;Cr=[],Cr.push(H);for(var ir=1;ir<D;ir++)Cr.push(H+ir/D*(ct-H));for(Cr.push(ct);Qr;){for(var Xt=0;Xt<D;Xt++)Tr[Xt]=0;for(var De=0;De<Ie;De++)for(var ze=ut[De],Oe=Number.MAX_VALUE,zn=void 0,Xr=0;Xr<D;Xr++){var Ir=ks(Cr[Xr]-ze);Ir<Oe&&(Oe=Ir,zn=Xr),Tr[zn]++,Dt[De]=zn}for(var or=new Array(D),gn=0;gn<D;gn++)or[gn]=null;for(var he=0;he<Ie;he++)Je=Dt[he],or[Je]===null?or[Je]=ut[he]:or[Je]+=ut[he];for(var Ee=0;Ee<D;Ee++)or[Ee]*=1/Tr[Ee];Qr=!1;for(var Wn=0;Wn<D;Wn++)if(or[Wn]!==Cr[Wn]){Qr=!0;break}Cr=or,yr++,yr>200&&(Qr=!1)}for(var Nn={},ni=0;ni<D;ni++)Nn[ni]=[];for(var Ro=0;Ro<Ie;Ro++)Je=Dt[Ro],Nn[Je].push(ut[Ro]);for(var Vn=[],ii=0;ii<D;ii++)Vn.push(Nn[ii][0]),Vn.push(Nn[ii][Nn[ii].length-1]);Vn=Vn.sort(function(Kt,ye){return Kt-ye}),ot.push(Vn[0]);for(var Xn=1;Xn<Vn.length;Xn+=2){var Ci=Vn[Xn];!isNaN(Ci)&&ot.indexOf(Ci)===-1&&ot.push(Ci)}}return ot},Uu={analyze:pu,limits:Fu},fu=function(w,P){w=new Zt(w),P=new Zt(P);var D=w.luminance(),H=P.luminance();return D>H?(D+.05)/(H+.05):(H+.05)/(D+.05)},Na=Math.sqrt,da=Math.atan2,ft=Math.abs,zt=Math.cos,It=Math.PI,jt=function(w,P,D,H){D===void 0&&(D=1),H===void 0&&(H=1),w=new Zt(w),P=new Zt(P);for(var ct=Array.from(w.lab()),ut=ct[0],ot=ct[1],wt=ct[2],gt=Array.from(P.lab()),Mt=gt[0],mt=gt[1],Ft=gt[2],le=Na(ot*ot+wt*wt),oe=Na(mt*mt+Ft*Ft),ge=ut<16?.511:.040975*ut/(1+.01765*ut),Je=.0638*le/(1+.0131*le)+.638,Ie=le<1e-6?0:da(wt,ot)*180/It;Ie<0;)Ie+=360;for(;Ie>=360;)Ie-=360;var Dt=Ie>=164&&Ie<=345?.56+ft(.2*zt(It*(Ie+168)/180)):.36+ft(.4*zt(It*(Ie+35)/180)),Tr=le*le*le*le,Qr=Na(Tr/(Tr+1900)),yr=Je*(Qr*Dt+1-Qr),Cr=ut-Mt,ir=le-oe,Xt=ot-mt,De=wt-Ft,ze=Xt*Xt+De*De-ir*ir,Oe=Cr/(D*ge),zn=ir/(H*Je),Xr=yr;return Na(Oe*Oe+zn*zn+ze/(Xr*Xr))},qe=function(w,P,D){D===void 0&&(D="lab"),w=new Zt(w),P=new Zt(P);var H=w.get(D),ct=P.get(D),ut=0;for(var ot in H){var wt=(H[ot]||0)-(ct[ot]||0);ut+=wt*wt}return Math.sqrt(ut)},lr=function(){for(var w=[],P=arguments.length;P--;)w[P]=arguments[P];try{return new(Function.prototype.bind.apply(Zt,[null].concat(w))),!0}catch{return!1}},jr={cool:function(){return pa([_e.hsl(180,1,.9),_e.hsl(250,.7,.4)])},hot:function(){return pa(["#000","#f00","#ff0","#fff"]).mode("rgb")}},xe={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Ke=0,ma=Object.keys(xe);Ke<ma.length;Ke+=1){var an=ma[Ke];xe[an.toLowerCase()]=xe[an]}var Ms=xe;_e.average=Fa,_e.bezier=uu,_e.blend=cu,_e.cubehelix=Ou,_e.mix=_e.interpolate=Is,_e.random=zs,_e.scale=pa,_e.analyze=Uu.analyze,_e.contrast=fu,_e.deltaE=jt,_e.distance=qe,_e.limits=Uu.limits,_e.valid=lr,_e.scales=jr,_e.colors=zo,_e.brewer=Ms;var as=_e;return as})})(ud);var am=ud.exports,rd={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(Kl,ch){(function(){var tt,_s="4.17.21",Hs=200,Au="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",Ei="Invalid `variable` option passed into `_.template`",Bt="__lodash_hash_undefined__",En=500,Te="__lodash_placeholder__",pn=1,Et=2,je=4,Zn=1,To=2,Zr=1,Zi=2,Zt=4,Jn=8,_e=16,Bn=32,ji=64,Ai=128,oo=256,On=512,jo=30,ao="...",Ka=800,Jr=16,ui=1,Ks=2,li=3,Gi=1/0,Bi=9007199254740991,Ys=17976931348623157e292,so=0/0,fn=4294967295,Io=fn-1,Ea=fn>>>1,Go=[["ary",Ai],["bind",Zr],["bindKey",Zi],["curry",Jn],["curryRight",_e],["flip",On],["partial",Bn],["partialRight",ji],["rearg",oo]],Oi="[object Arguments]",Ya="[object Array]",$n="[object AsyncFunction]",ci="[object Boolean]",pr="[object Date]",Wi="[object DOMException]",Eo="[object Error]",hi="[object Function]",He="[object GeneratorFunction]",An="[object Map]",dn="[object Number]",Fi="[object Null]",Xi="[object Object]",Ui="[object Promise]",Ja="[object Proxy]",Qn="[object RegExp]",jn="[object Set]",Ao="[object String]",pi="[object Symbol]",Hi="[object Undefined]",uo="[object WeakMap]",lo="[object WeakSet]",ia="[object ArrayBuffer]",Wo="[object DataView]",Aa="[object Float32Array]",Pa="[object Float64Array]",oa="[object Int8Array]",$a="[object Int16Array]",co="[object Int32Array]",Ca="[object Uint8Array]",Po="[object Uint8ClampedArray]",za="[object Uint16Array]",ka="[object Uint32Array]",Js=/\b__p \+= '';/g,xs=/\b(__p \+=) '' \+/g,Ma=/(__e\(.*?\)|\b__t\)) \+\n'';/g,aa=/&(?:amp|lt|gt|quot|#39);/g,Co=/[&<>"']/g,La=RegExp(aa.source),Qa=RegExp(Co.source),Gr=/<%-([\s\S]+?)%>/g,A=/<%([\s\S]+?)%>/g,M=/<%=([\s\S]+?)%>/g,L=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,N=/^\w*$/,X=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rt=/[\\^$.*+?()[\]{}|]/g,st=RegExp(rt.source),nt=/^\s+/,V=/\s/,Y=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Wt=/,? & /,vt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Rt=/[()=,{}\[\]\/\s]/,ee=/\\(\\)?/g,re=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ce=/\w*$/,At=/^[-+]0x[0-9a-f]+$/i,Ht=/^0b[01]+$/i,kt=/^\[object .+?Constructor\]$/,Me=/^0o[0-7]+$/i,Le=/^(?:0|[1-9]\d*)$/,ne=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_r=/($^)/,we=/['\n\r\u2028\u2029\\]/g,br="\\ud800-\\udfff",Mr="\\u0300-\\u036f",rr="\\ufe20-\\ufe2f",wr="\\u20d0-\\u20ff",Fr=Mr+rr+wr,Sr="\\u2700-\\u27bf",Ve="a-z\\xdf-\\xf6\\xf8-\\xff",ts="\\xac\\xb1\\xd7\\xf7",Ye="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Da="\\u2000-\\u206f",es=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nn="A-Z\\xc0-\\xd6\\xd8-\\xde",Gn="\\ufe0e\\ufe0f",$s=ts+Ye+Da+es,Xo="['\u2019]",wn="["+br+"]",ho="["+$s+"]",fi="["+Fr+"]",Ur="\\d+",di="["+Sr+"]",Fn="["+Ve+"]",mi="[^"+br+$s+Ur+Sr+Ve+nn+"]",po="\\ud83c[\\udffb-\\udfff]",Yl="(?:"+fi+"|"+po+")",Pi="[^"+br+"]",Qs="(?:\\ud83c[\\udde6-\\uddff]){2}",fo="[\\ud800-\\udbff][\\udc00-\\udfff]",$r="["+nn+"]",on="\\u200d",Ra="(?:"+Fn+"|"+mi+")",tu="(?:"+$r+"|"+mi+")",dl="(?:"+Xo+"(?:d|ll|m|re|s|t|ve))?",ml="(?:"+Xo+"(?:D|LL|M|RE|S|T|VE))?",bs=Yl+"?",gl="["+Gn+"]?",yl="(?:"+on+"(?:"+[Pi,Qs,fo].join("|")+")"+gl+bs+")*",Jl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ws=gl+bs+yl,eu="(?:"+[di,Qs,fo].join("|")+")"+ws,zo="(?:"+[Pi+fi+"?",fi,Qs,fo,wn].join("|")+")",vl=RegExp(Xo,"g"),ru=RegExp(fi,"g"),Ss=RegExp(po+"(?="+po+")|"+zo+ws,"g"),gi=RegExp([$r+"?"+Fn+"+"+dl+"(?="+[ho,$r,"$"].join("|")+")",tu+"+"+ml+"(?="+[ho,$r+Ra,"$"].join("|")+")",$r+"?"+Ra+"+"+dl,$r+"+"+ml,Pu,Jl,Ur,eu].join("|"),"g"),Ba=RegExp("["+on+br+Fr+Gn+"]"),sa=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ua=-1,xr={};xr[Aa]=xr[Pa]=xr[oa]=xr[$a]=xr[co]=xr[Ca]=xr[Po]=xr[za]=xr[ka]=!0,xr[Oi]=xr[Ya]=xr[ia]=xr[ci]=xr[Wo]=xr[pr]=xr[Eo]=xr[hi]=xr[An]=xr[dn]=xr[Xi]=xr[Qn]=xr[jn]=xr[Ao]=xr[uo]=!1;var mr={};mr[Oi]=mr[Ya]=mr[ia]=mr[Wo]=mr[ci]=mr[pr]=mr[Aa]=mr[Pa]=mr[oa]=mr[$a]=mr[co]=mr[An]=mr[dn]=mr[Xi]=mr[Qn]=mr[jn]=mr[Ao]=mr[pi]=mr[Ca]=mr[Po]=mr[za]=mr[ka]=!0,mr[Eo]=mr[hi]=mr[uo]=!1;var Ki={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Wr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},iu={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Cu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$l=parseFloat,Ql=parseInt,ou=typeof kc=="object"&&kc&&kc.Object===Object&&kc,zu=typeof self=="object"&&self&&self.Object===Object&&self,Pn=ou||zu||Function("return this")(),Ts=ch&&!ch.nodeType&&ch,la=Ts&&!0&&Kl&&!Kl.nodeType&&Kl,ku=la&&la.exports===Ts,Mu=ku&&ou.process,ti=function(){try{var ft=la&&la.require&&la.require("util").types;return ft||Mu&&Mu.binding&&Mu.binding("util")}catch{}}(),ca=ti&&ti.isArrayBuffer,ei=ti&&ti.isDate,Sn=ti&&ti.isMap,Is=ti&&ti.isRegExp,ko=ti&&ti.isSet,Ho=ti&&ti.isTypedArray;function mn(ft,zt,It){switch(It.length){case 0:return ft.call(zt);case 1:return ft.call(zt,It[0]);case 2:return ft.call(zt,It[0],It[1]);case 3:return ft.call(zt,It[0],It[1],It[2])}return ft.apply(zt,It)}function Yi(ft,zt,It,jt){for(var qe=-1,lr=ft==null?0:ft.length;++qe<lr;){var jr=ft[qe];zt(jt,jr,It(jr),ft)}return jt}function Cn(ft,zt){for(var It=-1,jt=ft==null?0:ft.length;++It<jt&&zt(ft[It],It,ft)!==!1;);return ft}function Oa(ft,zt){for(var It=ft==null?0:ft.length;It--&&zt(ft[It],It,ft)!==!1;);return ft}function Ji(ft,zt){for(var It=-1,jt=ft==null?0:ft.length;++It<jt;)if(!zt(ft[It],It,ft))return!1;return!0}function ri(ft,zt){for(var It=-1,jt=ft==null?0:ft.length,qe=0,lr=[];++It<jt;){var jr=ft[It];zt(jr,It,ft)&&(lr[qe++]=jr)}return lr}function Es(ft,zt){var It=ft==null?0:ft.length;return!!It&&Fa(ft,zt,0)>-1}function Lr(ft,zt,It){for(var jt=-1,qe=ft==null?0:ft.length;++jt<qe;)if(It(zt,ft[jt]))return!0;return!1}function Dr(ft,zt){for(var It=-1,jt=ft==null?0:ft.length,qe=Array(jt);++It<jt;)qe[It]=zt(ft[It],It,ft);return qe}function mo(ft,zt){for(var It=-1,jt=zt.length,qe=ft.length;++It<jt;)ft[qe+It]=zt[It];return ft}function au(ft,zt,It,jt){var qe=-1,lr=ft==null?0:ft.length;for(jt&&lr&&(It=ft[++qe]);++qe<lr;)It=zt(It,ft[qe],qe,ft);return It}function _l(ft,zt,It,jt){var qe=ft==null?0:ft.length;for(jt&&qe&&(It=ft[--qe]);qe--;)It=zt(It,ft[qe],qe,ft);return It}function rs(ft,zt){for(var It=-1,jt=ft==null?0:ft.length;++It<jt;)if(zt(ft[It],It,ft))return!0;return!1}var su=pa("length");function Lu(ft){return ft.split("")}function Ko(ft){return ft.match(vt)||[]}function Mo(ft,zt,It){var jt;return It(ft,function(qe,lr,jr){if(zt(qe,lr,jr))return jt=lr,!1}),jt}function Yo(ft,zt,It,jt){for(var qe=ft.length,lr=It+(jt?1:-1);jt?lr--:++lr<qe;)if(zt(ft[lr],lr,ft))return lr;return-1}function Fa(ft,zt,It){return zt===zt?zs(ft,zt,It):Yo(ft,Jo,It)}function xl(ft,zt,It,jt){for(var qe=It-1,lr=ft.length;++qe<lr;)if(jt(ft[qe],zt))return qe;return-1}function Jo(ft){return ft!==ft}function ha(ft,zt){var It=ft==null?0:ft.length;return It?yi(ft,zt)/It:so}function pa(ft){return function(zt){return zt==null?tt:zt[ft]}}function $o(ft){return function(zt){return ft==null?tt:ft[zt]}}function Qo(ft,zt,It,jt,qe){return qe(ft,function(lr,jr,xe){It=jt?(jt=!1,lr):zt(It,lr,jr,xe)}),It}function uu(ft,zt){var It=ft.length;for(ft.sort(zt);It--;)ft[It]=ft[It].value;return ft}function yi(ft,zt){for(var It,jt=-1,qe=ft.length;++jt<qe;){var lr=zt(ft[jt]);lr!==tt&&(It=It===tt?lr:It+lr)}return It}function nr(ft,zt){for(var It=-1,jt=Array(ft);++It<ft;)jt[It]=zt(It);return jt}function go(ft,zt){return Dr(zt,function(It){return[It,ft[It]]})}function Du(ft){return ft&&ft.slice(0,ks(ft)+1).replace(nt,"")}function Un(ft){return function(zt){return ft(zt)}}function Ru(ft,zt){return Dr(zt,function(It){return ft[It]})}function As(ft,zt){return ft.has(zt)}function ns(ft,zt){for(var It=-1,jt=ft.length;++It<jt&&Fa(zt,ft[It],0)>-1;);return It}function Bu(ft,zt){for(var It=ft.length;It--&&Fa(zt,ft[It],0)>-1;);return It}function is(ft,zt){for(var It=ft.length,jt=0;It--;)ft[It]===zt&&++jt;return jt}var lu=$o(Ki),cu=$o(Wr);function Ua(ft){return"\\"+Cu[ft]}function os(ft,zt){return ft==null?tt:ft[zt]}function fa(ft){return Ba.test(ft)}function Ps(ft){return sa.test(ft)}function yo(ft){for(var zt,It=[];!(zt=ft.next()).done;)It.push(zt.value);return It}function hu(ft){var zt=-1,It=Array(ft.size);return ft.forEach(function(jt,qe){It[++zt]=[qe,jt]}),It}function Ou(ft,zt){return function(It){return ft(zt(It))}}function Lo(ft,zt){for(var It=-1,jt=ft.length,qe=0,lr=[];++It<jt;){var jr=ft[It];(jr===zt||jr===Te)&&(ft[It]=Te,lr[qe++]=It)}return lr}function Do(ft){var zt=-1,It=Array(ft.size);return ft.forEach(function(jt){It[++zt]=jt}),It}function Cs(ft){var zt=-1,It=Array(ft.size);return ft.forEach(function(jt){It[++zt]=[jt,jt]}),It}function zs(ft,zt,It){for(var jt=It-1,qe=ft.length;++jt<qe;)if(ft[jt]===zt)return jt;return-1}function bl(ft,zt,It){for(var jt=It+1;jt--;)if(ft[jt]===zt)return jt;return jt}function ta(ft){return fa(ft)?Fu(ft):su(ft)}function vo(ft){return fa(ft)?Uu(ft):Lu(ft)}function ks(ft){for(var zt=ft.length;zt--&&V.test(ft.charAt(zt)););return zt}var pu=$o(iu);function Fu(ft){for(var zt=Ss.lastIndex=0;Ss.test(ft);)++zt;return zt}function Uu(ft){return ft.match(Ss)||[]}function fu(ft){return ft.match(gi)||[]}var Na=function ft(zt){zt=zt==null?Pn:da.defaults(Pn.Object(),zt,da.pick(Pn,nu));var It=zt.Array,jt=zt.Date,qe=zt.Error,lr=zt.Function,jr=zt.Math,xe=zt.Object,Ke=zt.RegExp,ma=zt.String,an=zt.TypeError,Ms=It.prototype,as=lr.prototype,w=xe.prototype,P=zt["__core-js_shared__"],D=as.toString,H=w.hasOwnProperty,ct=0,ut=function(){var a=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),ot=w.toString,wt=D.call(xe),gt=Pn._,Mt=Ke("^"+D.call(H).replace(rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mt=ku?zt.Buffer:tt,Ft=zt.Symbol,le=zt.Uint8Array,oe=mt?mt.allocUnsafe:tt,ge=Ou(xe.getPrototypeOf,xe),Je=xe.create,Ie=w.propertyIsEnumerable,Dt=Ms.splice,Tr=Ft?Ft.isConcatSpreadable:tt,Qr=Ft?Ft.iterator:tt,yr=Ft?Ft.toStringTag:tt,Cr=function(){try{var a=bu(xe,"defineProperty");return a({},"",{}),a}catch{}}(),ir=zt.clearTimeout!==Pn.clearTimeout&&zt.clearTimeout,Xt=jt&&jt.now!==Pn.Date.now&&jt.now,De=zt.setTimeout!==Pn.setTimeout&&zt.setTimeout,ze=jr.ceil,Oe=jr.floor,zn=xe.getOwnPropertySymbols,Xr=mt?mt.isBuffer:tt,Ir=zt.isFinite,or=Ms.join,gn=Ou(xe.keys,xe),he=jr.max,Ee=jr.min,Wn=jt.now,Nn=zt.parseInt,ni=jr.random,Ro=Ms.reverse,Vn=bu(zt,"DataView"),ii=bu(zt,"Map"),Xn=bu(zt,"Promise"),Ci=bu(zt,"Set"),Kt=bu(zt,"WeakMap"),ye=bu(xe,"create"),vi=Kt&&new Kt,_i={},Va=Tu(Vn),$i=Tu(ii),Bo=Tu(Xn),hh=Tu(Ci),qa=Tu(Kt),zr=Ft?Ft.prototype:tt,yn=zr?zr.valueOf:tt,wl=zr?zr.toString:tt;function F(a){if(hn(a)&&!Ne(a)&&!(a instanceof er)){if(a instanceof Ni)return a;if(H.call(a,"__wrapped__"))return gp(a)}return new Ni(a)}var Qi=function(){function a(){}return function(c){if(!qr(c))return{};if(Je)return Je(c);a.prototype=c;var g=new a;return a.prototype=tt,g}}();function xi(){}function Ni(a,c){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=tt}F.templateSettings={escape:Gr,evaluate:A,interpolate:M,variable:"",imports:{_:F}},F.prototype=xi.prototype,F.prototype.constructor=F,Ni.prototype=Qi(xi.prototype),Ni.prototype.constructor=Ni;function er(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=fn,this.__views__=[]}function Za(){var a=new er(this.__wrapped__);return a.__actions__=No(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=No(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=No(this.__views__),a}function du(){if(this.__filtered__){var a=new er(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function Nu(){var a=this.__wrapped__.value(),c=this.__dir__,g=Ne(a),b=c<0,z=g?a.length:0,q=gf(0,z,this.__views__),et=q.start,lt=q.end,yt=lt-et,Ot=b?lt:et-1,Nt=this.__iteratees__,Gt=Nt.length,pe=0,Ce=Ee(yt,this.__takeCount__);if(!g||!b&&z==yt&&Ce==yt)return sc(a,this.__actions__);var We=[];t:for(;yt--&&pe<Ce;){Ot+=c;for(var vr=-1,Xe=a[Ot];++vr<Gt;){var Pr=Nt[vr],Or=Pr.iteratee,Xa=Pr.type,na=Or(Xe);if(Xa==Ks)Xe=na;else if(!na){if(Xa==ui)continue t;break t}}We[pe++]=Xe}return We}er.prototype=Qi(xi.prototype),er.prototype.constructor=er;function ja(a){var c=-1,g=a==null?0:a.length;for(this.clear();++c<g;){var b=a[c];this.set(b[0],b[1])}}function Vu(){this.__data__=ye?ye(null):{},this.size=0}function ss(a){var c=this.has(a)&&delete this.__data__[a];return this.size-=c?1:0,c}function tc(a){var c=this.__data__;if(ye){var g=c[a];return g===Bt?tt:g}return H.call(c,a)?c[a]:tt}function ec(a){var c=this.__data__;return ye?c[a]!==tt:H.call(c,a)}function _o(a,c){var g=this.__data__;return this.size+=this.has(a)?0:1,g[a]=ye&&c===tt?Bt:c,this}ja.prototype.clear=Vu,ja.prototype.delete=ss,ja.prototype.get=tc,ja.prototype.has=ec,ja.prototype.set=_o;function Oo(a){var c=-1,g=a==null?0:a.length;for(this.clear();++c<g;){var b=a[c];this.set(b[0],b[1])}}function Ls(){this.__data__=[],this.size=0}function xo(a){var c=this.__data__,g=St(c,a);if(g<0)return!1;var b=c.length-1;return g==b?c.pop():Dt.call(c,g,1),--this.size,!0}function rc(a){var c=this.__data__,g=St(c,a);return g<0?tt:c[g][1]}function nc(a){return St(this.__data__,a)>-1}function qu(a,c){var g=this.__data__,b=St(g,a);return b<0?(++this.size,g.push([a,c])):g[b][1]=c,this}Oo.prototype.clear=Ls,Oo.prototype.delete=xo,Oo.prototype.get=rc,Oo.prototype.has=nc,Oo.prototype.set=qu;function Fo(a){var c=-1,g=a==null?0:a.length;for(this.clear();++c<g;){var b=a[c];this.set(b[0],b[1])}}function n(){this.size=0,this.__data__={hash:new ja,map:new(ii||Oo),string:new ja}}function o(a){var c=Ju(this,a).delete(a);return this.size-=c?1:0,c}function i(a){return Ju(this,a).get(a)}function u(a){return Ju(this,a).has(a)}function f(a,c){var g=Ju(this,a),b=g.size;return g.set(a,c),this.size+=g.size==b?0:1,this}Fo.prototype.clear=n,Fo.prototype.delete=o,Fo.prototype.get=i,Fo.prototype.has=u,Fo.prototype.set=f;function m(a){var c=-1,g=a==null?0:a.length;for(this.__data__=new Fo;++c<g;)this.add(a[c])}function y(a){return this.__data__.set(a,Bt),this}function _(a){return this.__data__.has(a)}m.prototype.add=m.prototype.push=y,m.prototype.has=_;function T(a){var c=this.__data__=new Oo(a);this.size=c.size}function C(){this.__data__=new Oo,this.size=0}function B(a){var c=this.__data__,g=c.delete(a);return this.size=c.size,g}function U(a){return this.__data__.get(a)}function O(a){return this.__data__.has(a)}function K(a,c){var g=this.__data__;if(g instanceof Oo){var b=g.__data__;if(!ii||b.length<Hs-1)return b.push([a,c]),this.size=++g.size,this;g=this.__data__=new Fo(b)}return g.set(a,c),this.size=g.size,this}T.prototype.clear=C,T.prototype.delete=B,T.prototype.get=U,T.prototype.has=O,T.prototype.set=K;function W(a,c){var g=Ne(a),b=!g&&Qe(a),z=!g&&!b&&Ti(a),q=!g&&!b&&!z&&Ga(a),et=g||b||z||q,lt=et?nr(a.length,ma):[],yt=lt.length;for(var Ot in a)(c||H.call(a,Ot))&&!(et&&(Ot=="length"||z&&(Ot=="offset"||Ot=="parent")||q&&(Ot=="buffer"||Ot=="byteLength"||Ot=="byteOffset")||ba(Ot,yt)))&&lt.push(Ot);return lt}function Q(a){var c=a.length;return c?a[fh(0,c-1)]:tt}function G(a,c){return pc(No(a),Jt(c,0,a.length))}function $(a){return pc(No(a))}function at(a,c,g){(g!==tt&&!fr(a[c],g)||g===tt&&!(c in a))&&Vt(a,c,g)}function ht(a,c,g){var b=a[c];(!(H.call(a,c)&&fr(b,g))||g===tt&&!(c in a))&&Vt(a,c,g)}function St(a,c){for(var g=a.length;g--;)if(fr(a[g][0],c))return g;return-1}function bt(a,c,g,b){return Se(a,function(z,q,et){c(b,z,g(z),et)}),b}function Tt(a,c){return a&&hs(c,Ri(c),a)}function Ct(a,c){return a&&hs(c,So(c),a)}function Vt(a,c,g){c=="__proto__"&&Cr?Cr(a,c,{configurable:!0,enumerable:!0,value:g,writable:!0}):a[c]=g}function Ut(a,c){for(var g=-1,b=c.length,z=It(b),q=a==null;++g<b;)z[g]=q?tt:sh(a,c[g]);return z}function Jt(a,c,g){return a===a&&(g!==tt&&(a=a<=g?a:g),c!==tt&&(a=a>=c?a:c)),a}function ae(a,c,g,b,z,q){var et,lt=c&pn,yt=c&Et,Ot=c&je;if(g&&(et=z?g(a,b,z,q):g(a)),et!==tt)return et;if(!qr(a))return a;var Nt=Ne(a);if(Nt){if(et=vf(a),!lt)return No(a,et)}else{var Gt=eo(a),pe=Gt==hi||Gt==He;if(Ti(a))return Fc(a,lt);if(Gt==Xi||Gt==Oi||pe&&!z){if(et=yt||pe?{}:cp(a),!lt)return yt?tp(a,Ct(et,a)):hf(a,Tt(et,a))}else{if(!mr[Gt])return z?a:{};et=_f(a,Gt,lt)}}q||(q=new T);var Ce=q.get(a);if(Ce)return Ce;q.set(a,et),Sc(a)?a.forEach(function(Xe){et.add(ae(Xe,c,g,Xe,a,q))}):sl(a)&&a.forEach(function(Xe,Pr){et.set(Pr,ae(Xe,c,g,Pr,a,q))});var We=Ot?yt?Ih:Zc:yt?So:Ri,vr=Nt?tt:We(a);return Cn(vr||a,function(Xe,Pr){vr&&(Pr=Xe,Xe=a[Pr]),ht(et,Pr,ae(Xe,c,g,Pr,a,q))}),et}function ve(a){var c=Ri(a);return function(g){return de(g,a,c)}}function de(a,c,g){var b=g.length;if(a==null)return!b;for(a=xe(a);b--;){var z=g[b],q=c[z],et=a[z];if(et===tt&&!(z in a)||!q(et))return!1}return!0}function ar(a,c,g){if(typeof a!="function")throw new an(h);return Ml(function(){a.apply(tt,g)},c)}function te(a,c,g,b){var z=-1,q=Es,et=!0,lt=a.length,yt=[],Ot=c.length;if(!lt)return yt;g&&(c=Dr(c,Un(g))),b?(q=Lr,et=!1):c.length>=Hs&&(q=As,et=!1,c=new m(c));t:for(;++z<lt;){var Nt=a[z],Gt=g==null?Nt:g(Nt);if(Nt=b||Nt!==0?Nt:0,et&&Gt===Gt){for(var pe=Ot;pe--;)if(c[pe]===Gt)continue t;yt.push(Nt)}else q(c,Gt,b)||yt.push(Nt)}return yt}var Se=ep(en),Ze=ep(Tn,!0);function Re(a,c){var g=!0;return Se(a,function(b,z,q){return g=!!c(b,z,q),g}),g}function Pe(a,c,g){for(var b=-1,z=a.length;++b<z;){var q=a[b],et=c(q);if(et!=null&&(lt===tt?et===et&&!no(et):g(et,lt)))var lt=et,yt=q}return yt}function ke(a,c,g,b){var z=a.length;for(g=ur(g),g<0&&(g=-g>z?0:z+g),b=b===tt||b>z?z:ur(b),b<0&&(b+=z),b=g>b?0:rh(b);g<b;)a[g++]=c;return a}function Ae(a,c){var g=[];return Se(a,function(b,z,q){c(b,z,q)&&g.push(b)}),g}function ie(a,c,g,b,z){var q=-1,et=a.length;for(g||(g=bf),z||(z=[]);++q<et;){var lt=a[q];c>0&&g(lt)?c>1?ie(lt,c-1,g,b,z):mo(z,lt):b||(z[z.length]=lt)}return z}var Er=_h(),sn=_h(!0);function en(a,c){return a&&Er(a,c,Ri)}function Tn(a,c){return a&&sn(a,c,Ri)}function vn(a,c){return ri(c,function(g){return ra(a[g])})}function Vr(a,c){c=Os(c,a);for(var g=0,b=c.length;a!=null&&g<b;)a=a[wa(c[g++])];return g&&g==b?a:tt}function oi(a,c,g){var b=c(a);return Ne(a)?b:mo(b,g(a))}function un(a){return a==null?a===tt?Hi:Fi:yr&&yr in xe(a)?Vs(a):Gc(a)}function ai(a,c){return a>c}function zi(a,c){return a!=null&&H.call(a,c)}function ga(a,c){return a!=null&&c in xe(a)}function bo(a,c,g){return a>=Ee(c,g)&&a<he(c,g)}function Zu(a,c,g){for(var b=g?Lr:Es,z=a[0].length,q=a.length,et=q,lt=It(q),yt=1/0,Ot=[];et--;){var Nt=a[et];et&&c&&(Nt=Dr(Nt,Un(c))),yt=Ee(Nt.length,yt),lt[et]=!g&&(c||z>=120&&Nt.length>=120)?new m(et&&Nt):tt}Nt=a[0];var Gt=-1,pe=lt[0];t:for(;++Gt<z&&Ot.length<yt;){var Ce=Nt[Gt],We=c?c(Ce):Ce;if(Ce=g||Ce!==0?Ce:0,!(pe?As(pe,We):b(Ot,We,g))){for(et=q;--et;){var vr=lt[et];if(!(vr?As(vr,We):b(a[et],We,g)))continue t}pe&&pe.push(We),Ot.push(Ce)}}return Ot}function us(a,c,g,b){return en(a,function(z,q,et){c(b,g(z),q,et)}),b}function ya(a,c,g){c=Os(c,a),a=ro(a,c);var b=a==null?a:a[wa(Sa(c))];return b==null?tt:mn(b,a,g)}function ls(a){return hn(a)&&un(a)==Oi}function ju(a){return hn(a)&&un(a)==ia}function mu(a){return hn(a)&&un(a)==pr}function to(a,c,g,b,z){return a===c?!0:a==null||c==null||!hn(a)&&!hn(c)?a!==a&&c!==c:gu(a,c,g,b,to,z)}function gu(a,c,g,b,z,q){var et=Ne(a),lt=Ne(c),yt=et?Ya:eo(a),Ot=lt?Ya:eo(c);yt=yt==Oi?Xi:yt,Ot=Ot==Oi?Xi:Ot;var Nt=yt==Xi,Gt=Ot==Xi,pe=yt==Ot;if(pe&&Ti(a)){if(!Ti(c))return!1;et=!0,Nt=!1}if(pe&&!Nt)return q||(q=new T),et||Ga(a)?Th(a,c,g,b,z,q):df(a,c,yt,g,b,z,q);if(!(g&Zn)){var Ce=Nt&&H.call(a,"__wrapped__"),We=Gt&&H.call(c,"__wrapped__");if(Ce||We){var vr=Ce?a.value():a,Xe=We?c.value():c;return q||(q=new T),z(vr,Xe,g,b,q)}}return pe?(q||(q=new T),mf(a,c,g,b,z,q)):!1}function kn(a){return hn(a)&&eo(a)==An}function ea(a,c,g,b){var z=g.length,q=z,et=!b;if(a==null)return!q;for(a=xe(a);z--;){var lt=g[z];if(et&&lt[2]?lt[1]!==a[lt[0]]:!(lt[0]in a))return!1}for(;++z<q;){lt=g[z];var yt=lt[0],Ot=a[yt],Nt=lt[1];if(et&&lt[2]){if(Ot===tt&&!(yt in a))return!1}else{var Gt=new T;if(b)var pe=b(Ot,Nt,yt,a,c,Gt);if(!(pe===tt?to(Nt,Ot,Zn|To,b,Gt):pe))return!1}}return!0}function Uo(a){if(!qr(a)||Sf(a))return!1;var c=ra(a)?Mt:kt;return c.test(Tu(a))}function Ds(a){return hn(a)&&un(a)==Qn}function _n(a){return hn(a)&&eo(a)==jn}function ln(a){return hn(a)&&al(a.length)&&!!xr[un(a)]}function bi(a){return typeof a=="function"?a:a==null?Ia:typeof a=="object"?Ne(a)?oc(a[0],a[1]):Wu(a):od(a)}function Rs(a){if(!Su(a))return gn(a);var c=[];for(var g in xe(a))H.call(a,g)&&g!="constructor"&&c.push(g);return c}function Sl(a){if(!qr(a))return Mi(a);var c=Su(a),g=[];for(var b in a)b=="constructor"&&(c||!H.call(a,b))||g.push(b);return g}function ic(a,c){return a<c}function Gu(a,c){var g=-1,b=Rn(a)?It(a.length):[];return Se(a,function(z,q,et){b[++g]=c(z,q,et)}),b}function Wu(a){var c=Rr(a);return c.length==1&&c[0][2]?zl(c[0][0],c[0][1]):function(g){return g===a||ea(g,a,c)}}function oc(a,c){return jc(a)&&Cl(c)?zl(wa(a),c):function(g){var b=sh(g,a);return b===tt&&b===c?io(g,a):to(c,b,Zn|To)}}function cs(a,c,g,b,z){a!==c&&Er(c,function(q,et){if(z||(z=new T),qr(q))Xu(a,c,et,g,cs,b,z);else{var lt=b?b(Wc(a,et),q,et+"",a,c,z):tt;lt===tt&&(lt=q),at(a,et,lt)}},So)}function Xu(a,c,g,b,z,q,et){var lt=Wc(a,g),yt=Wc(c,g),Ot=et.get(yt);if(Ot){at(a,g,Ot);return}var Nt=q?q(lt,yt,g+"",a,c,et):tt,Gt=Nt===tt;if(Gt){var pe=Ne(yt),Ce=!pe&&Ti(yt),We=!pe&&!Ce&&Ga(yt);Nt=yt,pe||Ce||We?Ne(lt)?Nt=lt:tr(lt)?Nt=No(lt):Ce?(Gt=!1,Nt=Fc(yt,!0)):We?(Gt=!1,Nt=$h(yt,!0)):Nt=[]:js(yt)||Qe(yt)?(Nt=lt,Qe(lt)?Nt=jl(lt):(!qr(lt)||ra(lt))&&(Nt=cp(yt))):Gt=!1}Gt&&(et.set(yt,Nt),z(Nt,yt,b,q,et),et.delete(yt)),at(a,g,Nt)}function ph(a,c){var g=a.length;if(!!g)return c+=c<0?g:0,ba(c,g)?a[c]:tt}function Mc(a,c,g){c.length?c=Dr(c,function(q){return Ne(q)?function(et){return Vr(et,q.length===1?q[0]:q)}:q}):c=[Ia];var b=-1;c=Dr(c,Un(Fe()));var z=Gu(a,function(q,et,lt){var yt=Dr(c,function(Ot){return Ot(q)});return{criteria:yt,index:++b,value:q}});return uu(z,function(q,et){return vh(q,et,g)})}function Hu(a,c){return Vi(a,c,function(g,b){return io(a,b)})}function Vi(a,c,g){for(var b=-1,z=c.length,q={};++b<z;){var et=c[b],lt=Vr(a,et);g(lt,et)&&Tl(q,Os(et,a),lt)}return q}function of(a){return function(c){return Vr(c,a)}}function Lc(a,c,g,b){var z=b?xl:Fa,q=-1,et=c.length,lt=a;for(a===c&&(c=No(c)),g&&(lt=Dr(a,Un(g)));++q<et;)for(var yt=0,Ot=c[q],Nt=g?g(Ot):Ot;(yt=z(lt,Nt,yt,b))>-1;)lt!==a&&Dt.call(lt,yt,1),Dt.call(a,yt,1);return a}function Xh(a,c){for(var g=a?c.length:0,b=g-1;g--;){var z=c[g];if(g==b||z!==q){var q=z;ba(z)?Dt.call(a,z,1):vu(a,z)}}return a}function fh(a,c){return a+Oe(ni()*(c-a+1))}function af(a,c,g,b){for(var z=-1,q=he(ze((c-a)/(g||1)),0),et=It(q);q--;)et[b?q:++z]=a,a+=g;return et}function dh(a,c){var g="";if(!a||c<1||c>Bi)return g;do c%2&&(g+=a),c=Oe(c/2),c&&(a+=a);while(c);return g}function cr(a,c){return hc(cc(a,c,Ia),a+"")}function sf(a){return Q(pl(a))}function Dc(a,c){var g=pl(a);return pc(g,Jt(c,0,g.length))}function Tl(a,c,g,b){if(!qr(a))return a;c=Os(c,a);for(var z=-1,q=c.length,et=q-1,lt=a;lt!=null&&++z<q;){var yt=wa(c[z]),Ot=g;if(yt==="__proto__"||yt==="constructor"||yt==="prototype")return a;if(z!=et){var Nt=lt[yt];Ot=b?b(Nt,yt,lt):tt,Ot===tt&&(Ot=qr(Nt)?Nt:ba(c[z+1])?[]:{})}ht(lt,yt,Ot),lt=lt[yt]}return a}var Bs=vi?function(a,c){return vi.set(a,c),a}:Ia,ac=Cr?function(a,c){return Cr(a,"toString",{configurable:!0,enumerable:!1,value:Yf(c),writable:!0})}:Ia;function uf(a){return pc(pl(a))}function va(a,c,g){var b=-1,z=a.length;c<0&&(c=-c>z?0:z+c),g=g>z?z:g,g<0&&(g+=z),z=c>g?0:g-c>>>0,c>>>=0;for(var q=It(z);++b<z;)q[b]=a[b+c];return q}function lf(a,c){var g;return Se(a,function(b,z,q){return g=c(b,z,q),!g}),!!g}function Rc(a,c,g){var b=0,z=a==null?b:a.length;if(typeof c=="number"&&c===c&&z<=Ea){for(;b<z;){var q=b+z>>>1,et=a[q];et!==null&&!no(et)&&(g?et<=c:et<c)?b=q+1:z=q}return z}return mh(a,c,Ia,g)}function mh(a,c,g,b){var z=0,q=a==null?0:a.length;if(q===0)return 0;c=g(c);for(var et=c!==c,lt=c===null,yt=no(c),Ot=c===tt;z<q;){var Nt=Oe((z+q)/2),Gt=g(a[Nt]),pe=Gt!==tt,Ce=Gt===null,We=Gt===Gt,vr=no(Gt);if(et)var Xe=b||We;else Ot?Xe=We&&(b||pe):lt?Xe=We&&pe&&(b||!Ce):yt?Xe=We&&pe&&!Ce&&(b||!vr):Ce||vr?Xe=!1:Xe=b?Gt<=c:Gt<c;Xe?z=Nt+1:q=Nt}return Ee(q,Io)}function Hh(a,c){for(var g=-1,b=a.length,z=0,q=[];++g<b;){var et=a[g],lt=c?c(et):et;if(!g||!fr(lt,yt)){var yt=lt;q[z++]=et===0?0:et}}return q}function Kh(a){return typeof a=="number"?a:no(a)?so:+a}function wo(a){if(typeof a=="string")return a;if(Ne(a))return Dr(a,wo)+"";if(no(a))return wl?wl.call(a):"";var c=a+"";return c=="0"&&1/a==-Gi?"-0":c}function yu(a,c,g){var b=-1,z=Es,q=a.length,et=!0,lt=[],yt=lt;if(g)et=!1,z=Lr;else if(q>=Hs){var Ot=c?null:up(a);if(Ot)return Do(Ot);et=!1,z=As,yt=new m}else yt=c?[]:lt;t:for(;++b<q;){var Nt=a[b],Gt=c?c(Nt):Nt;if(Nt=g||Nt!==0?Nt:0,et&&Gt===Gt){for(var pe=yt.length;pe--;)if(yt[pe]===Gt)continue t;c&&yt.push(Gt),lt.push(Nt)}else z(yt,Gt,g)||(yt!==lt&&yt.push(Gt),lt.push(Nt))}return lt}function vu(a,c){return c=Os(c,a),a=ro(a,c),a==null||delete a[wa(Sa(c))]}function Yh(a,c,g,b){return Tl(a,c,g(Vr(a,c)),b)}function cn(a,c,g,b){for(var z=a.length,q=b?z:-1;(b?q--:++q<z)&&c(a[q],q,a););return g?va(a,b?0:q,b?q+1:z):va(a,b?q+1:0,b?z:q)}function sc(a,c){var g=a;return g instanceof er&&(g=g.value()),au(c,function(b,z){return z.func.apply(z.thisArg,mo([b],z.args))},g)}function Bc(a,c,g){var b=a.length;if(b<2)return b?yu(a[0]):[];for(var z=-1,q=It(b);++z<b;)for(var et=a[z],lt=-1;++lt<b;)lt!=z&&(q[z]=te(q[z]||et,a[lt],c,g));return yu(ie(q,1),c,g)}function uc(a,c,g){for(var b=-1,z=a.length,q=c.length,et={};++b<z;){var lt=b<q?c[b]:tt;g(et,a[b],lt)}return et}function Il(a){return tr(a)?a:[]}function Ku(a){return typeof a=="function"?a:Ia}function Os(a,c){return Ne(a)?a:jc(a,c)?[a]:$u(dr(a))}var Jh=cr;function _a(a,c,g){var b=a.length;return g=g===tt?b:g,!c&&g>=b?a:va(a,c,g)}var Oc=ir||function(a){return Pn.clearTimeout(a)};function Fc(a,c){if(c)return a.slice();var g=a.length,b=oe?oe(g):new a.constructor(g);return a.copy(b),b}function gh(a){var c=new a.constructor(a.byteLength);return new le(c).set(new le(a)),c}function lc(a,c){var g=c?gh(a.buffer):a.buffer;return new a.constructor(g,a.byteOffset,a.byteLength)}function cf(a){var c=new a.constructor(a.source,ce.exec(a));return c.lastIndex=a.lastIndex,c}function yh(a){return yn?xe(yn.call(a)):{}}function $h(a,c){var g=c?gh(a.buffer):a.buffer;return new a.constructor(g,a.byteOffset,a.length)}function Uc(a,c){if(a!==c){var g=a!==tt,b=a===null,z=a===a,q=no(a),et=c!==tt,lt=c===null,yt=c===c,Ot=no(c);if(!lt&&!Ot&&!q&&a>c||q&&et&&yt&&!lt&&!Ot||b&&et&&yt||!g&&yt||!z)return 1;if(!b&&!q&&!Ot&&a<c||Ot&&g&&z&&!b&&!q||lt&&g&&z||!et&&z||!yt)return-1}return 0}function vh(a,c,g){for(var b=-1,z=a.criteria,q=c.criteria,et=z.length,lt=g.length;++b<et;){var yt=Uc(z[b],q[b]);if(yt){if(b>=lt)return yt;var Ot=g[b];return yt*(Ot=="desc"?-1:1)}}return a.index-c.index}function xa(a,c,g,b){for(var z=-1,q=a.length,et=g.length,lt=-1,yt=c.length,Ot=he(q-et,0),Nt=It(yt+Ot),Gt=!b;++lt<yt;)Nt[lt]=c[lt];for(;++z<et;)(Gt||z<q)&&(Nt[g[z]]=a[z]);for(;Ot--;)Nt[lt++]=a[z++];return Nt}function Qh(a,c,g,b){for(var z=-1,q=a.length,et=-1,lt=g.length,yt=-1,Ot=c.length,Nt=he(q-lt,0),Gt=It(Nt+Ot),pe=!b;++z<Nt;)Gt[z]=a[z];for(var Ce=z;++yt<Ot;)Gt[Ce+yt]=c[yt];for(;++et<lt;)(pe||z<q)&&(Gt[Ce+g[et]]=a[z++]);return Gt}function No(a,c){var g=-1,b=a.length;for(c||(c=It(b));++g<b;)c[g]=a[g];return c}function hs(a,c,g,b){var z=!g;g||(g={});for(var q=-1,et=c.length;++q<et;){var lt=c[q],yt=b?b(g[lt],a[lt],lt,g,a):tt;yt===tt&&(yt=a[lt]),z?Vt(g,lt,yt):ht(g,lt,yt)}return g}function hf(a,c){return hs(a,wu(a),c)}function tp(a,c){return hs(a,Ah(a),c)}function Fs(a,c){return function(g,b){var z=Ne(g)?Yi:bt,q=c?c():{};return z(g,a,Fe(b,2),q)}}function El(a){return cr(function(c,g){var b=-1,z=g.length,q=z>1?g[z-1]:tt,et=z>2?g[2]:tt;for(q=a.length>3&&typeof q=="function"?(z--,q):tt,et&&si(g[0],g[1],et)&&(q=z<3?tt:q,z=1),c=xe(c);++b<z;){var lt=g[b];lt&&a(c,lt,b,q)}return c})}function ep(a,c){return function(g,b){if(g==null)return g;if(!Rn(g))return a(g,b);for(var z=g.length,q=c?z:-1,et=xe(g);(c?q--:++q<z)&&b(et[q],q,et)!==!1;);return g}}function _h(a){return function(c,g,b){for(var z=-1,q=xe(c),et=b(c),lt=et.length;lt--;){var yt=et[a?lt:++z];if(g(q[yt],yt,q)===!1)break}return c}}function rp(a,c,g){var b=c&Zr,z=ps(a);function q(){var et=this&&this!==Pn&&this instanceof q?z:a;return et.apply(b?g:this,arguments)}return q}function np(a){return function(c){c=dr(c);var g=fa(c)?vo(c):tt,b=g?g[0]:c.charAt(0),z=g?_a(g,1).join(""):c.slice(1);return b[a]()+z}}function Al(a){return function(c){return au(nd(tf(c).replace(vl,"")),a,"")}}function ps(a){return function(){var c=arguments;switch(c.length){case 0:return new a;case 1:return new a(c[0]);case 2:return new a(c[0],c[1]);case 3:return new a(c[0],c[1],c[2]);case 4:return new a(c[0],c[1],c[2],c[3]);case 5:return new a(c[0],c[1],c[2],c[3],c[4]);case 6:return new a(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new a(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var g=Qi(a.prototype),b=a.apply(g,c);return qr(b)?b:g}}function pf(a,c,g){var b=ps(a);function z(){for(var q=arguments.length,et=It(q),lt=q,yt=Yu(z);lt--;)et[lt]=arguments[lt];var Ot=q<3&&et[0]!==yt&&et[q-1]!==yt?[]:Lo(et,yt);if(q-=Ot.length,q<g)return sp(a,c,Vo,z.placeholder,tt,et,Ot,tt,tt,g-q);var Nt=this&&this!==Pn&&this instanceof z?b:a;return mn(Nt,this,et)}return z}function Nc(a){return function(c,g,b){var z=xe(c);if(!Rn(c)){var q=Fe(g,3);c=Ri(c),g=function(lt){return q(z[lt],lt,z)}}var et=a(c,g,b);return et>-1?z[q?c[et]:et]:tt}}function Pl(a){return Ns(function(c){var g=c.length,b=g,z=Ni.prototype.thru;for(a&&c.reverse();b--;){var q=c[b];if(typeof q!="function")throw new an(h);if(z&&!et&&xu(q)=="wrapper")var et=new Ni([],!0)}for(b=et?b:g;++b<g;){q=c[b];var lt=xu(q),yt=lt=="wrapper"?Eh(q):tt;yt&&Ph(yt[0])&&yt[1]==(Ai|Jn|Bn|oo)&&!yt[4].length&&yt[9]==1?et=et[xu(yt[0])].apply(et,yt[3]):et=q.length==1&&Ph(q)?et[lt]():et.thru(q)}return function(){var Ot=arguments,Nt=Ot[0];if(et&&Ot.length==1&&Ne(Nt))return et.plant(Nt).value();for(var Gt=0,pe=g?c[Gt].apply(this,Ot):Nt;++Gt<g;)pe=c[Gt].call(this,pe);return pe}})}function Vo(a,c,g,b,z,q,et,lt,yt,Ot){var Nt=c&Ai,Gt=c&Zr,pe=c&Zi,Ce=c&(Jn|_e),We=c&On,vr=pe?tt:ps(a);function Xe(){for(var Pr=arguments.length,Or=It(Pr),Xa=Pr;Xa--;)Or[Xa]=arguments[Xa];if(Ce)var na=Yu(Xe),Ha=is(Or,na);if(b&&(Or=xa(Or,b,z,Ce)),q&&(Or=Qh(Or,q,et,Ce)),Pr-=Ha,Ce&&Pr<Ot){var Ii=Lo(Or,na);return sp(a,c,Vo,Xe.placeholder,g,Or,Ii,lt,yt,Ot-Pr)}var Xs=Gt?g:this,fl=pe?Xs[a]:a;return Pr=Or.length,lt?Or=pp(Or,lt):We&&Pr>1&&Or.reverse(),Nt&&yt<Pr&&(Or.length=yt),this&&this!==Pn&&this instanceof Xe&&(fl=vr||ps(fl)),fl.apply(Xs,Or)}return Xe}function ip(a,c){return function(g,b){return us(g,a,c(b),{})}}function Vc(a,c){return function(g,b){var z;if(g===tt&&b===tt)return c;if(g!==tt&&(z=g),b!==tt){if(z===tt)return b;typeof g=="string"||typeof b=="string"?(g=wo(g),b=wo(b)):(g=Kh(g),b=Kh(b)),z=a(g,b)}return z}}function xh(a){return Ns(function(c){return c=Dr(c,Un(Fe())),cr(function(g){var b=this;return a(c,function(z){return mn(z,b,g)})})})}function _u(a,c){c=c===tt?" ":wo(c);var g=c.length;if(g<2)return g?dh(c,a):c;var b=dh(c,ze(a/ta(c)));return fa(c)?_a(vo(b),0,a).join(""):b.slice(0,a)}function op(a,c,g,b){var z=c&Zr,q=ps(a);function et(){for(var lt=-1,yt=arguments.length,Ot=-1,Nt=b.length,Gt=It(Nt+yt),pe=this&&this!==Pn&&this instanceof et?q:a;++Ot<Nt;)Gt[Ot]=b[Ot];for(;yt--;)Gt[Ot++]=arguments[++lt];return mn(pe,z?g:this,Gt)}return et}function ap(a){return function(c,g,b){return b&&typeof b!="number"&&si(c,g,b)&&(g=b=tt),c=Wa(c),g===tt?(g=c,c=0):g=Wa(g),b=b===tt?c<g?1:-1:Wa(b),af(c,g,b,a)}}function qc(a){return function(c,g){return typeof c=="string"&&typeof g=="string"||(c=Ta(c),g=Ta(g)),a(c,g)}}function sp(a,c,g,b,z,q,et,lt,yt,Ot){var Nt=c&Jn,Gt=Nt?et:tt,pe=Nt?tt:et,Ce=Nt?q:tt,We=Nt?tt:q;c|=Nt?Bn:ji,c&=~(Nt?ji:Bn),c&Zt||(c&=~(Zr|Zi));var vr=[a,c,z,Ce,Gt,We,pe,lt,yt,Ot],Xe=g.apply(tt,vr);return Ph(a)&&fp(Xe,vr),Xe.placeholder=b,Xc(Xe,a,c)}function bh(a){var c=jr[a];return function(g,b){if(g=Ta(g),b=b==null?0:Ee(ur(b),292),b&&Ir(g)){var z=(dr(g)+"e").split("e"),q=c(z[0]+"e"+(+z[1]+b));return z=(dr(q)+"e").split("e"),+(z[0]+"e"+(+z[1]-b))}return c(g)}}var up=Ci&&1/Do(new Ci([,-0]))[1]==Gi?function(a){return new Ci(a)}:Qf;function ki(a){return function(c){var g=eo(c);return g==An?hu(c):g==jn?Cs(c):go(c,a(c))}}function Us(a,c,g,b,z,q,et,lt){var yt=c&Zi;if(!yt&&typeof a!="function")throw new an(h);var Ot=b?b.length:0;if(Ot||(c&=~(Bn|ji),b=z=tt),et=et===tt?et:he(ur(et),0),lt=lt===tt?lt:ur(lt),Ot-=z?z.length:0,c&ji){var Nt=b,Gt=z;b=z=tt}var pe=yt?tt:Eh(a),Ce=[a,c,g,b,z,Nt,Gt,q,et,lt];if(pe&&kl(Ce,pe),a=Ce[0],c=Ce[1],g=Ce[2],b=Ce[3],z=Ce[4],lt=Ce[9]=Ce[9]===tt?yt?0:a.length:he(Ce[9]-Ot,0),!lt&&c&(Jn|_e)&&(c&=~(Jn|_e)),!c||c==Zr)var We=rp(a,c,g);else c==Jn||c==_e?We=pf(a,c,lt):(c==Bn||c==(Zr|Bn))&&!z.length?We=op(a,c,g,b):We=Vo.apply(tt,Ce);var vr=pe?Bs:fp;return Xc(vr(We,Ce),a,c)}function wh(a,c,g,b){return a===tt||fr(a,w[g])&&!H.call(b,g)?c:a}function Sh(a,c,g,b,z,q){return qr(a)&&qr(c)&&(q.set(c,a),cs(a,c,tt,Sh,q),q.delete(c)),a}function ff(a){return js(a)?tt:a}function Th(a,c,g,b,z,q){var et=g&Zn,lt=a.length,yt=c.length;if(lt!=yt&&!(et&&yt>lt))return!1;var Ot=q.get(a),Nt=q.get(c);if(Ot&&Nt)return Ot==c&&Nt==a;var Gt=-1,pe=!0,Ce=g&To?new m:tt;for(q.set(a,c),q.set(c,a);++Gt<lt;){var We=a[Gt],vr=c[Gt];if(b)var Xe=et?b(vr,We,Gt,c,a,q):b(We,vr,Gt,a,c,q);if(Xe!==tt){if(Xe)continue;pe=!1;break}if(Ce){if(!rs(c,function(Pr,Or){if(!As(Ce,Or)&&(We===Pr||z(We,Pr,g,b,q)))return Ce.push(Or)})){pe=!1;break}}else if(!(We===vr||z(We,vr,g,b,q))){pe=!1;break}}return q.delete(a),q.delete(c),pe}function df(a,c,g,b,z,q,et){switch(g){case Wo:if(a.byteLength!=c.byteLength||a.byteOffset!=c.byteOffset)return!1;a=a.buffer,c=c.buffer;case ia:return!(a.byteLength!=c.byteLength||!q(new le(a),new le(c)));case ci:case pr:case dn:return fr(+a,+c);case Eo:return a.name==c.name&&a.message==c.message;case Qn:case Ao:return a==c+"";case An:var lt=hu;case jn:var yt=b&Zn;if(lt||(lt=Do),a.size!=c.size&&!yt)return!1;var Ot=et.get(a);if(Ot)return Ot==c;b|=To,et.set(a,c);var Nt=Th(lt(a),lt(c),b,z,q,et);return et.delete(a),Nt;case pi:if(yn)return yn.call(a)==yn.call(c)}return!1}function mf(a,c,g,b,z,q){var et=g&Zn,lt=Zc(a),yt=lt.length,Ot=Zc(c),Nt=Ot.length;if(yt!=Nt&&!et)return!1;for(var Gt=yt;Gt--;){var pe=lt[Gt];if(!(et?pe in c:H.call(c,pe)))return!1}var Ce=q.get(a),We=q.get(c);if(Ce&&We)return Ce==c&&We==a;var vr=!0;q.set(a,c),q.set(c,a);for(var Xe=et;++Gt<yt;){pe=lt[Gt];var Pr=a[pe],Or=c[pe];if(b)var Xa=et?b(Or,Pr,pe,c,a,q):b(Pr,Or,pe,a,c,q);if(!(Xa===tt?Pr===Or||z(Pr,Or,g,b,q):Xa)){vr=!1;break}Xe||(Xe=pe=="constructor")}if(vr&&!Xe){var na=a.constructor,Ha=c.constructor;na!=Ha&&"constructor"in a&&"constructor"in c&&!(typeof na=="function"&&na instanceof na&&typeof Ha=="function"&&Ha instanceof Ha)&&(vr=!1)}return q.delete(a),q.delete(c),vr}function Ns(a){return hc(cc(a,tt,Qu),a+"")}function Zc(a){return oi(a,Ri,wu)}function Ih(a){return oi(a,So,Ah)}var Eh=vi?function(a){return vi.get(a)}:Qf;function xu(a){for(var c=a.name+"",g=_i[c],b=H.call(_i,c)?g.length:0;b--;){var z=g[b],q=z.func;if(q==null||q==a)return z.name}return c}function Yu(a){var c=H.call(F,"placeholder")?F:a;return c.placeholder}function Fe(){var a=F.iteratee||Jf;return a=a===Jf?bi:a,arguments.length?a(arguments[0],arguments[1]):a}function Ju(a,c){var g=a.__data__;return wf(c)?g[typeof c=="string"?"string":"hash"]:g.map}function Rr(a){for(var c=Ri(a),g=c.length;g--;){var b=c[g],z=a[b];c[g]=[b,z,Cl(z)]}return c}function bu(a,c){var g=os(a,c);return Uo(g)?g:tt}function Vs(a){var c=H.call(a,yr),g=a[yr];try{a[yr]=tt;var b=!0}catch{}var z=ot.call(a);return b&&(c?a[yr]=g:delete a[yr]),z}var wu=zn?function(a){return a==null?[]:(a=xe(a),ri(zn(a),function(c){return Ie.call(a,c)}))}:td,Ah=zn?function(a){for(var c=[];a;)mo(c,wu(a)),a=ge(a);return c}:td,eo=un;(Vn&&eo(new Vn(new ArrayBuffer(1)))!=Wo||ii&&eo(new ii)!=An||Xn&&eo(Xn.resolve())!=Ui||Ci&&eo(new Ci)!=jn||Kt&&eo(new Kt)!=uo)&&(eo=function(a){var c=un(a),g=c==Xi?a.constructor:tt,b=g?Tu(g):"";if(b)switch(b){case Va:return Wo;case $i:return An;case Bo:return Ui;case hh:return jn;case qa:return uo}return c});function gf(a,c,g){for(var b=-1,z=g.length;++b<z;){var q=g[b],et=q.size;switch(q.type){case"drop":a+=et;break;case"dropRight":c-=et;break;case"take":c=Ee(c,a+et);break;case"takeRight":a=he(a,c-et);break}}return{start:a,end:c}}function yf(a){var c=a.match(Lt);return c?c[1].split(Wt):[]}function lp(a,c,g){c=Os(c,a);for(var b=-1,z=c.length,q=!1;++b<z;){var et=wa(c[b]);if(!(q=a!=null&&g(a,et)))break;a=a[et]}return q||++b!=z?q:(z=a==null?0:a.length,!!z&&al(z)&&ba(et,z)&&(Ne(a)||Qe(a)))}function vf(a){var c=a.length,g=new a.constructor(c);return c&&typeof a[0]=="string"&&H.call(a,"index")&&(g.index=a.index,g.input=a.input),g}function cp(a){return typeof a.constructor=="function"&&!Su(a)?Qi(ge(a)):{}}function _f(a,c,g){var b=a.constructor;switch(c){case ia:return gh(a);case ci:case pr:return new b(+a);case Wo:return lc(a,g);case Aa:case Pa:case oa:case $a:case co:case Ca:case Po:case za:case ka:return $h(a,g);case An:return new b;case dn:case Ao:return new b(a);case Qn:return cf(a);case jn:return new b;case pi:return yh(a)}}function xf(a,c){var g=c.length;if(!g)return a;var b=g-1;return c[b]=(g>1?"& ":"")+c[b],c=c.join(g>2?", ":" "),a.replace(Y,`{
/* [wrapped with `+c+`] */
`)}function bf(a){return Ne(a)||Qe(a)||!!(Tr&&a&&a[Tr])}function ba(a,c){var g=typeof a;return c=c==null?Bi:c,!!c&&(g=="number"||g!="symbol"&&Le.test(a))&&a>-1&&a%1==0&&a<c}function si(a,c,g){if(!qr(g))return!1;var b=typeof c;return(b=="number"?Rn(g)&&ba(c,g.length):b=="string"&&c in g)?fr(g[c],a):!1}function jc(a,c){if(Ne(a))return!1;var g=typeof a;return g=="number"||g=="symbol"||g=="boolean"||a==null||no(a)?!0:N.test(a)||!L.test(a)||c!=null&&a in xe(c)}function wf(a){var c=typeof a;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?a!=="__proto__":a===null}function Ph(a){var c=xu(a),g=F[c];if(typeof g!="function"||!(c in er.prototype))return!1;if(a===g)return!0;var b=Eh(g);return!!b&&a===b[0]}function Sf(a){return!!ut&&ut in a}var hp=P?ra:ed;function Su(a){var c=a&&a.constructor,g=typeof c=="function"&&c.prototype||w;return a===g}function Cl(a){return a===a&&!qr(a)}function zl(a,c){return function(g){return g==null?!1:g[a]===c&&(c!==tt||a in xe(g))}}function qo(a){var c=Nr(a,function(b){return g.size===En&&g.clear(),b}),g=c.cache;return c}function kl(a,c){var g=a[1],b=c[1],z=g|b,q=z<(Zr|Zi|Ai),et=b==Ai&&g==Jn||b==Ai&&g==oo&&a[7].length<=c[8]||b==(Ai|oo)&&c[7].length<=c[8]&&g==Jn;if(!(q||et))return a;b&Zr&&(a[2]=c[2],z|=g&Zr?0:Zt);var lt=c[3];if(lt){var yt=a[3];a[3]=yt?xa(yt,lt,c[4]):lt,a[4]=yt?Lo(a[3],Te):c[4]}return lt=c[5],lt&&(yt=a[5],a[5]=yt?Qh(yt,lt,c[6]):lt,a[6]=yt?Lo(a[5],Te):c[6]),lt=c[7],lt&&(a[7]=lt),b&Ai&&(a[8]=a[8]==null?c[8]:Ee(a[8],c[8])),a[9]==null&&(a[9]=c[9]),a[0]=c[0],a[1]=z,a}function Mi(a){var c=[];if(a!=null)for(var g in xe(a))c.push(g);return c}function Gc(a){return ot.call(a)}function cc(a,c,g){return c=he(c===tt?a.length-1:c,0),function(){for(var b=arguments,z=-1,q=he(b.length-c,0),et=It(q);++z<q;)et[z]=b[c+z];z=-1;for(var lt=It(c+1);++z<c;)lt[z]=b[z];return lt[c]=g(et),mn(a,this,lt)}}function ro(a,c){return c.length<2?a:Vr(a,va(c,0,-1))}function pp(a,c){for(var g=a.length,b=Ee(c.length,g),z=No(a);b--;){var q=c[b];a[b]=ba(q,g)?z[q]:tt}return a}function Wc(a,c){if(!(c==="constructor"&&typeof a[c]=="function")&&c!="__proto__")return a[c]}var fp=dp(Bs),Ml=De||function(a,c){return Pn.setTimeout(a,c)},hc=dp(ac);function Xc(a,c,g){var b=c+"";return hc(a,xf(b,mp(yf(b),g)))}function dp(a){var c=0,g=0;return function(){var b=Wn(),z=Jr-(b-g);if(g=b,z>0){if(++c>=Ka)return arguments[0]}else c=0;return a.apply(tt,arguments)}}function pc(a,c){var g=-1,b=a.length,z=b-1;for(c=c===tt?b:c;++g<c;){var q=fh(g,z),et=a[q];a[q]=a[g],a[g]=et}return a.length=c,a}var $u=qo(function(a){var c=[];return a.charCodeAt(0)===46&&c.push(""),a.replace(X,function(g,b,z,q){c.push(z?q.replace(ee,"$1"):b||g)}),c});function wa(a){if(typeof a=="string"||no(a))return a;var c=a+"";return c=="0"&&1/a==-Gi?"-0":c}function Tu(a){if(a!=null){try{return D.call(a)}catch{}try{return a+""}catch{}}return""}function mp(a,c){return Cn(Go,function(g){var b="_."+g[0];c&g[1]&&!Es(a,b)&&a.push(b)}),a.sort()}function gp(a){if(a instanceof er)return a.clone();var c=new Ni(a.__wrapped__,a.__chain__);return c.__actions__=No(a.__actions__),c.__index__=a.__index__,c.__values__=a.__values__,c}function yp(a,c,g){(g?si(a,c,g):c===tt)?c=1:c=he(ur(c),0);var b=a==null?0:a.length;if(!b||c<1)return[];for(var z=0,q=0,et=It(ze(b/c));z<b;)et[q++]=va(a,z,z+=c);return et}function vp(a){for(var c=-1,g=a==null?0:a.length,b=0,z=[];++c<g;){var q=a[c];q&&(z[b++]=q)}return z}function _p(){var a=arguments.length;if(!a)return[];for(var c=It(a-1),g=arguments[0],b=a;b--;)c[b-1]=arguments[b];return mo(Ne(g)?No(g):[g],ie(c,1))}var xp=cr(function(a,c){return tr(a)?te(a,ie(c,1,tr,!0)):[]}),Tf=cr(function(a,c){var g=Sa(c);return tr(g)&&(g=tt),tr(a)?te(a,ie(c,1,tr,!0),Fe(g,2)):[]}),If=cr(function(a,c){var g=Sa(c);return tr(g)&&(g=tt),tr(a)?te(a,ie(c,1,tr,!0),tt,g):[]});function bp(a,c,g){var b=a==null?0:a.length;return b?(c=g||c===tt?1:ur(c),va(a,c<0?0:c,b)):[]}function wp(a,c,g){var b=a==null?0:a.length;return b?(c=g||c===tt?1:ur(c),c=b-c,va(a,0,c<0?0:c)):[]}function Hc(a,c){return a&&a.length?cn(a,Fe(c,3),!0,!0):[]}function Sp(a,c){return a&&a.length?cn(a,Fe(c,3),!0):[]}function Kc(a,c,g,b){var z=a==null?0:a.length;return z?(g&&typeof g!="number"&&si(a,c,g)&&(g=0,b=z),ke(a,c,g,b)):[]}function fc(a,c,g){var b=a==null?0:a.length;if(!b)return-1;var z=g==null?0:ur(g);return z<0&&(z=he(b+z,0)),Yo(a,Fe(c,3),z)}function dc(a,c,g){var b=a==null?0:a.length;if(!b)return-1;var z=b-1;return g!==tt&&(z=ur(g),z=g<0?he(b+z,0):Ee(z,b-1)),Yo(a,Fe(c,3),z,!0)}function Qu(a){var c=a==null?0:a.length;return c?ie(a,1):[]}function Ef(a){var c=a==null?0:a.length;return c?ie(a,Gi):[]}function Af(a,c){var g=a==null?0:a.length;return g?(c=c===tt?1:ur(c),ie(a,c)):[]}function Pf(a){for(var c=-1,g=a==null?0:a.length,b={};++c<g;){var z=a[c];b[z[0]]=z[1]}return b}function tl(a){return a&&a.length?a[0]:tt}function Ch(a,c,g){var b=a==null?0:a.length;if(!b)return-1;var z=g==null?0:ur(g);return z<0&&(z=he(b+z,0)),Fa(a,c,z)}function Tp(a){var c=a==null?0:a.length;return c?va(a,0,-1):[]}var zh=cr(function(a){var c=Dr(a,Il);return c.length&&c[0]===a[0]?Zu(c):[]}),Ip=cr(function(a){var c=Sa(a),g=Dr(a,Il);return c===Sa(g)?c=tt:g.pop(),g.length&&g[0]===a[0]?Zu(g,Fe(c,2)):[]}),Ep=cr(function(a){var c=Sa(a),g=Dr(a,Il);return c=typeof c=="function"?c:tt,c&&g.pop(),g.length&&g[0]===a[0]?Zu(g,tt,c):[]});function Cf(a,c){return a==null?"":or.call(a,c)}function Sa(a){var c=a==null?0:a.length;return c?a[c-1]:tt}function zf(a,c,g){var b=a==null?0:a.length;if(!b)return-1;var z=b;return g!==tt&&(z=ur(g),z=z<0?he(b+z,0):Ee(z,b-1)),c===c?bl(a,c,z):Yo(a,Jo,z,!0)}function Yc(a,c){return a&&a.length?ph(a,ur(c)):tt}var kh=cr(Ap);function Ap(a,c){return a&&a.length&&c&&c.length?Lc(a,c):a}function Ll(a,c,g){return a&&a.length&&c&&c.length?Lc(a,c,Fe(g,2)):a}function mc(a,c,g){return a&&a.length&&c&&c.length?Lc(a,c,tt,g):a}var kr=Ns(function(a,c){var g=a==null?0:a.length,b=Ut(a,c);return Xh(a,Dr(c,function(z){return ba(z,g)?+z:z}).sort(Uc)),b});function kf(a,c){var g=[];if(!(a&&a.length))return g;var b=-1,z=[],q=a.length;for(c=Fe(c,3);++b<q;){var et=a[b];c(et,b,a)&&(g.push(et),z.push(b))}return Xh(a,z),g}function gc(a){return a==null?a:Ro.call(a)}function Dl(a,c,g){var b=a==null?0:a.length;return b?(g&&typeof g!="number"&&si(a,c,g)?(c=0,g=b):(c=c==null?0:ur(c),g=g===tt?b:ur(g)),va(a,c,g)):[]}function Mf(a,c){return Rc(a,c)}function Lf(a,c,g){return mh(a,c,Fe(g,2))}function Df(a,c){var g=a==null?0:a.length;if(g){var b=Rc(a,c);if(b<g&&fr(a[b],c))return b}return-1}function Rf(a,c){return Rc(a,c,!0)}function Bf(a,c,g){return mh(a,c,Fe(g,2),!0)}function Of(a,c){var g=a==null?0:a.length;if(g){var b=Rc(a,c,!0)-1;if(fr(a[b],c))return b}return-1}function Ff(a){return a&&a.length?Hh(a):[]}function Pp(a,c){return a&&a.length?Hh(a,Fe(c,2)):[]}function Cp(a){var c=a==null?0:a.length;return c?va(a,1,c):[]}function zp(a,c,g){return a&&a.length?(c=g||c===tt?1:ur(c),va(a,0,c<0?0:c)):[]}function kp(a,c,g){var b=a==null?0:a.length;return b?(c=g||c===tt?1:ur(c),c=b-c,va(a,c<0?0:c,b)):[]}function Jc(a,c){return a&&a.length?cn(a,Fe(c,3),!1,!0):[]}function el(a,c){return a&&a.length?cn(a,Fe(c,3)):[]}var Mh=cr(function(a){return yu(ie(a,1,tr,!0))}),Rl=cr(function(a){var c=Sa(a);return tr(c)&&(c=tt),yu(ie(a,1,tr,!0),Fe(c,2))}),Mp=cr(function(a){var c=Sa(a);return c=typeof c=="function"?c:tt,yu(ie(a,1,tr,!0),tt,c)});function Mn(a){return a&&a.length?yu(a):[]}function Hr(a,c){return a&&a.length?yu(a,Fe(c,2)):[]}function Lp(a,c){return c=typeof c=="function"?c:tt,a&&a.length?yu(a,tt,c):[]}function $c(a){if(!(a&&a.length))return[];var c=0;return a=ri(a,function(g){if(tr(g))return c=he(g.length,c),!0}),nr(c,function(g){return Dr(a,pa(g))})}function Lh(a,c){if(!(a&&a.length))return[];var g=$c(a);return c==null?g:Dr(g,function(b){return mn(c,tt,b)})}var Dp=cr(function(a,c){return tr(a)?te(a,c):[]}),Rp=cr(function(a){return Bc(ri(a,tr))}),Dh=cr(function(a){var c=Sa(a);return tr(c)&&(c=tt),Bc(ri(a,tr),Fe(c,2))}),rl=cr(function(a){var c=Sa(a);return c=typeof c=="function"?c:tt,Bc(ri(a,tr),tt,c)}),nl=cr($c);function Bp(a,c){return uc(a||[],c||[],ht)}function Ln(a,c){return uc(a||[],c||[],Tl)}var yc=cr(function(a){var c=a.length,g=c>1?a[c-1]:tt;return g=typeof g=="function"?(a.pop(),g):tt,Lh(a,g)});function fs(a){var c=F(a);return c.__chain__=!0,c}function Qc(a,c){return c(a),a}function il(a,c){return c(a)}var Rh=Ns(function(a){var c=a.length,g=c?a[0]:0,b=this.__wrapped__,z=function(q){return Ut(q,a)};return c>1||this.__actions__.length||!(b instanceof er)||!ba(g)?this.thru(z):(b=b.slice(g,+g+(c?1:0)),b.__actions__.push({func:il,args:[z],thisArg:tt}),new Ni(b,this.__chain__).thru(function(q){return c&&!q.length&&q.push(tt),q}))});function Bl(){return fs(this)}function qs(){return new Ni(this.value(),this.__chain__)}function Op(){this.__values__===tt&&(this.__values__=Oh(this.value()));var a=this.__index__>=this.__values__.length,c=a?tt:this.__values__[this.__index__++];return{done:a,value:c}}function Fp(){return this}function Uf(a){for(var c,g=this;g instanceof xi;){var b=gp(g);b.__index__=0,b.__values__=tt,c?z.__wrapped__=b:c=b;var z=b;g=g.__wrapped__}return z.__wrapped__=a,c}function Hn(){var a=this.__wrapped__;if(a instanceof er){var c=a;return this.__actions__.length&&(c=new er(this)),c=c.reverse(),c.__actions__.push({func:il,args:[gc],thisArg:tt}),new Ni(c,this.__chain__)}return this.thru(gc)}function Iu(){return sc(this.__wrapped__,this.__actions__)}var Up=Fs(function(a,c,g){H.call(a,g)?++a[g]:Vt(a,g,1)});function t(a,c,g){var b=Ne(a)?Ji:Re;return g&&si(a,c,g)&&(c=tt),b(a,Fe(c,3))}function e(a,c){var g=Ne(a)?ri:Ae;return g(a,Fe(c,3))}var r=Nc(fc),s=Nc(dc);function l(a,c){return ie(R(a,c),1)}function p(a,c){return ie(R(a,c),Gi)}function d(a,c,g){return g=g===tt?1:ur(g),ie(R(a,c),g)}function v(a,c){var g=Ne(a)?Cn:Se;return g(a,Fe(c,3))}function x(a,c){var g=Ne(a)?Oa:Ze;return g(a,Fe(c,3))}var S=Fs(function(a,c,g){H.call(a,g)?a[g].push(c):Vt(a,g,[c])});function I(a,c,g,b){a=Rn(a)?a:pl(a),g=g&&!b?ur(g):0;var z=a.length;return g<0&&(g=he(z+g,0)),Gs(a)?g<=z&&a.indexOf(c,g)>-1:!!z&&Fa(a,c,g)>-1}var E=cr(function(a,c,g){var b=-1,z=typeof c=="function",q=Rn(a)?It(a.length):[];return Se(a,function(et){q[++b]=z?mn(c,et,g):ya(et,c,g)}),q}),k=Fs(function(a,c,g){Vt(a,g,c)});function R(a,c){var g=Ne(a)?Dr:Gu;return g(a,Fe(c,3))}function Z(a,c,g,b){return a==null?[]:(Ne(c)||(c=c==null?[]:[c]),g=b?tt:g,Ne(g)||(g=g==null?[]:[g]),Mc(a,c,g))}var j=Fs(function(a,c,g){a[g?0:1].push(c)},function(){return[[],[]]});function it(a,c,g){var b=Ne(a)?au:Qo,z=arguments.length<3;return b(a,Fe(c,4),g,z,Se)}function J(a,c,g){var b=Ne(a)?_l:Qo,z=arguments.length<3;return b(a,Fe(c,4),g,z,Ze)}function pt(a,c){var g=Ne(a)?ri:Ae;return g(a,Kr(Fe(c,3)))}function dt(a){var c=Ne(a)?Q:sf;return c(a)}function _t(a,c,g){(g?si(a,c,g):c===tt)?c=1:c=ur(c);var b=Ne(a)?G:Dc;return b(a,c)}function xt(a){var c=Ne(a)?$:uf;return c(a)}function Pt(a){if(a==null)return 0;if(Rn(a))return Gs(a)?ta(a):a.length;var c=eo(a);return c==An||c==jn?a.size:Rs(a).length}function qt(a,c,g){var b=Ne(a)?rs:lf;return g&&si(a,c,g)&&(c=tt),b(a,Fe(c,3))}var Yt=cr(function(a,c){if(a==null)return[];var g=c.length;return g>1&&si(a,c[0],c[1])?c=[]:g>2&&si(c[0],c[1],c[2])&&(c=[c[0]]),Mc(a,ie(c,1),[])}),se=Xt||function(){return Pn.Date.now()};function $t(a,c){if(typeof c!="function")throw new an(h);return a=ur(a),function(){if(--a<1)return c.apply(this,arguments)}}function fe(a,c,g){return c=g?tt:c,c=a&&c==null?a.length:c,Us(a,Ai,tt,tt,tt,tt,c)}function Qt(a,c){var g;if(typeof c!="function")throw new an(h);return a=ur(a),function(){return--a>0&&(g=c.apply(this,arguments)),a<=1&&(c=tt),g}}var Ue=cr(function(a,c,g){var b=Zr;if(g.length){var z=Lo(g,Yu(Ue));b|=Bn}return Us(a,b,c,g,z)}),be=cr(function(a,c,g){var b=Zr|Zi;if(g.length){var z=Lo(g,Yu(be));b|=Bn}return Us(c,b,a,g,z)});function ue(a,c,g){c=g?tt:c;var b=Us(a,Jn,tt,tt,tt,tt,tt,c);return b.placeholder=ue.placeholder,b}function Ge(a,c,g){c=g?tt:c;var b=Us(a,_e,tt,tt,tt,tt,tt,c);return b.placeholder=Ge.placeholder,b}function Be(a,c,g){var b,z,q,et,lt,yt,Ot=0,Nt=!1,Gt=!1,pe=!0;if(typeof a!="function")throw new an(h);c=Ta(c)||0,qr(g)&&(Nt=!!g.leading,Gt="maxWait"in g,q=Gt?he(Ta(g.maxWait)||0,c):q,pe="trailing"in g?!!g.trailing:pe);function Ce(Ii){var Xs=b,fl=z;return b=z=tt,Ot=Ii,et=a.apply(fl,Xs),et}function We(Ii){return Ot=Ii,lt=Ml(Pr,c),Nt?Ce(Ii):et}function vr(Ii){var Xs=Ii-yt,fl=Ii-Ot,ad=c-Xs;return Gt?Ee(ad,q-fl):ad}function Xe(Ii){var Xs=Ii-yt,fl=Ii-Ot;return yt===tt||Xs>=c||Xs<0||Gt&&fl>=q}function Pr(){var Ii=se();if(Xe(Ii))return Or(Ii);lt=Ml(Pr,vr(Ii))}function Or(Ii){return lt=tt,pe&&b?Ce(Ii):(b=z=tt,et)}function Xa(){lt!==tt&&Oc(lt),Ot=0,b=yt=z=lt=tt}function na(){return lt===tt?et:Or(se())}function Ha(){var Ii=se(),Xs=Xe(Ii);if(b=arguments,z=this,yt=Ii,Xs){if(lt===tt)return We(yt);if(Gt)return Oc(lt),lt=Ml(Pr,c),Ce(yt)}return lt===tt&&(lt=Ml(Pr,c)),et}return Ha.cancel=Xa,Ha.flush=na,Ha}var sr=cr(function(a,c){return ar(a,1,c)}),me=cr(function(a,c,g){return ar(a,Ta(c)||0,g)});function gr(a){return Us(a,On)}function Nr(a,c){if(typeof a!="function"||c!=null&&typeof c!="function")throw new an(h);var g=function(){var b=arguments,z=c?c.apply(this,b):b[0],q=g.cache;if(q.has(z))return q.get(z);var et=a.apply(this,b);return g.cache=q.set(z,et)||q,et};return g.cache=new(Nr.Cache||Fo),g}Nr.Cache=Fo;function Kr(a){if(typeof a!="function")throw new an(h);return function(){var c=arguments;switch(c.length){case 0:return!a.call(this);case 1:return!a.call(this,c[0]);case 2:return!a.call(this,c[0],c[1]);case 3:return!a.call(this,c[0],c[1],c[2])}return!a.apply(this,c)}}function rn(a){return Qt(2,a)}var Yr=Jh(function(a,c){c=c.length==1&&Ne(c[0])?Dr(c[0],Un(Fe())):Dr(ie(c,1),Un(Fe()));var g=c.length;return cr(function(b){for(var z=-1,q=Ee(b.length,g);++z<q;)b[z]=c[z].call(this,b[z]);return mn(a,this,b)})}),tn=cr(function(a,c){var g=Lo(c,Yu(tn));return Us(a,Bn,tt,c,g)}),Dn=cr(function(a,c){var g=Lo(c,Yu(Dn));return Us(a,ji,tt,c,g)}),qn=Ns(function(a,c){return Us(a,oo,tt,tt,tt,c)});function Li(a,c){if(typeof a!="function")throw new an(h);return c=c===tt?c:ur(c),cr(a,c)}function Kn(a,c){if(typeof a!="function")throw new an(h);return c=c==null?0:he(ur(c),0),cr(function(g){var b=g[c],z=_a(g,0,c);return b&&mo(z,b),mn(a,this,z)})}function Di(a,c,g){var b=!0,z=!0;if(typeof a!="function")throw new an(h);return qr(g)&&(b="leading"in g?!!g.leading:b,z="trailing"in g?!!g.trailing:z),Be(a,c,{leading:b,maxWait:c,trailing:z})}function xn(a){return fe(a,1)}function Yn(a,c){return tn(Ku(c),a)}function $e(){if(!arguments.length)return[];var a=arguments[0];return Ne(a)?a:[a]}function Br(a){return ae(a,je)}function Ar(a,c){return c=typeof c=="function"?c:tt,ae(a,je,c)}function hr(a){return ae(a,pn|je)}function qi(a,c){return c=typeof c=="function"?c:tt,ae(a,pn|je,c)}function wi(a,c){return c==null||de(a,c,Ri(c))}function fr(a,c){return a===c||a!==a&&c!==c}var In=qc(ai),Si=qc(function(a,c){return a>=c}),Qe=ls(function(){return arguments}())?ls:function(a){return hn(a)&&H.call(a,"callee")&&!Ie.call(a,"callee")},Ne=It.isArray,Zo=ca?Un(ca):ju;function Rn(a){return a!=null&&al(a.length)&&!ra(a)}function tr(a){return hn(a)&&Rn(a)}function ds(a){return a===!0||a===!1||hn(a)&&un(a)==ci}var Ti=Xr||ed,Ol=ei?Un(ei):mu;function ol(a){return hn(a)&&a.nodeType===1&&!js(a)}function Fl(a){if(a==null)return!0;if(Rn(a)&&(Ne(a)||typeof a=="string"||typeof a.splice=="function"||Ti(a)||Ga(a)||Qe(a)))return!a.length;var c=eo(a);if(c==An||c==jn)return!a.size;if(Su(a))return!Rs(a).length;for(var g in a)if(H.call(a,g))return!1;return!0}function Zs(a,c){return to(a,c)}function Ul(a,c,g){g=typeof g=="function"?g:tt;var b=g?g(a,c):tt;return b===tt?to(a,c,tt,g):!!b}function Nl(a){if(!hn(a))return!1;var c=un(a);return c==Eo||c==Wi||typeof a.message=="string"&&typeof a.name=="string"&&!js(a)}function Vl(a){return typeof a=="number"&&Ir(a)}function ra(a){if(!qr(a))return!1;var c=un(a);return c==hi||c==He||c==$n||c==Ja}function vc(a){return typeof a=="number"&&a==ur(a)}function al(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=Bi}function qr(a){var c=typeof a;return a!=null&&(c=="object"||c=="function")}function hn(a){return a!=null&&typeof a=="object"}var sl=Sn?Un(Sn):kn;function Eu(a,c){return a===c||ea(a,c,Rr(c))}function ql(a,c,g){return g=typeof g=="function"?g:tt,ea(a,c,Rr(c),g)}function th(a){return bc(a)&&a!=+a}function eh(a){if(hp(a))throw new qe(Au);return Uo(a)}function _c(a){return a===null}function xc(a){return a==null}function bc(a){return typeof a=="number"||hn(a)&&un(a)==dn}function js(a){if(!hn(a)||un(a)!=Xi)return!1;var c=ge(a);if(c===null)return!0;var g=H.call(c,"constructor")&&c.constructor;return typeof g=="function"&&g instanceof g&&D.call(g)==wt}var ul=Is?Un(Is):Ds;function wc(a){return vc(a)&&a>=-Bi&&a<=Bi}var Sc=ko?Un(ko):_n;function Gs(a){return typeof a=="string"||!Ne(a)&&hn(a)&&un(a)==Ao}function no(a){return typeof a=="symbol"||hn(a)&&un(a)==pi}var Ga=Ho?Un(Ho):ln;function Tc(a){return a===tt}function ll(a){return hn(a)&&eo(a)==uo}function Ic(a){return hn(a)&&un(a)==lo}var Zl=qc(ic),Bh=qc(function(a,c){return a<=c});function Oh(a){if(!a)return[];if(Rn(a))return Gs(a)?vo(a):No(a);if(Qr&&a[Qr])return yo(a[Qr]());var c=eo(a),g=c==An?hu:c==jn?Do:pl;return g(a)}function Wa(a){if(!a)return a===0?a:0;if(a=Ta(a),a===Gi||a===-Gi){var c=a<0?-1:1;return c*Ys}return a===a?a:0}function ur(a){var c=Wa(a),g=c%1;return c===c?g?c-g:c:0}function rh(a){return a?Jt(ur(a),0,fn):0}function Ta(a){if(typeof a=="number")return a;if(no(a))return so;if(qr(a)){var c=typeof a.valueOf=="function"?a.valueOf():a;a=qr(c)?c+"":c}if(typeof a!="string")return a===0?a:+a;a=Du(a);var g=Ht.test(a);return g||Me.test(a)?Ql(a.slice(2),g?2:8):At.test(a)?so:+a}function jl(a){return hs(a,So(a))}function bn(a){return a?Jt(ur(a),-Bi,Bi):a===0?a:0}function dr(a){return a==null?"":wo(a)}var Nf=El(function(a,c){if(Su(c)||Rn(c)){hs(c,Ri(c),a);return}for(var g in c)H.call(c,g)&&ht(a,g,c[g])}),Ws=El(function(a,c){hs(c,So(c),a)}),Gl=El(function(a,c,g,b){hs(c,So(c),a,b)}),Np=El(function(a,c,g,b){hs(c,Ri(c),a,b)}),nh=Ns(Ut);function ms(a,c){var g=Qi(a);return c==null?g:Tt(g,c)}var ih=cr(function(a,c){a=xe(a);var g=-1,b=c.length,z=b>2?c[2]:tt;for(z&&si(c[0],c[1],z)&&(b=1);++g<b;)for(var q=c[g],et=So(q),lt=-1,yt=et.length;++lt<yt;){var Ot=et[lt],Nt=a[Ot];(Nt===tt||fr(Nt,w[Ot])&&!H.call(a,Ot))&&(a[Ot]=q[Ot])}return a}),Ec=cr(function(a){return a.push(tt,Sh),mn(hl,tt,a)});function oh(a,c){return Mo(a,Fe(c,3),en)}function ah(a,c){return Mo(a,Fe(c,3),Tn)}function Fh(a,c){return a==null?a:Er(a,Fe(c,3),So)}function Vp(a,c){return a==null?a:sn(a,Fe(c,3),So)}function Ac(a,c){return a&&en(a,Fe(c,3))}function qp(a,c){return a&&Tn(a,Fe(c,3))}function Zp(a){return a==null?[]:vn(a,Ri(a))}function jp(a){return a==null?[]:vn(a,So(a))}function sh(a,c,g){var b=a==null?tt:Vr(a,c);return b===tt?g:b}function Gp(a,c){return a!=null&&lp(a,c,zi)}function io(a,c){return a!=null&&lp(a,c,ga)}var uh=ip(function(a,c,g){c!=null&&typeof c.toString!="function"&&(c=ot.call(c)),a[c]=g},Yf(Ia)),Wp=ip(function(a,c,g){c!=null&&typeof c.toString!="function"&&(c=ot.call(c)),H.call(a,c)?a[c].push(g):a[c]=[g]},Fe),gs=cr(ya);function Ri(a){return Rn(a)?W(a):Rs(a)}function So(a){return Rn(a)?W(a,!0):Sl(a)}function cl(a,c){var g={};return c=Fe(c,3),en(a,function(b,z,q){Vt(g,c(b,z,q),b)}),g}function Wl(a,c){var g={};return c=Fe(c,3),en(a,function(b,z,q){Vt(g,z,c(b,z,q))}),g}var Xl=El(function(a,c,g){cs(a,c,g)}),hl=El(function(a,c,g,b){cs(a,c,g,b)}),Hl=Ns(function(a,c){var g={};if(a==null)return g;var b=!1;c=Dr(c,function(q){return q=Os(q,a),b||(b=q.length>1),q}),hs(a,Ih(a),g),b&&(g=ae(g,pn|Et|je,ff));for(var z=c.length;z--;)vu(g,c[z]);return g});function Xp(a,c){return Uh(a,Kr(Fe(c)))}var Hp=Ns(function(a,c){return a==null?{}:Hu(a,c)});function Uh(a,c){if(a==null)return{};var g=Dr(Ih(a),function(b){return[b]});return c=Fe(c),Vi(a,g,function(b,z){return c(b,z[0])})}function Kp(a,c,g){c=Os(c,a);var b=-1,z=c.length;for(z||(z=1,a=tt);++b<z;){var q=a==null?tt:a[wa(c[b])];q===tt&&(b=z,q=g),a=ra(q)?q.call(a):q}return a}function Nh(a,c,g){return a==null?a:Tl(a,c,g)}function Vh(a,c,g,b){return b=typeof b=="function"?b:tt,a==null?a:Tl(a,c,g,b)}var ys=ki(Ri),qh=ki(So);function Zh(a,c,g){var b=Ne(a),z=b||Ti(a)||Ga(a);if(c=Fe(c,4),g==null){var q=a&&a.constructor;z?g=b?new q:[]:qr(a)?g=ra(q)?Qi(ge(a)):{}:g={}}return(z?Cn:en)(a,function(et,lt,yt){return c(g,et,lt,yt)}),g}function jh(a,c){return a==null?!0:vu(a,c)}function Yp(a,c,g){return a==null?a:Yh(a,c,Ku(g))}function Gh(a,c,g,b){return b=typeof b=="function"?b:tt,a==null?a:Yh(a,c,Ku(g),b)}function pl(a){return a==null?[]:Ru(a,Ri(a))}function Jp(a){return a==null?[]:Ru(a,So(a))}function Wh(a,c,g){return g===tt&&(g=c,c=tt),g!==tt&&(g=Ta(g),g=g===g?g:0),c!==tt&&(c=Ta(c),c=c===c?c:0),Jt(Ta(a),c,g)}function $p(a,c,g){return c=Wa(c),g===tt?(g=c,c=0):g=Wa(g),a=Ta(a),bo(a,c,g)}function Pc(a,c,g){if(g&&typeof g!="boolean"&&si(a,c,g)&&(c=g=tt),g===tt&&(typeof c=="boolean"?(g=c,c=tt):typeof a=="boolean"&&(g=a,a=tt)),a===tt&&c===tt?(a=0,c=1):(a=Wa(a),c===tt?(c=a,a=0):c=Wa(c)),a>c){var b=a;a=c,c=b}if(g||a%1||c%1){var z=ni();return Ee(a+z*(c-a+$l("1e-"+((z+"").length-1))),c)}return fh(a,c)}var Qp=Al(function(a,c,g){return c=c.toLowerCase(),a+(g?Cc(c):c)});function Cc(a){return Kf(dr(a).toLowerCase())}function tf(a){return a=dr(a),a&&a.replace(ne,lu).replace(ru,"")}function ef(a,c,g){a=dr(a),c=wo(c);var b=a.length;g=g===tt?b:Jt(ur(g),0,b);var z=g;return g-=c.length,g>=0&&a.slice(g,z)==c}function Vf(a){return a=dr(a),a&&Qa.test(a)?a.replace(Co,cu):a}function qf(a){return a=dr(a),a&&st.test(a)?a.replace(rt,"\\$&"):a}var Zf=Al(function(a,c,g){return a+(g?"-":"")+c.toLowerCase()}),jf=Al(function(a,c,g){return a+(g?" ":"")+c.toLowerCase()}),Gf=np("toLowerCase");function Wf(a,c,g){a=dr(a),c=ur(c);var b=c?ta(a):0;if(!c||b>=c)return a;var z=(c-b)/2;return _u(Oe(z),g)+a+_u(ze(z),g)}function Xf(a,c,g){a=dr(a),c=ur(c);var b=c?ta(a):0;return c&&b<c?a+_u(c-b,g):a}function Hf(a,c,g){a=dr(a),c=ur(c);var b=c?ta(a):0;return c&&b<c?_u(c-b,g)+a:a}function vs(a,c,g){return g||c==null?c=0:c&&(c=+c),Nn(dr(a).replace(nt,""),c||0)}function lh(a,c,g){return(g?si(a,c,g):c===tt)?c=1:c=ur(c),dh(dr(a),c)}function rf(){var a=arguments,c=dr(a[0]);return a.length<3?c:c.replace(a[1],a[2])}var zc=Al(function(a,c,g){return a+(g?"_":"")+c.toLowerCase()});function nf(a,c,g){return g&&typeof g!="number"&&si(a,c,g)&&(c=g=tt),g=g===tt?fn:g>>>0,g?(a=dr(a),a&&(typeof c=="string"||c!=null&&!ul(c))&&(c=wo(c),!c&&fa(a))?_a(vo(a),0,g):a.split(c,g)):[]}var ld=Al(function(a,c,g){return a+(g?" ":"")+Kf(c)});function cd(a,c,g){return a=dr(a),g=g==null?0:Jt(ur(g),0,a.length),c=wo(c),a.slice(g,g+c.length)==c}function hd(a,c,g){var b=F.templateSettings;g&&si(a,c,g)&&(c=tt),a=dr(a),c=Gl({},c,b,wh);var z=Gl({},c.imports,b.imports,wh),q=Ri(z),et=Ru(z,q),lt,yt,Ot=0,Nt=c.interpolate||_r,Gt="__p += '",pe=Ke((c.escape||_r).source+"|"+Nt.source+"|"+(Nt===M?re:_r).source+"|"+(c.evaluate||_r).source+"|$","g"),Ce="//# sourceURL="+(H.call(c,"sourceURL")?(c.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ua+"]")+`
`;a.replace(pe,function(Xe,Pr,Or,Xa,na,Ha){return Or||(Or=Xa),Gt+=a.slice(Ot,Ha).replace(we,Ua),Pr&&(lt=!0,Gt+=`' +
__e(`+Pr+`) +
'`),na&&(yt=!0,Gt+=`';
`+na+`;
__p += '`),Or&&(Gt+=`' +
((__t = (`+Or+`)) == null ? '' : __t) +
'`),Ot=Ha+Xe.length,Xe}),Gt+=`';
`;var We=H.call(c,"variable")&&c.variable;if(!We)Gt=`with (obj) {
`+Gt+`
}
`;else if(Rt.test(We))throw new qe(Ei);Gt=(yt?Gt.replace(Js,""):Gt).replace(xs,"$1").replace(Ma,"$1;"),Gt="function("+(We||"obj")+`) {
`+(We?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(lt?", __e = _.escape":"")+(yt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Gt+`return __p
}`;var vr=id(function(){return lr(q,Ce+"return "+Gt).apply(tt,et)});if(vr.source=Gt,Nl(vr))throw vr;return vr}function pd(a){return dr(a).toLowerCase()}function fd(a){return dr(a).toUpperCase()}function dd(a,c,g){if(a=dr(a),a&&(g||c===tt))return Du(a);if(!a||!(c=wo(c)))return a;var b=vo(a),z=vo(c),q=ns(b,z),et=Bu(b,z)+1;return _a(b,q,et).join("")}function md(a,c,g){if(a=dr(a),a&&(g||c===tt))return a.slice(0,ks(a)+1);if(!a||!(c=wo(c)))return a;var b=vo(a),z=Bu(b,vo(c))+1;return _a(b,0,z).join("")}function gd(a,c,g){if(a=dr(a),a&&(g||c===tt))return a.replace(nt,"");if(!a||!(c=wo(c)))return a;var b=vo(a),z=ns(b,vo(c));return _a(b,z).join("")}function yd(a,c){var g=jo,b=ao;if(qr(c)){var z="separator"in c?c.separator:z;g="length"in c?ur(c.length):g,b="omission"in c?wo(c.omission):b}a=dr(a);var q=a.length;if(fa(a)){var et=vo(a);q=et.length}if(g>=q)return a;var lt=g-ta(b);if(lt<1)return b;var yt=et?_a(et,0,lt).join(""):a.slice(0,lt);if(z===tt)return yt+b;if(et&&(lt+=yt.length-lt),ul(z)){if(a.slice(lt).search(z)){var Ot,Nt=yt;for(z.global||(z=Ke(z.source,dr(ce.exec(z))+"g")),z.lastIndex=0;Ot=z.exec(Nt);)var Gt=Ot.index;yt=yt.slice(0,Gt===tt?lt:Gt)}}else if(a.indexOf(wo(z),lt)!=lt){var pe=yt.lastIndexOf(z);pe>-1&&(yt=yt.slice(0,pe))}return yt+b}function vd(a){return a=dr(a),a&&La.test(a)?a.replace(aa,pu):a}var _d=Al(function(a,c,g){return a+(g?" ":"")+c.toUpperCase()}),Kf=np("toUpperCase");function nd(a,c,g){return a=dr(a),c=g?tt:c,c===tt?Ps(a)?fu(a):Ko(a):a.match(c)||[]}var id=cr(function(a,c){try{return mn(a,tt,c)}catch(g){return Nl(g)?g:new qe(g)}}),xd=Ns(function(a,c){return Cn(c,function(g){g=wa(g),Vt(a,g,Ue(a[g],a))}),a});function bd(a){var c=a==null?0:a.length,g=Fe();return a=c?Dr(a,function(b){if(typeof b[1]!="function")throw new an(h);return[g(b[0]),b[1]]}):[],cr(function(b){for(var z=-1;++z<c;){var q=a[z];if(mn(q[0],this,b))return mn(q[1],this,b)}})}function wd(a){return ve(ae(a,pn))}function Yf(a){return function(){return a}}function Sd(a,c){return a==null||a!==a?c:a}var Td=Pl(),Id=Pl(!0);function Ia(a){return a}function Jf(a){return bi(typeof a=="function"?a:ae(a,pn))}function Ed(a){return Wu(ae(a,pn))}function Ad(a,c){return oc(a,ae(c,pn))}var Pd=cr(function(a,c){return function(g){return ya(g,a,c)}}),Cd=cr(function(a,c){return function(g){return ya(a,g,c)}});function $f(a,c,g){var b=Ri(c),z=vn(c,b);g==null&&!(qr(c)&&(z.length||!b.length))&&(g=c,c=a,a=this,z=vn(c,Ri(c)));var q=!(qr(g)&&"chain"in g)||!!g.chain,et=ra(a);return Cn(z,function(lt){var yt=c[lt];a[lt]=yt,et&&(a.prototype[lt]=function(){var Ot=this.__chain__;if(q||Ot){var Nt=a(this.__wrapped__),Gt=Nt.__actions__=No(this.__actions__);return Gt.push({func:yt,args:arguments,thisArg:a}),Nt.__chain__=Ot,Nt}return yt.apply(a,mo([this.value()],arguments))})}),a}function zd(){return Pn._===this&&(Pn._=gt),this}function Qf(){}function kd(a){return a=ur(a),cr(function(c){return ph(c,a)})}var Md=xh(Dr),Ld=xh(Ji),Dd=xh(rs);function od(a){return jc(a)?pa(wa(a)):of(a)}function Rd(a){return function(c){return a==null?tt:Vr(a,c)}}var Bd=ap(),Od=ap(!0);function td(){return[]}function ed(){return!1}function Fd(){return{}}function Ud(){return""}function Nd(){return!0}function Vd(a,c){if(a=ur(a),a<1||a>Bi)return[];var g=fn,b=Ee(a,fn);c=Fe(c),a-=fn;for(var z=nr(b,c);++g<a;)c(g);return z}function qd(a){return Ne(a)?Dr(a,wa):no(a)?[a]:No($u(dr(a)))}function Zd(a){var c=++ct;return dr(a)+c}var jd=Vc(function(a,c){return a+c},0),Gd=bh("ceil"),Wd=Vc(function(a,c){return a/c},1),Xd=bh("floor");function Hd(a){return a&&a.length?Pe(a,Ia,ai):tt}function Kd(a,c){return a&&a.length?Pe(a,Fe(c,2),ai):tt}function Yd(a){return ha(a,Ia)}function Jd(a,c){return ha(a,Fe(c,2))}function $d(a){return a&&a.length?Pe(a,Ia,ic):tt}function Qd(a,c){return a&&a.length?Pe(a,Fe(c,2),ic):tt}var tm=Vc(function(a,c){return a*c},1),em=bh("round"),rm=Vc(function(a,c){return a-c},0);function nm(a){return a&&a.length?yi(a,Ia):0}function im(a,c){return a&&a.length?yi(a,Fe(c,2)):0}return F.after=$t,F.ary=fe,F.assign=Nf,F.assignIn=Ws,F.assignInWith=Gl,F.assignWith=Np,F.at=nh,F.before=Qt,F.bind=Ue,F.bindAll=xd,F.bindKey=be,F.castArray=$e,F.chain=fs,F.chunk=yp,F.compact=vp,F.concat=_p,F.cond=bd,F.conforms=wd,F.constant=Yf,F.countBy=Up,F.create=ms,F.curry=ue,F.curryRight=Ge,F.debounce=Be,F.defaults=ih,F.defaultsDeep=Ec,F.defer=sr,F.delay=me,F.difference=xp,F.differenceBy=Tf,F.differenceWith=If,F.drop=bp,F.dropRight=wp,F.dropRightWhile=Hc,F.dropWhile=Sp,F.fill=Kc,F.filter=e,F.flatMap=l,F.flatMapDeep=p,F.flatMapDepth=d,F.flatten=Qu,F.flattenDeep=Ef,F.flattenDepth=Af,F.flip=gr,F.flow=Td,F.flowRight=Id,F.fromPairs=Pf,F.functions=Zp,F.functionsIn=jp,F.groupBy=S,F.initial=Tp,F.intersection=zh,F.intersectionBy=Ip,F.intersectionWith=Ep,F.invert=uh,F.invertBy=Wp,F.invokeMap=E,F.iteratee=Jf,F.keyBy=k,F.keys=Ri,F.keysIn=So,F.map=R,F.mapKeys=cl,F.mapValues=Wl,F.matches=Ed,F.matchesProperty=Ad,F.memoize=Nr,F.merge=Xl,F.mergeWith=hl,F.method=Pd,F.methodOf=Cd,F.mixin=$f,F.negate=Kr,F.nthArg=kd,F.omit=Hl,F.omitBy=Xp,F.once=rn,F.orderBy=Z,F.over=Md,F.overArgs=Yr,F.overEvery=Ld,F.overSome=Dd,F.partial=tn,F.partialRight=Dn,F.partition=j,F.pick=Hp,F.pickBy=Uh,F.property=od,F.propertyOf=Rd,F.pull=kh,F.pullAll=Ap,F.pullAllBy=Ll,F.pullAllWith=mc,F.pullAt=kr,F.range=Bd,F.rangeRight=Od,F.rearg=qn,F.reject=pt,F.remove=kf,F.rest=Li,F.reverse=gc,F.sampleSize=_t,F.set=Nh,F.setWith=Vh,F.shuffle=xt,F.slice=Dl,F.sortBy=Yt,F.sortedUniq=Ff,F.sortedUniqBy=Pp,F.split=nf,F.spread=Kn,F.tail=Cp,F.take=zp,F.takeRight=kp,F.takeRightWhile=Jc,F.takeWhile=el,F.tap=Qc,F.throttle=Di,F.thru=il,F.toArray=Oh,F.toPairs=ys,F.toPairsIn=qh,F.toPath=qd,F.toPlainObject=jl,F.transform=Zh,F.unary=xn,F.union=Mh,F.unionBy=Rl,F.unionWith=Mp,F.uniq=Mn,F.uniqBy=Hr,F.uniqWith=Lp,F.unset=jh,F.unzip=$c,F.unzipWith=Lh,F.update=Yp,F.updateWith=Gh,F.values=pl,F.valuesIn=Jp,F.without=Dp,F.words=nd,F.wrap=Yn,F.xor=Rp,F.xorBy=Dh,F.xorWith=rl,F.zip=nl,F.zipObject=Bp,F.zipObjectDeep=Ln,F.zipWith=yc,F.entries=ys,F.entriesIn=qh,F.extend=Ws,F.extendWith=Gl,$f(F,F),F.add=jd,F.attempt=id,F.camelCase=Qp,F.capitalize=Cc,F.ceil=Gd,F.clamp=Wh,F.clone=Br,F.cloneDeep=hr,F.cloneDeepWith=qi,F.cloneWith=Ar,F.conformsTo=wi,F.deburr=tf,F.defaultTo=Sd,F.divide=Wd,F.endsWith=ef,F.eq=fr,F.escape=Vf,F.escapeRegExp=qf,F.every=t,F.find=r,F.findIndex=fc,F.findKey=oh,F.findLast=s,F.findLastIndex=dc,F.findLastKey=ah,F.floor=Xd,F.forEach=v,F.forEachRight=x,F.forIn=Fh,F.forInRight=Vp,F.forOwn=Ac,F.forOwnRight=qp,F.get=sh,F.gt=In,F.gte=Si,F.has=Gp,F.hasIn=io,F.head=tl,F.identity=Ia,F.includes=I,F.indexOf=Ch,F.inRange=$p,F.invoke=gs,F.isArguments=Qe,F.isArray=Ne,F.isArrayBuffer=Zo,F.isArrayLike=Rn,F.isArrayLikeObject=tr,F.isBoolean=ds,F.isBuffer=Ti,F.isDate=Ol,F.isElement=ol,F.isEmpty=Fl,F.isEqual=Zs,F.isEqualWith=Ul,F.isError=Nl,F.isFinite=Vl,F.isFunction=ra,F.isInteger=vc,F.isLength=al,F.isMap=sl,F.isMatch=Eu,F.isMatchWith=ql,F.isNaN=th,F.isNative=eh,F.isNil=xc,F.isNull=_c,F.isNumber=bc,F.isObject=qr,F.isObjectLike=hn,F.isPlainObject=js,F.isRegExp=ul,F.isSafeInteger=wc,F.isSet=Sc,F.isString=Gs,F.isSymbol=no,F.isTypedArray=Ga,F.isUndefined=Tc,F.isWeakMap=ll,F.isWeakSet=Ic,F.join=Cf,F.kebabCase=Zf,F.last=Sa,F.lastIndexOf=zf,F.lowerCase=jf,F.lowerFirst=Gf,F.lt=Zl,F.lte=Bh,F.max=Hd,F.maxBy=Kd,F.mean=Yd,F.meanBy=Jd,F.min=$d,F.minBy=Qd,F.stubArray=td,F.stubFalse=ed,F.stubObject=Fd,F.stubString=Ud,F.stubTrue=Nd,F.multiply=tm,F.nth=Yc,F.noConflict=zd,F.noop=Qf,F.now=se,F.pad=Wf,F.padEnd=Xf,F.padStart=Hf,F.parseInt=vs,F.random=Pc,F.reduce=it,F.reduceRight=J,F.repeat=lh,F.replace=rf,F.result=Kp,F.round=em,F.runInContext=ft,F.sample=dt,F.size=Pt,F.snakeCase=zc,F.some=qt,F.sortedIndex=Mf,F.sortedIndexBy=Lf,F.sortedIndexOf=Df,F.sortedLastIndex=Rf,F.sortedLastIndexBy=Bf,F.sortedLastIndexOf=Of,F.startCase=ld,F.startsWith=cd,F.subtract=rm,F.sum=nm,F.sumBy=im,F.template=hd,F.times=Vd,F.toFinite=Wa,F.toInteger=ur,F.toLength=rh,F.toLower=pd,F.toNumber=Ta,F.toSafeInteger=bn,F.toString=dr,F.toUpper=fd,F.trim=dd,F.trimEnd=md,F.trimStart=gd,F.truncate=yd,F.unescape=vd,F.uniqueId=Zd,F.upperCase=_d,F.upperFirst=Kf,F.each=v,F.eachRight=x,F.first=tl,$f(F,function(){var a={};return en(F,function(c,g){H.call(F.prototype,g)||(a[g]=c)}),a}(),{chain:!1}),F.VERSION=_s,Cn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){F[a].placeholder=F}),Cn(["drop","take"],function(a,c){er.prototype[a]=function(g){g=g===tt?1:he(ur(g),0);var b=this.__filtered__&&!c?new er(this):this.clone();return b.__filtered__?b.__takeCount__=Ee(g,b.__takeCount__):b.__views__.push({size:Ee(g,fn),type:a+(b.__dir__<0?"Right":"")}),b},er.prototype[a+"Right"]=function(g){return this.reverse()[a](g).reverse()}}),Cn(["filter","map","takeWhile"],function(a,c){var g=c+1,b=g==ui||g==li;er.prototype[a]=function(z){var q=this.clone();return q.__iteratees__.push({iteratee:Fe(z,3),type:g}),q.__filtered__=q.__filtered__||b,q}}),Cn(["head","last"],function(a,c){var g="take"+(c?"Right":"");er.prototype[a]=function(){return this[g](1).value()[0]}}),Cn(["initial","tail"],function(a,c){var g="drop"+(c?"":"Right");er.prototype[a]=function(){return this.__filtered__?new er(this):this[g](1)}}),er.prototype.compact=function(){return this.filter(Ia)},er.prototype.find=function(a){return this.filter(a).head()},er.prototype.findLast=function(a){return this.reverse().find(a)},er.prototype.invokeMap=cr(function(a,c){return typeof a=="function"?new er(this):this.map(function(g){return ya(g,a,c)})}),er.prototype.reject=function(a){return this.filter(Kr(Fe(a)))},er.prototype.slice=function(a,c){a=ur(a);var g=this;return g.__filtered__&&(a>0||c<0)?new er(g):(a<0?g=g.takeRight(-a):a&&(g=g.drop(a)),c!==tt&&(c=ur(c),g=c<0?g.dropRight(-c):g.take(c-a)),g)},er.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},er.prototype.toArray=function(){return this.take(fn)},en(er.prototype,function(a,c){var g=/^(?:filter|find|map|reject)|While$/.test(c),b=/^(?:head|last)$/.test(c),z=F[b?"take"+(c=="last"?"Right":""):c],q=b||/^find/.test(c);!z||(F.prototype[c]=function(){var et=this.__wrapped__,lt=b?[1]:arguments,yt=et instanceof er,Ot=lt[0],Nt=yt||Ne(et),Gt=function(Pr){var Or=z.apply(F,mo([Pr],lt));return b&&pe?Or[0]:Or};Nt&&g&&typeof Ot=="function"&&Ot.length!=1&&(yt=Nt=!1);var pe=this.__chain__,Ce=!!this.__actions__.length,We=q&&!pe,vr=yt&&!Ce;if(!q&&Nt){et=vr?et:new er(this);var Xe=a.apply(et,lt);return Xe.__actions__.push({func:il,args:[Gt],thisArg:tt}),new Ni(Xe,pe)}return We&&vr?a.apply(this,lt):(Xe=this.thru(Gt),We?b?Xe.value()[0]:Xe.value():Xe)})}),Cn(["pop","push","shift","sort","splice","unshift"],function(a){var c=Ms[a],g=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",b=/^(?:pop|shift)$/.test(a);F.prototype[a]=function(){var z=arguments;if(b&&!this.__chain__){var q=this.value();return c.apply(Ne(q)?q:[],z)}return this[g](function(et){return c.apply(Ne(et)?et:[],z)})}}),en(er.prototype,function(a,c){var g=F[c];if(g){var b=g.name+"";H.call(_i,b)||(_i[b]=[]),_i[b].push({name:c,func:g})}}),_i[Vo(tt,Zi).name]=[{name:"wrapper",func:tt}],er.prototype.clone=Za,er.prototype.reverse=du,er.prototype.value=Nu,F.prototype.at=Rh,F.prototype.chain=Bl,F.prototype.commit=qs,F.prototype.next=Op,F.prototype.plant=Uf,F.prototype.reverse=Hn,F.prototype.toJSON=F.prototype.valueOf=F.prototype.value=Iu,F.prototype.first=F.prototype.head,Qr&&(F.prototype[Qr]=Fp),F},da=Na();la?((la.exports=da)._=da,Ts._=da):Pn._=da}).call(kc)})(rd,rd.exports);var sm=rd.exports;export{sm as _,am as c,om as m};
